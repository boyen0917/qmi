function initSingleChatGallery(e,t){var i=$(".al-single main");list=[],name?$(".subpage-album .title").html(name).show():$(".subpage-album .title").hide(),i.html(""),cns.debug(ui,at,lang,this_gi,this_gai);try{getAlbum(this_gi,this_gai).complete(function(e){if(200==e.status){var t=$.parseJSON(e.responseText),a=t.fl.length;$(".al-single .hd-photoCnt").html(a);for(var n=0;n<t.fl.length;n++){var o=t.fl[n],s=new Date(o.ct),r=s.customFormat("_#YYYY#_#MM#_#DD#"),l=s.customFormat("#YYYY#/#MM#/#DD#"),c=$("."+r);if(c.length<=0){c=$("<div class='container "+r+"'></div>");var d=$("<div class='ct-info'></div>");d.append("<div class='date'>"+l+"</div>"),d.append("<div class='cnt'></div>"),d.append("<img class='img' src='images/icon/icon_album_single.png'/>"),c.append(d),c.append("<div class='ct-imgList'></div>"),i.append(c)}var a=c.find("img").length-1;c.find(".cnt").html(a+1);var u=$("<div class='imgGrid'><img/></div>"),h=minetypeToTypeID(o.mt);if(h>0){var p=u.find("img");p.data("index",list.length),p.attr("src",o.th),cns.debug(list.length,o.th),list.push({s32:"",text:l}),getS3fileSP(o.fi,o.pi,p,h)}c.find(".ct-imgList").append(u)}}})}catch(a){errorReport(a)}}function getS3fileSP(e,t,i,a){var n="groups/"+this_gi+"/files/"+e+"?pi="+t+"&ti="+this_ti,o={ui:ui,at:at,li:lang},s="get",r=ajaxDo(n,o,s,!1);r.complete(function(e){if(200!=e.status)return!1;var t=$.parseJSON(e.responseText);if(t.api_name=n,!i||!a)return t.s3;switch(a){case 6:var o=i.data("index");o>=0&&o<list.length&&(list[o].s32=t.s32);break;case 8:i.attr("src",t.s3)}})}function showAddMemberPage(){$.mobile.changePage("#page-contact-addmem"),$("#page-contact-addmem .ca-list-area .cal-coachmake").show(),$("#page-contact-addmem .ca-list-area .cal-div-area").hide(),initQRCodePage(),$("#page-contact-addmem .ca-nav-box").off("click").click(function(){var e=$(this);e.hasClass("ca-invite")?($("#page-contact-addmem .ca-invite-area").show(),$("#page-contact-addmem .ca-list-area").hide()):($("#page-contact-addmem .ca-invite-area").hide(),$("#page-contact-addmem .ca-list-area").show(),getInviteList()),$("#page-contact-addmem .ca-nav-active").removeClass("ca-nav-active"),e.addClass("ca-nav-active")}),$("#page-contact-addmem .ca-invite").trigger("click"),$("#page-contact-addmem .ca-invite-submit").off("click").click(sendInvite),updateInvitePending()}function updateInvitePending(){var e="groups/"+gi+"/invitations",t={ui:ui,at:at,li:lang},i="get",a=ajaxDo(e,t,i,!1);a.complete(function(e){if(200!=e.status)return!1;var t=$.parseJSON(e.responseText);t&&t.hasOwnProperty("il")&&(inviteGuAll=t.il);var i=$.lStorage(ui);i&&gi&&i.hasOwnProperty(gi)&&(i[gi].inviteGuAll=inviteGuAll),$.lStorage(ui,i);var a=$("#page-contact-addmem .ca-pending-area"),n=a.children(".list"),o=a.children(".coach");if(inviteGuAll&&inviteGuAll.length>0){o.hide(),n.html("").show();for(var s=$('<div class="row"><div class="left"><img class="pend_img" src="images/common/others/empty_img_personal_l.png"/></div><div class="mid"><div class="name"></div><div class="phone"></div></div><div class="right"><img class="resend" src="images/icon/icon_invite_mail.png"/><img class="del" src="images/icon/icon_chatroom_chatlist_del.png"</div></div>'),r=0;r<inviteGuAll.length;r++){var l=inviteGuAll[r],c=s.clone();c.find(".name").html(htmlFormat(l.nk||"")),c.find(".phone").text(l.ik||""),c.data("pn",l.ik).data("nk",l.nk).data("gi",gi),n.append(c)}n.find(".resend").click(function(e){var t=$(this).parents(".row"),i=t.data("gi"),a=t.data("pn"),n=t.data("nk");cns.debug("resend",a,n),i&&n&&a?sendInviteAPI(i,[{pn:a,nk:n}],function(e){if(200==e.status)try{var t=$.parseJSON(e.responseText);1==t.ul[0].aj?toastShow($.i18n.getString("INVITE_ALREADY_IN_GROUP")):toastShow($.i18n.getString("INVITE_SUCC")),updateInvitePending()}catch(i){toastShow($.i18n.getString("INVITE_FAIL")),errorReport(i)}else toastShow($.i18n.getString("INVITE_FAIL"))}):toastShow($.i18n.getString("INVITE_FAIL"))}),n.find(".del").click(function(e){var t=$(this).parents(".row"),i=t.data("gi"),a=t.data("pn");if(cns.debug("del",i,a),i&&a){var n=!1;removeInviteAPI(i,[{ik:a}],function(e){if(200==e.status)try{var t=$.parseJSON(e.responseText);updateInvitePending(),toastShow(t.rsp_msg),n=!0}catch(i){errorReport(i)}n||toastShow($.i18n.getString("INVITE_DELETED_FAIL"))})}else toastShow($.i18n.getString("INVITE_DELETED_FAIL"))})}else o.show(),n.hide()})}function getInviteList(){var e="groups/"+gi+"/invitations",t={ui:ui,at:at,li:lang},i="get",a=ajaxDo(e,t,i,!1);a.complete(function(e){if(200!=e.status)return!1;var t=$.parseJSON(e.responseText);if(t.il&&t.il.length<=0)$("#page-contact-addmem .ca-list-area .cal-coachmake").fadeIn(),$("#page-contact-addmem .ca-list-area .cal-div-area").fadeOut();else{var i=$("#page-contact-addmem .ca-list-area .cal-div-area");i.html("");for(var a=0;a<t.il.length;a++){var n=t.il[a];if(n){var o=$("<div class='cal-row'></div>");if(o.append("<div class='photo'><img class='st-user-pic' src='images/common/others/empty_img_personal_l.png'/></div>"),o.append("<div class=info><div class='name'></div><div class='tel'></div></div>"),o.append("<div class='img'><img src='images/invitemembers/invitemembers_icon_reinvite.png'/></div>"),i.append(o),n.aut&&o.find(".photo img").attr("src",n.aut.replaceOriEmojiCode()),n.nk&&o.find(".info .name").html(n.nk.replaceOriEmojiCode()),n.ik&&n.ik.length>0)if(0==n.tp){var s=n.ik.replace(/^(\+.{3})/,"0");o.find(".info .tel").html(s)}else o.find(".info .tel").html(n.ik)}}$("#page-contact-addmem .ca-list-area .cal-coachmake").fadeOut(),i.fadeIn()}})}function sendInvite(){var e=$(".cai-name input").val();if(!e||0==e.length)return void popupShowAdjust("",$.i18n.getString("INVITE_DISPLAY_NAME"));var t=$(".cai-num input").val();if(!t||0==t.length)return void popupShowAdjust("",$.i18n.getString("INVITE_PHONE_NUMBER"));if(t.length<10||0!=t.indexOf("0"))return void popupShowAdjust("",$.i18n.getString("INVITE_PHONE_ERROR"));var i=$(".cai-area .area");t=t.replace(/^0/,i.html()),sendInviteAPI(gi,[{pn:t,nk:e}],function(i){if(200==i.status)try{var a=$.parseJSON(i.responseText);1==a.ul[0].aj?toastShow($.i18n.getString("INVITE_ALREADY_IN_GROUP")):(toastShow($.i18n.getString("INVITE_SUCC")),$(".cai-name input").val(""),$(".cai-num input").val("")),inviteGuAll||(inviteGuAll={}),inviteGuAll[a.ul[0].gu]={gu:a.ul[0].gu,ik:a.ul[0].ik,tp:a.ul[0].tp,st:0,nk:e,pn:t},updateInvitePending()}catch(n){}else toastShow($.i18n.getString("INVITE_FAIL"))})}function sendInviteAPI(e,t,i){var a,n="groups/"+e+"/invitations",o={ui:ui,at:at,li:lang};try{if(0==e.indexOf(_pri_split_chat)){var s=parsePrivateGi(e),r=$.lStorage("_pri_group")[s.ci];o.uui=ui,o.uat=at,o.ui=r.ui,o.at=r.at,a=r.cl,n="groups/"+s.gi+"/invitations"}}catch(l){errorReport(l)}var c={ul:t},d="post",u=ajaxDo(n,o,d,!1,c,null,null,a);u.complete(function(e){i(e)})}function removeInviteAPI(e,t,i){var a="groups/"+e+"/invitations",n={ui:ui,at:at,li:lang},o={il:t},s="put",r=ajaxDo(a,n,s,!1,o);r.complete(function(e){i(e)})}function updateContactBranchList(){if($(".subpage-contact").is(":visible"))$(".sm-small-area[data-sm-act=memberslist]").trigger("click");else{var e=$(".contact-subpages");e.is(":visible")&&e.find(".page-back").trigger("click")}}function updateContactFavorite(){initContactData();var e=$(".subpage-contact");if(e.length>0){var t=e.find(".row.favorite .left");if(t.length>0){var i=Object.keys(fbl).length;t.find(".detail.mem").html($.i18n.getString("COMPOSE_N_MEMBERS",g_group.favCnt?g_group.favCnt:0));var a=t.find(".detail.branch");i>0?a.html($.i18n.getString("COMPOSE_N_SUBGROUP",i)):a.hide()}}var n=$("#page-contact_favorite");n.length>0&&updateFavoritePage(!1)}function initQRCodePage(){var e=$(".ca-qrcode-area"),t=e.find(".qr_img_container");t.find("img").hide();var i=e.find(".switch"),a=e.find(".qr_btn[data-type=save]");a.addClass("disabled"),a.removeAttr("href"),a.removeAttr("download");var n="groups/"+gi+"/qrcode",o={ui:ui,at:at,li:lang};ajaxDo(n,o,"get",!0).complete(function(e){if(200==e.status){var n=$.parseJSON(e.responseText);if(!n||n.rsp_code<0)return t.find("img").hide(),void t.addClass("disabled");i.attr("data-enabled",n.rps),0==n.qst?(t.removeClass("disabled"),i.children("img").attr("src","images/registration/checkbox_check.png")):(t.addClass("disabled"),i.children("img").attr("src","images/registration/checkbox_none.png")),t.find("img").attr("src",n.qru).show(),a.removeClass("disabled"),a.attr("href",n.qru);var o=getQRCodeFileNameWithExtension(n.qru);a.attr("download",o)}}),$("#page-contact-addmem .ca-tab").off("click").click(function(){$(this).parent().find(".ca-tab.active").removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-type");$("#page-contact-addmem .ca-sub-area.active").removeClass("active"),$("#page-contact-addmem ."+e).addClass("active"),"pending"==e&&updateInvitePending()}),$("#page-contact-addmem .ca-qrcode-area .switch").off("click").click(function(){var e=$(this),t=(new Date).getTime();return e.data("enabledTime")&&e.data("enabledTime")>t?void toastShow($.i18n.getString("COMMON_ACT_TOO_FREQUENT")):(e.data("enabledTime",t+3e3),void updateQRCodeSetting(0==e.attr("data-enabled")?1:0))}),$("#page-contact-addmem .ca-qrcode-area .qr_btn[data-type='update']").off("click").click(function(){var e=$(this),t=(new Date).getTime();return e.data("enabledTime")&&e.data("enabledTime")>t?void toastShow($.i18n.getString("COMMON_ACT_TOO_FREQUENT")):(e.data("enabledTime",t+3e3),void refreshQRCode())})}function refreshQRCode(e){cns.debug("refreshQRCode");var t=$(".ca-qrcode-area"),i=t.find(".qr_img_container");i.addClass("disabled"),i.find("img").hide();var a=t.find(".qr_btn[data-type=save]");a.addClass("disabled"),a.removeAttr("href"),a.removeAttr("download");var n="groups/"+gi+"/qrcode",o={ui:ui,at:at,li:lang};ajaxDo(n,o,"put",!0).complete(function(t){if(200==t.status){var n=$.parseJSON(t.responseText);if(!n||n.rsp_code<0)return i.find("img").hide(),i.addClass("disabled"),void(e&&e(!1));i.find("img").attr("src",n.qru).off("load").load(function(){$(this).show(),i.removeClass("disabled"),a.removeClass("disabled")}),a.attr("href",n.qru);var o=getQRCodeFileNameWithExtension(n.qru);a.attr("download",o),e&&e(!0)}else i.find("img").hide(),i.addClass("disabled"),e&&e(!1)})}function updateQRCodeSetting(e,t){var i="groups/"+gi,a={ui:ui,at:at,li:lang},n={qst:e};ajaxDo(i,a,"put",!0,n).complete(function(e){if(200==e.status){var i=$.parseJSON(e.responseText),a=$("#page-contact-addmem"),n=a.find(".ca-qrcode-area .switch");n.attr("data-enabled",i.qst);var o=a.find(".qr_img_container");1==i.qst?(o.addClass("disabled"),n.children("img").attr("src","images/registration/checkbox_none.png")):(o.removeClass("disabled"),n.children("img").attr("src","images/registration/checkbox_check.png")),t&&t(!0)}else t&&t(!1)})}function requestLeaveGroup(e,t,i){var a="groups/"+e+"/users/"+t+"/status",n={ui:ui,at:at,li:lang},o="put",s={st:2};ajaxDo(a,n,o,!0,s).complete(function(t){200==t.status&&(removeGroup(e),i&&i())})}function removeGroup(e){if($(".sm-group-area[data-gi="+e+"]").remove(),gi==e){var t=$(".sm-group-area.enable");t.length>0?$(t[0]).trigger("click"):(delete $.lStorage(ui)[e],$(document).data("page-history",[]),$(".page-back").hide(),$(".hg-create").trigger("click"))}try{var i="unknown",a=$.lStorage(ui);if(a.hasOwnProperty(e)){var n=a[e];null!=n&&null!=n.gn&&(i=n.gn),delete a[e],$.lStorage(ui,a)}var o=$.lStorage("_groupList");$.each(o,function(t,i){var a=o[t];return a.gi==e?(o.splice(t,1),!1):void 0}),$.lStorage("_groupList",o),a=$.lStorage(ui),null==g_idb_chat_cnts?initChatCntDB(clearChatIDB(e)):clearChatIDB(e),toastShow($.i18n.getString("GROUP_X_DELETED",i))}catch(s){errorReport(s)}}function clearChatIDB(e,t){g_idb_chat_msgs.iterate(function(e){try{null!=e&&(cns.debug(e.ei),g_idb_chat_msgs.remove(e.ei))}catch(t){errorReport(t)}},{index:"gi_ci_ct",keyRange:g_idb_chat_msgs.makeKeyRange({upper:[e,"T9999999999"],lower:[e,"T0000000000"]}),order:"DESC",onEnd:function(e){cns.debug("onError:",e),t&&t()},onError:function(e){cns.debug("onError:",e)}})}function clearTimelineIDB(e,t){idb_timeline_events.iterate(function(e){try{null!=e&&(cns.debug(e.ei),idb_timeline_events.remove(e.ei))}catch(t){errorReport(t)}},{index:"gi_ct",keyRange:idb_timeline_events.makeKeyRange({upper:[e,9999999999999],lower:[e]}),order:"DESC",onEnd:function(e){cns.debug("onError:",e),t&&t()},onError:function(e){cns.debug("onError:",e)}})}function showUpdatePermissionPage(){var e={};try{var t=$.lStorage(ui),i=t[gi].guAll;for(var a in i){var n=i[a];1==n.st&&1==n.ad&&(e[a]=n.nk)}}catch(o){errorReport(o)}var s={isShowBranch:!1,isShowSelf:!0,isShowAll:!1,isShowFav:!0,isShowFavBranch:!1,isShowLeftMem:!1},r=$(".gs-row[data-type=permission]");r.data("object_str",JSON.stringify(e)),composeObjectShowDelegate(r,r,s,function(){try{var t=$.parseJSON(r.data("object_str")),i=[],a=[];for(var n in t)e.hasOwnProperty(n)||i.push(n);for(var n in e)t.hasOwnProperty(n)||a.push(n);requestUpdatePermission(gi,i,a,null)}catch(o){}})}function requestUpdatePermission(e,t,i,a){var n="groups/"+e+"/administrators",o={ui:ui,at:at,li:lang},s="put",r={el:t,dl:i};ajaxDo(n,o,s,!0,r).complete(function(t){200==t.status?setGroupAllUser(null,e,a):a&&a(t)})}function showGroupInfoPage(){var e=!1,t=$.i18n.getString("USER_PROFILE_NO_DATA"),i=t,a=null;try{var n=$.lStorage(ui),o=n[gi];e=1==o.ad,t=o.gn,i=o.gd,a=o.auo}catch(s){errorReport(s)}var r=$(".ga-info.view");r.show(),$(".ga-info.edit").hide(),e?(r.addClass("admin"),$(".ga-avatar").addClass("admin"),$(".subpage-groupAbout .admin").show(),$(".subpage-groupAbout .general").hide(),$(".ga-header-bar").removeClass("bgColor"),$(".ga-info.edit .ga-info-row[data-type='name'] .content").val(t),$(".ga-info.edit .ga-info-row[data-type='info'] .content").val(i)):(r.removeClass("admin"),$(".ga-avatar").removeClass("admin"),$(".subpage-groupAbout .admin").hide(),$(".subpage-groupAbout .general").show(),$(".ga-header-bar").addClass("bgColor")),$(".subpage-groupAbout").css("margin-left","100%"),$(".subpage-groupAbout").show(),$(".subpage-groupAbout").off("animate").animate({marginLeft:"0%"},1e3,function(){$(".subpage-groupSetting").hide(),$(".subpage-contact").hide(),$(".subpage-timeline").hide(),$(".subpage-chatList").hide(),$(".subpage-album").hide()}),$(".subpage-contact").is(":visible")?$(".subpage-groupAbout").data("lastPage",".subpage-contact"):$(".subpage-timeline").is(":visible")?$(".subpage-groupAbout").data("lastPage",".subpage-timeline"):$(".subpage-chatList").is(":visible")?$(".subpage-groupAbout").data("lastPage",".subpage-chatList"):$(".subpage-album").is(":visible")?$(".subpage-groupAbout").data("lastPage",".subpage-album"):$(".subpage-groupSetting").is(":visible")&&$(".subpage-groupAbout").data("lastPage",".subpage-groupSetting");var l=$(".ga-avatar-img");l.filter(".upload").hide(),l.filter(".currentGroup").show(),resetGroupInfo()}function resetGroupInfo(){$(".ga-header-done").removeClass("ready");var e=$(".ga-avatar input");e.replaceWith(e.clone(!0));var t=$(".ga-info"),i=t.filter(".edit .ga-info-row .content");$.each(i,function(e,t){var i=$(t);i.data("oriText",i.val())}),t.filter(".view").show(),t.filter(".edit").hide()}function checkGroupInfoChange(){$(".ga-avatar input").hasClass("ready")||$(".ga-info.edit .ga-info-row .content.ready").length>0?$(".ga-header-done").addClass("ready"):$(".ga-header-done").removeClass("ready")}function requestUpdateGroupInfo(e,t,i,a,n){var o=!1;if(null!=t||null!=i?getUpdateGroupInfoApi(e,t,i).complete(function(t){200==t.status&&(o&&setGroupAllUser(null,e,function(){n&&n(),s_load_show=!1}),o=!0)}):o=!0,a){var s=[1280,1280,.7],r=[120,120,.6],l="groups/"+e+"/avatar";uploadToS3(a,l,s,r,function(t){if(t||toastShow($.i18n.getString("GROUP_AVATAR_UPLOAD_ALERT")),o){var i=$(".ga-avatar-img");i.filter(".currentGroup").load(function(){$(this).show().off("load"),i.filter(".upload").hide()}),setGroupAllUser(null,e,function(){n&&n(),s_load_show=!1})}o=!0})}else o=!0}function getUpdateGroupInfoApi(e,t,i){var a="groups/"+e,n={ui:ui,at:at,li:lang},o="put",s={};return t&&(s.gn=t),i&&(s.gd=i),ajaxDo(a,n,o,!0,s)}function initChatDB(e){null==g_idb_chat_msgs&&(g_idb_chat_msgs=new IDBStore({dbVersion:2,storeName:"chat_msgs",keyPath:"ei",indexes:[{name:"gi_ci_ct",keyPath:["gi","ci","ct"]}],onStoreReady:e}))}function onReceivePollingChatMsg(e){cns.debug("-----------------------");for(var t=0;t<e.length;t++){var i=e[t];i.cnt=0;for(var a=0;a<i.el.length;a++){var n=i.el[a];if(n.cn=i.cn,n.hasOwnProperty("meta")){var o={gi:i.gi,ci:i.ci,ei:n.ei,ct:n.meta.ct,data:n};g_idb_chat_msgs.put(o,function(t){onPollingMsgSaveSucc(e,t,n)});cns.debug("[updateChatDB]",i.gi,i.ci,n.ei,n.ml[0].c)}}}}function onPollingMsgSaveSucc(e,t,i){for(var i,a=0;a<e.length;a++)for(var n=e[a],o=0;o<n.el.length;o++)if(i=n.el[o],i.ei==t){n.cnt++;break}if(!i)return void cns.debug("ei no match",ei);var s=n.gi,r=n.ci;cns.debug(i.ei);var l=!1;null!=windowList&&(windowList.hasOwnProperty(r)&&null!=windowList[r]&&0==windowList[r].closed?(l=!0,n.cnt>=n.el.length&&(windowList[r].g_msgTmp=n.el,$(windowList[r].document).find("button.pollingMsg").trigger("click"))):cns.debug("room ",r," not opened")),"undefined"!=typeof updateLastMsg&&updateLastMsg(s,r,l,i.ei)}function onChatReceiveMsg(e,t,i,a,n){if(cns.debug("-----------------------"),!a||0==a.length)return void(n&&n());for(var o=0,s=0;s<a.length;s++){var r=a[s];if(r.cn=i||"",r.hasOwnProperty("meta")){var l={gi:e,ci:t,ei:r.ei,ct:r.meta.ct,data:r};g_idb_chat_msgs.put(l,function(e){o++,o==a.length&&n&&n()});cns.debug("[updateChatDB]",e,t,r.ei,r.ml[0].c)}}}function initChatCntDB(e){e&&e()}function onReceivePollingChatCnt(e){for(var t=$.lStorage(ui),i=0;i<e.length;i++){var a=e[i],n=a.gi;null==t[n]&&(t[n]=new Object),null==t[n].chatAll&&(t[n].chatAll=new Object),null==t[n].chatAll[a.ci]&&(t[n].chatAll[a.ci]=new Object);for(var o=new Object,s=0;s<a.cc.length;s++)o[s]=a.cc[s];t[n].chatAll[a.ci].cnt=o}if($.lStorage(ui,t),"undefined"!=typeof windowList&&null!=windowList)for(var i=0;i<e.length;i++){var a=e[i];null!=windowList[a.ci]&&0==windowList[a.ci].closed&&$(windowList[a.ci].document).find("button.pollingCnt").trigger("click")}}function updateChatList(e,t){var i=$(".subpage-chatList");i.find(".coachmake").hide(),i.find(".loading").show(),i.find(".rows").html("");var a=$.lStorage(ui);if(a){var n=a[e];if(n){var o="groups/"+e+"/chats",s={ui:ui,at:at,li:lang},r="get",l=ajaxDo(o,s,r,!1);l.complete(function(o){if(200==o.status){i.find(".loading").hide();try{var s=$.parseJSON(o.responseText);if("undefined"!=typeof s){var r={},l=n.hasOwnProperty("chatAll"),c=[];if($.each(s.cl,function(t,i){if(i.cm&&"object"==typeof i.cm&&c.push({gi:e,ci:i.ci,ei:i.cm.ei,ct:i.cm.meta.ct,data:i.cm}),l&&n.chatAll.hasOwnProperty(i.ci)){var a=n.chatAll[i.ci];for(var o in a)i.hasOwnProperty(o)||(i[o]=a[o])}if(null==i.cn)i.cn="",i.nk="";else if("1"==i.tp)try{var s=i.cn.split(","),d=n.gu;i.memList={};for(var u=0;u<s.length;u++)if(i.memList[s[u]]={gu:s[u]},s[u]!=d&&n.guAll.hasOwnProperty(s[u])){var h=n.guAll[s[u]];i.nk=h.nk,i.other=s[u]}}catch(p){errorReport(p),i.cn=""}else i.nk=i.cn;r[i.ci]=i}),n.chatAll=r,$.lStorage(ui,a),c.length>0)for(var d=0,u=0;u<c.length;u++)g_idb_chat_msgs.put(c[u],function(){d++,d>=c.length&&gi==e&&showChatList()});else gi==e&&s.cl.length>1?showChatList():(i.find("rows").hide(),i.find(".coachmake").fadeIn())}}catch(h){errorReport(h)}}t&&t()})}}}function showChatList(){var e=$.lStorage(ui);if(null!=e){var t=e[gi];if(null!=t){var i=t.chatAll;if(null!=i){var a=$(".subpage-chatList .rows");if(Object.keys(i).length<=1)return a.hide(),void $(".subpage-chatList .coachmake").fadeIn();if($(".subpage-chatList .rows").html(""),a.hide(),$(".subpage-chatList .coachmake").hide(),a){$.each(i,function(e,i){if("0"!=i.tp){var n=i.nk||"",o="";if("1"==i.tp){o="images/common/others/empty_img_personal_l.png";var s=i.other;if(t.guAll.hasOwnProperty(s)){var r=t.guAll[s];r.auo&&(o=r.auo)}}else o=i.cat||"images/common/others/empty_img_mother_l.png";i.uiName=n,$(this).find(".cp-top-btn").attr("src","images/compose/compose_form_icon_check_none.png");var l=$("<div class='subpage-chatList-row polling-cnt-cl' data-rid='"+i.ci+"' style='width:100%' data-polling-cnt='B7' data-ci='"+i.ci+"'></div>");$(l).data("time",0);var c=$("<div class='tr'></div>");l.append(c);var d=$("<div class='td'></div>");d.append("<img class='aut st-user-pic' src="+o+"></img>"),"1"==i.tp&&d.find("img").data("gi",gi).data("gu",s).addClass("namecard"),c.append(d),d=$("<div class='td' data-id='"+i.ci+"'></div>");var u=n.replaceOriEmojiCode();void 0!==i.cpc&&(u+=" ("+i.cpc+")"),d.append("<div class='name'>"+u+"</div>");var h=$("<div class='msg'></div>");d.append(h),c.append(d),d=$("<div class='td' align='right'></div>");var p=$("<div class='time'></div>");d.append(p),d.append("<div class='cnt sm-cl-count' data-gi='"+gi+"' data-ci='"+i.ci+"'></div>"),d.append("<div class='drag'></div>"),c.append(d),setLastMsg(gi,i.ci,l,!1),a.append(l)}}),setTimeout(function(){a.show()},150),$.lStorage(ui,e)}$(".subpage-chatList-row .td:nth-child(2)").off("click"),$(".subpage-chatList-row .td:nth-child(2)").on("click",function(){openChatWindow(gi,$(this).data("id"))}),$(".subpage-chatList-row .drag").off("click"),$(".subpage-chatList-row .drag").on("click",function(){var e=$(this).parent().prev(),t=e.find(".name").html();popupShowAdjust($.i18n.getString("CHAT_DELETE_CHATROOM"),$.i18n.getString("CHAT_CONFIRM_DELETE_CHATROOM",t),!0,!0,[deleteRoom,e])}),$(".update").off("click").click(function(){updateLastMsg($(this).attr("data-gi"),$(this).attr("data-ci"))})}}}}function deleteRoom(e){var t=e.data("id"),i="groups/"+gi+"/chats/"+t,a={ui:ui,at:at,li:lang},n="delete",o=ajaxDo(i,a,n,!1);o.complete(function(e){200==e.status?(updateChatList(gi),toastShow($.i18n.getString("CHAT_DELETE_CHATROOM_SUCC"))):toastShow($.i18n.getString("CHAT_DELETE_CHATROOM_FAIL"))})}function openChatWindow(e,t){if(clearChatListCnt(e,t),windowList.hasOwnProperty(t)&&null!=windowList[t]&&0==windowList[t].closed);else{var i=new Object;i.gi=e,i.ci=t,i.ui=ui,i.at=at,$.lStorage("_chatRoom",i),windowList[t]=window.open("chat.html","_blank","width=400, height=600")}windowList[t].focus()}function updateLastMsg(e,t,i,a){var n=$(".subpage-chatList-row[data-rid='"+t+"']");setLastMsg(e,t,n,!0,i,a)}function clearChatListCnt(e,t){var i=$.lStorage(ui),a=i[e],n=a.chatAll[t];n.unreadCnt=0,$.lStorage(ui,i),$(".subpage-chatList-row[data-rid='"+t+"'] .cnt").html("")}function setLastMsg(e,t,i,a,n,o){null==n&&(n=!1);try{var s=$.lStorage(ui),r=s[e];r.guAll&&0!=Object.keys(r.guAll).length?getDBMsg(e,t,i,a,n,o):setGroupAllUser(null,e,function(){s=$.lStorage(ui),r=s[e],getDBMsg(e,t,i,a,n,o)})}catch(l){errorReport(l)}}function getDBMsg(e,t,i,a,n,o){var s,r,l=$.lStorage(ui),c=l[e];o?g_idb_chat_msgs.get(o,function(o){var s=o.data;try{c.gi!=e&&cns.debug("incoming chat msg is not currentGroup"),setLastMsgContent(e,t,i,s,a,n)}catch(r){errorReport(r)}}):(s="gi_ci_ct",r=(new Date).getTime(),g_idb_chat_msgs.limit(function(o){try{if(c.gi!=e&&cns.debug("incoming chat msg is not currentGroup"),o.length>0&&null!=o[0]){var s=o[0].data;setLastMsgContent(e,t,i,s,a,n)}}catch(r){errorReport(r)}},{index:s,keyRange:g_idb_chat_msgs.makeKeyRange({upper:[e,t,r],lower:[e,t]}),limit:1,order:"DESC",onEnd:function(e){cns.debug("setLastMsg end:",e.ci+" "+e.ct)},onError:function(e){cns.debug("[!] setLastMsg error:",e)}}))}function setLastMsgContent(e,t,i,a,n,o){if(null==a||""==a)return void cns.debug("[setLastMsgContent] null data");var s=$.lStorage(ui),r=s[e];if(null==r)return void cns.debug("[setLastMsgContent] no groupData");var l;if(r.chatAll&&r.chatAll.hasOwnProperty(t)){var c=r.chatAll[t];l=c.unreadCnt||0}r.guAll&&r.guAll.hasOwnProperty(a.meta.gu)?setLastMsgContentPart2(e,t,i,a,n,o,r,l):setGroupAllUser(null,e,function(){s=$.lStorage(ui),r=s[e],null!=r&&null!=r.chatAll&&r.chatAll.hasOwnProperty(t)&&setLastMsgContentPart2(e,t,i,a,n,o,r,l)})}function setLastMsgContentPart2(e,t,i,a,n,o,s,r){var l="",c=s.guAll[a.meta.gu];if(null==c)return void cns.debug("[setLastMsgContentPart2] mem null");var d=c.nk;if(!(null==a.ml||a.ml.length<=0)){var u=a.meta.gu==s.gu;switch(u&&(d=$.i18n.getString("COMMON_YOU")),a.ml[0].tp){case 5:l=$.i18n.getString("CHAT_SOMEONE_SEND_STICKER",d);break;case 6:l=$.i18n.getString("CHAT_SOMEONE_SEND_PHOTO",d);break;case 7:l=$.i18n.getString("CHAT_SOMEONE_SEND_VIDEO",d);break;case 8:l=$.i18n.getString("CHAT_SOMEONE_SEND_VOICE",d);break;case 9:l=$.i18n.getString("CHAT_SOMEONE_SEND_LOCATION",d);break;case 22:var h="unknown";if(a.ml[0].t&&s.guAll.hasOwnProperty(a.ml[0].t)){var p=s.guAll[a.ml[0].t];p&&(h=p.nk)}if(null==c)return;l=1==a.ml[0].a?$.i18n.getString("CHAT_SOMEONE_LEAVE",h):$.i18n.getString("CHAT_SOMEONE_JOIN",h);break;case 23:l=u?$.i18n.getString("CHAT_VOIP_MAKE_CALL"):$.i18n.getString("CHAT_VOIP_GET_CALL",d);break;default:try{l=a.ml[0].c&&a.ml[0].c.length>0?a.ml[0].c:""}catch(f){cns.debug(f.message)}}if(gi==e){if(i.length>0){i.data("time",a.meta.ct);var g=i.find(".msg"),m=i.find(".time");if(g&&g.html(l.replaceOriEmojiCode()),m&&m.html(new Date(a.meta.ct).toFormatString(!1)),0==o){var v=i.find(".cnt");if(v){var b="";r>99?(b="99+",v.html(b).show()):r&&r>0?(b=r,v.html(b).show()):v.hide()}}}else $(".subpage-chatList").is(":visible")&&$('.sm-small-area[data-sm-act="chat"]').trigger("click");sortRoomList()}if(!u&&n)try{cns.debug(s.gn.parseHtmlString()+" - "+c.nk,l);var w=a.cn||"";a.meta.ct>=login_time&&riseNotification(null,c.nk+" ("+s.gn.parseHtmlString()+" - "+w.parseHtmlString()+")",l,function(){cns.debug(t),openChatWindow(e,t)})}catch(f){cns.debug(f.message)}}}function sortRoomList(){$(".subpage-chatList-row").each(function(){var e=$(this).data("time");e>0&&$(this).find(".time").html(new Date(e).toFormatString())}),$(".rows").each(function(){var e=$(this),t=e.find(".subpage-chatList-row").get().sort(function(e,t){return $(t).data("time")-$(e).data("time")});e.append(t)})}function parseRoomName(e,t){try{if(1==t.tp){for(var i=t.cn.split(","),a=e.gu,n=0;n<i.length;n++)if(t.memList[i[n]]={gu:i[n]},i[n]!=a&&e.guAll.hasOwnProperty(i[n])){var o=e.guAll[i[n]];return o.nk||""}return}return t.cn||""}catch(s){errorReport(s)}return""}function showNewRoomPage(){composeObjectShowDelegate($(".chatList-add"),$(".chatList-add"),{isShowBranch:!1,isShowSelf:!1,isShowAll:!1,isShowFav:!0,isShowFavBranch:!0,isBack:!1},onShowNewRoomPageDone)}function onShowNewRoomPageDone(){try{var e=$.parseJSON($(".chatList-add").data("object_str")),t=$.lStorage(ui)[gi];e.hasOwnProperty(t.gu)&&delete e[t.gu],g_newChatMemList=Object.keys(e),e=$.parseJSON($(".chatList-add").data("favorite_str")),g_newChatFavList=null==e?[]:Object.keys(e),showNewRoomDetailPage()}catch(i){cns.debug("[!]showNewRoomPage",i.message),errorReport(i)}}function toggleSelectAll(e){"page-newChat"==$.mobile.activePage.attr("id")&&(e?$(".newChat-content .mem .checkbox").each(function(){$(this).attr("check","true"),addMember($(this).data("memid"),$(this).data("memname"))}):($(".newChat-content .mem .checkbox").attr("check","false"),$(".newChat-list .addMemList").html(""),g_newChatMemList=[]))}function showNewRoomDetailPage(){if(0==g_newChatMemList.length&&0==g_newChatFavList.length)return void alert($.i18n.getString("CHAT_CHATROOM_MEMBER_EMPTY"));if(1==g_newChatMemList.length&&0==g_newChatFavList.length){var e=g_newChatMemList[0],t=$.lStorage(ui)[gi];for(var i in t.chatAll){var a=t.chatAll[i];if(1==a.tp&&a.cn.indexOf(e)>=0)return openChatWindow(gi,a.ci),void $.mobile.changePage("#page-group-main")}return void requestNewChatRoom()}$.mobile.changePage("#page-newChatDetail");var n=$(".newChatDetail-content.mem"),o=$(".newChatDetail table .input"),s=$(".newChatDetail table .count");o.val(""),s.html("0/"+o.attr("maxlength")),n.html("");for(var t=$.lStorage(ui)[gi],r=0;r<g_newChatMemList.length;r++){var l=t.guAll[g_newChatMemList[r]],c=$("<div class='row mem'></div>");l.auo?(c.append("<img class='namecard' src='"+l.auo+"'>"),c.find("img").data("gu",g_newChatMemList[r]),c.find("img").data("gi",gi)):c.append("<img src='images/common/others/empty_img_personal_l.png'>"),c.append("<span>"+l.nk.replaceOriEmojiCode()+"</span>"),n.append(c)}n=$(".newChatDetail-content.fav"),n.html("");for(var r=0;r<g_newChatFavList.length;r++){var d=t.fbl[g_newChatFavList[r]],u=$("<div class='row fav'></div>");u.append("<img src='images/common/others/select_empty_all_photo.png'>"),u.append("<span>"+d.fn.replaceOriEmojiCode()+"</span>"),n.append(u)}var h=$.i18n.getString(o.data("textid"));o.attr("placeholder",h),o.off("change"),o.keyup(function(){var e=$(this).val();s.html(20-e.length+"/"+$(this).attr("maxlength"))}),$(".newChatDetail-nextStep").off("click"),$(".newChatDetail-nextStep").click(requestNewChatRoom)}function requestNewChatRoom(){for(var e=$(".newChatDetail table .input").val(),t=[],i=$.lStorage(ui),a=i[gi],n=a.gu,o=0;o<g_newChatMemList.length;o++)g_newChatMemList[o]!=n&&t.push({gu:g_newChatMemList[o]});var s=1==t.length;return s||e&&0!=e.length?void requestNewChatRoomApi(gi,e,t,g_newChatFavList,function(e){$.mobile.changePage("#page-group-main")}):void alert($.i18n.getString("CHAT_CHATROOM_NAME_EMPTY"))}function requestNewChatRoomApi(e,t,i,a,n,o){null==o&&(o=!0);var s="groups/"+e+"/chats",r={ui:ui,at:at,li:lang},l={cn:t};null!=i&&(l.gul=i),null!=a&&(l.fl=a);var c="post";ajaxDo(s,r,c,!0,l).complete(function(t){if(200==t.status){var a=$.parseJSON(t.responseText);updateChatList(e,function(){if(a.ci){var t=$.lStorage(ui),s=t[e];if(null==s)return;var r=s.gu;if(null==s.chatAll[a.ci]){s.chatAll[a.ci]={ci:a.ci};var l=1==i.length;if(l){var c=i[0].gu;s.chatAll[a.ci].tp=1,s.chatAll[a.ci].cn=r+","+c;var d=s.guAll[c];d?s.chatAll[a.ci].uiName=d.nk:s.chatAll[a.ci].uiName=""}else s.chatAll[a.ci].tp=2,s.chatAll[a.ci].cn=text,s.chatAll[a.ci].uiName=text;$.lStorage(ui,t)}o&&setTimeout(function(){openChatWindow(e,a.ci)},300)}n&&n(a)})}else n&&n(null)})}!function(e,t){function i(e){var t=e.length,i=le.type(e);return le.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function a(e){var t=ke[e]={};return le.each(e.match(de)||[],function(e,i){t[i]=!0}),t}function n(e,i,a,n){if(le.acceptData(e)){var o,s,r=le.expando,l="string"==typeof i,c=e.nodeType,d=c?le.cache:e,u=c?e[r]:e[r]&&r;if(u&&d[u]&&(n||d[u].data)||!l||a!==t)return u||(c?e[r]=u=Q.pop()||le.guid++:u=r),d[u]||(d[u]={},c||(d[u].toJSON=le.noop)),("object"==typeof i||"function"==typeof i)&&(n?d[u]=le.extend(d[u],i):d[u].data=le.extend(d[u].data,i)),o=d[u],n||(o.data||(o.data={}),o=o.data),a!==t&&(o[le.camelCase(i)]=a),l?(s=o[i],null==s&&(s=o[le.camelCase(i)])):s=o,s}}function o(e,t,i){if(le.acceptData(e)){var a,n,o,s=e.nodeType,l=s?le.cache:e,c=s?e[le.expando]:le.expando;if(l[c]){if(t&&(o=i?l[c]:l[c].data)){le.isArray(t)?t=t.concat(le.map(t,le.camelCase)):t in o?t=[t]:(t=le.camelCase(t),t=t in o?[t]:t.split(" "));for(a=0,n=t.length;n>a;a++)delete o[t[a]];if(!(i?r:le.isEmptyObject)(o))return}(i||(delete l[c].data,r(l[c])))&&(s?le.cleanData([e],!0):le.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}function s(e,i,a){if(a===t&&1===e.nodeType){var n="data-"+i.replace(Ce,"-$1").toLowerCase();if(a=e.getAttribute(n),"string"==typeof a){try{a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:$e.test(a)?le.parseJSON(a):a}catch(o){}le.data(e,i,a)}else a=t}return a}function r(e){var t;for(t in e)if(("data"!==t||!le.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function c(){return!1}function d(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function u(e,t,i){if(t=t||0,le.isFunction(t))return le.grep(e,function(e,a){var n=!!t.call(e,a,e);return n===i});if(t.nodeType)return le.grep(e,function(e){return e===t===i});if("string"==typeof t){var a=le.grep(e,function(e){return 1===e.nodeType});if(ze.test(t))return le.filter(t,a,!i);t=le.filter(t,a)}return le.grep(e,function(e){return le.inArray(e,t)>=0===i})}function h(e){var t=Ge.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function p(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t));
}function f(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function g(e){var t=nt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function m(e,t){for(var i,a=0;null!=(i=e[a]);a++)le._data(i,"globalEval",!t||le._data(t[a],"globalEval"))}function v(e,t){if(1===t.nodeType&&le.hasData(e)){var i,a,n,o=le._data(e),s=le._data(t,o),r=o.events;if(r){delete s.handle,s.events={};for(i in r)for(a=0,n=r[i].length;n>a;a++)le.event.add(t,i,r[i][a])}s.data&&(s.data=le.extend({},s.data))}}function b(e,t){var i,a,n;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!le.support.noCloneEvent&&t[le.expando]){n=le._data(t);for(a in n.events)le.removeEvent(t,a,n.handle);t.removeAttribute(le.expando)}"script"===i&&t.text!==e.text?(f(t).text=e.text,g(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),le.support.html5Clone&&e.innerHTML&&!le.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&tt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function w(e,i){var a,n,o=0,s=typeof e.getElementsByTagName!==V?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==V?e.querySelectorAll(i||"*"):t;if(!s)for(s=[],a=e.childNodes||e;null!=(n=a[o]);o++)!i||le.nodeName(n,i)?s.push(n):le.merge(s,w(n,i));return i===t||i&&le.nodeName(e,i)?le.merge([e],s):s}function _(e){tt.test(e.type)&&(e.defaultChecked=e.checked)}function y(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),a=t,n=$t.length;n--;)if(t=$t[n]+i,t in e)return t;return a}function x(e,t){return e=t||e,"none"===le.css(e,"display")||!le.contains(e.ownerDocument,e)}function k(e,t){for(var i,a,n,o=[],s=0,r=e.length;r>s;s++)a=e[s],a.style&&(o[s]=le._data(a,"olddisplay"),i=a.style.display,t?(o[s]||"none"!==i||(a.style.display=""),""===a.style.display&&x(a)&&(o[s]=le._data(a,"olddisplay",T(a.nodeName)))):o[s]||(n=x(a),(i&&"none"!==i||!n)&&le._data(a,"olddisplay",n?i:le.css(a,"display"))));for(s=0;r>s;s++)a=e[s],a.style&&(t&&"none"!==a.style.display&&""!==a.style.display||(a.style.display=t?o[s]||"":"none"));return e}function $(e,t,i){var a=vt.exec(t);return a?Math.max(0,a[1]-(i||0))+(a[2]||"px"):t}function C(e,t,i,a,n){for(var o=i===(a?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===i&&(s+=le.css(e,i+kt[o],!0,n)),a?("content"===i&&(s-=le.css(e,"padding"+kt[o],!0,n)),"margin"!==i&&(s-=le.css(e,"border"+kt[o]+"Width",!0,n))):(s+=le.css(e,"padding"+kt[o],!0,n),"padding"!==i&&(s+=le.css(e,"border"+kt[o]+"Width",!0,n)));return s}function S(e,t,i){var a=!0,n="width"===t?e.offsetWidth:e.offsetHeight,o=dt(e),s=le.support.boxSizing&&"border-box"===le.css(e,"boxSizing",!1,o);if(0>=n||null==n){if(n=ut(e,t,o),(0>n||null==n)&&(n=e.style[t]),bt.test(n))return n;a=s&&(le.support.boxSizingReliable||n===e.style[t]),n=parseFloat(n)||0}return n+C(e,t,i||(s?"border":"content"),a,o)+"px"}function T(e){var t=Y,i=_t[e];return i||(i=E(e,t),"none"!==i&&i||(ct=(ct||le("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ct[0].contentWindow||ct[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=E(e,t),ct.detach()),_t[e]=i),i}function E(e,t){var i=le(t.createElement(e)).appendTo(t.body),a=le.css(i[0],"display");return i.remove(),a}function O(e,t,i,a){var n;if(le.isArray(t))le.each(t,function(t,n){i||St.test(e)?a(e,n):O(e+"["+("object"==typeof n?t:"")+"]",n,i,a)});else if(i||"object"!==le.type(t))a(e,t);else for(n in t)O(e+"["+n+"]",t[n],i,a)}function D(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var a,n=0,o=t.toLowerCase().match(de)||[];if(le.isFunction(i))for(;a=o[n++];)"+"===a[0]?(a=a.slice(1)||"*",(e[a]=e[a]||[]).unshift(i)):(e[a]=e[a]||[]).push(i)}}function A(e,i,a,n){function o(l){var c;return s[l]=!0,le.each(e[l]||[],function(e,l){var d=l(i,a,n);return"string"!=typeof d||r||s[d]?r?!(c=d):t:(i.dataTypes.unshift(d),o(d),!1)}),c}var s={},r=e===zt;return o(i.dataTypes[0])||!s["*"]&&o("*")}function M(e,i){var a,n,o=le.ajaxSettings.flatOptions||{};for(n in i)i[n]!==t&&((o[n]?e:a||(a={}))[n]=i[n]);return a&&le.extend(!0,e,a),e}function P(e,i,a){var n,o,s,r,l=e.contents,c=e.dataTypes,d=e.responseFields;for(r in d)r in a&&(i[d[r]]=a[r]);for(;"*"===c[0];)c.shift(),o===t&&(o=e.mimeType||i.getResponseHeader("Content-Type"));if(o)for(r in l)if(l[r]&&l[r].test(o)){c.unshift(r);break}if(c[0]in a)s=c[0];else{for(r in a){if(!c[0]||e.converters[r+" "+c[0]]){s=r;break}n||(n=r)}s=s||n}return s?(s!==c[0]&&c.unshift(s),a[s]):t}function N(e,t){var i,a,n,o,s={},r=0,l=e.dataTypes.slice(),c=l[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l[1])for(n in e.converters)s[n.toLowerCase()]=e.converters[n];for(;a=l[++r];)if("*"!==a){if("*"!==c&&c!==a){if(n=s[c+" "+a]||s["* "+a],!n)for(i in s)if(o=i.split(" "),o[1]===a&&(n=s[c+" "+o[0]]||s["* "+o[0]])){n===!0?n=s[i]:s[i]!==!0&&(a=o[0],l.splice(r--,0,a));break}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(d){return{state:"parsererror",error:n?d:"No conversion from "+c+" to "+a}}}c=a}return{state:"success",data:t}}function L(){try{return new e.XMLHttpRequest}catch(t){}}function j(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function I(){return setTimeout(function(){Zt=t}),Zt=le.now()}function R(e,t){le.each(t,function(t,i){for(var a=(ni[t]||[]).concat(ni["*"]),n=0,o=a.length;o>n;n++)if(a[n].call(e,t,i))return})}function B(e,t,i){var a,n,o=0,s=ai.length,r=le.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=Zt||I(),i=Math.max(0,c.startTime+c.duration-t),a=i/c.duration||0,o=1-a,s=0,l=c.tweens.length;l>s;s++)c.tweens[s].run(o);return r.notifyWith(e,[c,o,i]),1>o&&l?i:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:le.extend({},t),opts:le.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Zt||I(),duration:i.duration,tweens:[],createTween:function(t,i){var a=le.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(a),a},stop:function(t){var i=0,a=t?c.tweens.length:0;if(n)return this;for(n=!0;a>i;i++)c.tweens[i].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),d=c.props;for(F(d,c.opts.specialEasing);s>o;o++)if(a=ai[o].call(c,e,d,c.opts))return a;return R(c,d),le.isFunction(c.opts.start)&&c.opts.start.call(e,c),le.fx.timer(le.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function F(e,t){var i,a,n,o,s;for(n in e)if(a=le.camelCase(n),o=t[a],i=e[n],le.isArray(i)&&(o=i[1],i=e[n]=i[0]),n!==a&&(e[a]=i,delete e[n]),s=le.cssHooks[a],s&&"expand"in s){i=s.expand(i),delete e[a];for(n in i)n in e||(e[n]=i[n],t[n]=o)}else t[a]=o}function H(e,t,i){var a,n,o,s,r,l,c,d,u,h=this,p=e.style,f={},g=[],m=e.nodeType&&x(e);i.queue||(d=le._queueHooks(e,"fx"),null==d.unqueued&&(d.unqueued=0,u=d.empty.fire,d.empty.fire=function(){d.unqueued||u()}),d.unqueued++,h.always(function(){h.always(function(){d.unqueued--,le.queue(e,"fx").length||d.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===le.css(e,"display")&&"none"===le.css(e,"float")&&(le.support.inlineBlockNeedsLayout&&"inline"!==T(e.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",le.support.shrinkWrapBlocks||h.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in t)if(s=t[n],ei.exec(s)){if(delete t[n],l=l||"toggle"===s,s===(m?"hide":"show"))continue;g.push(n)}if(o=g.length){r=le._data(e,"fxshow")||le._data(e,"fxshow",{}),"hidden"in r&&(m=r.hidden),l&&(r.hidden=!m),m?le(e).show():h.done(function(){le(e).hide()}),h.done(function(){var t;le._removeData(e,"fxshow");for(t in f)le.style(e,t,f[t])});for(n=0;o>n;n++)a=g[n],c=h.createTween(a,m?r[a]:0),f[a]=r[a]||le.style(e,a),a in r||(r[a]=c.start,m&&(c.end=c.start,c.start="width"===a||"height"===a?1:0))}}function q(e,t,i,a,n){return new q.prototype.init(e,t,i,a,n)}function z(e,t){var i,a={height:e},n=0;for(t=t?1:0;4>n;n+=2-t)i=kt[n],a["margin"+i]=a["padding"+i]=e;return t&&(a.opacity=a.width=e),a}function U(e){return le.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var W,G,V=typeof t,Y=e.document,J=e.location,K=e.jQuery,X=e.$,Z={},Q=[],ee="1.9.1",te=Q.concat,ie=Q.push,ae=Q.slice,ne=Q.indexOf,oe=Z.toString,se=Z.hasOwnProperty,re=ee.trim,le=function(e,t){return new le.fn.init(e,t,G)},ce=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,de=/\S+/g,ue=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,he=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,pe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,fe=/^[\],:{}\s]*$/,ge=/(?:^|:|,)(?:\s*\[)+/g,me=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ve=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,be=/^-ms-/,we=/-([\da-z])/gi,_e=function(e,t){return t.toUpperCase()},ye=function(e){(Y.addEventListener||"load"===e.type||"complete"===Y.readyState)&&(xe(),le.ready())},xe=function(){Y.addEventListener?(Y.removeEventListener("DOMContentLoaded",ye,!1),e.removeEventListener("load",ye,!1)):(Y.detachEvent("onreadystatechange",ye),e.detachEvent("onload",ye))};le.fn=le.prototype={jquery:ee,constructor:le,init:function(e,i,a){var n,o;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:he.exec(e),!n||!n[1]&&i)return!i||i.jquery?(i||a).find(e):this.constructor(i).find(e);if(n[1]){if(i=i instanceof le?i[0]:i,le.merge(this,le.parseHTML(n[1],i&&i.nodeType?i.ownerDocument||i:Y,!0)),pe.test(n[1])&&le.isPlainObject(i))for(n in i)le.isFunction(this[n])?this[n](i[n]):this.attr(n,i[n]);return this}if(o=Y.getElementById(n[2]),o&&o.parentNode){if(o.id!==n[2])return a.find(e);this.length=1,this[0]=o}return this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):le.isFunction(e)?a.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),le.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return ae.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=le.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return le.each(this,e,t)},ready:function(e){return le.ready.promise().done(e),this},slice:function(){return this.pushStack(ae.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(le.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:ie,sort:[].sort,splice:[].splice},le.fn.init.prototype=le.fn,le.extend=le.fn.extend=function(){var e,i,a,n,o,s,r=arguments[0]||{},l=1,c=arguments.length,d=!1;for("boolean"==typeof r&&(d=r,r=arguments[1]||{},l=2),"object"==typeof r||le.isFunction(r)||(r={}),c===l&&(r=this,--l);c>l;l++)if(null!=(o=arguments[l]))for(n in o)e=r[n],a=o[n],r!==a&&(d&&a&&(le.isPlainObject(a)||(i=le.isArray(a)))?(i?(i=!1,s=e&&le.isArray(e)?e:[]):s=e&&le.isPlainObject(e)?e:{},r[n]=le.extend(d,s,a)):a!==t&&(r[n]=a));return r},le.extend({noConflict:function(t){return e.$===le&&(e.$=X),t&&e.jQuery===le&&(e.jQuery=K),le},isReady:!1,readyWait:1,holdReady:function(e){e?le.readyWait++:le.ready(!0)},ready:function(e){if(e===!0?!--le.readyWait:!le.isReady){if(!Y.body)return setTimeout(le.ready);le.isReady=!0,e!==!0&&--le.readyWait>0||(W.resolveWith(Y,[le]),le.fn.trigger&&le(Y).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===le.type(e)},isArray:Array.isArray||function(e){return"array"===le.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[oe.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==le.type(e)||e.nodeType||le.isWindow(e))return!1;try{if(e.constructor&&!se.call(e,"constructor")&&!se.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var a;for(a in e);return a===t||se.call(e,a)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||Y;var a=pe.exec(e),n=!i&&[];return a?[t.createElement(a[1])]:(a=le.buildFragment([e],t,n),n&&le(n).remove(),le.merge([],a.childNodes))},parseJSON:function(i){return e.JSON&&e.JSON.parse?e.JSON.parse(i):null===i?i:"string"==typeof i&&(i=le.trim(i),i&&fe.test(i.replace(me,"@").replace(ve,"]").replace(ge,"")))?Function("return "+i)():(le.error("Invalid JSON: "+i),t)},parseXML:function(i){var a,n;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(n=new DOMParser,a=n.parseFromString(i,"text/xml")):(a=new ActiveXObject("Microsoft.XMLDOM"),a.async="false",a.loadXML(i))}catch(o){a=t}return a&&a.documentElement&&!a.getElementsByTagName("parsererror").length||le.error("Invalid XML: "+i),a},noop:function(){},globalEval:function(t){t&&le.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(be,"ms-").replace(we,_e)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,a){var n,o=0,s=e.length,r=i(e);if(a){if(r)for(;s>o&&(n=t.apply(e[o],a),n!==!1);o++);else for(o in e)if(n=t.apply(e[o],a),n===!1)break}else if(r)for(;s>o&&(n=t.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=t.call(e[o],o,e[o]),n===!1)break;return e},trim:re&&!re.call("\ufeff ")?function(e){return null==e?"":re.call(e)}:function(e){return null==e?"":(e+"").replace(ue,"")},makeArray:function(e,t){var a=t||[];return null!=e&&(i(Object(e))?le.merge(a,"string"==typeof e?[e]:e):ie.call(a,e)),a},inArray:function(e,t,i){var a;if(t){if(ne)return ne.call(t,e,i);for(a=t.length,i=i?0>i?Math.max(0,a+i):i:0;a>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var a=i.length,n=e.length,o=0;if("number"==typeof a)for(;a>o;o++)e[n++]=i[o];else for(;i[o]!==t;)e[n++]=i[o++];return e.length=n,e},grep:function(e,t,i){var a,n=[],o=0,s=e.length;for(i=!!i;s>o;o++)a=!!t(e[o],o),i!==a&&n.push(e[o]);return n},map:function(e,t,a){var n,o=0,s=e.length,r=i(e),l=[];if(r)for(;s>o;o++)n=t(e[o],o,a),null!=n&&(l[l.length]=n);else for(o in e)n=t(e[o],o,a),null!=n&&(l[l.length]=n);return te.apply([],l)},guid:1,proxy:function(e,i){var a,n,o;return"string"==typeof i&&(o=e[i],i=e,e=o),le.isFunction(e)?(a=ae.call(arguments,2),n=function(){return e.apply(i||this,a.concat(ae.call(arguments)))},n.guid=e.guid=e.guid||le.guid++,n):t},access:function(e,i,a,n,o,s,r){var l=0,c=e.length,d=null==a;if("object"===le.type(a)){o=!0;for(l in a)le.access(e,i,l,a[l],!0,s,r)}else if(n!==t&&(o=!0,le.isFunction(n)||(r=!0),d&&(r?(i.call(e,n),i=null):(d=i,i=function(e,t,i){return d.call(le(e),i)})),i))for(;c>l;l++)i(e[l],a,r?n:n.call(e[l],l,i(e[l],a)));return o?e:d?i.call(e):c?i(e[0],a):s},now:function(){return(new Date).getTime()}}),le.ready.promise=function(t){if(!W)if(W=le.Deferred(),"complete"===Y.readyState)setTimeout(le.ready);else if(Y.addEventListener)Y.addEventListener("DOMContentLoaded",ye,!1),e.addEventListener("load",ye,!1);else{Y.attachEvent("onreadystatechange",ye),e.attachEvent("onload",ye);var i=!1;try{i=null==e.frameElement&&Y.documentElement}catch(a){}i&&i.doScroll&&function n(){if(!le.isReady){try{i.doScroll("left")}catch(e){return setTimeout(n,50)}xe(),le.ready()}}()}return W.promise(t)},le.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()}),G=le(Y);var ke={};le.Callbacks=function(e){e="string"==typeof e?ke[e]||a(e):le.extend({},e);var i,n,o,s,r,l,c=[],d=!e.once&&[],u=function(t){for(n=e.memory&&t,o=!0,r=l||0,l=0,s=c.length,i=!0;c&&s>r;r++)if(c[r].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,c&&(d?d.length&&u(d.shift()):n?c=[]:h.disable())},h={add:function(){if(c){var t=c.length;!function a(t){le.each(t,function(t,i){var n=le.type(i);"function"===n?e.unique&&h.has(i)||c.push(i):i&&i.length&&"string"!==n&&a(i)})}(arguments),i?s=c.length:n&&(l=t,u(n))}return this},remove:function(){return c&&le.each(arguments,function(e,t){for(var a;(a=le.inArray(t,c,a))>-1;)c.splice(a,1),i&&(s>=a&&s--,r>=a&&r--)}),this},has:function(e){return e?le.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=d=n=t,this},disabled:function(){return!c},lock:function(){return d=t,n||h.disable(),this},locked:function(){return!d},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||o&&!d||(i?d.push(t):u(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},le.extend({Deferred:function(e){var t=[["resolve","done",le.Callbacks("once memory"),"resolved"],["reject","fail",le.Callbacks("once memory"),"rejected"],["notify","progress",le.Callbacks("memory")]],i="pending",a={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return le.Deferred(function(i){le.each(t,function(t,o){var s=o[0],r=le.isFunction(e[t])&&e[t];n[o[1]](function(){var e=r&&r.apply(this,arguments);e&&le.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s+"With"](this===a?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?le.extend(e,a):a}},n={};return a.pipe=a.then,le.each(t,function(e,o){var s=o[2],r=o[3];a[o[1]]=s.add,r&&s.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),n[o[0]]=function(){return n[o[0]+"With"](this===n?a:this,arguments),this},n[o[0]+"With"]=s.fireWith}),a.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,a,n=0,o=ae.call(arguments),s=o.length,r=1!==s||e&&le.isFunction(e.promise)?s:0,l=1===r?e:le.Deferred(),c=function(e,i,a){return function(n){i[e]=this,a[e]=arguments.length>1?ae.call(arguments):n,a===t?l.notifyWith(i,a):--r||l.resolveWith(i,a)}};if(s>1)for(t=Array(s),i=Array(s),a=Array(s);s>n;n++)o[n]&&le.isFunction(o[n].promise)?o[n].promise().done(c(n,a,o)).fail(l.reject).progress(c(n,i,t)):--r;return r||l.resolveWith(a,o),l.promise()}}),le.support=function(){var t,i,a,n,o,s,r,l,c,d,u=Y.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=u.getElementsByTagName("*"),a=u.getElementsByTagName("a")[0],!i||!a||!i.length)return{};o=Y.createElement("select"),r=o.appendChild(Y.createElement("option")),n=u.getElementsByTagName("input")[0],a.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==u.className,leadingWhitespace:3===u.firstChild.nodeType,tbody:!u.getElementsByTagName("tbody").length,htmlSerialize:!!u.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:"/a"===a.getAttribute("href"),opacity:/^0.5/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:!!n.value,optSelected:r.selected,enctype:!!Y.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==Y.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===Y.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!r.disabled;try{delete u.test}catch(h){t.deleteExpando=!1}n=Y.createElement("input"),n.setAttribute("value",""),t.input=""===n.getAttribute("value"),n.value="t",n.setAttribute("type","radio"),t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),s=Y.createDocumentFragment(),s.appendChild(n),t.appendChecked=n.checked,t.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){t.noCloneEvent=!1}),u.cloneNode(!0).click());for(d in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+d,"t"),t[d+"Bubbles"]=l in e||u.attributes[l].expando===!1;return u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===u.style.backgroundClip,le(function(){var i,a,n,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",s=Y.getElementsByTagName("body")[0];s&&(i=Y.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(i).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=u.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",t.reliableHiddenOffsets=c&&0===n[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===u.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==s.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(u,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(u,null)||{width:"4px"}).width,a=u.appendChild(Y.createElement("div")),a.style.cssText=u.style.cssText=o,a.style.marginRight=a.style.width="0",u.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(a,null)||{}).marginRight)),typeof u.style.zoom!==V&&(u.innerHTML="",u.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==u.offsetWidth,t.inlineBlockNeedsLayout&&(s.style.zoom=1)),s.removeChild(i),i=u=n=a=null)}),i=o=s=r=a=n=null,t}();var $e=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ce=/([A-Z])/g;le.extend({cache:{},expando:"jQuery"+(ee+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?le.cache[e[le.expando]]:e[le.expando],!!e&&!r(e)},data:function(e,t,i){return n(e,t,i)},removeData:function(e,t){return o(e,t)},_data:function(e,t,i){return n(e,t,i,!0)},_removeData:function(e,t){return o(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&le.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),le.fn.extend({data:function(e,i){var a,n,o=this[0],r=0,l=null;if(e===t){if(this.length&&(l=le.data(o),1===o.nodeType&&!le._data(o,"parsedAttrs"))){for(a=o.attributes;a.length>r;r++)n=a[r].name,n.indexOf("data-")||(n=le.camelCase(n.slice(5)),s(o,n,l[n]));le._data(o,"parsedAttrs",!0)}return l}return"object"==typeof e?this.each(function(){le.data(this,e)}):le.access(this,function(i){return i===t?o?s(o,e,le.data(o,e)):null:(this.each(function(){le.data(this,e,i)}),t)},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){le.removeData(this,e)})}}),le.extend({queue:function(e,i,a){var n;return e?(i=(i||"fx")+"queue",n=le._data(e,i),a&&(!n||le.isArray(a)?n=le._data(e,i,le.makeArray(a)):n.push(a)),n||[]):t},dequeue:function(e,t){t=t||"fx";var i=le.queue(e,t),a=i.length,n=i.shift(),o=le._queueHooks(e,t),s=function(){le.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),a--),o.cur=n,n&&("fx"===t&&i.unshift("inprogress"),delete o.stop,n.call(e,s,o)),!a&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return le._data(e,i)||le._data(e,i,{empty:le.Callbacks("once memory").add(function(){le._removeData(e,t+"queue"),le._removeData(e,i)})})}}),le.fn.extend({queue:function(e,i){var a=2;return"string"!=typeof e&&(i=e,e="fx",a--),a>arguments.length?le.queue(this[0],e):i===t?this:this.each(function(){var t=le.queue(this,e,i);le._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&le.dequeue(this,e)})},dequeue:function(e){return this.each(function(){le.dequeue(this,e)})},delay:function(e,t){return e=le.fx?le.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var a=setTimeout(t,e);i.stop=function(){clearTimeout(a)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var a,n=1,o=le.Deferred(),s=this,r=this.length,l=function(){--n||o.resolveWith(s,[s])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";r--;)a=le._data(s[r],e+"queueHooks"),a&&a.empty&&(n++,a.empty.add(l));return l(),o.promise(i)}});var Se,Te,Ee=/[\t\r\n]/g,Oe=/\r/g,De=/^(?:input|select|textarea|button|object)$/i,Ae=/^(?:a|area)$/i,Me=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Pe=/^(?:checked|selected)$/i,Ne=le.support.getSetAttribute,Le=le.support.input;le.fn.extend({attr:function(e,t){return le.access(this,le.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){le.removeAttr(this,e)})},prop:function(e,t){return le.access(this,le.prop,e,t,arguments.length>1)},removeProp:function(e){return e=le.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,a,n,o,s=0,r=this.length,l="string"==typeof e&&e;if(le.isFunction(e))return this.each(function(t){le(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(de)||[];r>s;s++)if(i=this[s],a=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ee," "):" ")){for(o=0;n=t[o++];)0>a.indexOf(" "+n+" ")&&(a+=n+" ");i.className=le.trim(a)}return this},removeClass:function(e){var t,i,a,n,o,s=0,r=this.length,l=0===arguments.length||"string"==typeof e&&e;if(le.isFunction(e))return this.each(function(t){le(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(de)||[];r>s;s++)if(i=this[s],a=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ee," "):"")){for(o=0;n=t[o++];)for(;a.indexOf(" "+n+" ")>=0;)a=a.replace(" "+n+" "," ");i.className=e?le.trim(a):""}return this},toggleClass:function(e,t){var i=typeof e,a="boolean"==typeof t;return le.isFunction(e)?this.each(function(i){le(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var n,o=0,s=le(this),r=t,l=e.match(de)||[];n=l[o++];)r=a?r:!s.hasClass(n),s[r?"addClass":"removeClass"](n);else(i===V||"boolean"===i)&&(this.className&&le._data(this,"__className__",this.className),this.className=this.className||e===!1?"":le._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,a=this.length;a>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Ee," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,a,n,o=this[0];return arguments.length?(n=le.isFunction(e),this.each(function(i){var o,s=le(this);1===this.nodeType&&(o=n?e.call(this,i,s.val()):e,null==o?o="":"number"==typeof o?o+="":le.isArray(o)&&(o=le.map(o,function(e){return null==e?"":e+""})),a=le.valHooks[this.type]||le.valHooks[this.nodeName.toLowerCase()],a&&"set"in a&&a.set(this,o,"value")!==t||(this.value=o))})):o?(a=le.valHooks[o.type]||le.valHooks[o.nodeName.toLowerCase()],a&&"get"in a&&(i=a.get(o,"value"))!==t?i:(i=o.value,"string"==typeof i?i.replace(Oe,""):null==i?"":i)):void 0}}),le.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,a=e.options,n=e.selectedIndex,o="select-one"===e.type||0>n,s=o?null:[],r=o?n+1:a.length,l=0>n?r:o?n:0;r>l;l++)if(i=a[l],!(!i.selected&&l!==n||(le.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&le.nodeName(i.parentNode,"optgroup"))){if(t=le(i).val(),o)return t;s.push(t)}return s},set:function(e,t){var i=le.makeArray(t);return le(e).find("option").each(function(){this.selected=le.inArray(le(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,i,a){var n,o,s,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?typeof e.getAttribute===V?le.prop(e,i,a):(o=1!==r||!le.isXMLDoc(e),o&&(i=i.toLowerCase(),n=le.attrHooks[i]||(Me.test(i)?Te:Se)),a===t?n&&o&&"get"in n&&null!==(s=n.get(e,i))?s:(typeof e.getAttribute!==V&&(s=e.getAttribute(i)),null==s?t:s):null!==a?n&&o&&"set"in n&&(s=n.set(e,a,i))!==t?s:(e.setAttribute(i,a+""),a):(le.removeAttr(e,i),t)):void 0},removeAttr:function(e,t){var i,a,n=0,o=t&&t.match(de);if(o&&1===e.nodeType)for(;i=o[n++];)a=le.propFix[i]||i,Me.test(i)?!Ne&&Pe.test(i)?e[le.camelCase("default-"+i)]=e[a]=!1:e[a]=!1:le.attr(e,i,""),e.removeAttribute(Ne?i:a)},attrHooks:{type:{set:function(e,t){if(!le.support.radioValue&&"radio"===t&&le.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,a){var n,o,s,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?(s=1!==r||!le.isXMLDoc(e),s&&(i=le.propFix[i]||i,o=le.propHooks[i]),a!==t?o&&"set"in o&&(n=o.set(e,a,i))!==t?n:e[i]=a:o&&"get"in o&&null!==(n=o.get(e,i))?n:e[i]):void 0},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):De.test(e.nodeName)||Ae.test(e.nodeName)&&e.href?0:t}}}}),Te={get:function(e,i){var a=le.prop(e,i),n="boolean"==typeof a&&e.getAttribute(i),o="boolean"==typeof a?Le&&Ne?null!=n:Pe.test(i)?e[le.camelCase("default-"+i)]:!!n:e.getAttributeNode(i);return o&&o.value!==!1?i.toLowerCase():t},set:function(e,t,i){return t===!1?le.removeAttr(e,i):Le&&Ne||!Pe.test(i)?e.setAttribute(!Ne&&le.propFix[i]||i,i):e[le.camelCase("default-"+i)]=e[i]=!0,i}},Le&&Ne||(le.attrHooks.value={get:function(e,i){var a=e.getAttributeNode(i);return le.nodeName(e,"input")?e.defaultValue:a&&a.specified?a.value:t},set:function(e,i,a){return le.nodeName(e,"input")?(e.defaultValue=i,t):Se&&Se.set(e,i,a)}}),Ne||(Se=le.valHooks.button={get:function(e,i){var a=e.getAttributeNode(i);return a&&("id"===i||"name"===i||"coords"===i?""!==a.value:a.specified)?a.value:t},set:function(e,i,a){var n=e.getAttributeNode(a);return n||e.setAttributeNode(n=e.ownerDocument.createAttribute(a)),n.value=i+="","value"===a||i===e.getAttribute(a)?i:t}},le.attrHooks.contenteditable={get:Se.get,set:function(e,t,i){Se.set(e,""===t?!1:t,i)}},le.each(["width","height"],function(e,i){le.attrHooks[i]=le.extend(le.attrHooks[i],{set:function(e,a){return""===a?(e.setAttribute(i,"auto"),a):t}})})),le.support.hrefNormalized||(le.each(["href","src","width","height"],function(e,i){le.attrHooks[i]=le.extend(le.attrHooks[i],{get:function(e){var a=e.getAttribute(i,2);return null==a?t:a}})}),le.each(["href","src"],function(e,t){le.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),le.support.style||(le.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),le.support.optSelected||(le.propHooks.selected=le.extend(le.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),le.support.enctype||(le.propFix.enctype="encoding"),le.support.checkOn||le.each(["radio","checkbox"],function(){le.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),le.each(["radio","checkbox"],function(){le.valHooks[this]=le.extend(le.valHooks[this],{set:function(e,i){return le.isArray(i)?e.checked=le.inArray(le(e).val(),i)>=0:t}})});var je=/^(?:input|select|textarea)$/i,Ie=/^key/,Re=/^(?:mouse|contextmenu)|click/,Be=/^(?:focusinfocus|focusoutblur)$/,Fe=/^([^.]*)(?:\.(.+)|)$/;le.event={global:{},add:function(e,i,a,n,o){var s,r,l,c,d,u,h,p,f,g,m,v=le._data(e);if(v){for(a.handler&&(c=a,a=c.handler,o=c.selector),a.guid||(a.guid=le.guid++),
(r=v.events)||(r=v.events={}),(u=v.handle)||(u=v.handle=function(e){return typeof le===V||e&&le.event.triggered===e.type?t:le.event.dispatch.apply(u.elem,arguments)},u.elem=e),i=(i||"").match(de)||[""],l=i.length;l--;)s=Fe.exec(i[l])||[],f=m=s[1],g=(s[2]||"").split(".").sort(),d=le.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,d=le.event.special[f]||{},h=le.extend({type:f,origType:m,data:n,handler:a,guid:a.guid,selector:o,needsContext:o&&le.expr.match.needsContext.test(o),namespace:g.join(".")},c),(p=r[f])||(p=r[f]=[],p.delegateCount=0,d.setup&&d.setup.call(e,n,g,u)!==!1||(e.addEventListener?e.addEventListener(f,u,!1):e.attachEvent&&e.attachEvent("on"+f,u))),d.add&&(d.add.call(e,h),h.handler.guid||(h.handler.guid=a.guid)),o?p.splice(p.delegateCount++,0,h):p.push(h),le.event.global[f]=!0;e=null}},remove:function(e,t,i,a,n){var o,s,r,l,c,d,u,h,p,f,g,m=le.hasData(e)&&le._data(e);if(m&&(d=m.events)){for(t=(t||"").match(de)||[""],c=t.length;c--;)if(r=Fe.exec(t[c])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p){for(u=le.event.special[p]||{},p=(a?u.delegateType:u.bindType)||p,h=d[p]||[],r=r[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=h.length;o--;)s=h[o],!n&&g!==s.origType||i&&i.guid!==s.guid||r&&!r.test(s.namespace)||a&&a!==s.selector&&("**"!==a||!s.selector)||(h.splice(o,1),s.selector&&h.delegateCount--,u.remove&&u.remove.call(e,s));l&&!h.length&&(u.teardown&&u.teardown.call(e,f,m.handle)!==!1||le.removeEvent(e,p,m.handle),delete d[p])}else for(p in d)le.event.remove(e,p+t[c],i,a,!0);le.isEmptyObject(d)&&(delete m.handle,le._removeData(e,"events"))}},trigger:function(i,a,n,o){var s,r,l,c,d,u,h,p=[n||Y],f=se.call(i,"type")?i.type:i,g=se.call(i,"namespace")?i.namespace.split("."):[];if(l=u=n=n||Y,3!==n.nodeType&&8!==n.nodeType&&!Be.test(f+le.event.triggered)&&(f.indexOf(".")>=0&&(g=f.split("."),f=g.shift(),g.sort()),r=0>f.indexOf(":")&&"on"+f,i=i[le.expando]?i:new le.Event(f,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=g.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=n),a=null==a?[i]:le.makeArray(a,[i]),d=le.event.special[f]||{},o||!d.trigger||d.trigger.apply(n,a)!==!1)){if(!o&&!d.noBubble&&!le.isWindow(n)){for(c=d.delegateType||f,Be.test(c+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),u=l;u===(n.ownerDocument||Y)&&p.push(u.defaultView||u.parentWindow||e)}for(h=0;(l=p[h++])&&!i.isPropagationStopped();)i.type=h>1?c:d.bindType||f,s=(le._data(l,"events")||{})[i.type]&&le._data(l,"handle"),s&&s.apply(l,a),s=r&&l[r],s&&le.acceptData(l)&&s.apply&&s.apply(l,a)===!1&&i.preventDefault();if(i.type=f,!(o||i.isDefaultPrevented()||d._default&&d._default.apply(n.ownerDocument,a)!==!1||"click"===f&&le.nodeName(n,"a")||!le.acceptData(n)||!r||!n[f]||le.isWindow(n))){u=n[r],u&&(n[r]=null),le.event.triggered=f;try{n[f]()}catch(m){}le.event.triggered=t,u&&(n[r]=u)}return i.result}},dispatch:function(e){e=le.event.fix(e);var i,a,n,o,s,r=[],l=ae.call(arguments),c=(le._data(this,"events")||{})[e.type]||[],d=le.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!d.preDispatch||d.preDispatch.call(this,e)!==!1){for(r=le.event.handlers.call(this,e,c),i=0;(o=r[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,s=0;(n=o.handlers[s++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(n.namespace))&&(e.handleObj=n,e.data=n.data,a=((le.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,l),a!==t&&(e.result=a)===!1&&(e.preventDefault(),e.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,e),e.result}},handlers:function(e,i){var a,n,o,s,r=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==e.type)){for(o=[],s=0;l>s;s++)n=i[s],a=n.selector+" ",o[a]===t&&(o[a]=n.needsContext?le(a,this).index(c)>=0:le.find(a,this,null,[c]).length),o[a]&&o.push(n);o.length&&r.push({elem:c,handlers:o})}return i.length>l&&r.push({elem:this,handlers:i.slice(l)}),r},fix:function(e){if(e[le.expando])return e;var t,i,a,n=e.type,o=e,s=this.fixHooks[n];for(s||(this.fixHooks[n]=s=Re.test(n)?this.mouseHooks:Ie.test(n)?this.keyHooks:{}),a=s.props?this.props.concat(s.props):this.props,e=new le.Event(o),t=a.length;t--;)i=a[t],e[i]=o[i];return e.target||(e.target=o.srcElement||Y),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var a,n,o,s=i.button,r=i.fromElement;return null==e.pageX&&null!=i.clientX&&(n=e.target.ownerDocument||Y,o=n.documentElement,a=n.body,e.pageX=i.clientX+(o&&o.scrollLeft||a&&a.scrollLeft||0)-(o&&o.clientLeft||a&&a.clientLeft||0),e.pageY=i.clientY+(o&&o.scrollTop||a&&a.scrollTop||0)-(o&&o.clientTop||a&&a.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?i.toElement:r),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return le.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==Y.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===Y.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,a){var n=le.extend(new le.Event,i,{type:e,isSimulated:!0,originalEvent:{}});a?le.event.trigger(n,null,t):le.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},le.removeEvent=Y.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var a="on"+t;e.detachEvent&&(typeof e[a]===V&&(e[a]=null),e.detachEvent(a,i))},le.Event=function(e,i){return this instanceof le.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:c):this.type=e,i&&le.extend(this,i),this.timeStamp=e&&e.timeStamp||le.now(),this[le.expando]=!0,t):new le.Event(e,i)},le.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},le.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){le.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,a=this,n=e.relatedTarget,o=e.handleObj;return(!n||n!==a&&!le.contains(a,n))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),le.support.submitBubbles||(le.event.special.submit={setup:function(){return le.nodeName(this,"form")?!1:(le.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,a=le.nodeName(i,"input")||le.nodeName(i,"button")?i.form:t;a&&!le._data(a,"submitBubbles")&&(le.event.add(a,"submit._submit",function(e){e._submit_bubble=!0}),le._data(a,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&le.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return le.nodeName(this,"form")?!1:(le.event.remove(this,"._submit"),t)}}),le.support.changeBubbles||(le.event.special.change={setup:function(){return je.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(le.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),le.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),le.event.simulate("change",this,e,!0)})),!1):(le.event.add(this,"beforeactivate._change",function(e){var t=e.target;je.test(t.nodeName)&&!le._data(t,"changeBubbles")&&(le.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||le.event.simulate("change",this.parentNode,e,!0)}),le._data(t,"changeBubbles",!0))}),t)},handle:function(e){var i=e.target;return this!==i||e.isSimulated||e.isTrigger||"radio"!==i.type&&"checkbox"!==i.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return le.event.remove(this,"._change"),!je.test(this.nodeName)}}),le.support.focusinBubbles||le.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,a=function(e){le.event.simulate(t,e.target,le.event.fix(e),!0)};le.event.special[t]={setup:function(){0===i++&&Y.addEventListener(e,a,!0)},teardown:function(){0===--i&&Y.removeEventListener(e,a,!0)}}}),le.fn.extend({on:function(e,i,a,n,o){var s,r;if("object"==typeof e){"string"!=typeof i&&(a=a||i,i=t);for(s in e)this.on(s,i,a,e[s],o);return this}if(null==a&&null==n?(n=i,a=i=t):null==n&&("string"==typeof i?(n=a,a=t):(n=a,a=i,i=t)),n===!1)n=c;else if(!n)return this;return 1===o&&(r=n,n=function(e){return le().off(e),r.apply(this,arguments)},n.guid=r.guid||(r.guid=le.guid++)),this.each(function(){le.event.add(this,e,n,a,i)})},one:function(e,t,i,a){return this.on(e,t,i,a,1)},off:function(e,i,a){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,le(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return(i===!1||"function"==typeof i)&&(a=i,i=t),a===!1&&(a=c),this.each(function(){le.event.remove(this,e,a,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,a){return this.on(t,e,i,a)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){le.event.trigger(e,t,this)})},triggerHandler:function(e,i){var a=this[0];return a?le.event.trigger(e,i,a,!0):t}}),function(e,t){function i(e){return fe.test(e+"")}function a(){var e,t=[];return e=function(i,a){return t.push(i+=" ")>$.cacheLength&&delete e[t.shift()],e[i]=a}}function n(e){return e[B]=!0,e}function o(e){var t=A.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}}function s(e,t,i,a){var n,o,s,r,l,c,d,p,f,g;if((t?t.ownerDocument||t:F)!==A&&D(t),t=t||A,i=i||[],!e||"string"!=typeof e)return i;if(1!==(r=t.nodeType)&&9!==r)return[];if(!P&&!a){if(n=ge.exec(e))if(s=n[1]){if(9===r){if(o=t.getElementById(s),!o||!o.parentNode)return i;if(o.id===s)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&I(t,o)&&o.id===s)return i.push(o),i}else{if(n[2])return X.apply(i,Z.call(t.getElementsByTagName(e),0)),i;if((s=n[3])&&H.getByClassName&&t.getElementsByClassName)return X.apply(i,Z.call(t.getElementsByClassName(s),0)),i}if(H.qsa&&!N.test(e)){if(d=!0,p=B,f=t,g=9===r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(c=u(e),(d=t.getAttribute("id"))?p=d.replace(be,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+h(c[l]);f=pe.test(e)&&t.parentNode||t,g=c.join(",")}if(g)try{return X.apply(i,Z.call(f.querySelectorAll(g),0)),i}catch(m){}finally{d||t.removeAttribute("id")}}}return _(e.replace(se,"$1"),t,i,a)}function r(e,t){var i=t&&e,a=i&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(a)return a;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function c(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function d(e){return n(function(t){return t=+t,n(function(i,a){for(var n,o=e([],i.length,t),s=o.length;s--;)i[n=o[s]]&&(i[n]=!(a[n]=i[n]))})})}function u(e,t){var i,a,n,o,r,l,c,d=W[e+" "];if(d)return t?0:d.slice(0);for(r=e,l=[],c=$.preFilter;r;){(!i||(a=re.exec(r)))&&(a&&(r=r.slice(a[0].length)||r),l.push(n=[])),i=!1,(a=ce.exec(r))&&(i=a.shift(),n.push({value:i,type:a[0].replace(se," ")}),r=r.slice(i.length));for(o in $.filter)!(a=he[o].exec(r))||c[o]&&!(a=c[o](a))||(i=a.shift(),n.push({value:i,type:o,matches:a}),r=r.slice(i.length));if(!i)break}return t?r.length:r?s.error(e):W(e,l).slice(0)}function h(e){for(var t=0,i=e.length,a="";i>t;t++)a+=e[t].value;return a}function p(e,t,i){var a=t.dir,n=i&&"parentNode"===a,o=z++;return t.first?function(t,i,o){for(;t=t[a];)if(1===t.nodeType||n)return e(t,i,o)}:function(t,i,s){var r,l,c,d=q+" "+o;if(s){for(;t=t[a];)if((1===t.nodeType||n)&&e(t,i,s))return!0}else for(;t=t[a];)if(1===t.nodeType||n)if(c=t[B]||(t[B]={}),(l=c[a])&&l[0]===d){if((r=l[1])===!0||r===k)return r===!0}else if(l=c[a]=[d],l[1]=e(t,i,s)||k,l[1]===!0)return!0}}function f(e){return e.length>1?function(t,i,a){for(var n=e.length;n--;)if(!e[n](t,i,a))return!1;return!0}:e[0]}function g(e,t,i,a,n){for(var o,s=[],r=0,l=e.length,c=null!=t;l>r;r++)(o=e[r])&&(!i||i(o,a,n))&&(s.push(o),c&&t.push(r));return s}function m(e,t,i,a,o,s){return a&&!a[B]&&(a=m(a)),o&&!o[B]&&(o=m(o,s)),n(function(n,s,r,l){var c,d,u,h=[],p=[],f=s.length,m=n||w(t||"*",r.nodeType?[r]:r,[]),v=!e||!n&&t?m:g(m,h,e,r,l),b=i?o||(n?e:f||a)?[]:s:v;if(i&&i(v,b,r,l),a)for(c=g(b,p),a(c,[],r,l),d=c.length;d--;)(u=c[d])&&(b[p[d]]=!(v[p[d]]=u));if(n){if(o||e){if(o){for(c=[],d=b.length;d--;)(u=b[d])&&c.push(v[d]=u);o(null,b=[],c,l)}for(d=b.length;d--;)(u=b[d])&&(c=o?Q.call(n,u):h[d])>-1&&(n[c]=!(s[c]=u))}}else b=g(b===s?b.splice(f,b.length):b),o?o(null,s,b,l):X.apply(s,b)})}function v(e){for(var t,i,a,n=e.length,o=$.relative[e[0].type],s=o||$.relative[" "],r=o?1:0,l=p(function(e){return e===t},s,!0),c=p(function(e){return Q.call(t,e)>-1},s,!0),d=[function(e,i,a){return!o&&(a||i!==O)||((t=i).nodeType?l(e,i,a):c(e,i,a))}];n>r;r++)if(i=$.relative[e[r].type])d=[p(f(d),i)];else{if(i=$.filter[e[r].type].apply(null,e[r].matches),i[B]){for(a=++r;n>a&&!$.relative[e[a].type];a++);return m(r>1&&f(d),r>1&&h(e.slice(0,r-1)).replace(se,"$1"),i,a>r&&v(e.slice(r,a)),n>a&&v(e=e.slice(a)),n>a&&h(e))}d.push(i)}return f(d)}function b(e,t){var i=0,a=t.length>0,o=e.length>0,r=function(n,r,l,c,d){var u,h,p,f=[],m=0,v="0",b=n&&[],w=null!=d,_=O,y=n||o&&$.find.TAG("*",d&&r.parentNode||r),x=q+=null==_?1:Math.random()||.1;for(w&&(O=r!==A&&r,k=i);null!=(u=y[v]);v++){if(o&&u){for(h=0;p=e[h++];)if(p(u,r,l)){c.push(u);break}w&&(q=x,k=++i)}a&&((u=!p&&u)&&m--,n&&b.push(u))}if(m+=v,a&&v!==m){for(h=0;p=t[h++];)p(b,f,r,l);if(n){if(m>0)for(;v--;)b[v]||f[v]||(f[v]=K.call(c));f=g(f)}X.apply(c,f),w&&!n&&f.length>0&&m+t.length>1&&s.uniqueSort(c)}return w&&(q=x,O=_),b};return a?n(r):r}function w(e,t,i){for(var a=0,n=t.length;n>a;a++)s(e,t[a],i);return i}function _(e,t,i,a){var n,o,s,r,l,c=u(e);if(!a&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&!P&&$.relative[o[1].type]){if(t=$.find.ID(s.matches[0].replace(_e,ye),t)[0],!t)return i;e=e.slice(o.shift().value.length)}for(n=he.needsContext.test(e)?0:o.length;n--&&(s=o[n],!$.relative[r=s.type]);)if((l=$.find[r])&&(a=l(s.matches[0].replace(_e,ye),pe.test(o[0].type)&&t.parentNode||t))){if(o.splice(n,1),e=a.length&&h(o),!e)return X.apply(i,Z.call(a,0)),i;break}}return T(e,c)(a,t,P,i,pe.test(e)),i}function y(){}var x,k,$,C,S,T,E,O,D,A,M,P,N,L,j,I,R,B="sizzle"+-new Date,F=e.document,H={},q=0,z=0,U=a(),W=a(),G=a(),V=typeof t,Y=1<<31,J=[],K=J.pop,X=J.push,Z=J.slice,Q=J.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie=te.replace("w","w#"),ae="([*^$|!~]?=)",ne="\\["+ee+"*("+te+")"+ee+"*(?:"+ae+ee+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ie+")|)|)"+ee+"*\\]",oe=":("+te+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ne.replace(3,8)+")*)|.*)\\)|)",se=RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),re=RegExp("^"+ee+"*,"+ee+"*"),ce=RegExp("^"+ee+"*([\\x20\\t\\r\\n\\f>+~])"+ee+"*"),de=RegExp(oe),ue=RegExp("^"+ie+"$"),he={ID:RegExp("^#("+te+")"),CLASS:RegExp("^\\.("+te+")"),NAME:RegExp("^\\[name=['\"]?("+te+")['\"]?\\]"),TAG:RegExp("^("+te.replace("w","w*")+")"),ATTR:RegExp("^"+ne),PSEUDO:RegExp("^"+oe),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),needsContext:RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},pe=/[\x20\t\r\n\f]*[+~]/,fe=/^[^{]+\{\s*\[native code/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,me=/^(?:input|select|textarea|button)$/i,ve=/^h\d$/i,be=/'|\\/g,we=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,_e=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,ye=function(e,t){var i="0x"+t-65536;return i!==i?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(55296|i>>10,56320|1023&i)};try{Z.call(F.documentElement.childNodes,0)[0].nodeType}catch(xe){Z=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}S=s.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},D=s.setDocument=function(e){var a=e?e.ownerDocument||e:F;return a!==A&&9===a.nodeType&&a.documentElement?(A=a,M=a.documentElement,P=S(a),H.tagNameNoComments=o(function(e){return e.appendChild(a.createComment("")),!e.getElementsByTagName("*").length}),H.attributes=o(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),H.getByClassName=o(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),H.getByName=o(function(e){e.id=B+0,e.innerHTML="<a name='"+B+"'></a><div name='"+B+"'></div>",M.insertBefore(e,M.firstChild);var t=a.getElementsByName&&a.getElementsByName(B).length===2+a.getElementsByName(B+0).length;return H.getIdNotName=!a.getElementById(B),M.removeChild(e),t}),$.attrHandle=o(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==V&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},H.getIdNotName?($.find.ID=function(e,t){if(typeof t.getElementById!==V&&!P){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},$.filter.ID=function(e){var t=e.replace(_e,ye);return function(e){return e.getAttribute("id")===t}}):($.find.ID=function(e,i){if(typeof i.getElementById!==V&&!P){var a=i.getElementById(e);return a?a.id===e||typeof a.getAttributeNode!==V&&a.getAttributeNode("id").value===e?[a]:t:[]}},$.filter.ID=function(e){var t=e.replace(_e,ye);return function(e){var i=typeof e.getAttributeNode!==V&&e.getAttributeNode("id");return i&&i.value===t}}),$.find.TAG=H.tagNameNoComments?function(e,i){return typeof i.getElementsByTagName!==V?i.getElementsByTagName(e):t}:function(e,t){var i,a=[],n=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[n++];)1===i.nodeType&&a.push(i);return a}return o},$.find.NAME=H.getByName&&function(e,i){return typeof i.getElementsByName!==V?i.getElementsByName(name):t},$.find.CLASS=H.getByClassName&&function(e,i){return typeof i.getElementsByClassName===V||P?t:i.getElementsByClassName(e)},L=[],N=[":focus"],(H.qsa=i(a.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||N.push("\\["+ee+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||N.push(":checked")}),o(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&N.push("[*^$]="+ee+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(H.matchesSelector=i(j=M.matchesSelector||M.mozMatchesSelector||M.webkitMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(e){H.disconnectedMatch=j.call(e,"div"),j.call(e,"[s!='']:x"),L.push("!=",oe)}),N=RegExp(N.join("|")),L=RegExp(L.join("|")),I=i(M.contains)||M.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,a=t&&t.parentNode;return e===a||!(!a||1!==a.nodeType||!(i.contains?i.contains(a):e.compareDocumentPosition&&16&e.compareDocumentPosition(a)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},R=M.compareDocumentPosition?function(e,t){var i;return e===t?(E=!0,0):(i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&i||e.parentNode&&11===e.parentNode.nodeType?e===a||I(F,e)?-1:t===a||I(F,t)?1:0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,n=0,o=e.parentNode,s=t.parentNode,l=[e],c=[t];if(e===t)return E=!0,0;if(!o||!s)return e===a?-1:t===a?1:o?-1:s?1:0;if(o===s)return r(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[n]===c[n];)n++;return n?r(l[n],c[n]):l[n]===F?-1:c[n]===F?1:0},E=!1,[0,0].sort(R),H.detectDuplicates=E,A):A},s.matches=function(e,t){return s(e,null,null,t)},s.matchesSelector=function(e,t){if((e.ownerDocument||e)!==A&&D(e),t=t.replace(we,"='$1']"),!(!H.matchesSelector||P||L&&L.test(t)||N.test(t)))try{var i=j.call(e,t);if(i||H.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(a){}return s(t,A,null,[e]).length>0},s.contains=function(e,t){return(e.ownerDocument||e)!==A&&D(e),I(e,t)},s.attr=function(e,t){var i;return(e.ownerDocument||e)!==A&&D(e),P||(t=t.toLowerCase()),(i=$.attrHandle[t])?i(e):P||H.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:i&&i.specified?i.value:null},s.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},s.uniqueSort=function(e){var t,i=[],a=1,n=0;if(E=!H.detectDuplicates,e.sort(R),E){for(;t=e[a];a++)t===e[a-1]&&(n=i.push(a));for(;n--;)e.splice(i[n],1)}return e},C=s.getText=function(e){var t,i="",a=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=C(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[a];a++)i+=C(t);return i},$=s.selectors={cacheLength:50,createPseudo:n,match:he,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_e,ye),e[3]=(e[4]||e[5]||"").replace(_e,ye),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||s.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&s.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return he.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&de.test(i)&&(t=u(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(_e,ye).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=U[e+" "];return t||(t=RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&U(e,function(e){return t.test(e.className||typeof e.getAttribute!==V&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(a){var n=s.attr(a,e);return null==n?"!="===t:t?(n+="","="===t?n===i:"!="===t?n!==i:"^="===t?i&&0===n.indexOf(i):"*="===t?i&&n.indexOf(i)>-1:"$="===t?i&&n.slice(-i.length)===i:"~="===t?(" "+n+" ").indexOf(i)>-1:"|="===t?n===i||n.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,i,a,n){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),r="of-type"===t;return 1===a&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var c,d,u,h,p,f,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),b=!l&&!r;if(m){if(o){for(;g;){for(u=t;u=u[g];)if(r?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&b){for(d=m[B]||(m[B]={}),c=d[e]||[],p=c[0]===q&&c[1],h=c[0]===q&&c[2],u=p&&m.childNodes[p];u=++p&&u&&u[g]||(h=p=0)||f.pop();)if(1===u.nodeType&&++h&&u===t){d[e]=[q,p,h];break}}else if(b&&(c=(t[B]||(t[B]={}))[e])&&c[0]===q)h=c[1];else for(;(u=++p&&u&&u[g]||(h=p=0)||f.pop())&&((r?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++h||(b&&((u[B]||(u[B]={}))[e]=[q,h]),u!==t)););return h-=n,h===a||0===h%a&&h/a>=0}}},PSEUDO:function(e,t){var i,a=$.pseudos[e]||$.setFilters[e.toLowerCase()]||s.error("unsupported pseudo: "+e);return a[B]?a(t):a.length>1?(i=[e,e,"",t],$.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,i){for(var n,o=a(e,t),s=o.length;s--;)n=Q.call(e,o[s]),e[n]=!(i[n]=o[s])}):function(e){return a(e,0,i)}):a}},pseudos:{not:n(function(e){var t=[],i=[],a=T(e.replace(se,"$1"));return a[B]?n(function(e,t,i,n){for(var o,s=a(e,null,n,[]),r=e.length;r--;)(o=s[r])&&(e[r]=!(t[r]=o))}):function(e,n,o){return t[0]=e,a(t,null,o,i),!i.pop()}}),has:n(function(e){return function(t){return s(e,t).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:n(function(e){return ue.test(e||"")||s.error("unsupported lang: "+e),e=e.replace(_e,ye).toLowerCase(),function(t){var i;do if(i=P?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!$.pseudos.empty(e)},header:function(e){return ve.test(e.nodeName)},input:function(e){return me.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:d(function(){return[0]}),last:d(function(e,t){return[t-1]}),eq:d(function(e,t,i){return[0>i?i+t:i]}),even:d(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:d(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:d(function(e,t,i){for(var a=0>i?i+t:i;--a>=0;)e.push(a);return e}),gt:d(function(e,t,i){for(var a=0>i?i+t:i;t>++a;)e.push(a);return e})}};for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})$.pseudos[x]=l(x);for(x in{submit:!0,reset:!0})$.pseudos[x]=c(x);T=s.compile=function(e,t){var i,a=[],n=[],o=G[e+" "];if(!o){for(t||(t=u(e)),i=t.length;i--;)o=v(t[i]),o[B]?a.push(o):n.push(o);o=G(e,b(n,a))}return o},$.pseudos.nth=$.pseudos.eq,$.filters=y.prototype=$.pseudos,$.setFilters=new y,D(),s.attr=le.attr,le.find=s,le.expr=s.selectors,le.expr[":"]=le.expr.pseudos,le.unique=s.uniqueSort,le.text=s.getText,le.isXMLDoc=s.isXML,le.contains=s.contains}(e);var He=/Until$/,qe=/^(?:parents|prev(?:Until|All))/,ze=/^.[^:#\[\.,]*$/,Ue=le.expr.match.needsContext,We={children:!0,contents:!0,next:!0,prev:!0};le.fn.extend({find:function(e){var t,i,a,n=this.length;if("string"!=typeof e)return a=this,this.pushStack(le(e).filter(function(){for(t=0;n>t;t++)if(le.contains(a[t],this))return!0}));for(i=[],t=0;n>t;t++)le.find(e,this[t],i);return i=this.pushStack(n>1?le.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=le(e,this),a=i.length;return this.filter(function(){for(t=0;a>t;t++)if(le.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(u(this,e,!1))},filter:function(e){return this.pushStack(u(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?Ue.test(e)?le(e,this.context).index(this[0])>=0:le.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,a=0,n=this.length,o=[],s=Ue.test(e)||"string"!=typeof e?le(e,t||this.context):0;n>a;a++)for(i=this[a];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(s?s.index(i)>-1:le.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return this.pushStack(o.length>1?le.unique(o):o)},index:function(e){return e?"string"==typeof e?le.inArray(this[0],le(e)):le.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?le(e,t):le.makeArray(e&&e.nodeType?[e]:e),a=le.merge(this.get(),i);return this.pushStack(le.unique(a))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),le.fn.andSelf=le.fn.addBack,le.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return le.dir(e,"parentNode")},parentsUntil:function(e,t,i){return le.dir(e,"parentNode",i)},next:function(e){return d(e,"nextSibling")},prev:function(e){return d(e,"previousSibling")},nextAll:function(e){return le.dir(e,"nextSibling")},prevAll:function(e){return le.dir(e,"previousSibling")},nextUntil:function(e,t,i){return le.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return le.dir(e,"previousSibling",i)},siblings:function(e){return le.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return le.sibling(e.firstChild)},contents:function(e){return le.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:le.merge([],e.childNodes)}},function(e,t){le.fn[e]=function(i,a){var n=le.map(this,t,i);return He.test(e)||(a=i),a&&"string"==typeof a&&(n=le.filter(a,n)),n=this.length>1&&!We[e]?le.unique(n):n,this.length>1&&qe.test(e)&&(n=n.reverse()),this.pushStack(n)}}),le.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?le.find.matchesSelector(t[0],e)?[t[0]]:[]:le.find.matches(e,t)},dir:function(e,i,a){for(var n=[],o=e[i];o&&9!==o.nodeType&&(a===t||1!==o.nodeType||!le(o).is(a));)1===o.nodeType&&n.push(o),o=o[i];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Ge="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ve=/ jQuery\d+="(?:null|\d+)"/g,Ye=RegExp("<(?:"+Ge+")[\\s/>]","i"),Je=/^\s+/,Ke=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Xe=/<([\w:]+)/,Ze=/<tbody/i,Qe=/<|&#?\w+;/,et=/<(?:script|style|link)/i,tt=/^(?:checkbox|radio)$/i,it=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,nt=/^true\/(.*)/,ot=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,st={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:le.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},rt=h(Y),lt=rt.appendChild(Y.createElement("div"));st.optgroup=st.option,st.tbody=st.tfoot=st.colgroup=st.caption=st.thead,st.th=st.td,le.fn.extend({text:function(e){return le.access(this,function(e){return e===t?le.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(e));
},null,e,arguments.length)},wrapAll:function(e){if(le.isFunction(e))return this.each(function(t){le(this).wrapAll(e.call(this,t))});if(this[0]){var t=le(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return le.isFunction(e)?this.each(function(t){le(this).wrapInner(e.call(this,t))}):this.each(function(){var t=le(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=le.isFunction(e);return this.each(function(i){le(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){le.nodeName(this,"body")||le(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,a=0;null!=(i=this[a]);a++)(!e||le.filter(e,[i]).length>0)&&(t||1!==i.nodeType||le.cleanData(w(i)),i.parentNode&&(t&&le.contains(i.ownerDocument,i)&&m(w(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&le.cleanData(w(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&le.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return le.clone(this,e,t)})},html:function(e){return le.access(this,function(e){var i=this[0]||{},a=0,n=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(Ve,""):t;if(!("string"!=typeof e||et.test(e)||!le.support.htmlSerialize&&Ye.test(e)||!le.support.leadingWhitespace&&Je.test(e)||st[(Xe.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ke,"<$1></$2>");try{for(;n>a;a++)i=this[a]||{},1===i.nodeType&&(le.cleanData(w(i,!1)),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=le.isFunction(e);return t||"string"==typeof e||(e=le(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(le(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,a){e=te.apply([],e);var n,o,s,r,l,c,d=0,u=this.length,h=this,m=u-1,v=e[0],b=le.isFunction(v);if(b||!(1>=u||"string"!=typeof v||le.support.checkClone)&&it.test(v))return this.each(function(n){var o=h.eq(n);b&&(e[0]=v.call(this,n,i?o.html():t)),o.domManip(e,i,a)});if(u&&(c=le.buildFragment(e,this[0].ownerDocument,!1,this),n=c.firstChild,1===c.childNodes.length&&(c=n),n)){for(i=i&&le.nodeName(n,"tr"),r=le.map(w(c,"script"),f),s=r.length;u>d;d++)o=c,d!==m&&(o=le.clone(o,!0,!0),s&&le.merge(r,w(o,"script"))),a.call(i&&le.nodeName(this[d],"table")?p(this[d],"tbody"):this[d],o,d);if(s)for(l=r[r.length-1].ownerDocument,le.map(r,g),d=0;s>d;d++)o=r[d],at.test(o.type||"")&&!le._data(o,"globalEval")&&le.contains(l,o)&&(o.src?le.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):le.globalEval((o.text||o.textContent||o.innerHTML||"").replace(ot,"")));c=n=null}return this}}),le.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){le.fn[e]=function(e){for(var i,a=0,n=[],o=le(e),s=o.length-1;s>=a;a++)i=a===s?this:this.clone(!0),le(o[a])[t](i),ie.apply(n,i.get());return this.pushStack(n)}}),le.extend({clone:function(e,t,i){var a,n,o,s,r,l=le.contains(e.ownerDocument,e);if(le.support.html5Clone||le.isXMLDoc(e)||!Ye.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(lt.innerHTML=e.outerHTML,lt.removeChild(o=lt.firstChild)),!(le.support.noCloneEvent&&le.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||le.isXMLDoc(e)))for(a=w(o),r=w(e),s=0;null!=(n=r[s]);++s)a[s]&&b(n,a[s]);if(t)if(i)for(r=r||w(e),a=a||w(o),s=0;null!=(n=r[s]);s++)v(n,a[s]);else v(e,o);return a=w(o,"script"),a.length>0&&m(a,!l&&w(e,"script")),a=r=n=null,o},buildFragment:function(e,t,i,a){for(var n,o,s,r,l,c,d,u=e.length,p=h(t),f=[],g=0;u>g;g++)if(o=e[g],o||0===o)if("object"===le.type(o))le.merge(f,o.nodeType?[o]:o);else if(Qe.test(o)){for(r=r||p.appendChild(t.createElement("div")),l=(Xe.exec(o)||["",""])[1].toLowerCase(),d=st[l]||st._default,r.innerHTML=d[1]+o.replace(Ke,"<$1></$2>")+d[2],n=d[0];n--;)r=r.lastChild;if(!le.support.leadingWhitespace&&Je.test(o)&&f.push(t.createTextNode(Je.exec(o)[0])),!le.support.tbody)for(o="table"!==l||Ze.test(o)?"<table>"!==d[1]||Ze.test(o)?0:r:r.firstChild,n=o&&o.childNodes.length;n--;)le.nodeName(c=o.childNodes[n],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(le.merge(f,r.childNodes),r.textContent="";r.firstChild;)r.removeChild(r.firstChild);r=p.lastChild}else f.push(t.createTextNode(o));for(r&&p.removeChild(r),le.support.appendChecked||le.grep(w(f,"input"),_),g=0;o=f[g++];)if((!a||-1===le.inArray(o,a))&&(s=le.contains(o.ownerDocument,o),r=w(p.appendChild(o),"script"),s&&m(r),i))for(n=0;o=r[n++];)at.test(o.type||"")&&i.push(o);return r=null,p},cleanData:function(e,t){for(var i,a,n,o,s=0,r=le.expando,l=le.cache,c=le.support.deleteExpando,d=le.event.special;null!=(i=e[s]);s++)if((t||le.acceptData(i))&&(n=i[r],o=n&&l[n])){if(o.events)for(a in o.events)d[a]?le.event.remove(i,a):le.removeEvent(i,a,o.handle);l[n]&&(delete l[n],c?delete i[r]:typeof i.removeAttribute!==V?i.removeAttribute(r):i[r]=null,Q.push(n))}}});var ct,dt,ut,ht=/alpha\([^)]*\)/i,pt=/opacity\s*=\s*([^)]*)/,ft=/^(top|right|bottom|left)$/,gt=/^(none|table(?!-c[ea]).+)/,mt=/^margin/,vt=RegExp("^("+ce+")(.*)$","i"),bt=RegExp("^("+ce+")(?!px)[a-z%]+$","i"),wt=RegExp("^([+-])=("+ce+")","i"),_t={BODY:"block"},yt={position:"absolute",visibility:"hidden",display:"block"},xt={letterSpacing:0,fontWeight:400},kt=["Top","Right","Bottom","Left"],$t=["Webkit","O","Moz","ms"];le.fn.extend({css:function(e,i){return le.access(this,function(e,i,a){var n,o,s={},r=0;if(le.isArray(i)){for(o=dt(e),n=i.length;n>r;r++)s[i[r]]=le.css(e,i[r],!1,o);return s}return a!==t?le.style(e,i,a):le.css(e,i)},e,i,arguments.length>1)},show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:x(this))?le(this).show():le(this).hide()})}}),le.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ut(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":le.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,a,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,s,r,l=le.camelCase(i),c=e.style;if(i=le.cssProps[l]||(le.cssProps[l]=y(c,l)),r=le.cssHooks[i]||le.cssHooks[l],a===t)return r&&"get"in r&&(o=r.get(e,!1,n))!==t?o:c[i];if(s=typeof a,"string"===s&&(o=wt.exec(a))&&(a=(o[1]+1)*o[2]+parseFloat(le.css(e,i)),s="number"),!(null==a||"number"===s&&isNaN(a)||("number"!==s||le.cssNumber[l]||(a+="px"),le.support.clearCloneStyle||""!==a||0!==i.indexOf("background")||(c[i]="inherit"),r&&"set"in r&&(a=r.set(e,a,n))===t)))try{c[i]=a}catch(d){}}},css:function(e,i,a,n){var o,s,r,l=le.camelCase(i);return i=le.cssProps[l]||(le.cssProps[l]=y(e.style,l)),r=le.cssHooks[i]||le.cssHooks[l],r&&"get"in r&&(s=r.get(e,!0,a)),s===t&&(s=ut(e,i,n)),"normal"===s&&i in xt&&(s=xt[i]),""===a||a?(o=parseFloat(s),a===!0||le.isNumeric(o)?o||0:s):s},swap:function(e,t,i,a){var n,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];n=i.apply(e,a||[]);for(o in t)e.style[o]=s[o];return n}}),e.getComputedStyle?(dt=function(t){return e.getComputedStyle(t,null)},ut=function(e,i,a){var n,o,s,r=a||dt(e),l=r?r.getPropertyValue(i)||r[i]:t,c=e.style;return r&&(""!==l||le.contains(e.ownerDocument,e)||(l=le.style(e,i)),bt.test(l)&&mt.test(i)&&(n=c.width,o=c.minWidth,s=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=r.width,c.width=n,c.minWidth=o,c.maxWidth=s)),l}):Y.documentElement.currentStyle&&(dt=function(e){return e.currentStyle},ut=function(e,i,a){var n,o,s,r=a||dt(e),l=r?r[i]:t,c=e.style;return null==l&&c&&c[i]&&(l=c[i]),bt.test(l)&&!ft.test(i)&&(n=c.left,o=e.runtimeStyle,s=o&&o.left,s&&(o.left=e.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=n,s&&(o.left=s)),""===l?"auto":l}),le.each(["height","width"],function(e,i){le.cssHooks[i]={get:function(e,a,n){return a?0===e.offsetWidth&&gt.test(le.css(e,"display"))?le.swap(e,yt,function(){return S(e,i,n)}):S(e,i,n):t},set:function(e,t,a){var n=a&&dt(e);return $(e,t,a?C(e,i,a,le.support.boxSizing&&"border-box"===le.css(e,"boxSizing",!1,n),n):0)}}}),le.support.opacity||(le.cssHooks.opacity={get:function(e,t){return pt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,a=e.currentStyle,n=le.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=a&&a.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===le.trim(o.replace(ht,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||a&&!a.filter)||(i.filter=ht.test(o)?o.replace(ht,n):o+" "+n)}}),le(function(){le.support.reliableMarginRight||(le.cssHooks.marginRight={get:function(e,i){return i?le.swap(e,{display:"inline-block"},ut,[e,"marginRight"]):t}}),!le.support.pixelPosition&&le.fn.position&&le.each(["top","left"],function(e,i){le.cssHooks[i]={get:function(e,a){return a?(a=ut(e,i),bt.test(a)?le(e).position()[i]+"px":a):t}}})}),le.expr&&le.expr.filters&&(le.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!le.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||le.css(e,"display"))},le.expr.filters.visible=function(e){return!le.expr.filters.hidden(e)}),le.each({margin:"",padding:"",border:"Width"},function(e,t){le.cssHooks[e+t]={expand:function(i){for(var a=0,n={},o="string"==typeof i?i.split(" "):[i];4>a;a++)n[e+kt[a]+t]=o[a]||o[a-2]||o[0];return n}},mt.test(e)||(le.cssHooks[e+t].set=$)});var Ct=/%20/g,St=/\[\]$/,Tt=/\r?\n/g,Et=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;le.fn.extend({serialize:function(){return le.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=le.prop(this,"elements");return e?le.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!le(this).is(":disabled")&&Ot.test(this.nodeName)&&!Et.test(e)&&(this.checked||!tt.test(e))}).map(function(e,t){var i=le(this).val();return null==i?null:le.isArray(i)?le.map(i,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}}):{name:t.name,value:i.replace(Tt,"\r\n")}}).get()}}),le.param=function(e,i){var a,n=[],o=function(e,t){t=le.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=le.ajaxSettings&&le.ajaxSettings.traditional),le.isArray(e)||e.jquery&&!le.isPlainObject(e))le.each(e,function(){o(this.name,this.value)});else for(a in e)O(a,e[a],i,o);return n.join("&").replace(Ct,"+")},le.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){le.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),le.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var Dt,At,Mt=le.now(),Pt=/\?/,Nt=/#.*$/,Lt=/([?&])_=[^&]*/,jt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,It=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Rt=/^(?:GET|HEAD)$/,Bt=/^\/\//,Ft=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ht=le.fn.load,qt={},zt={},Ut="*/".concat("*");try{At=J.href}catch(Wt){At=Y.createElement("a"),At.href="",At=At.href}Dt=Ft.exec(At.toLowerCase())||[],le.fn.load=function(e,i,a){if("string"!=typeof e&&Ht)return Ht.apply(this,arguments);var n,o,s,r=this,l=e.indexOf(" ");return l>=0&&(n=e.slice(l,e.length),e=e.slice(0,l)),le.isFunction(i)?(a=i,i=t):i&&"object"==typeof i&&(s="POST"),r.length>0&&le.ajax({url:e,type:s,dataType:"html",data:i}).done(function(e){o=arguments,r.html(n?le("<div>").append(le.parseHTML(e)).find(n):e)}).complete(a&&function(e,t){r.each(a,o||[e.responseText,t,e])}),this},le.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){le.fn[t]=function(e){return this.on(t,e)}}),le.each(["get","post"],function(e,i){le[i]=function(e,a,n,o){return le.isFunction(a)&&(o=o||n,n=a,a=t),le.ajax({url:e,type:i,dataType:o,data:a,success:n})}}),le.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At,type:"GET",isLocal:It.test(Dt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":le.parseJSON,"text xml":le.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?M(M(e,le.ajaxSettings),t):M(le.ajaxSettings,e)},ajaxPrefilter:D(qt),ajaxTransport:D(zt),ajax:function(e,i){function a(e,i,a,n){var o,u,b,w,y,k=i;2!==_&&(_=2,l&&clearTimeout(l),d=t,r=n||"",x.readyState=e>0?4:0,a&&(w=P(h,x,a)),e>=200&&300>e||304===e?(h.ifModified&&(y=x.getResponseHeader("Last-Modified"),y&&(le.lastModified[s]=y),y=x.getResponseHeader("etag"),y&&(le.etag[s]=y)),204===e?(o=!0,k="nocontent"):304===e?(o=!0,k="notmodified"):(o=N(h,w),k=o.state,u=o.data,b=o.error,o=!b)):(b=k,(e||!k)&&(k="error",0>e&&(e=0))),x.status=e,x.statusText=(i||k)+"",o?g.resolveWith(p,[u,k,x]):g.rejectWith(p,[x,k,b]),x.statusCode(v),v=t,c&&f.trigger(o?"ajaxSuccess":"ajaxError",[x,h,o?u:b]),m.fireWith(p,[x,k]),c&&(f.trigger("ajaxComplete",[x,h]),--le.active||le.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var n,o,s,r,l,c,d,u,h=le.ajaxSetup({},i),p=h.context||h,f=h.context&&(p.nodeType||p.jquery)?le(p):le.event,g=le.Deferred(),m=le.Callbacks("once memory"),v=h.statusCode||{},b={},w={},_=0,y="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!u)for(u={};t=jt.exec(r);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return _||(e=w[i]=w[i]||e,b[e]=t),this},overrideMimeType:function(e){return _||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>_)for(t in e)v[t]=[v[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||y;return d&&d.abort(t),a(0,t),this}};if(g.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,h.url=((e||h.url||At)+"").replace(Nt,"").replace(Bt,Dt[1]+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=le.trim(h.dataType||"*").toLowerCase().match(de)||[""],null==h.crossDomain&&(n=Ft.exec(h.url.toLowerCase()),h.crossDomain=!(!n||n[1]===Dt[1]&&n[2]===Dt[2]&&(n[3]||("http:"===n[1]?80:443))==(Dt[3]||("http:"===Dt[1]?80:443)))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=le.param(h.data,h.traditional)),A(qt,h,i,x),2===_)return x;c=h.global,c&&0===le.active++&&le.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Rt.test(h.type),s=h.url,h.hasContent||(h.data&&(s=h.url+=(Pt.test(s)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Lt.test(s)?s.replace(Lt,"$1_="+Mt++):s+(Pt.test(s)?"&":"?")+"_="+Mt++)),h.ifModified&&(le.lastModified[s]&&x.setRequestHeader("If-Modified-Since",le.lastModified[s]),le.etag[s]&&x.setRequestHeader("If-None-Match",le.etag[s])),(h.data&&h.hasContent&&h.contentType!==!1||i.contentType)&&x.setRequestHeader("Content-Type",h.contentType),x.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Ut+"; q=0.01":""):h.accepts["*"]);for(o in h.headers)x.setRequestHeader(o,h.headers[o]);if(h.beforeSend&&(h.beforeSend.call(p,x,h)===!1||2===_))return x.abort();y="abort";for(o in{success:1,error:1,complete:1})x[o](h[o]);if(d=A(zt,h,i,x)){x.readyState=1,c&&f.trigger("ajaxSend",[x,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){x.abort("timeout")},h.timeout));try{_=1,d.send(b,a)}catch(k){if(!(2>_))throw k;a(-1,k)}}else a(-1,"No Transport");return x},getScript:function(e,i){return le.get(e,t,i,"script")},getJSON:function(e,t,i){return le.get(e,t,i,"json")}}),le.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return le.globalEval(e),e}}}),le.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),le.ajaxTransport("script",function(e){if(e.crossDomain){var i,a=Y.head||le("head")[0]||Y.documentElement;return{send:function(t,n){i=Y.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||n(200,"success"))},a.insertBefore(i,a.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Gt=[],Vt=/(=)\?(?=&|$)|\?\?/;le.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Gt.pop()||le.expando+"_"+Mt++;return this[e]=!0,e}}),le.ajaxPrefilter("json jsonp",function(i,a,n){var o,s,r,l=i.jsonp!==!1&&(Vt.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vt.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=le.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Vt,"$1"+o):i.jsonp!==!1&&(i.url+=(Pt.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return r||le.error(o+" was not called"),r[0]},i.dataTypes[0]="json",s=e[o],e[o]=function(){r=arguments},n.always(function(){e[o]=s,i[o]&&(i.jsonpCallback=a.jsonpCallback,Gt.push(o)),r&&le.isFunction(s)&&s(r[0]),r=s=t}),"script"):t});var Yt,Jt,Kt=0,Xt=e.ActiveXObject&&function(){var e;for(e in Yt)Yt[e](t,!0)};le.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&L()||j()}:L,Jt=le.ajaxSettings.xhr(),le.support.cors=!!Jt&&"withCredentials"in Jt,Jt=le.support.ajax=!!Jt,Jt&&le.ajaxTransport(function(i){if(!i.crossDomain||le.support.cors){var a;return{send:function(n,o){var s,r,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(r in i.xhrFields)l[r]=i.xhrFields[r];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");try{for(r in n)l.setRequestHeader(r,n[r])}catch(c){}l.send(i.hasContent&&i.data||null),a=function(e,n){var r,c,d,u;try{if(a&&(n||4===l.readyState))if(a=t,s&&(l.onreadystatechange=le.noop,Xt&&delete Yt[s]),n)4!==l.readyState&&l.abort();else{u={},r=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{d=l.statusText}catch(h){d=""}r||!i.isLocal||i.crossDomain?1223===r&&(r=204):r=u.text?200:404}}catch(p){n||o(-1,p)}u&&o(r,d,u,c)},i.async?4===l.readyState?setTimeout(a):(s=++Kt,Xt&&(Yt||(Yt={},le(e).unload(Xt)),Yt[s]=a),l.onreadystatechange=a):a()},abort:function(){a&&a(t,!0)}}}});var Zt,Qt,ei=/^(?:toggle|show|hide)$/,ti=RegExp("^(?:([+-])=|)("+ce+")([a-z%]*)$","i"),ii=/queueHooks$/,ai=[H],ni={"*":[function(e,t){var i,a,n=this.createTween(e,t),o=ti.exec(t),s=n.cur(),r=+s||0,l=1,c=20;if(o){if(i=+o[2],a=o[3]||(le.cssNumber[e]?"":"px"),"px"!==a&&r){r=le.css(n.elem,e,!0)||i||1;do l=l||".5",r/=l,le.style(n.elem,e,r+a);while(l!==(l=n.cur()/s)&&1!==l&&--c)}n.unit=a,n.start=r,n.end=o[1]?r+(o[1]+1)*i:i}return n}]};le.Animation=le.extend(B,{tweener:function(e,t){le.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,a=0,n=e.length;n>a;a++)i=e[a],ni[i]=ni[i]||[],ni[i].unshift(t)},prefilter:function(e,t){t?ai.unshift(e):ai.push(e)}}),le.Tween=q,q.prototype={constructor:q,init:function(e,t,i,a,n,o){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=a,this.unit=o||(le.cssNumber[i]?"":"px")},cur:function(){var e=q.propHooks[this.prop];return e&&e.get?e.get(this):q.propHooks._default.get(this)},run:function(e){var t,i=q.propHooks[this.prop];return this.pos=t=this.options.duration?le.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):q.propHooks._default.set(this),this}},q.prototype.init.prototype=q.prototype,q.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=le.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){le.fx.step[e.prop]?le.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[le.cssProps[e.prop]]||le.cssHooks[e.prop])?le.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},q.propHooks.scrollTop=q.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},le.each(["toggle","show","hide"],function(e,t){var i=le.fn[t];le.fn[t]=function(e,a,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(z(t,!0),e,a,n)}}),le.fn.extend({fadeTo:function(e,t,i,a){return this.filter(x).css("opacity",0).show().end().animate({opacity:t},e,i,a)},animate:function(e,t,i,a){var n=le.isEmptyObject(e),o=le.speed(t,i,a),s=function(){var t=B(this,le.extend({},e),o);s.finish=function(){t.stop(!0)},(n||le._data(this,"finish"))&&t.stop(!0)};return s.finish=s,n||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,i,a){var n=function(e){var t=e.stop;delete e.stop,t(a)};return"string"!=typeof e&&(a=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=le.timers,s=le._data(this);if(i)s[i]&&s[i].stop&&n(s[i]);else for(i in s)s[i]&&s[i].stop&&ii.test(i)&&n(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(a),t=!1,o.splice(i,1));(t||!a)&&le.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=le._data(this),a=i[e+"queue"],n=i[e+"queueHooks"],o=le.timers,s=a?a.length:0;for(i.finish=!0,le.queue(this,e,[]),n&&n.cur&&n.cur.finish&&n.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)a[t]&&a[t].finish&&a[t].finish.call(this);delete i.finish})}}),le.each({slideDown:z("show"),slideUp:z("hide"),slideToggle:z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){le.fn[e]=function(e,i,a){return this.animate(t,e,i,a)}}),le.speed=function(e,t,i){var a=e&&"object"==typeof e?le.extend({},e):{complete:i||!i&&t||le.isFunction(e)&&e,duration:e,easing:i&&t||t&&!le.isFunction(t)&&t};return a.duration=le.fx.off?0:"number"==typeof a.duration?a.duration:a.duration in le.fx.speeds?le.fx.speeds[a.duration]:le.fx.speeds._default,(null==a.queue||a.queue===!0)&&(a.queue="fx"),a.old=a.complete,a.complete=function(){le.isFunction(a.old)&&a.old.call(this),a.queue&&le.dequeue(this,a.queue)},a},le.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},le.timers=[],le.fx=q.prototype.init,le.fx.tick=function(){var e,i=le.timers,a=0;for(Zt=le.now();i.length>a;a++)e=i[a],e()||i[a]!==e||i.splice(a--,1);i.length||le.fx.stop(),Zt=t},le.fx.timer=function(e){e()&&le.timers.push(e)&&le.fx.start()},le.fx.interval=13,le.fx.start=function(){Qt||(Qt=setInterval(le.fx.tick,le.fx.interval))},le.fx.stop=function(){clearInterval(Qt),Qt=null},le.fx.speeds={slow:600,fast:200,_default:400},le.fx.step={},le.expr&&le.expr.filters&&(le.expr.filters.animated=function(e){return le.grep(le.timers,function(t){return e===t.elem}).length}),le.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){le.offset.setOffset(this,e,t)});var i,a,n={top:0,left:0},o=this[0],s=o&&o.ownerDocument;return s?(i=s.documentElement,le.contains(i,o)?(typeof o.getBoundingClientRect!==V&&(n=o.getBoundingClientRect()),a=U(s),{top:n.top+(a.pageYOffset||i.scrollTop)-(i.clientTop||0),left:n.left+(a.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):n):void 0},le.offset={setOffset:function(e,t,i){var a=le.css(e,"position");"static"===a&&(e.style.position="relative");var n,o,s=le(e),r=s.offset(),l=le.css(e,"top"),c=le.css(e,"left"),d=("absolute"===a||"fixed"===a)&&le.inArray("auto",[l,c])>-1,u={},h={};d?(h=s.position(),n=h.top,o=h.left):(n=parseFloat(l)||0,o=parseFloat(c)||0),le.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(u.top=t.top-r.top+n),null!=t.left&&(u.left=t.left-r.left+o),"using"in t?t.using.call(e,u):s.css(u)}},le.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},a=this[0];return"fixed"===le.css(a,"position")?t=a.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),le.nodeName(e[0],"html")||(i=e.offset()),i.top+=le.css(e[0],"borderTopWidth",!0),i.left+=le.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-le.css(a,"marginTop",!0),left:t.left-i.left-le.css(a,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Y.documentElement;e&&!le.nodeName(e,"html")&&"static"===le.css(e,"position");)e=e.offsetParent;return e||Y.documentElement})}}),le.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var a=/Y/.test(i);le.fn[e]=function(n){return le.access(this,function(e,n,o){var s=U(e);return o===t?s?i in s?s[i]:s.document.documentElement[n]:e[n]:(s?s.scrollTo(a?le(s).scrollLeft():o,a?o:le(s).scrollTop()):e[n]=o,t)},e,n,arguments.length,null)}}),le.each({Height:"height",Width:"width"},function(e,i){le.each({padding:"inner"+e,content:i,"":"outer"+e},function(a,n){le.fn[n]=function(n,o){var s=arguments.length&&(a||"boolean"!=typeof n),r=a||(n===!0||o===!0?"margin":"border");return le.access(this,function(i,a,n){var o;return le.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):n===t?le.css(i,a,r):le.style(i,a,n,r)},i,s?n:t,s,null)}})}),e.jQuery=e.$=le,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return le})}(window),function(e,t,i){"function"==typeof define&&define.amd?define(["jquery"],function(a){return i(a,e,t),a.mobile}):i(e.jQuery,e,t)}(this,document,function(e,t,i,a){!function(e){e.mobile={}}(e),function(e,t){function a(t,i){var a,o,s,r=t.nodeName.toLowerCase();return"area"===r?(a=t.parentNode,o=a.name,t.href&&o&&"map"===a.nodeName.toLowerCase()?(s=e("img[usemap=#"+o+"]")[0],!!s&&n(s)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,a){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),a&&a.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(this[0].ownerDocument||i):t},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,a){return!!e.data(t,a[3])},focusable:function(t){return a(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),n=isNaN(i);return(n||i>=0)&&a(t,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,a){function n(t,i,a,n){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,a&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),n&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===a?["Left","Right"]:["Top","Bottom"],s=a.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+a]=function(i){return i===t?r["inner"+a].call(this):this.each(function(){e(this).css(s,n(this,i)+"px")})},e.fn["outer"+a]=function(t,i){return"number"!=typeof t?r["outer"+a].call(this,t):this.each(function(){e(this).css(s,n(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in i.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(a){if(a!==t)return this.css("zIndex",a);if(this.length)for(var n,o,s=e(this[0]);s.length&&s[0]!==i;){if(n=s.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(o=parseInt(s.css("zIndex"),10),!isNaN(o)&&0!==o))return o;s=s.parent()}return 0}}),e.ui.plugin={add:function(t,i,a){var n,o=e.ui[t].prototype;for(n in a)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,a[n]])},call:function(e,t,i,a){var n,o=e.plugins[t];if(o&&(a||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;n<o.length;n++)e.options[o[n][0]]&&o[n][1].apply(e.element,i)}}}(e),function(e,t,a){var n=function(t,i){var a=t.parent(),n=[],o=function(){var t=e(this),i=e.mobile.toolbar&&t.data("mobile-toolbar")?t.toolbar("option"):{position:t.attr("data-"+e.mobile.ns+"position"),updatePagePadding:t.attr("data-"+e.mobile.ns+"update-page-padding")!==!1};return!("fixed"===i.position&&i.updatePagePadding===!0)},s=a.children(":jqmData(role='header')").filter(o),r=t.children(":jqmData(role='header')"),l=a.children(":jqmData(role='footer')").filter(o),c=t.children(":jqmData(role='footer')");return 0===r.length&&s.length>0&&(n=n.concat(s.toArray())),0===c.length&&l.length>0&&(n=n.concat(l.toArray())),e.each(n,function(t,a){i-=e(a).outerHeight()}),Math.max(0,i)};e.extend(e.mobile,{window:e(t),document:e(i),keyCode:e.ui.keyCode,behaviors:{},silentScroll:function(i){"number"!==e.type(i)&&(i=e.mobile.defaultHomeScroll),e.event.special.scrollstart.enabled=!1,setTimeout(function(){t.scrollTo(0,i),e.mobile.document.trigger("silentscroll",{x:0,y:i})},20),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},getClosestBaseUrl:function(t){var i=e(t).closest(".ui-page").jqmData("url"),a=e.mobile.path.documentBase.hrefNoHash;
return e.mobile.dynamicBaseEnabled&&i&&e.mobile.path.isPath(i)||(i=a),e.mobile.path.makeUrlAbsolute(i,a)},removeActiveLinkClass:function(t){!e.mobile.activeClickedLink||e.mobile.activeClickedLink.closest("."+e.mobile.activePageClass).length&&!t||e.mobile.activeClickedLink.removeClass(e.mobile.activeBtnClass),e.mobile.activeClickedLink=null},getInheritedTheme:function(e,t){for(var i,a,n=e[0],o="",s=/ui-(bar|body|overlay)-([a-z])\b/;n&&(i=n.className||"",!(i&&(a=s.exec(i))&&(o=a[2])));)n=n.parentNode;return o||t||"a"},enhanceable:function(e){return this.haveParents(e,"enhance")},hijackable:function(e){return this.haveParents(e,"ajax")},haveParents:function(t,i){if(!e.mobile.ignoreContentEnabled)return t;var a,n,o,s,r,l=t.length,c=e();for(s=0;l>s;s++){for(n=t.eq(s),o=!1,a=t[s];a;){if(r=a.getAttribute?a.getAttribute("data-"+e.mobile.ns+i):"","false"===r){o=!0;break}a=a.parentNode}o||(c=c.add(n))}return c},getScreenHeight:function(){return t.innerHeight||e.mobile.window.height()},resetActivePageHeight:function(t){var i=e("."+e.mobile.activePageClass),a=i.height(),o=i.outerHeight(!0);t=n(i,"number"==typeof t?t:e.mobile.getScreenHeight()),i.css("min-height",""),i.height()<t&&i.css("min-height",t-(o-a))},loading:function(){var t=this.loading._widget||e(e.mobile.loader.prototype.defaultHtml).loader(),i=t.loader.apply(t,arguments);return this.loading._widget=t,i}}),e.addDependents=function(t,i){var a=e(t),n=a.jqmData("dependents")||e();a.jqmData("dependents",e(n).add(i))},e.fn.extend({removeWithDependents:function(){e.removeWithDependents(this)},enhanceWithin:function(){var t,i={},a=e.mobile.page.prototype.keepNativeSelector(),n=this;e.mobile.nojs&&e.mobile.nojs(this),e.mobile.links&&e.mobile.links(this),e.mobile.degradeInputsWithin&&e.mobile.degradeInputsWithin(this),e.fn.buttonMarkup&&this.find(e.fn.buttonMarkup.initSelector).not(a).jqmEnhanceable().buttonMarkup(),e.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(a).jqmEnhanceable().fieldcontain(),e.each(e.mobile.widgets,function(t,o){if(o.initSelector){var s=e.mobile.enhanceable(n.find(o.initSelector));s.length>0&&(s=s.not(a)),s.length>0&&(i[o.prototype.widgetName]=s)}});for(t in i)i[t][t]();return this},addDependents:function(t){e.addDependents(this,t)},getEncodedText:function(){return e("<a>").text(this.text()).html()},jqmEnhanceable:function(){return e.mobile.enhanceable(this)},jqmHijackable:function(){return e.mobile.hijackable(this)}}),e.removeWithDependents=function(t){var i=e(t);(i.jqmData("dependents")||e()).remove(),i.remove()},e.addDependents=function(t,i){var a=e(t),n=a.jqmData("dependents")||e();a.jqmData("dependents",e(n).add(i))},e.find.matches=function(t,i){return e.find(t,null,null,i)},e.find.matchesSelector=function(t,i){return e.find(i,null,null,[t]).length>0}}(e,this),function(e,t,i){e.extend(e.mobile,{version:"1.4.5",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"c",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:e(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"})}(e,this),function(e,t){var i=0,a=Array.prototype.slice,n=e.cleanData;e.cleanData=function(t){for(var i,a=0;null!=(i=t[a]);a++)try{e(i).triggerHandler("remove")}catch(o){}n(t)},e.widget=function(t,i,a){var n,o,s,r,l={},c=t.split(".")[0];return t=t.split(".")[1],n=c+"-"+t,a||(a=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[c]=e[c]||{},o=e[c][t],s=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:a.version,_proto:e.extend({},a),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(a,function(t,a){return e.isFunction(a)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=n,t=a.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(l[t]=a)}),s.prototype=e.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix||t:t},l,{constructor:s,namespace:c,widgetName:t,widgetFullName:n}),o?(e.each(o._childConstructors,function(t,i){var a=i.prototype;e.widget(a.namespace+"."+a.widgetName,s,i._proto)}),delete o._childConstructors):i._childConstructors.push(s),e.widget.bridge(t,s),s},e.widget.extend=function(i){for(var n,o,s=a.call(arguments,1),r=0,l=s.length;l>r;r++)for(n in s[r])o=s[r][n],s[r].hasOwnProperty(n)&&o!==t&&(e.isPlainObject(o)?i[n]=e.isPlainObject(i[n])?e.widget.extend({},i[n],o):e.widget.extend({},o):i[n]=o);return i},e.widget.bridge=function(i,n){var o=n.prototype.widgetFullName||i;e.fn[i]=function(s){var r="string"==typeof s,l=a.call(arguments,1),c=this;return s=!r&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,r?this.each(function(){var a,n=e.data(this,o);return"instance"===s?(c=n,!1):n?e.isFunction(n[s])&&"_"!==s.charAt(0)?(a=n[s].apply(n,l),a!==n&&a!==t?(c=a&&a.jquery?c.pushStack(a.get()):a,!1):void 0):e.error("no such method '"+s+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+s+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(s||{})._init():e.data(this,o,new n(s,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,a){a=e(a||this.defaultElement||this)[0],this.element=e(a),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),a!==this&&(e.data(a,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===a&&this.destroy()}}),this.document=e(a.style?a.ownerDocument:a.document||a),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,a){var n,o,s,r=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(r={},n=i.split("."),i=n.shift(),n.length){for(o=r[i]=e.widget.extend({},this.options[i]),s=0;s<n.length-1;s++)o[n[s]]=o[n[s]]||{},o=o[n[s]];if(i=n.pop(),a===t)return o[i]===t?null:o[i];o[i]=a}else{if(a===t)return this.options[i]===t?null:this.options[i];r[i]=a}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,a){var n,o=this;"boolean"!=typeof t&&(a=i,i=t,t=!1),a?(i=n=e(i),this.bindings=this.bindings.add(i)):(a=i,i=this.element,n=this.widget()),e.each(a,function(a,s){function r(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(r.guid=s.guid=s.guid||r.guid||e.guid++);var l=a.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,d=l[2];d?n.delegate(d,c,r):i.bind(c,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?a[e]:e).apply(a,arguments)}var a=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,a){var n,o,s=this.options[t];if(a=a||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,a),!(e.isFunction(s)&&s.apply(this.element[0],[i].concat(a))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(a,n,o){"string"==typeof n&&(n={effect:n});var s,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),s=!e.isEmptyObject(n),n.complete=o,n.delay&&a.delay(n.delay),s&&e.effects&&e.effects.effect[r]?a[t](n):r!==t&&a[r]?a[r](n.duration,n.easing,o):a.queue(function(i){e(this)[t](),o&&o.call(a[0]),i()})}})}(e),function(e,t,i){var a={},n=e.find,o=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,s=/:jqmData\(([^)]*)\)/g;e.extend(e.mobile,{ns:"",getAttribute:function(t,i){var a;t=t.jquery?t[0]:t,t&&t.getAttribute&&(a=t.getAttribute("data-"+e.mobile.ns+i));try{a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:o.test(a)?JSON.parse(a):a}catch(n){}return a},nsNormalizeDict:a,nsNormalize:function(t){return a[t]||(a[t]=e.camelCase(e.mobile.ns+t))},closestPageData:function(e){return e.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),e.fn.jqmData=function(t,a){var n;return"undefined"!=typeof t&&(t&&(t=e.mobile.nsNormalize(t)),n=arguments.length<2||a===i?this.data(t):this.data(t,a)),n},e.jqmData=function(t,i,a){var n;return"undefined"!=typeof i&&(n=e.data(t,i?e.mobile.nsNormalize(i):i,a)),n},e.fn.jqmRemoveData=function(t){return this.removeData(e.mobile.nsNormalize(t))},e.jqmRemoveData=function(t,i){return e.removeData(t,e.mobile.nsNormalize(i))},e.find=function(t,i,a,o){return t.indexOf(":jqmData")>-1&&(t=t.replace(s,"[data-"+(e.mobile.ns||"")+"$1]")),n.call(this,t,i,a,o)},e.extend(e.find,n)}(e,this),function(e,t){var i=/[A-Z]/g,a=function(e){return"-"+e.toLowerCase()};e.extend(e.Widget.prototype,{_getCreateOptions:function(){var t,n,o=this.element[0],s={};if(!e.mobile.getAttribute(o,"defaults"))for(t in this.options)n=e.mobile.getAttribute(o,t.replace(i,a)),null!=n&&(s[t]=n);return s}}),e.mobile.widget=e.Widget}(e),function(e){var t="ui-loader",i=e("html");e.widget("mobile.loader",{options:{theme:"c",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='"+t+"'><span class='ui-icon-loading'></span><h1></h1></div>",fakeFixLoader:function(){var t=e("."+e.mobile.activeBtnClass).first();this.element.css({top:e.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||t.length&&t.offset().top||100})},checkLoaderPosition:function(){var t=this.element.offset(),i=this.window.scrollTop(),a=e.mobile.getScreenHeight();(t.top<i||t.top-i>a)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),this.window.unbind("scroll",this.checkLoaderPosition).bind("scroll",e.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(e(this.defaultHtml).html())},show:function(a,n,o){var s,r,l;this.resetHtml(),"object"===e.type(a)?(l=e.extend({},this.options,a),a=l.theme):(l=this.options,a=a||l.theme),r=n||(l.text===!1?"":l.text),i.addClass("ui-loading"),s=l.textVisible,this.element.attr("class",t+" ui-corner-all ui-body-"+a+" ui-loader-"+(s||n||a.text?"verbose":"default")+(l.textonly||o?" ui-loader-textonly":"")),l.html?this.element.html(l.html):this.element.find("h1").text(r),this.element.appendTo(e(e.mobile.pagecontainer?":mobile-pagecontainer":"body")),this.checkLoaderPosition(),this.window.bind("scroll",e.proxy(this.checkLoaderPosition,this))},hide:function(){i.removeClass("ui-loading"),this.options.text&&this.element.removeClass("ui-loader-fakefix"),this.window.unbind("scroll",this.fakeFixLoader),this.window.unbind("scroll",this.checkLoaderPosition)}})}(e,this),function(e,t,a){"$:nomunge";function n(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var o,s="hashchange",r=i,l=e.event.special,c=r.documentMode,d="on"+s in t&&(c===a||c>7);e.fn[s]=function(e){return e?this.bind(s,e):this.trigger(s)},e.fn[s].delay=50,l[s]=e.extend(l[s],{setup:function(){return d?!1:void e(o.start)},teardown:function(){return d?!1:void e(o.stop)}}),o=function(){function i(){var a=n(),r=p(c);a!==c?(h(c=a,r),e(t).trigger(s)):r!==c&&(location.href=location.href.replace(/#.*/,"")+r),o=setTimeout(i,e.fn[s].delay)}var o,l={},c=n(),u=function(e){return e},h=u,p=u;return l.start=function(){o||i()},l.stop=function(){o&&clearTimeout(o),o=a},t.attachEvent&&!t.addEventListener&&!d&&function(){var t,a;l.start=function(){t||(a=e.fn[s].src,a=a&&a+n(),t=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){a||h(n()),i()}).attr("src",a||"javascript:0").insertAfter("body")[0].contentWindow,r.onpropertychange=function(){try{"title"===event.propertyName&&(t.document.title=r.title)}catch(e){}})},l.stop=u,p=function(){return n(t.location.href)},h=function(i,a){var n=t.document,o=e.fn[s].domain;i!==a&&(n.title=r.title,n.open(),o&&n.write('<script>document.domain="'+o+'"</script>'),n.close(),t.location.hash=i)}}(),l}()}(e,this),function(e,a){t.matchMedia=t.matchMedia||function(e,t){var i,a=e.documentElement,n=a.firstElementChild||a.firstChild,o=e.createElement("body"),s=e.createElement("div");return s.id="mq-test-1",s.style.cssText="position:absolute;top:-100em",o.style.background="none",o.appendChild(s),function(e){return s.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',a.insertBefore(o,n),i=42===s.offsetWidth,a.removeChild(o),{matches:i,media:e}}}(i),e.mobile.media=function(e){return t.matchMedia(e).matches}}(e),function(e,t){var a={touch:"ontouchend"in i};e.mobile.support=e.mobile.support||{},e.extend(e.support,a),e.extend(e.mobile.support,a)}(e),function(e,i){e.extend(e.support,{orientation:"orientation"in t&&"onorientationchange"in t})}(e),function(e,a){function n(e){var t,i=e.charAt(0).toUpperCase()+e.substr(1),n=(e+" "+f.join(i+" ")+i).split(" ");for(t in n)if(p[n[t]]!==a)return!0}function o(){var i=t,a=!(!i.document.createElementNS||!i.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||i.opera&&-1===navigator.userAgent.indexOf("Chrome")),n=function(t){t&&a||e("html").addClass("ui-nosvg")},o=new i.Image;o.onerror=function(){n(!1)},o.onload=function(){n(1===o.width&&1===o.height)},o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}function s(){var n,o,s,r="transform-3d",l=e.mobile.media("(-"+f.join("-"+r+"),(-")+"-"+r+"),("+r+")");if(l)return!!l;n=i.createElement("div"),o={MozTransform:"-moz-transform",transform:"transform"},h.append(n);for(s in o)n.style[s]!==a&&(n.style[s]="translate3d( 100px, 1px, 1px )",l=t.getComputedStyle(n).getPropertyValue(o[s]));return!!l&&"none"!==l}function r(){var t,i,a=location.protocol+"//"+location.host+location.pathname+"ui-dir/",n=e("head base"),o=null,s="";return n.length?s=n.attr("href"):n=o=e("<base>",{href:a}).appendTo("head"),t=e("<a href='testurl' />").prependTo(h),i=t[0].href,n[0].href=s||location.pathname,o&&o.remove(),0===i.indexOf(a)}function l(){var e,a=i.createElement("x"),n=i.documentElement,o=t.getComputedStyle;return"pointerEvents"in a.style?(a.style.pointerEvents="auto",a.style.pointerEvents="x",n.appendChild(a),e=o&&"auto"===o(a,"").pointerEvents,n.removeChild(a),!!e):!1}function c(){var e=i.createElement("div");return"undefined"!=typeof e.getBoundingClientRect}function d(){var e=t,i=navigator.userAgent,a=navigator.platform,n=i.match(/AppleWebKit\/([0-9]+)/),o=!!n&&n[1],s=i.match(/Fennec\/([0-9]+)/),r=!!s&&s[1],l=i.match(/Opera Mobi\/([0-9]+)/),c=!!l&&l[1];return(a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1||a.indexOf("iPod")>-1)&&o&&534>o||e.operamini&&"[object OperaMini]"==={}.toString.call(e.operamini)||l&&7458>c||i.indexOf("Android")>-1&&o&&533>o||r&&6>r||"palmGetResource"in t&&o&&534>o||i.indexOf("MeeGo")>-1&&i.indexOf("NokiaBrowser/8.5.0")>-1?!1:!0}var u,h=e("<body>").prependTo("html"),p=h[0].style,f=["Webkit","Moz","O"],g="palmGetResource"in t,m=t.operamini&&"[object OperaMini]"==={}.toString.call(t.operamini),v=t.blackberry&&!n("-webkit-transform");e.extend(e.mobile,{browser:{}}),e.mobile.browser.oldIE=function(){var e=3,t=i.createElement("div"),a=t.all||[];do t.innerHTML="<!--[if gt IE "+ ++e+"]><br><![endif]-->";while(a[0]);return e>4?e:!e}(),e.extend(e.support,{pushState:"pushState"in history&&"replaceState"in history&&!(t.navigator.userAgent.indexOf("Firefox")>=0&&t.top!==t)&&-1===t.navigator.userAgent.search(/CriOS/),mediaquery:e.mobile.media("only all"),cssPseudoElement:!!n("content"),touchOverflow:!!n("overflowScrolling"),cssTransform3d:s(),boxShadow:!!n("boxShadow")&&!v,fixedPosition:d(),scrollTop:("pageXOffset"in t||"scrollTop"in i.documentElement||"scrollTop"in h[0])&&!g&&!m,dynamicBaseTag:r(),cssPointerEvents:l(),boundingRect:c(),inlineSVG:o}),h.remove(),u=function(){var e=t.navigator.userAgent;return e.indexOf("Nokia")>-1&&(e.indexOf("Symbian/3")>-1||e.indexOf("Series60/5")>-1)&&e.indexOf("AppleWebKit")>-1&&e.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)}(),e.mobile.gradeA=function(){return(e.support.mediaquery&&e.support.cssPseudoElement||e.mobile.browser.oldIE&&e.mobile.browser.oldIE>=8)&&(e.support.boundingRect||null!==e.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},e.mobile.ajaxBlacklist=t.blackberry&&!t.WebKitPoint||m||u,u&&e(function(){e("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")}),e.support.boxShadow||e("html").addClass("ui-noboxshadow")}(e),function(e,t){var i,a=e.mobile.window,n=function(){};e.event.special.beforenavigate={setup:function(){a.on("navigate",n)},teardown:function(){a.off("navigate",n)}},e.event.special.navigate=i={bound:!1,pushStateEnabled:!0,originalEventName:t,isPushStateEnabled:function(){return e.support.pushState&&e.mobile.pushStateEnabled===!0&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return e.mobile.hashListeningEnabled===!0},popstate:function(t){var i=new e.Event("navigate"),n=new e.Event("beforenavigate"),o=t.originalEvent.state||{};n.originalEvent=t,a.trigger(n),n.isDefaultPrevented()||(t.historyState&&e.extend(o,t.historyState),i.originalEvent=t,setTimeout(function(){a.trigger(i,{state:o})},0))},hashchange:function(t){var i=new e.Event("navigate"),n=new e.Event("beforenavigate");n.originalEvent=t,a.trigger(n),n.isDefaultPrevented()||(i.originalEvent=t,a.trigger(i,{state:t.hashchangeState||{}}))},setup:function(){i.bound||(i.bound=!0,i.isPushStateEnabled()?(i.originalEventName="popstate",a.bind("popstate.navigate",i.popstate)):i.isHashChangeEnabled()&&(i.originalEventName="hashchange",a.bind("hashchange.navigate",i.hashchange)))}}}(e),function(e,i){var a,n,o="&ui-state=dialog";e.mobile.path=a={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=this.parseUrl(e||location.href),i=e?t:location,a=t.hash;return a="#"===a?"":a,i.protocol+t.doubleSlash+i.host+(""!==i.protocol&&"/"!==i.pathname.substring(0,1)?"/":"")+i.pathname+i.search+a},getDocumentUrl:function(t){return t?e.extend({},a.documentUrl):a.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(t){if("object"===e.type(t))return t;var i=a.urlParseRE.exec(t||"")||[];return{href:i[0]||"",hrefNoHash:i[1]||"",hrefNoSearch:i[2]||"",domain:i[3]||"",protocol:i[4]||"",doubleSlash:i[5]||"",authority:i[6]||"",username:i[8]||"",password:i[9]||"",host:i[10]||"",hostname:i[11]||"",port:i[12]||"",pathname:i[13]||"",directory:i[14]||"",filename:i[15]||"",search:i[16]||"",hash:i[17]||""}},makePathAbsolute:function(e,t){var i,a,n,o;if(e&&"/"===e.charAt(0))return e;for(e=e||"",t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"",i=t?t.split("/"):[],a=e.split("/"),n=0;n<a.length;n++)switch(o=a[n]){case".":break;case"..":i.length&&i.pop();break;default:i.push(o)}return"/"+i.join("/")},isSameDomain:function(e,t){return a.parseUrl(e).domain.toLowerCase()===a.parseUrl(t).domain.toLowerCase()},isRelativeUrl:function(e){return""===a.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==a.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!a.isRelativeUrl(e))return e;t===i&&(t=this.documentBase);var n=a.parseUrl(e),o=a.parseUrl(t),s=n.protocol||o.protocol,r=n.protocol?n.doubleSlash:n.doubleSlash||o.doubleSlash,l=n.authority||o.authority,c=""!==n.pathname,d=a.makePathAbsolute(n.pathname||o.filename,o.pathname),u=n.search||!c&&o.search||"",h=n.hash;return s+r+l+d+u+h},addSearchParams:function(t,i){var n=a.parseUrl(t),o="object"==typeof i?e.param(i):i,s=n.search||"?";return n.hrefNoSearch+s+("?"!==s.charAt(s.length-1)?"&":"")+o+(n.hash||"")},convertUrlToDataUrl:function(e){var i=e,n=a.parseUrl(e);return a.isEmbeddedPage(n)?i=n.hash.split(o)[0].replace(/^#/,"").replace(/\?.*$/,""):a.isSameDomain(n,this.documentBase)&&(i=n.hrefNoHash.replace(this.documentBase.domain,"").split(o)[0]),t.decodeURIComponent(i)},get:function(e){return e===i&&(e=a.parseLocation().hash),a.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return a.stripHash(e.replace(/\?.*$/,"").replace(o,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=a.parseUrl(e);return!(!t.protocol||t.domain.toLowerCase()===this.documentUrl.domain.toLowerCase())},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=a.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},squash:function(e,t){var i,n,o,s,r,l=this.isPath(e),c=this.parseUrl(e),d=c.hash,u="";return t||(l?t=a.getLocation():(r=a.getDocumentUrl(!0),t=a.isPath(r.hash)?a.squash(r.href):r.href)),n=l?a.stripHash(e):e,n=a.isPath(c.hash)?a.stripHash(c.hash):n,s=n.indexOf(this.uiStateKey),s>-1&&(u=n.slice(s),n=n.slice(0,s)),i=a.makeUrlAbsolute(n,t),o=this.parseUrl(i).search,l?((a.isPath(d)||0===d.replace("#","").indexOf(this.uiStateKey))&&(d=""),u&&-1===d.indexOf(this.uiStateKey)&&(d+=u),-1===d.indexOf("#")&&""!==d&&(d="#"+d),i=a.parseUrl(i),i=i.protocol+i.doubleSlash+i.host+i.pathname+o+d):i+=i.indexOf("#")>-1?u:"#"+u,i},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(e){var t="#"===e.substring(0,1);return t&&(e=e.substring(1)),(t?"#":"")+e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(e){return e&&e.split(o)[0]},isFirstPageUrl:function(t){var n=a.parseUrl(a.makeUrlAbsolute(t,this.documentBase)),o=n.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&n.hrefNoHash===this.documentBase.hrefNoHash,s=e.mobile.firstPage,r=s&&s[0]?s[0].id:i;return o&&(!n.hash||"#"===n.hash||r&&n.hash.replace(/^#/,"")===r)},isPermittedCrossDomainRequest:function(t,i){return e.mobile.allowCrossDomainPages&&("file:"===t.protocol||"content:"===t.protocol)&&-1!==i.search(/^https?:/)}},a.documentUrl=a.parseLocation(),n=e("head").find("base"),a.documentBase=n.length?a.parseUrl(a.makeUrlAbsolute(n.attr("href"),a.documentUrl.href)):a.documentUrl,a.documentBaseDiffers=a.documentUrl.hrefNoHash!==a.documentBase.hrefNoHash,a.getDocumentBase=function(t){return t?e.extend({},a.documentBase):a.documentBase.href},e.extend(e.mobile,{getDocumentUrl:a.getDocumentUrl,getDocumentBase:a.getDocumentBase})}(e),function(e,t){e.mobile.History=function(e,t){this.stack=e||[],this.activeIndex=t||0},e.extend(e.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(e,t){t=t||{},this.getNext()&&this.clearForward(),t.hash&&-1===t.hash.indexOf("#")&&(t.hash="#"+t.hash),t.url=e,this.stack.push(t),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(e,t,i){t=t||this.stack;var a,n,o,s=t.length;for(n=0;s>n;n++)if(a=t[n],(decodeURIComponent(e)===decodeURIComponent(a.url)||decodeURIComponent(e)===decodeURIComponent(a.hash))&&(o=n,i))return o;return o},closest:function(e){var i,a=this.activeIndex;return i=this.find(e,this.stack.slice(0,a)),i===t&&(i=this.find(e,this.stack.slice(a),!0),i=i===t?i:i+a),i},direct:function(i){var a=this.closest(i.url),n=this.activeIndex;a!==t&&(this.activeIndex=a,this.previousIndex=n),n>a?(i.present||i.back||e.noop)(this.getActive(),"back"):a>n?(i.present||i.forward||e.noop)(this.getActive(),"forward"):a===t&&i.missing&&i.missing(this.getActive())}})}(e),function(e,a){var n=e.mobile.path,o=location.href;e.mobile.Navigator=function(t){this.history=t,this.ignoreInitialHashChange=!0,e.mobile.window.bind({"popstate.history":e.proxy(this.popstate,this),"hashchange.history":e.proxy(this.hashchange,this)})},e.extend(e.mobile.Navigator.prototype,{squash:function(a,o){var s,r,l=n.isPath(a)?n.stripHash(a):a;return r=n.squash(a),s=e.extend({hash:l,url:r},o),t.history.replaceState(s,s.title||i.title,r),s},hash:function(e,t){var i,a,o,s;return i=n.parseUrl(e),a=n.parseLocation(),a.pathname+a.search===i.pathname+i.search?o=i.hash?i.hash:i.pathname+i.search:n.isPath(e)?(s=n.parseUrl(t),o=s.pathname+s.search+(n.isPreservableHash(s.hash)?s.hash.replace("#",""):"")):o=e,o},go:function(a,o,s){var r,l,c,d,u=e.event.special.navigate.isPushStateEnabled();l=n.squash(a),c=this.hash(a,l),s&&c!==n.stripHash(n.parseLocation().hash)&&(this.preventNextHashChange=s),this.preventHashAssignPopState=!0,t.location.hash=c,this.preventHashAssignPopState=!1,r=e.extend({url:l,hash:c,title:i.title},o),u&&(d=new e.Event("popstate"),d.originalEvent={type:"popstate",state:null},this.squash(a,r),s||(this.ignorePopState=!0,e.mobile.window.trigger(d))),this.history.add(r.url,r)},popstate:function(t){var i,a;if(e.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,void t.stopImmediatePropagation()):this.ignorePopState?void(this.ignorePopState=!1):!t.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===o)?void t.preventDefault():(i=n.parseLocation().hash,!t.originalEvent.state&&i?(a=this.squash(i),this.history.add(a.url,a),void(t.historyState=a)):void this.history.direct({url:(t.originalEvent.state||{}).url||i,present:function(i,a){t.historyState=e.extend({},i),t.historyState.direction=a}}))},hashchange:function(t){var a,o;if(e.event.special.navigate.isHashChangeEnabled()&&!e.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,void t.stopImmediatePropagation();a=this.history,o=n.parseLocation().hash,this.history.direct({url:o,present:function(i,a){t.hashchangeState=e.extend({},i),t.hashchangeState.direction=a},missing:function(){a.add(o,{hash:o,title:i.title})}})}}})}(e),function(e,t){e.mobile.navigate=function(t,i,a){e.mobile.navigate.navigator.go(t,i,a)},e.mobile.navigate.history=new e.mobile.History,e.mobile.navigate.navigator=new e.mobile.Navigator(e.mobile.navigate.history);var i=e.mobile.path.parseLocation();e.mobile.navigate.history.add(i.href,{hash:i.hash})}(e),function(e,t){var a={animation:{},transition:{}},n=i.createElement("a"),o=["","webkit-","moz-","o-"];e.each(["animation","transition"],function(i,s){var r=0===i?s+"-name":s;e.each(o,function(i,o){return n.style[e.camelCase(o+r)]!==t?(a[s].prefix=o,!1):void 0}),a[s].duration=e.camelCase(a[s].prefix+s+"-duration"),a[s].event=e.camelCase(a[s].prefix+s+"-end"),""===a[s].prefix&&(a[s].event=a[s].event.toLowerCase())}),e.support.cssTransitions=a.transition.prefix!==t,e.support.cssAnimations=a.animation.prefix!==t,e(n).remove(),e.fn.animationComplete=function(n,o,s){var r,l,c=this,d=function(){clearTimeout(r),n.apply(this,arguments)},u=o&&"animation"!==o?"transition":"animation";return e.support.cssTransitions&&"transition"===u||e.support.cssAnimations&&"animation"===u?(s===t&&(e(this).context!==i&&(l=3e3*parseFloat(e(this).css(a[u].duration))),(0===l||l===t||isNaN(l))&&(l=e.fn.animationComplete.defaultDuration)),r=setTimeout(function(){e(c).off(a[u].event,d),n.apply(c)},l),e(this).one(a[u].event,d)):(setTimeout(e.proxy(n,this),0),e(this))},e.fn.animationComplete.defaultDuration=1e3}(e),function(e,t,i,a){function n(e){for(;e&&"undefined"!=typeof e.originalEvent;)e=e.originalEvent;return e}function o(t,i){var o,s,r,l,c,d,u,h,p,f=t.type;if(t=e.Event(t),t.type=i,o=t.originalEvent,s=e.event.props,f.search(/^(mouse|click)/)>-1&&(s=D),o)for(u=s.length,l;u;)l=s[--u],t[l]=o[l];if(f.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==f.search(/^touch/)&&(r=n(o),f=r.touches,c=r.changedTouches,d=f&&f.length?f[0]:c&&c.length?c[0]:a))for(h=0,p=E.length;p>h;h++)l=E[h],t[l]=d[l];return t}function s(t){for(var i,a,n={};t;){i=e.data(t,C);for(a in i)i[a]&&(n[a]=n.hasVirtualBinding=!0);t=t.parentNode}return n}function r(t,i){for(var a;t;){if(a=e.data(t,C),a&&(!i||a[i]))return t;t=t.parentNode}return null}function l(){R=!1}function c(){R=!0}function d(){q=0,j.length=0,I=!1,c()}function u(){l()}function h(){p(),M=setTimeout(function(){M=0,d()},e.vmouse.resetTimerDuration)}function p(){M&&(clearTimeout(M),M=0)}function f(t,i,a){var n;return(a&&a[t]||!a&&r(i.target,t))&&(n=o(i,t),e(i.target).trigger(n)),n}function g(t){var i,a=e.data(t.target,S);I||q&&q===a||(i=f("v"+t.type,t),i&&(i.isDefaultPrevented()&&t.preventDefault(),i.isPropagationStopped()&&t.stopPropagation(),i.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function m(t){var i,a,o,r=n(t).touches;r&&1===r.length&&(i=t.target,a=s(i),a.hasVirtualBinding&&(q=H++,e.data(i,S,q),p(),u(),L=!1,o=n(t).touches[0],P=o.pageX,N=o.pageY,f("vmouseover",t,a),f("vmousedown",t,a)))}function v(e){R||(L||f("vmousecancel",e,s(e.target)),L=!0,h())}function b(t){if(!R){var i=n(t).touches[0],a=L,o=e.vmouse.moveDistanceThreshold,r=s(t.target);L=L||Math.abs(i.pageX-P)>o||Math.abs(i.pageY-N)>o,L&&!a&&f("vmousecancel",t,r),f("vmousemove",t,r),h()}}function w(e){if(!R){c();var t,i,a=s(e.target);f("vmouseup",e,a),L||(t=f("vclick",e,a),t&&t.isDefaultPrevented()&&(i=n(e).changedTouches[0],j.push({touchID:q,x:i.clientX,y:i.clientY}),I=!0)),f("vmouseout",e,a),L=!1,h()}}function _(t){var i,a=e.data(t,C);if(a)for(i in a)if(a[i])return!0;return!1}function y(){}function x(t){var i=t.substr(1);return{setup:function(){_(this)||e.data(this,C,{});var a=e.data(this,C);a[t]=!0,A[t]=(A[t]||0)+1,1===A[t]&&F.bind(i,g),e(this).bind(i,y),B&&(A.touchstart=(A.touchstart||0)+1,1===A.touchstart&&F.bind("touchstart",m).bind("touchend",w).bind("touchmove",b).bind("scroll",v));
},teardown:function(){--A[t],A[t]||F.unbind(i,g),B&&(--A.touchstart,A.touchstart||F.unbind("touchstart",m).unbind("touchmove",b).unbind("touchend",w).unbind("scroll",v));var a=e(this),n=e.data(this,C);n&&(n[t]=!1),a.unbind(i,y),_(this)||a.removeData(C)}}}var k,$,C="virtualMouseBindings",S="virtualTouchID",T="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),E="clientX clientY pageX pageY screenX screenY".split(" "),O=e.event.mouseHooks?e.event.mouseHooks.props:[],D=e.event.props.concat(O),A={},M=0,P=0,N=0,L=!1,j=[],I=!1,R=!1,B="addEventListener"in i,F=e(i),H=1,q=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},$=0;$<T.length;$++)e.event.special[T[$]]=x(T[$]);B&&i.addEventListener("click",function(t){var i,a,n,o,s,r,l=j.length,c=t.target;if(l)for(i=t.clientX,a=t.clientY,k=e.vmouse.clickDistanceThreshold,n=c;n;){for(o=0;l>o;o++)if(s=j[o],r=0,n===c&&Math.abs(s.x-i)<k&&Math.abs(s.y-a)<k||e.data(n,S)===s.touchID)return t.preventDefault(),void t.stopPropagation();n=n.parentNode}},!0)}(e,t,i),function(e,t,a){function n(t,i,n,o){var s=n.type;n.type=i,o?e.event.trigger(n,a,t):e.event.dispatch.call(t,n),n.type=s}var o=e(i),s=e.mobile.support.touch,r="touchmove scroll",l=s?"touchstart":"mousedown",c=s?"touchend":"mouseup",d=s?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,i){e.fn[i]=function(e){return e?this.bind(i,e):this.trigger(i)},e.attrFn&&(e.attrFn[i]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){i=t,n(o,i?"scrollstart":"scrollstop",e)}var i,a,o=this,s=e(o);s.bind(r,function(n){e.event.special.scrollstart.enabled&&(i||t(n,!0),clearTimeout(a),a=setTimeout(function(){t(n,!1)},50))})},teardown:function(){e(this).unbind(r)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,i=e(t),a=!1;i.bind("vmousedown",function(s){function r(){clearTimeout(d)}function l(){r(),i.unbind("vclick",c).unbind("vmouseup",r),o.unbind("vmousecancel",l)}function c(e){l(),a||u!==e.target?a&&e.preventDefault():n(t,"tap",e)}if(a=!1,s.which&&1!==s.which)return!1;var d,u=s.target;i.bind("vmouseup",r).bind("vclick",c),o.bind("vmousecancel",l),d=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(a=!0),n(t,"taphold",e.Event("taphold",{target:u}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),o.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(e){var i=t.pageXOffset,a=t.pageYOffset,n=e.clientX,o=e.clientY;return 0===e.pageY&&Math.floor(o)>Math.floor(e.pageY)||0===e.pageX&&Math.floor(n)>Math.floor(e.pageX)?(n-=i,o-=a):(o<e.pageY-a||n<e.pageX-i)&&(n=e.pageX-i,o=e.pageY-a),{x:n,y:o}},start:function(t){var i=t.originalEvent.touches?t.originalEvent.touches[0]:t,a=e.event.special.swipe.getLocation(i);return{time:(new Date).getTime(),coords:[a.x,a.y],origin:e(t.target)}},stop:function(t){var i=t.originalEvent.touches?t.originalEvent.touches[0]:t,a=e.event.special.swipe.getLocation(i);return{time:(new Date).getTime(),coords:[a.x,a.y]}},handleSwipe:function(t,i,a,o){if(i.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-i.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-i.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var s=t.coords[0]>i.coords[0]?"swipeleft":"swiperight";return n(a,"swipe",e.Event("swipe",{target:o,swipestart:t,swipestop:i}),!0),n(a,s,e.Event(s,{target:o,swipestart:t,swipestop:i}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,i=this,a=e(i),n={};t=e.data(this,"mobile-events"),t||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=n,n.start=function(t){if(!e.event.special.swipe.eventInProgress){e.event.special.swipe.eventInProgress=!0;var a,s=e.event.special.swipe.start(t),r=t.target,l=!1;n.move=function(t){s&&!t.isDefaultPrevented()&&(a=e.event.special.swipe.stop(t),l||(l=e.event.special.swipe.handleSwipe(s,a,i,r),l&&(e.event.special.swipe.eventInProgress=!1)),Math.abs(s.coords[0]-a.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())},n.stop=function(){l=!0,e.event.special.swipe.eventInProgress=!1,o.off(d,n.move),n.move=null},o.on(d,n.move).one(c,n.stop)}},a.on(l,n.start)},teardown:function(){var t,i;t=e.data(this,"mobile-events"),t&&(i=t.swipe,delete t.swipe,t.length--,0===t.length&&e.removeData(this,"mobile-events")),i&&(i.start&&e(this).off(l,i.start),i.move&&o.off(d,i.move),i.stop&&o.off(c,i.stop))}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,i){e.event.special[t]={setup:function(){e(this).bind(i,e.noop)},teardown:function(){e(this).unbind(i)}}})}(e,this),function(e){e.event.special.throttledresize={setup:function(){e(this).bind("resize",o)},teardown:function(){e(this).unbind("resize",o)}};var t,i,a,n=250,o=function(){i=(new Date).getTime(),a=i-s,a>=n?(s=i,e(this).trigger("throttledresize")):(t&&clearTimeout(t),t=setTimeout(o,n-a))},s=0}(e),function(e,t){function a(){var e=n();e!==o&&(o=e,u.trigger(h))}var n,o,s,r,l,c,d,u=e(t),h="orientationchange",p={0:!0,180:!0};e.support.orientation&&(l=t.innerWidth||u.width(),c=t.innerHeight||u.height(),d=50,s=l>c&&l-c>d,r=p[t.orientation],(s&&r||!s&&!r)&&(p={"-90":!0,90:!0})),e.event.special.orientationchange=e.extend({},e.event.special.orientationchange,{setup:function(){return e.support.orientation&&!e.event.special.orientationchange.disabled?!1:(o=n(),void u.bind("throttledresize",a))},teardown:function(){return e.support.orientation&&!e.event.special.orientationchange.disabled?!1:void u.unbind("throttledresize",a)},add:function(e){var t=e.handler;e.handler=function(e){return e.orientation=n(),t.apply(this,arguments)}}}),e.event.special.orientationchange.orientation=n=function(){var a=!0,n=i.documentElement;return a=e.support.orientation?p[t.orientation]:n&&n.clientWidth/n.clientHeight<1.1,a?"portrait":"landscape"},e.fn[h]=function(e){return e?this.bind(h,e):this.trigger(h)},e.attrFn&&(e.attrFn[h]=!0)}(e,this),function(e,t){var i=e("head").children("base"),a={element:i.length?i:e("<base>",{href:e.mobile.path.documentBase.hrefNoHash}).prependTo(e("head")),linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",set:function(t){e.mobile.dynamicBaseEnabled&&e.support.dynamicBaseTag&&a.element.attr("href",e.mobile.path.makeUrlAbsolute(t,e.mobile.path.documentBase))},rewrite:function(t,i){var n=e.mobile.path.get(t);i.find(a.linkSelector).each(function(t,i){var a=e(i).is("[href]")?"href":e(i).is("[src]")?"src":"action",o=e.mobile.path.parseLocation(),s=e(i).attr(a);s=s.replace(o.protocol+o.doubleSlash+o.host+o.pathname,""),/^(\w+:|#|\/)/.test(s)||e(i).attr(a,n+s)})},reset:function(){a.element.attr("href",e.mobile.path.documentBase.hrefNoSearch)}};e.mobile.base=a}(e),function(e,t){e.mobile.widgets={};var i=e.widget,a=e.mobile.keepNative;e.widget=function(i){return function(){var a=i.apply(this,arguments),n=a.prototype.widgetName;return a.initSelector=a.prototype.initSelector!==t?a.prototype.initSelector:":jqmData(role='"+n+"')",e.mobile.widgets[n]=a,a}}(e.widget),e.extend(e.widget,i),e.mobile.document.on("create",function(t){e(t.target).enhanceWithin()}),e.widget("mobile.page",{options:{theme:"c",domCache:!1,keepNativeDefault:e.mobile.keepNative,contentTheme:null,enhanced:!1},_createWidget:function(){e.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_create:function(){return this._trigger("beforecreate")===!1?!1:(this.options.enhanced||this._enhance(),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),this.element.enhanceWithin(),void("dialog"===e.mobile.getAttribute(this.element[0],"role")&&e.mobile.dialog&&this.element.dialog()))},_enhance:function(){var i="data-"+e.mobile.ns,a=this;this.options.role&&this.element.attr("data-"+e.mobile.ns+"role",this.options.role),this.element.attr("tabindex","0").addClass("ui-page ui-page-theme-"+this.options.theme),this.element.find("["+i+"role='content']").each(function(){var n=e(this),o=this.getAttribute(i+"theme")||t;a.options.contentTheme=o||a.options.contentTheme||a.options.dialog&&a.options.theme||"dialog"===a.element.jqmData("role")&&a.options.theme,n.addClass("ui-content"),a.options.contentTheme&&n.addClass("ui-body-"+a.options.contentTheme),n.attr("role","main").addClass("ui-content")})},bindRemove:function(t){var i=this.element;!i.data("mobile-page").options.domCache&&i.is(":jqmData(external-page='true')")&&i.bind("pagehide.remove",t||function(t,i){if(!i.samePage){var a=e(this),n=new e.Event("pageremove");a.trigger(n),n.isDefaultPrevented()||a.removeWithDependents()}})},_setOptions:function(i){i.theme!==t&&this.element.removeClass("ui-page-theme-"+this.options.theme).addClass("ui-page-theme-"+i.theme),i.contentTheme!==t&&this.element.find("[data-"+e.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme).addClass("ui-body-"+i.contentTheme)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){this.element.closest(":mobile-pagecontainer").pagecontainer({theme:"none"})},setContainerBackground:function(e){this.element.parent().pagecontainer({theme:e||this.options.theme})},keepNativeSelector:function(){var t=this.options,i=e.trim(t.keepNative||""),n=e.trim(e.mobile.keepNative),o=e.trim(t.keepNativeDefault),s=a===n?"":n,r=""===s?o:"";return(i?[i]:[]).concat(s?[s]:[]).concat(r?[r]:[]).join(", ")}})}(e),function(e,a){e.widget("mobile.pagecontainer",{options:{theme:"c"},initSelector:!1,_create:function(){this._trigger("beforecreate"),this.setLastScrollEnabled=!0,this._on(this.window,{navigate:"_disableRecordScroll",scrollstop:"_delayedRecordScroll"}),this._on(this.window,{navigate:"_filterNavigateEvents"}),this._on({pagechange:"_afterContentChange"}),this.window.one("navigate",e.proxy(function(){this.setLastScrollEnabled=!0},this))},_setOptions:function(e){e.theme!==a&&"none"!==e.theme?this.element.removeClass("ui-overlay-"+this.options.theme).addClass("ui-overlay-"+e.theme):e.theme!==a&&this.element.removeClass("ui-overlay-"+this.options.theme),this._super(e)},_disableRecordScroll:function(){this.setLastScrollEnabled=!1},_enableRecordScroll:function(){this.setLastScrollEnabled=!0},_afterContentChange:function(){this.setLastScrollEnabled=!0,this._off(this.window,"scrollstop"),this._on(this.window,{scrollstop:"_delayedRecordScroll"})},_recordScroll:function(){if(this.setLastScrollEnabled){var e,t,i,a=this._getActiveHistory();a&&(e=this._getScroll(),t=this._getMinScroll(),i=this._getDefaultScroll(),a.lastScroll=t>e?i:e)}},_delayedRecordScroll:function(){setTimeout(e.proxy(this,"_recordScroll"),100)},_getScroll:function(){return this.window.scrollTop()},_getMinScroll:function(){return e.mobile.minScrollBack},_getDefaultScroll:function(){return e.mobile.defaultHomeScroll},_filterNavigateEvents:function(t,i){var a;t.originalEvent&&t.originalEvent.isDefaultPrevented()||(a=t.originalEvent.type.indexOf("hashchange")>-1?i.state.hash:i.state.url,a||(a=this._getHash()),a&&"#"!==a&&0!==a.indexOf("#"+e.mobile.path.uiStateKey)||(a=location.href),this._handleNavigate(a,i.state))},_getHash:function(){return e.mobile.path.parseLocation().hash},getActivePage:function(){return this.activePage},_getInitialContent:function(){return e.mobile.firstPage},_getHistory:function(){return e.mobile.navigate.history},_getActiveHistory:function(){return this._getHistory().getActive()},_getDocumentBase:function(){return e.mobile.path.documentBase},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(i){if(e.mobile.hashListeningEnabled)t.history.go(i);else{var a=e.mobile.navigate.history.activeIndex,n=a+parseInt(i,10),o=e.mobile.navigate.history.stack[n].url,s=i>=1?"forward":"back";e.mobile.navigate.history.activeIndex=n,e.mobile.navigate.history.previousIndex=a,this.change(o,{direction:s,changeHash:!1,fromHashChange:!0})}},_handleDestination:function(t){var i;return"string"===e.type(t)&&(t=e.mobile.path.stripHash(t)),t&&(i=this._getHistory(),t=e.mobile.path.isPath(t)?t:e.mobile.path.makeUrlAbsolute("#"+t,this._getDocumentBase())),t||this._getInitialContent()},_transitionFromHistory:function(e,t){var i=this._getHistory(),a="back"===e?i.getLast():i.getActive();return a&&a.transition||t},_handleDialog:function(t,i){var a,n,o=this.getActivePage();return o&&!o.data("mobile-dialog")?("back"===i.direction?this.back():this.forward(),!1):(a=i.pageUrl,n=this._getActiveHistory(),e.extend(t,{role:n.role,transition:this._transitionFromHistory(i.direction,t.transition),reverse:"back"===i.direction}),a)},_handleNavigate:function(t,i){var a=e.mobile.path.stripHash(t),n=this._getHistory(),o=0===n.stack.length?"none":this._transitionFromHistory(i.direction),s={changeHash:!1,fromHashChange:!0,reverse:"back"===i.direction};e.extend(s,i,{transition:o}),n.activeIndex>0&&a.indexOf(e.mobile.dialogHashKey)>-1&&(a=this._handleDialog(s,i),a===!1)||this._changeContent(this._handleDestination(a),s)},_changeContent:function(t,i){e.mobile.changePage(t,i)},_getBase:function(){return e.mobile.base},_getNs:function(){return e.mobile.ns},_enhance:function(e,t){return e.page({role:t})},_include:function(e,t){e.appendTo(this.element),this._enhance(e,t.role),e.page("bindRemove")},_find:function(t){var i,a=this._createFileUrl(t),n=this._createDataUrl(t),o=this._getInitialContent();return i=this.element.children("[data-"+this._getNs()+"url='"+e.mobile.path.hashToSelector(n)+"']"),0===i.length&&n&&!e.mobile.path.isPath(n)&&(i=this.element.children(e.mobile.path.hashToSelector("#"+n)).attr("data-"+this._getNs()+"url",n).jqmData("url",n)),0===i.length&&e.mobile.path.isFirstPageUrl(a)&&o&&o.parent().length&&(i=e(o)),i},_getLoader:function(){return e.mobile.loading()},_showLoading:function(t,i,a,n){this._loadMsg||(this._loadMsg=setTimeout(e.proxy(function(){this._getLoader().loader("show",i,a,n),this._loadMsg=0},this),t))},_hideLoading:function(){clearTimeout(this._loadMsg),this._loadMsg=0,this._getLoader().loader("hide")},_showError:function(){this._hideLoading(),this._showLoading(0,e.mobile.pageLoadErrorMessageTheme,e.mobile.pageLoadErrorMessage,!0),setTimeout(e.proxy(this,"_hideLoading"),1500)},_parse:function(t,i){var a,n=e("<div></div>");return n.get(0).innerHTML=t,a=n.find(":jqmData(role='page'), :jqmData(role='dialog')").first(),a.length||(a=e("<div data-"+this._getNs()+"role='page'>"+(t.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),a.attr("data-"+this._getNs()+"url",this._createDataUrl(i)).attr("data-"+this._getNs()+"external-page",!0),a},_setLoadedTitle:function(t,i){var a=i.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;a&&!t.jqmData("title")&&(a=e("<div>"+a+"</div>").text(),t.jqmData("title",a))},_isRewritableBaseTag:function(){return e.mobile.dynamicBaseEnabled&&!e.support.dynamicBaseTag},_createDataUrl:function(t){return e.mobile.path.convertUrlToDataUrl(t)},_createFileUrl:function(t){return e.mobile.path.getFilePath(t)},_triggerWithDeprecated:function(t,i,a){var n=e.Event("page"+t),o=e.Event(this.widgetName+t);return(a||this.element).trigger(n,i),this._trigger(t,o,i),{deprecatedEvent:n,event:o}},_loadSuccess:function(t,i,n,o){var s=this._createFileUrl(t);return e.proxy(function(r,l,c){var d,u=new RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),h=new RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");u.test(r)&&RegExp.$1&&h.test(RegExp.$1)&&RegExp.$1&&(s=e.mobile.path.getFilePath(e("<div>"+RegExp.$1+"</div>").text()),s=this.window[0].encodeURIComponent(s)),n.prefetch===a&&this._getBase().set(s),d=this._parse(r,s),this._setLoadedTitle(d,r),i.xhr=c,i.textStatus=l,i.page=d,i.content=d,i.toPage=d,this._triggerWithDeprecated("load",i).event.isDefaultPrevented()||(this._isRewritableBaseTag()&&d&&this._getBase().rewrite(s,d),this._include(d,n),n.showLoadMsg&&this._hideLoading(),o.resolve(t,n,d))},this)},_loadDefaults:{type:"get",data:a,reloadPage:!1,reload:!1,role:a,showLoadMsg:!1,loadMsgDelay:50},load:function(t,i){var n,o,s,r,l=i&&i.deferred||e.Deferred(),c=i&&i.reload===a&&i.reloadPage!==a?{reload:i.reloadPage}:{},d=e.extend({},this._loadDefaults,i,c),u=null,h=e.mobile.path.makeUrlAbsolute(t,this._findBaseWithDefault());return d.data&&"get"===d.type&&(h=e.mobile.path.addSearchParams(h,d.data),d.data=a),d.data&&"post"===d.type&&(d.reload=!0),n=this._createFileUrl(h),o=this._createDataUrl(h),u=this._find(h),0===u.length&&e.mobile.path.isEmbeddedPage(n)&&!e.mobile.path.isFirstPageUrl(n)?(l.reject(h,d),l.promise()):(this._getBase().reset(),u.length&&!d.reload?(this._enhance(u,d.role),l.resolve(h,d,u),d.prefetch||this._getBase().set(t),l.promise()):(r={url:t,absUrl:h,toPage:t,prevPage:i?i.fromPage:a,dataUrl:o,deferred:l,options:d},s=this._triggerWithDeprecated("beforeload",r),s.deprecatedEvent.isDefaultPrevented()||s.event.isDefaultPrevented()?l.promise():(d.showLoadMsg&&this._showLoading(d.loadMsgDelay),d.prefetch===a&&this._getBase().reset(),e.mobile.allowCrossDomainPages||e.mobile.path.isSameDomain(e.mobile.path.documentUrl,h)?(e.ajax({url:n,type:d.type,data:d.data,contentType:d.contentType,dataType:"html",success:this._loadSuccess(h,r,d,l),error:this._loadError(h,r,d,l)}),l.promise()):(l.reject(h,d),l.promise()))))},_loadError:function(t,i,a,n){return e.proxy(function(o,s,r){this._getBase().set(e.mobile.path.get()),i.xhr=o,i.textStatus=s,i.errorThrown=r;var l=this._triggerWithDeprecated("loadfailed",i);l.deprecatedEvent.isDefaultPrevented()||l.event.isDefaultPrevented()||(a.showLoadMsg&&this._showError(),n.reject(t,a))},this)},_getTransitionHandler:function(t){return t=e.mobile._maybeDegradeTransition(t),e.mobile.transitionHandlers[t]||e.mobile.defaultTransitionHandler},_triggerCssTransitionEvents:function(t,i,a){var n=!1;a=a||"",i&&(t[0]===i[0]&&(n=!0),this._triggerWithDeprecated(a+"hide",{nextPage:t,toPage:t,prevPage:i,samePage:n},i)),this._triggerWithDeprecated(a+"show",{prevPage:i||e(""),toPage:t},t)},_cssTransition:function(t,i,a){var n,o,s=a.transition,r=a.reverse,l=a.deferred;this._triggerCssTransitionEvents(t,i,"before"),this._hideLoading(),n=this._getTransitionHandler(s),o=new n(s,r,t,i).transition(),o.done(e.proxy(function(){this._triggerCssTransitionEvents(t,i)},this)),o.done(function(){l.resolve.apply(l,arguments)})},_releaseTransitionLock:function(){o=!1,n.length>0&&e.mobile.changePage.apply(null,n.pop())},_removeActiveLinkClass:function(t){e.mobile.removeActiveLinkClass(t)},_loadUrl:function(t,i,a){a.target=t,a.deferred=e.Deferred(),this.load(t,a),a.deferred.done(e.proxy(function(e,t,a){o=!1,t.absUrl=i.absUrl,this.transition(a,i,t)},this)),a.deferred.fail(e.proxy(function(){this._removeActiveLinkClass(!0),this._releaseTransitionLock(),this._triggerWithDeprecated("changefailed",i)},this))},_triggerPageBeforeChange:function(t,i,a){var n;return i.prevPage=this.activePage,e.extend(i,{toPage:t,options:a}),"string"===e.type(t)?i.absUrl=e.mobile.path.makeUrlAbsolute(t,this._findBaseWithDefault()):i.absUrl=a.absUrl,n=this._triggerWithDeprecated("beforechange",i),n.event.isDefaultPrevented()||n.deprecatedEvent.isDefaultPrevented()?!1:!0},change:function(t,i){if(o)return void n.unshift(arguments);var a=e.extend({},e.mobile.changePage.defaults,i),s={};a.fromPage=a.fromPage||this.activePage,this._triggerPageBeforeChange(t,s,a)&&(t=s.toPage,"string"===e.type(t)?(o=!0,this._loadUrl(t,s,a)):this.transition(t,s,a))},transition:function(t,s,r){var l,c,d,u,h,p,f,g,m,v,b,w,_,y;if(o)return void n.unshift([t,r]);if(this._triggerPageBeforeChange(t,s,r)&&(s.prevPage=r.fromPage,y=this._triggerWithDeprecated("beforetransition",s),!y.deprecatedEvent.isDefaultPrevented()&&!y.event.isDefaultPrevented())){if(o=!0,t[0]!==e.mobile.firstPage[0]||r.dataUrl||(r.dataUrl=e.mobile.path.documentUrl.hrefNoHash),l=r.fromPage,c=r.dataUrl&&e.mobile.path.convertUrlToDataUrl(r.dataUrl)||t.jqmData("url"),d=c,u=e.mobile.path.getFilePath(c),h=e.mobile.navigate.history.getActive(),p=0===e.mobile.navigate.history.activeIndex,f=0,g=i.title,m=("dialog"===r.role||"dialog"===t.jqmData("role"))&&t.jqmData("dialog")!==!0,l&&l[0]===t[0]&&!r.allowSamePageTransition)return o=!1,this._triggerWithDeprecated("transition",s),this._triggerWithDeprecated("change",s),void(r.fromHashChange&&e.mobile.navigate.history.direct({url:c}));t.page({role:r.role}),r.fromHashChange&&(f="back"===r.direction?-1:1);try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()?e(i.activeElement).blur():e("input:focus, textarea:focus, select:focus").blur()}catch(x){}v=!1,m&&h&&(h.url&&h.url.indexOf(e.mobile.dialogHashKey)>-1&&this.activePage&&!this.activePage.hasClass("ui-dialog")&&e.mobile.navigate.history.activeIndex>0&&(r.changeHash=!1,v=!0),c=h.url||"",c+=!v&&c.indexOf("#")>-1?e.mobile.dialogHashKey:"#"+e.mobile.dialogHashKey),b=h?t.jqmData("title")||t.children(":jqmData(role='header')").find(".ui-title").text():g,b&&g===i.title&&(g=b),t.jqmData("title")||t.jqmData("title",g),r.transition=r.transition||(f&&!p?h.transition:a)||(m?e.mobile.defaultDialogTransition:e.mobile.defaultPageTransition),!f&&v&&(e.mobile.navigate.history.getActive().pageUrl=d),c&&!r.fromHashChange&&(!e.mobile.path.isPath(c)&&c.indexOf("#")<0&&(c="#"+c),w={transition:r.transition,title:g,pageUrl:d,role:r.role},r.changeHash!==!1&&e.mobile.hashListeningEnabled?e.mobile.navigate(this.window[0].encodeURI(c),w,!0):t[0]!==e.mobile.firstPage[0]&&e.mobile.navigate.history.add(c,w)),e.mobile.activePage=t,this.activePage=t,r.reverse=r.reverse||0>f,_=e.Deferred(),this._cssTransition(t,l,{transition:r.transition,reverse:r.reverse,deferred:_}),_.done(e.proxy(function(i,a,n,o,l){e.mobile.removeActiveLinkClass(),r.duplicateCachedPage&&r.duplicateCachedPage.remove(),l||e.mobile.focusPage(t),this._releaseTransitionLock(),this._triggerWithDeprecated("transition",s),this._triggerWithDeprecated("change",s)},this))}},_findBaseWithDefault:function(){var t=this.activePage&&e.mobile.getClosestBaseUrl(this.activePage);return t||e.mobile.path.documentBase.hrefNoHash}}),e.mobile.navreadyDeferred=e.Deferred();var n=[],o=!1}(e),function(e,a){function n(e){for(;e&&("string"!=typeof e.nodeName||"a"!==e.nodeName.toLowerCase());)e=e.parentNode;return e}var o=e.Deferred(),s=e.Deferred(),r=function(){s.resolve(),s=null},l=e.mobile.path.documentUrl,c=null;e.mobile.loadPage=function(t,i){var a;return i=i||{},a=i.pageContainer||e.mobile.pageContainer,i.deferred=e.Deferred(),a.pagecontainer("load",t,i),i.deferred.promise()},e.mobile.back=function(){var i=t.navigator;this.phonegapNavigationEnabled&&i&&i.app&&i.app.backHistory?i.app.backHistory():e.mobile.pageContainer.pagecontainer("back")},e.mobile.focusPage=function(e){var t=e.find("[autofocus]"),i=e.find(".ui-title:eq(0)");return t.length?void t.focus():void(i.length?i.focus():e.focus())},e.mobile._maybeDegradeTransition=e.mobile._maybeDegradeTransition||function(e){return e},e.mobile.changePage=function(t,i){e.mobile.pageContainer.pagecontainer("change",t,i)},e.mobile.changePage.defaults={transition:a,reverse:!1,changeHash:!0,fromHashChange:!1,role:a,duplicateCachedPage:a,pageContainer:a,showLoadMsg:!0,dataUrl:a,fromPage:a,allowSamePageTransition:!1},e.mobile._registerInternalEvents=function(){var i=function(t,i){var a,n,o,s,r=!0;return!e.mobile.ajaxEnabled||t.is(":jqmData(ajax='false')")||!t.jqmHijackable().length||t.attr("target")?!1:(a=c&&c.attr("formaction")||t.attr("action"),s=(t.attr("method")||"get").toLowerCase(),a||(a=e.mobile.getClosestBaseUrl(t),"get"===s&&(a=e.mobile.path.parseUrl(a).hrefNoSearch),a===e.mobile.path.documentBase.hrefNoHash&&(a=l.hrefNoSearch)),a=e.mobile.path.makeUrlAbsolute(a,e.mobile.getClosestBaseUrl(t)),e.mobile.path.isExternal(a)&&!e.mobile.path.isPermittedCrossDomainRequest(l,a)?!1:(i||(n=t.serializeArray(),c&&c[0].form===t[0]&&(o=c.attr("name"),o&&(e.each(n,function(e,t){return t.name===o?(o="",!1):void 0}),o&&n.push({name:o,value:c.attr("value")}))),r={url:a,options:{type:s,data:e.param(n),transition:t.jqmData("transition"),reverse:"reverse"===t.jqmData("direction"),reloadPage:!0}}),r))};e.mobile.document.delegate("form","submit",function(t){var a;t.isDefaultPrevented()||(a=i(e(this)),a&&(e.mobile.changePage(a.url,a.options),t.preventDefault()))}),e.mobile.document.bind("vclick",function(t){var a,o,s=t.target,r=!1;if(!(t.which>1)&&e.mobile.linkBindingEnabled){if(c=e(s),e.data(s,"mobile-button")){if(!i(e(s).closest("form"),!0))return;s.parentNode&&(s=s.parentNode)}else{if(s=n(s),!s||"#"===e.mobile.path.parseUrl(s.getAttribute("href")||"#").hash)return;if(!e(s).jqmHijackable().length)return}~s.className.indexOf("ui-link-inherit")?s.parentNode&&(o=e.data(s.parentNode,"buttonElements")):o=e.data(s,"buttonElements"),o?s=o.outer:r=!0,a=e(s),r&&(a=a.closest(".ui-btn")),a.length>0&&!a.hasClass("ui-state-disabled")&&(e.mobile.removeActiveLinkClass(!0),e.mobile.activeClickedLink=a,e.mobile.activeClickedLink.addClass(e.mobile.activeBtnClass))}}),e.mobile.document.bind("click",function(i){if(e.mobile.linkBindingEnabled&&!i.isDefaultPrevented()){var o,s,r,c,d,u,h,p=n(i.target),f=e(p),g=function(){t.setTimeout(function(){e.mobile.removeActiveLinkClass(!0)},200)};if(e.mobile.activeClickedLink&&e.mobile.activeClickedLink[0]===i.target.parentNode&&g(),p&&!(i.which>1)&&f.jqmHijackable().length){if(f.is(":jqmData(rel='back')"))return e.mobile.back(),!1;if(o=e.mobile.getClosestBaseUrl(f),s=e.mobile.path.makeUrlAbsolute(f.attr("href")||"#",o),!e.mobile.ajaxEnabled&&!e.mobile.path.isEmbeddedPage(s))return void g();if(!(-1===s.search("#")||e.mobile.path.isExternal(s)&&e.mobile.path.isAbsoluteUrl(s))){if(s=s.replace(/[^#]*#/,""),!s)return void i.preventDefault();s=e.mobile.path.isPath(s)?e.mobile.path.makeUrlAbsolute(s,o):e.mobile.path.makeUrlAbsolute("#"+s,l.hrefNoHash)}if(r=f.is("[rel='external']")||f.is(":jqmData(ajax='false')")||f.is("[target]"),c=r||e.mobile.path.isExternal(s)&&!e.mobile.path.isPermittedCrossDomainRequest(l,s))return void g();d=f.jqmData("transition"),u="reverse"===f.jqmData("direction")||f.jqmData("back"),h=f.attr("data-"+e.mobile.ns+"rel")||a,e.mobile.changePage(s,{transition:d,reverse:u,role:h,link:f}),i.preventDefault()}}}),e.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){var t=[];e(this).find("a:jqmData(prefetch)").each(function(){var i=e(this),a=i.attr("href");a&&-1===e.inArray(a,t)&&(t.push(a),e.mobile.loadPage(a,{role:i.attr("data-"+e.mobile.ns+"rel"),prefetch:!0}))})}),e.mobile.pageContainer.pagecontainer(),e.mobile.document.bind("pageshow",function(){s?s.done(e.mobile.resetActivePageHeight):e.mobile.resetActivePageHeight()}),e.mobile.window.bind("throttledresize",e.mobile.resetActivePageHeight)},e(function(){o.resolve()}),"complete"===i.readyState?r():e.mobile.window.load(r),e.when(o,e.mobile.navreadyDeferred).done(function(){e.mobile._registerInternalEvents()})}(e),function(e,t,i){e.mobile.Transition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.Transition.prototype,{toPreClass:" ui-page-pre-in",init:function(t,i,a,n){e.extend(this,{name:t,reverse:i,$to:a,$from:n,deferred:new e.Deferred})},cleanFrom:function(){this.$from.removeClass(e.mobile.activePageClass+" out in reverse "+this.name).height("")},beforeDoneIn:function(){},beforeDoneOut:function(){},beforeStartOut:function(){},doneIn:function(){this.beforeDoneIn(),this.$to.removeClass("out in reverse "+this.name).height(""),this.toggleViewportClass(),e.mobile.window.scrollTop()!==this.toScroll&&this.scrollPage(),this.sequential||this.$to.addClass(e.mobile.activePageClass),this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,!0)},doneOut:function(e,t,i,a){this.beforeDoneOut(),this.startIn(e,t,i,a)},hideIn:function(e){this.$to.css("z-index",-10),e.call(this),this.$to.css("z-index","")},scrollPage:function(){e.event.special.scrollstart.enabled=!1,(e.mobile.hideUrlBar||this.toScroll!==e.mobile.defaultHomeScroll)&&t.scrollTo(0,this.toScroll),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},startIn:function(t,i,a,n){this.hideIn(function(){this.$to.addClass(e.mobile.activePageClass+this.toPreClass),n||e.mobile.focusPage(this.$to),this.$to.height(t+this.toScroll),a||this.scrollPage()}),this.$to.removeClass(this.toPreClass).addClass(this.name+" in "+i),a?this.doneIn():this.$to.animationComplete(e.proxy(function(){this.doneIn()},this))},startOut:function(t,i,a){this.beforeStartOut(t,i,a),this.$from.height(t+e.mobile.window.scrollTop()).addClass(this.name+" out"+i)},toggleViewportClass:function(){e.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name)},transition:function(){var t,i=this.reverse?" reverse":"",a=e.mobile.getScreenHeight(),n=e.mobile.maxTransitionWidth!==!1&&e.mobile.window.width()>e.mobile.maxTransitionWidth;return this.toScroll=e.mobile.navigate.history.getActive().lastScroll||e.mobile.defaultHomeScroll,t=!e.support.cssTransitions||!e.support.cssAnimations||n||!this.name||"none"===this.name||Math.max(e.mobile.window.scrollTop(),this.toScroll)>e.mobile.getMaxScrollForTransition(),this.toggleViewportClass(),this.$from&&!t?this.startOut(a,i,t):this.doneOut(a,i,t,!0),this.deferred.promise()}})}(e,this),function(e){e.mobile.SerialTransition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.SerialTransition.prototype,e.mobile.Transition.prototype,{sequential:!0,beforeDoneOut:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(t,i,a){this.$from.animationComplete(e.proxy(function(){this.doneOut(t,i,a)},this))}})}(e),function(e){e.mobile.ConcurrentTransition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.ConcurrentTransition.prototype,e.mobile.Transition.prototype,{sequential:!1,beforeDoneIn:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(e,t,i){this.doneOut(e,t,i)}})}(e),function(e){var t=function(){return 3*e.mobile.getScreenHeight()};e.mobile.transitionHandlers={sequential:e.mobile.SerialTransition,simultaneous:e.mobile.ConcurrentTransition},e.mobile.defaultTransitionHandler=e.mobile.transitionHandlers.sequential,e.mobile.transitionFallbacks={},e.mobile._maybeDegradeTransition=function(t){return t&&!e.support.cssTransform3d&&e.mobile.transitionFallbacks[t]&&(t=e.mobile.transitionFallbacks[t]),t},e.mobile.getMaxScrollForTransition=e.mobile.getMaxScrollForTransition||t}(e),function(e,t,i){e.mobile.transitionFallbacks.flip="fade"}(e,this),function(e,t,i){e.mobile.transitionFallbacks.flow="fade"}(e,this),function(e,t,i){e.mobile.transitionFallbacks.pop="fade"}(e,this),function(e,t,i){e.mobile.transitionHandlers.slide=e.mobile.transitionHandlers.simultaneous,e.mobile.transitionFallbacks.slide="fade"}(e,this),function(e,t,i){e.mobile.transitionFallbacks.slidedown="fade"}(e,this),function(e,t,i){e.mobile.transitionFallbacks.slidefade="fade"}(e,this),function(e,t,i){e.mobile.transitionFallbacks.slideup="fade"}(e,this),function(e,t,i){e.mobile.transitionFallbacks.turn="fade"}(e,this),function(e,t){e.mobile.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},e.mobile.page.prototype.options.degradeInputs=e.mobile.degradeInputs,e.mobile.degradeInputsWithin=function(t){t=e(t),t.find("input").not(e.mobile.page.prototype.keepNativeSelector()).each(function(){var t,i,a,n,o=e(this),s=this.getAttribute("type"),r=e.mobile.degradeInputs[s]||"text";e.mobile.degradeInputs[s]&&(t=e("<div>").html(o.clone()).html(),i=t.indexOf(" type=")>-1,a=i?/\s+type=["']?\w+['"]?/:/\/?>/,n=' type="'+r+'" data-'+e.mobile.ns+'type="'+s+'"'+(i?"":">"),o.replaceWith(t.replace(a,n)))})}}(e),function(e,t,i){e.widget("mobile.page",e.mobile.page,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"c",corners:!0,dialog:!1},_create:function(){this._super(),this.options.dialog&&(e.extend(this,{_inner:this.element.children(),
_headerCloseButton:null}),this.options.enhanced||this._setCloseBtn(this.options.closeBtn))},_enhance:function(){this._super(),this.options.dialog&&this.element.addClass("ui-dialog").wrapInner(e("<div/>",{role:"dialog","class":"ui-dialog-contain ui-overlay-shadow"+(this.options.corners?" ui-corner-all":"")}))},_setOptions:function(t){var a,n,o=this.options;t.corners!==i&&this._inner.toggleClass("ui-corner-all",!!t.corners),t.overlayTheme!==i&&e.mobile.activePage[0]===this.element[0]&&(o.overlayTheme=t.overlayTheme,this._handlePageBeforeShow()),t.closeBtnText!==i&&(a=o.closeBtn,n=t.closeBtnText),t.closeBtn!==i&&(a=t.closeBtn),a&&this._setCloseBtn(a,n),this._super(t)},_handlePageBeforeShow:function(){this.options.overlayTheme&&this.options.dialog?(this.removeContainerBackground(),this.setContainerBackground(this.options.overlayTheme)):this._super()},_setCloseBtn:function(t,i){var a,n=this._headerCloseButton;t="left"===t?"left":"right"===t?"right":"none","none"===t?n&&(n.remove(),n=null):n?(n.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+t),i&&n.text(i)):(a=this._inner.find(":jqmData(role='header')").first(),n=e("<a></a>",{href:"#","class":"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+t}).attr("data-"+e.mobile.ns+"rel","back").text(i||this.options.closeBtnText||"").prependTo(a)),this._headerCloseButton=n}})}(e,this),function(e,t,i){e.widget("mobile.dialog",{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"c",corners:!0},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_handleVClickSubmit:function(t){var i,a=e(t.target).closest("vclick"===t.type?"a":"form");a.length&&!a.jqmData("transition")&&(i={},i["data-"+e.mobile.ns+"transition"]=(e.mobile.navigate.history.getActive()||{}).transition||e.mobile.defaultDialogTransition,i["data-"+e.mobile.ns+"direction"]="reverse",a.attr(i))},_create:function(){var t=this.element,i=this.options;t.addClass("ui-dialog").wrapInner(e("<div/>",{role:"dialog","class":"ui-dialog-contain ui-overlay-shadow"+(i.corners?" ui-corner-all":"")})),e.extend(this,{_isCloseable:!1,_inner:t.children(),_headerCloseButton:null}),this._on(t,{vclick:"_handleVClickSubmit",submit:"_handleVClickSubmit",pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),this._setCloseBtn(i.closeBtn)},_setOptions:function(t){var a,n,o=this.options;t.corners!==i&&this._inner.toggleClass("ui-corner-all",!!t.corners),t.overlayTheme!==i&&e.mobile.activePage[0]===this.element[0]&&(o.overlayTheme=t.overlayTheme,this._handlePageBeforeShow()),t.closeBtnText!==i&&(a=o.closeBtn,n=t.closeBtnText),t.closeBtn!==i&&(a=t.closeBtn),a&&this._setCloseBtn(a,n),this._super(t)},_setCloseBtn:function(t,i){var a,n=this._headerCloseButton;t="left"===t?"left":"right"===t?"right":"none","none"===t?n&&(n.remove(),n=null):n?(n.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+t),i&&n.text(i)):(a=this._inner.find(":jqmData(role='header')").first(),n=e("<a></a>",{role:"button",href:"#","class":"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+t}).text(i||this.options.closeBtnText||"").prependTo(a),this._on(n,{click:"close"})),this._headerCloseButton=n},close:function(){var t=e.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,e.mobile.hashListeningEnabled&&t.activeIndex>0?e.mobile.back():e.mobile.pageContainer.pagecontainer("back"))}})}(e,this),function(e,t){var i=/([A-Z])/g,a=function(e){return"ui-btn-icon-"+(null===e?"left":e)};e.widget("mobile.collapsible",{options:{enhanced:!1,expandCueText:null,collapseCueText:null,collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:null,expandedIcon:null,iconpos:null,theme:null,contentTheme:null,inset:null,corners:null,mini:null},_create:function(){var t=this.element,i={accordion:t.closest(":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')"+(e.mobile.collapsibleset?", :mobile-collapsibleset":"")).addClass("ui-collapsible-set")};this._ui=i,this._renderedOptions=this._getOptions(this.options),this.options.enhanced?(i.heading=this.element.children(".ui-collapsible-heading"),i.content=i.heading.next(),i.anchor=i.heading.children(),i.status=i.anchor.children(".ui-collapsible-heading-status")):this._enhance(t,i),this._on(i.heading,{tap:function(){i.heading.find("a").first().addClass(e.mobile.activeBtnClass)},click:function(e){this._handleExpandCollapse(!i.heading.hasClass("ui-collapsible-heading-collapsed")),e.preventDefault(),e.stopPropagation()}})},_getOptions:function(t){var a,n=this._ui.accordion,o=this._ui.accordionWidget;t=e.extend({},t),n.length&&!o&&(this._ui.accordionWidget=o=n.data("mobile-collapsibleset"));for(a in t)t[a]=null!=t[a]?t[a]:o?o.options[a]:n.length?e.mobile.getAttribute(n[0],a.replace(i,"-$1").toLowerCase()):null,null==t[a]&&(t[a]=e.mobile.collapsible.defaults[a]);return t},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_enhance:function(t,i){var n,o=this._renderedOptions,s=this._themeClassFromOption("ui-body-",o.contentTheme);return t.addClass("ui-collapsible "+(o.inset?"ui-collapsible-inset ":"")+(o.inset&&o.corners?"ui-corner-all ":"")+(s?"ui-collapsible-themed-content ":"")),i.originalHeading=t.children(this.options.heading).first(),i.content=t.wrapInner("<div class='ui-collapsible-content "+s+"'></div>").children(".ui-collapsible-content"),i.heading=i.originalHeading,i.heading.is("legend")&&(i.heading=e("<div role='heading'>"+i.heading.html()+"</div>"),i.placeholder=e("<div><!-- placeholder for legend --></div>").insertBefore(i.originalHeading),i.originalHeading.remove()),n=o.collapsed?o.collapsedIcon?"ui-icon-"+o.collapsedIcon:"":o.expandedIcon?"ui-icon-"+o.expandedIcon:"",i.status=e("<span class='ui-collapsible-heading-status'></span>"),i.anchor=i.heading.detach().addClass("ui-collapsible-heading").append(i.status).wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().addClass("ui-btn "+(n?n+" ":"")+(n?a(o.iconpos)+" ":"")+this._themeClassFromOption("ui-btn-",o.theme)+" "+(o.mini?"ui-mini ":"")),i.heading.insertBefore(i.content),this._handleExpandCollapse(this.options.collapsed),i},refresh:function(){this._applyOptions(this.options),this._renderedOptions=this._getOptions(this.options)},_applyOptions:function(e){var i,n,o,s,r,l=this.element,c=this._renderedOptions,d=this._ui,u=d.anchor,h=d.status,p=this._getOptions(e);e.collapsed!==t&&this._handleExpandCollapse(e.collapsed),i=l.hasClass("ui-collapsible-collapsed"),i?p.expandCueText!==t&&h.text(p.expandCueText):p.collapseCueText!==t&&h.text(p.collapseCueText),r=p.collapsedIcon!==t?p.collapsedIcon!==!1:c.collapsedIcon!==!1,(p.iconpos!==t||p.collapsedIcon!==t||p.expandedIcon!==t)&&(u.removeClass([a(c.iconpos)].concat(c.expandedIcon?["ui-icon-"+c.expandedIcon]:[]).concat(c.collapsedIcon?["ui-icon-"+c.collapsedIcon]:[]).join(" ")),r&&u.addClass([a(p.iconpos!==t?p.iconpos:c.iconpos)].concat(i?["ui-icon-"+(p.collapsedIcon!==t?p.collapsedIcon:c.collapsedIcon)]:["ui-icon-"+(p.expandedIcon!==t?p.expandedIcon:c.expandedIcon)]).join(" "))),p.theme!==t&&(o=this._themeClassFromOption("ui-btn-",c.theme),n=this._themeClassFromOption("ui-btn-",p.theme),u.removeClass(o).addClass(n)),p.contentTheme!==t&&(o=this._themeClassFromOption("ui-body-",c.contentTheme),n=this._themeClassFromOption("ui-body-",p.contentTheme),d.content.removeClass(o).addClass(n)),p.inset!==t&&(l.toggleClass("ui-collapsible-inset",p.inset),s=!(!p.inset||!p.corners&&!c.corners)),p.corners!==t&&(s=!(!p.corners||!p.inset&&!c.inset)),s!==t&&l.toggleClass("ui-corner-all",s),p.mini!==t&&u.toggleClass("ui-mini",p.mini)},_setOptions:function(e){this._applyOptions(e),this._super(e),this._renderedOptions=this._getOptions(this.options)},_handleExpandCollapse:function(t){var i=this._renderedOptions,a=this._ui;a.status.text(t?i.expandCueText:i.collapseCueText),a.heading.toggleClass("ui-collapsible-heading-collapsed",t).find("a").first().toggleClass("ui-icon-"+i.expandedIcon,!t).toggleClass("ui-icon-"+i.collapsedIcon,t||i.expandedIcon===i.collapsedIcon).removeClass(e.mobile.activeBtnClass),this.element.toggleClass("ui-collapsible-collapsed",t),a.content.toggleClass("ui-collapsible-content-collapsed",t).attr("aria-hidden",t).trigger("updatelayout"),this.options.collapsed=t,this._trigger(t?"collapse":"expand")},expand:function(){this._handleExpandCollapse(!1)},collapse:function(){this._handleExpandCollapse(!0)},_destroy:function(){var e=this._ui,t=this.options;t.enhanced||(e.placeholder?(e.originalHeading.insertBefore(e.placeholder),e.placeholder.remove(),e.heading.remove()):(e.status.remove(),e.heading.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed").children().contents().unwrap()),e.anchor.contents().unwrap(),e.content.contents().unwrap(),this.element.removeClass("ui-collapsible ui-collapsible-collapsed ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"))}}),e.mobile.collapsible.defaults={expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsedIcon:"plus",contentTheme:"inherit",expandedIcon:"minus",iconpos:"left",inset:!0,corners:!0,theme:"inherit",mini:!1}}(e),function(e,t){function i(t){var i,n=t.length,o=[];for(i=0;n>i;i++)t[i].className.match(a)||o.push(t[i]);return e(o)}var a=/\bui-screen-hidden\b/;e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var a;return t?a=i(e):(a=e.filter(":visible"),0===a.length&&(a=i(e))),a},_addFirstLastClasses:function(e,t,i){e.removeClass("ui-first-child ui-last-child"),t.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),i||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(e){e.removeClass("ui-first-child ui-last-child")}}}(e),function(e,t){var i=":mobile-collapsible, "+e.mobile.collapsible.initSelector;e.widget("mobile.collapsibleset",e.extend({initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",options:e.extend({enhanced:!1},e.mobile.collapsible.defaults),_handleCollapsibleExpand:function(t){var i=e(t.target).closest(".ui-collapsible");i.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")&&i.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)").collapsible("collapse")},_create:function(){var t=this.element,i=this.options;e.extend(this,{_classes:""}),i.enhanced||(t.addClass("ui-collapsible-set "+this._themeClassFromOption("ui-group-theme-",i.theme)+" "+(i.corners&&i.inset?"ui-corner-all ":"")),this.element.find(e.mobile.collapsible.initSelector).collapsible()),this._on(t,{collapsibleexpand:"_handleCollapsibleExpand"})},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_init:function(){this._refresh(!0),this.element.children(i).filter(":jqmData(collapsed='false')").collapsible("expand")},_setOptions:function(e){var i,a,n=this.element,o=this._themeClassFromOption("ui-group-theme-",e.theme);return o&&n.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme)).addClass(o),e.inset!==t&&(a=!(!e.inset||!e.corners&&!this.options.corners)),e.corners!==t&&(a=!(!e.corners||!e.inset&&!this.options.inset)),a!==t&&n.toggleClass("ui-corner-all",a),i=this._super(e),this.element.children(":mobile-collapsible").collapsible("refresh"),i},_destroy:function(){var e=this.element;this._removeFirstLastClasses(e.children(i)),e.removeClass("ui-collapsible-set ui-corner-all "+this._themeClassFromOption("ui-group-theme-",this.options.theme)).children(":mobile-collapsible").collapsible("destroy")},_refresh:function(t){var a=this.element.children(i);this.element.find(e.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible(),this._addFirstLastClasses(a,this._getVisibles(a,t),t)},refresh:function(){this._refresh(!1)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e,t){e.fn.fieldcontain=function(){return this.addClass("ui-field-contain")}}(e),function(e,t){e.fn.grid=function(t){return this.each(function(){var i,a,n=e(this),o=e.extend({grid:null},t),s=n.children(),r={solo:1,a:2,b:3,c:4,d:5},l=o.grid;if(!l)if(s.length<=5)for(a in r)r[a]===s.length&&(l=a);else l="a",n.addClass("ui-grid-duo");i=r[l],n.addClass("ui-grid-"+l),s.filter(":nth-child("+i+"n+1)").addClass("ui-block-a"),i>1&&s.filter(":nth-child("+i+"n+2)").addClass("ui-block-b"),i>2&&s.filter(":nth-child("+i+"n+3)").addClass("ui-block-c"),i>3&&s.filter(":nth-child("+i+"n+4)").addClass("ui-block-d"),i>4&&s.filter(":nth-child("+i+"n+5)").addClass("ui-block-e")})}}(e),function(e,t){e.widget("mobile.navbar",{options:{iconpos:"top",grid:null},_create:function(){var a=this.element,n=a.find("a, button"),o=n.filter(":jqmData(icon)").length?this.options.iconpos:t;a.addClass("ui-navbar").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),n.each(function(){var t=e.mobile.getAttribute(this,"icon"),i=e.mobile.getAttribute(this,"theme"),a="ui-btn";i&&(a+=" ui-btn-"+i),t&&(a+=" ui-icon-"+t+" ui-btn-icon-"+o),e(this).addClass(a)}),a.delegate("a","vclick",function(){var t=e(this);t.hasClass("ui-state-disabled")||t.hasClass("ui-disabled")||t.hasClass(e.mobile.activeBtnClass)||(n.removeClass(e.mobile.activeBtnClass),t.addClass(e.mobile.activeBtnClass),e(i).one("pagehide",function(){t.removeClass(e.mobile.activeBtnClass)}))}),a.closest(".ui-page").bind("pagebeforeshow",function(){n.filter(".ui-state-persist").addClass(e.mobile.activeBtnClass)})}})}(e),function(e,t){var i=e.mobile.getAttribute;e.widget("mobile.listview",e.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var e=this,t="";t+=e.options.inset?" ui-listview-inset":"",e.options.inset&&(t+=e.options.corners?" ui-corner-all":"",t+=e.options.shadow?" ui-shadow":""),e.element.addClass(" ui-listview"+t),e.refresh(!0)},_findFirstElementByTagName:function(e,t,i,a){var n={};for(n[i]=n[a]=!0;e;){if(n[e.nodeName])return e;e=e[t]}return null},_addThumbClasses:function(t){var i,a,n=t.length;for(i=0;n>i;i++)a=e(this._findFirstElementByTagName(t[i].firstChild,"nextSibling","img","IMG")),a.length&&e(this._findFirstElementByTagName(a[0].parentNode,"parentNode","li","LI")).addClass(a.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(t,i,a){var n=[],o={};for(o[i]=o[a]=!0,t=t.firstChild;t;)o[t.nodeName]&&n.push(t),t=t.nextSibling;return e(n)},_beforeListviewRefresh:e.noop,_afterListviewRefresh:e.noop,refresh:function(t){var a,n,o,s,r,l,c,d,u,h,p,f,g,m,v,b,w,_,y,x,k=this.options,$=this.element,C=!!e.nodeName($[0],"ol"),S=$.attr("start"),T={},E=$.find(".ui-li-count"),O=i($[0],"counttheme")||this.options.countTheme,D=O?"ui-body-"+O:"ui-body-inherit";for(k.theme&&$.addClass("ui-group-theme-"+k.theme),C&&(S||0===S)&&(p=parseInt(S,10)-1,$.css("counter-reset","listnumbering "+p)),this._beforeListviewRefresh(),x=this._getChildrenByTagName($[0],"li","LI"),n=0,o=x.length;o>n;n++)s=x.eq(n),r="",(t||s[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0)&&(u=this._getChildrenByTagName(s[0],"a","A"),h="list-divider"===i(s[0],"role"),g=s.attr("value"),l=i(s[0],"theme"),u.length&&u[0].className.search(/\bui-btn\b/)<0&&!h?(c=i(s[0],"icon"),d=c===!1?!1:c||k.icon,u.removeClass("ui-link"),a="ui-btn",l&&(a+=" ui-btn-"+l),u.length>1?(r="ui-li-has-alt",m=u.last(),v=i(m[0],"theme")||k.splitTheme||i(s[0],"theme",!0),b=v?" ui-btn-"+v:"",w=i(m[0],"icon")||i(s[0],"icon")||k.splitIcon,_="ui-btn ui-btn-icon-notext ui-icon-"+w+b,m.attr("title",e.trim(m.getEncodedText())).addClass(_).empty(),u=u.first()):d&&(a+=" ui-btn-icon-right ui-icon-"+d),u.addClass(a)):h?(y=i(s[0],"theme")||k.dividerTheme||k.theme,r="ui-li-divider ui-bar-"+(y?y:"inherit"),s.attr("role","heading")):u.length<=0&&(r="ui-li-static ui-body-"+(l?l:"inherit")),C&&g&&(f=parseInt(g,10)-1,s.css("counter-reset","listnumbering "+f))),T[r]||(T[r]=[]),T[r].push(s[0]);for(r in T)e(T[r]).addClass(r);E.each(function(){e(this).closest("li").addClass("ui-li-has-count")}),D&&E.not("[class*='ui-body-']").addClass(D),this._addThumbClasses(x),this._addThumbClasses(x.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(x,this._getVisibles(x,t),t)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e,t){function a(t){var i=e.trim(t.text())||null;return i?i=i.slice(0,1).toUpperCase():null}e.widget("mobile.listview",e.mobile.listview,{options:{autodividers:!1,autodividersSelector:a},_beforeListviewRefresh:function(){this.options.autodividers&&(this._replaceDividers(),this._superApply(arguments))},_replaceDividers:function(){var t,a,n,o,s,r=null,l=this.element;for(l.children("li:jqmData(role='list-divider')").remove(),a=l.children("li"),t=0;t<a.length;t++)n=a[t],o=this.options.autodividersSelector(e(n)),o&&r!==o&&(s=i.createElement("li"),s.appendChild(i.createTextNode(o)),s.setAttribute("data-"+e.mobile.ns+"role","list-divider"),n.parentNode.insertBefore(s,n)),r=o}})}(e),function(e,t){var i=/(^|\s)ui-li-divider($|\s)/,a=/(^|\s)ui-screen-hidden($|\s)/;e.widget("mobile.listview",e.mobile.listview,{options:{hideDividers:!1},_afterListviewRefresh:function(){var e,t,n,o=!0;if(this._superApply(arguments),this.options.hideDividers)for(e=this._getChildrenByTagName(this.element[0],"li","LI"),t=e.length-1;t>-1;t--)n=e[t],n.className.match(i)?(o&&(n.className=n.className+" ui-screen-hidden"),o=!0):n.className.match(a)||(o=!1)}})}(e),function(e,t){e.mobile.nojs=function(t){e(":jqmData(role='nojs')",t).addClass("ui-nojs")}}(e),function(e,t){e.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}}}(e),function(e,t){var i=e.mobile.path.hashToSelector;e.widget("mobile.checkboxradio",e.extend({initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",options:{theme:"inherit",mini:!1,wrapperClass:null,enhanced:!1,iconpos:"left"},_create:function(){var t=this.element,i=this.options,a=function(e,t){return e.jqmData(t)||e.closest("form, fieldset").jqmData(t)},n=this.options.enhanced?{element:this.element.siblings("label"),isParent:!1}:this._findLabel(),o=t[0].type,s="ui-"+o+"-on",r="ui-"+o+"-off";("checkbox"===o||"radio"===o)&&(this.element[0].disabled&&(this.options.disabled=!0),i.iconpos=a(t,"iconpos")||n.element.attr("data-"+e.mobile.ns+"iconpos")||i.iconpos,i.mini=a(t,"mini")||i.mini,e.extend(this,{input:t,label:n.element,labelIsParent:n.isParent,inputtype:o,checkedClass:s,uncheckedClass:r}),this.options.enhanced||this._enhance(),this._on(n.element,{vmouseover:"_handleLabelVMouseOver",vclick:"_handleLabelVClick"}),this._on(t,{vmousedown:"_cacheVals",vclick:"_handleInputVClick",focus:"_handleInputFocus",blur:"_handleInputBlur"}),this._handleFormReset(),this.refresh())},_findLabel:function(){var t,a,n,o=this.element,s=o[0].labels;return s&&s.length>0?(a=e(s[0]),n=e.contains(a[0],o[0])):(t=o.closest("label"),n=t.length>0,a=n?t:e(this.document[0].getElementsByTagName("label")).filter("[for='"+i(o[0].id)+"']").first()),{element:a,isParent:n}},_enhance:function(){this.label.addClass("ui-btn ui-corner-all"),this.labelIsParent?this.input.add(this.label).wrapAll(this._wrapper()):(this.element.wrap(this._wrapper()),this.element.parent().prepend(this.label)),this._setOptions({theme:this.options.theme,iconpos:this.options.iconpos,mini:this.options.mini})},_wrapper:function(){return e("<div class='"+(this.options.wrapperClass?this.options.wrapperClass:"")+" ui-"+this.inputtype+(this.options.disabled?" ui-state-disabled":"")+"' ></div>")},_handleInputFocus:function(){this.label.addClass(e.mobile.focusClass)},_handleInputBlur:function(){this.label.removeClass(e.mobile.focusClass)},_handleInputVClick:function(){this.element.prop("checked",this.element.is(":checked")),this._getInputSet().not(this.element).prop("checked",!1),this._updateAll(!0)},_handleLabelVMouseOver:function(e){this.label.parent().hasClass("ui-state-disabled")&&e.stopPropagation()},_handleLabelVClick:function(e){var t=this.element;return t.is(":disabled")?void e.preventDefault():(this._cacheVals(),t.prop("checked","radio"===this.inputtype&&!0||!t.prop("checked")),t.triggerHandler("click"),this._getInputSet().not(t).prop("checked",!1),this._updateAll(),!1)},_cacheVals:function(){this._getInputSet().each(function(){e(this).attr("data-"+e.mobile.ns+"cacheVal",this.checked)})},_getInputSet:function(){var t,a,n=this.element[0],o=n.name,s=n.form,r=this.element.parents().last().get(0),l=this.element;return o&&"radio"===this.inputtype&&r&&(t="input[type='radio'][name='"+i(o)+"']",s?(a=s.getAttribute("id"),a&&(l=e(t+"[form='"+i(a)+"']",r)),l=e(s).find(t).filter(function(){return this.form===s}).add(l)):l=e(t,r).filter(function(){return!this.form})),l},_updateAll:function(t){var i=this;this._getInputSet().each(function(){var a=e(this);!this.checked&&"checkbox"!==i.inputtype||t||a.trigger("change")}).checkboxradio("refresh")},_reset:function(){this.refresh()},_hasIcon:function(){var t,i,a=e.mobile.controlgroup;return a&&(t=this.element.closest(":mobile-controlgroup,"+a.prototype.initSelector),t.length>0)?(i=e.data(t[0],"mobile-controlgroup"),"horizontal"!==(i?i.options.type:t.attr("data-"+e.mobile.ns+"type"))):!0},refresh:function(){var t=this.element[0].checked,i=e.mobile.activeBtnClass,a="ui-btn-icon-"+this.options.iconpos,n=[],o=[];this._hasIcon()?(o.push(i),n.push(a)):(o.push(a),(t?n:o).push(i)),t?(n.push(this.checkedClass),o.push(this.uncheckedClass)):(n.push(this.uncheckedClass),o.push(this.checkedClass)),this.widget().toggleClass("ui-state-disabled",this.element.prop("disabled")),this.label.addClass(n.join(" ")).removeClass(o.join(" "))},widget:function(){return this.label.parent()},_setOptions:function(e){var i=this.label,a=this.options,n=this.widget(),o=this._hasIcon();e.disabled!==t&&(this.input.prop("disabled",!!e.disabled),n.toggleClass("ui-state-disabled",!!e.disabled)),e.mini!==t&&n.toggleClass("ui-mini",!!e.mini),e.theme!==t&&i.removeClass("ui-btn-"+a.theme).addClass("ui-btn-"+e.theme),e.wrapperClass!==t&&n.removeClass(a.wrapperClass).addClass(e.wrapperClass),e.iconpos!==t&&o?i.removeClass("ui-btn-icon-"+a.iconpos).addClass("ui-btn-icon-"+e.iconpos):o||i.removeClass("ui-btn-icon-"+a.iconpos),this._super(e)}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.button",{initSelector:"input[type='button'], input[type='submit'], input[type='reset']",options:{theme:null,icon:null,iconpos:"left",iconshadow:!1,corners:!0,shadow:!0,inline:null,mini:null,wrapperClass:null,enhanced:!1},_create:function(){this.element.is(":disabled")&&(this.options.disabled=!0),this.options.enhanced||this._enhance(),e.extend(this,{wrapper:this.element.parent()}),this._on({focus:function(){this.widget().addClass(e.mobile.focusClass)},blur:function(){this.widget().removeClass(e.mobile.focusClass)}}),this.refresh(!0)},_enhance:function(){this.element.wrap(this._button())},_button:function(){var t=this.options,i=this._getIconClasses(this.options);return e("<div class='ui-btn ui-input-btn"+(t.wrapperClass?" "+t.wrapperClass:"")+(t.theme?" ui-btn-"+t.theme:"")+(t.corners?" ui-corner-all":"")+(t.shadow?" ui-shadow":"")+(t.inline?" ui-btn-inline":"")+(t.mini?" ui-mini":"")+(t.disabled?" ui-state-disabled":"")+(i?" "+i:"")+"' >"+this.element.val()+"</div>")},widget:function(){return this.wrapper},_destroy:function(){this.element.insertBefore(this.wrapper),this.wrapper.remove()},_getIconClasses:function(e){return e.icon?"ui-icon-"+e.icon+(e.iconshadow?" ui-shadow-icon":"")+" ui-btn-icon-"+e.iconpos:""},_setOptions:function(i){var a=this.widget();i.theme!==t&&a.removeClass(this.options.theme).addClass("ui-btn-"+i.theme),i.corners!==t&&a.toggleClass("ui-corner-all",i.corners),i.shadow!==t&&a.toggleClass("ui-shadow",i.shadow),i.inline!==t&&a.toggleClass("ui-btn-inline",i.inline),i.mini!==t&&a.toggleClass("ui-mini",i.mini),i.disabled!==t&&(this.element.prop("disabled",i.disabled),a.toggleClass("ui-state-disabled",i.disabled)),(i.icon!==t||i.iconshadow!==t||i.iconpos!==t)&&a.removeClass(this._getIconClasses(this.options)).addClass(this._getIconClasses(e.extend({},this.options,i))),this._super(i)},refresh:function(t){var i,a=this.element.prop("disabled");this.options.icon&&"notext"===this.options.iconpos&&this.element.attr("title")&&this.element.attr("title",this.element.val()),t||(i=this.element.detach(),e(this.wrapper).text(this.element.val()).append(i)),this.options.disabled!==a&&this._setOptions({disabled:a})}})}(e),function(e){var t=e("meta[name=viewport]"),i=t.attr("content"),a=i+",maximum-scale=1, user-scalable=no",n=i+",maximum-scale=10, user-scalable=yes",o=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(i);e.mobile.zoom=e.extend({},{enabled:!o,locked:!1,disable:function(i){o||e.mobile.zoom.locked||(t.attr("content",a),e.mobile.zoom.enabled=!1,e.mobile.zoom.locked=i||!1)},enable:function(i){o||e.mobile.zoom.locked&&i!==!0||(t.attr("content",n),e.mobile.zoom.enabled=!0,e.mobile.zoom.locked=!1)},restore:function(){o||(t.attr("content",i),e.mobile.zoom.enabled=!0)}})}(e),function(e,t){e.widget("mobile.textinput",{initSelector:"input[type='text'],input[type='search'],:jqmData(type='search'),input[type='number'],:jqmData(type='number'),input[type='password'],input[type='email'],input[type='url'],input[type='tel'],textarea,input[type='time'],input[type='date'],input[type='month'],input[type='week'],input[type='datetime'],input[type='datetime-local'],input[type='color'],input:not([type]),input[type='file']",options:{theme:null,corners:!0,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,wrapperClass:"",enhanced:!1},_create:function(){var t=this.options,i=this.element.is("[type='search'], :jqmData(type='search')"),a="TEXTAREA"===this.element[0].tagName,n=this.element.is("[data-"+(e.mobile.ns||"")+"type='range']"),o=(this.element.is("input")||this.element.is("[data-"+(e.mobile.ns||"")+"type='search']"))&&!n;this.element.prop("disabled")&&(t.disabled=!0),e.extend(this,{classes:this._classesFromOptions(),isSearch:i,isTextarea:a,isRange:n,inputNeedsWrap:o}),this._autoCorrect(),t.enhanced||this._enhance(),this._on({focus:"_handleFocus",blur:"_handleBlur"})},refresh:function(){this.setOptions({disabled:this.element.is(":disabled")})},_enhance:function(){var e=[];this.isTextarea&&e.push("ui-input-text"),(this.isTextarea||this.isRange)&&e.push("ui-shadow-inset"),this.inputNeedsWrap?this.element.wrap(this._wrap()):e=e.concat(this.classes),this.element.addClass(e.join(" "))},widget:function(){return this.inputNeedsWrap?this.element.parent():this.element},_classesFromOptions:function(){var e=this.options,t=[];return t.push("ui-body-"+(null===e.theme?"inherit":e.theme)),e.corners&&t.push("ui-corner-all"),e.mini&&t.push("ui-mini"),e.disabled&&t.push("ui-state-disabled"),e.wrapperClass&&t.push(e.wrapperClass),t},_wrap:function(){return e("<div class='"+(this.isSearch?"ui-input-search ":"ui-input-text ")+this.classes.join(" ")+" ui-shadow-inset'></div>")},_autoCorrect:function(){"undefined"==typeof this.element[0].autocorrect||e.support.touchOverflow||(this.element[0].setAttribute("autocorrect","off"),this.element[0].setAttribute("autocomplete","off"))},_handleBlur:function(){this.widget().removeClass(e.mobile.focusClass),this.options.preventFocusZoom&&e.mobile.zoom.enable(!0)},_handleFocus:function(){this.options.preventFocusZoom&&e.mobile.zoom.disable(!0),this.widget().addClass(e.mobile.focusClass)},_setOptions:function(e){var i=this.widget();this._super(e),(e.disabled!==t||e.mini!==t||e.corners!==t||e.theme!==t||e.wrapperClass!==t)&&(i.removeClass(this.classes.join(" ")),this.classes=this._classesFromOptions(),i.addClass(this.classes.join(" "))),e.disabled!==t&&this.element.prop("disabled",!!e.disabled)},_destroy:function(){this.options.enhanced||(this.inputNeedsWrap&&this.element.unwrap(),this.element.removeClass("ui-input-text "+this.classes.join(" ")))}})}(e),function(e,a){e.widget("mobile.slider",e.extend({initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!1},_create:function(){var n,o,s,r,l,c,d,u,h,p,f=this,g=this.element,m=this.options.trackTheme||e.mobile.getAttribute(g[0],"theme"),v=m?" ui-bar-"+m:" ui-bar-inherit",b=this.options.corners||g.jqmData("corners")?" ui-corner-all":"",w=this.options.mini||g.jqmData("mini")?" ui-mini":"",_=g[0].nodeName.toLowerCase(),y="select"===_,x=g.parent().is(":jqmData(role='rangeslider')"),k=y?"ui-slider-switch":"",$=g.attr("id"),C=e("[for='"+$+"']"),S=C.attr("id")||$+"-label",T=y?0:parseFloat(g.attr("min")),E=y?g.find("option").length-1:parseFloat(g.attr("max")),O=t.parseFloat(g.attr("step")||1),D=i.createElement("a"),A=e(D),M=i.createElement("div"),P=e(M),N=this.options.highlight&&!y?function(){var t=i.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass,e(t).prependTo(P)}():!1;if(C.attr("id",S),this.isToggleSwitch=y,D.setAttribute("href","#"),M.setAttribute("role","application"),M.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",k,v,b,w].join(""),D.className="ui-slider-handle",M.appendChild(D),A.attr({role:"slider","aria-valuemin":T,"aria-valuemax":E,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":S}),e.extend(this,{slider:P,handle:A,control:g,type:_,step:O,max:E,min:T,valuebg:N,isRangeslider:x,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),y){for(d=g.attr("tabindex"),d&&A.attr("tabindex",d),g.attr("tabindex","-1").focus(function(){e(this).blur(),A.focus()}),o=i.createElement("div"),o.className="ui-slider-inneroffset",s=0,r=M.childNodes.length;r>s;s++)o.appendChild(M.childNodes[s]);for(M.appendChild(o),A.addClass("ui-slider-handle-snapping"),n=g.find("option"),l=0,c=n.length;c>l;l++)u=l?"a":"b",h=l?" "+e.mobile.activeBtnClass:"",p=i.createElement("span"),p.className=["ui-slider-label ui-slider-label-",u,h].join(""),p.setAttribute("role","img"),p.appendChild(i.createTextNode(n[l].innerHTML)),e(p).prependTo(P);f._labels=e(".ui-slider-label",P)}g.addClass(y?"ui-slider-switch":"ui-slider-input"),this._on(g,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),P.bind("vmousedown",e.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(i,{vmousemove:"_preventDocumentDrag"}),this._on(P.add(i),{vmouseup:"_sliderVMouseUp"}),P.insertAfter(g),y||x||(o=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",g.add(P).wrapAll(o)),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(a,a,!0)},_setOptions:function(e){e.theme!==a&&this._setTheme(e.theme),e.trackTheme!==a&&this._setTrackTheme(e.trackTheme),e.corners!==a&&this._setCorners(e.corners),e.mini!==a&&this._setMini(e.mini),e.highlight!==a&&this._setHighlight(e.highlight),e.disabled!==a&&this._setDisabled(e.disabled),this._super(e)},_controlChange:function(e){return this._trigger("controlchange",e)===!1?!1:void(this.mouseMoved||this.refresh(this._value(),!0))},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(t){var i=this._value();if(!this.options.disabled){switch(t.keyCode){case e.mobile.keyCode.HOME:case e.mobile.keyCode.END:case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:t.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"));
}switch(t.keyCode){case e.mobile.keyCode.HOME:this.refresh(this.min);break;case e.mobile.keyCode.END:this.refresh(this.max);break;case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:this.refresh(i+this.step);break;case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:this.refresh(i-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(e){return this.options.disabled||1!==e.which&&0!==e.which&&e.which!==a?!1:this._trigger("beforestart",e)===!1?!1:(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(e),this._trigger("start"),!1)},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.mouseMoved?this.userModified?this.refresh(0===this.beforeStart?1:0):this.refresh(this.beforeStart):this.refresh(0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):void 0},_preventDocumentDrag:function(e){return this._trigger("drag",e)===!1?!1:this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(e),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):void 0},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(a,!1,!0)},refresh:function(t,a,n){var o,s,r,l,c,d,u,h,p,f,g,m,v,b,w,_,y,x,k,$,C=this,S=e.mobile.getAttribute(this.element[0],"theme"),T=this.options.theme||S,E=T?" ui-btn-"+T:"",O=this.options.trackTheme||S,D=O?" ui-bar-"+O:" ui-bar-inherit",A=this.options.corners?" ui-corner-all":"",M=this.options.mini?" ui-mini":"";if(C.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",D,A,M].join(""),(this.options.disabled||this.element.prop("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=function(){var t=i.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass,e(t).prependTo(C.slider)}()),this.handle.addClass("ui-btn"+E+" ui-shadow"),u=this.element,h=!this.isToggleSwitch,p=h?[]:u.find("option"),f=h?parseFloat(u.attr("min")):0,g=h?parseFloat(u.attr("max")):p.length-1,m=h&&parseFloat(u.attr("step"))>0?parseFloat(u.attr("step")):1,"object"==typeof t){if(r=t,l=8,o=this.slider.offset().left,s=this.slider.width(),c=s/((g-f)/m),!this.dragging||r.pageX<o-l||r.pageX>o+s+l)return;d=c>1?(r.pageX-o)/s*100:Math.round((r.pageX-o)/s*100)}else null==t&&(t=h?parseFloat(u.val()||0):u[0].selectedIndex),d=(parseFloat(t)-f)/(g-f)*100;if(!isNaN(d)&&(v=d/100*(g-f)+f,b=(v-f)%m,w=v-b,2*Math.abs(b)>=m&&(w+=b>0?m:-m),_=100/((g-f)/m),v=parseFloat(w.toFixed(5)),"undefined"==typeof c&&(c=s/((g-f)/m)),c>1&&h&&(d=(v-f)*_*(1/m)),0>d&&(d=0),d>100&&(d=100),f>v&&(v=f),v>g&&(v=g),this.handle.css("left",d+"%"),this.handle[0].setAttribute("aria-valuenow",h?v:p.eq(v).attr("value")),this.handle[0].setAttribute("aria-valuetext",h?v:p.eq(v).getEncodedText()),this.handle[0].setAttribute("title",h?v:p.eq(v).getEncodedText()),this.valuebg&&this.valuebg.css("width",d+"%"),this._labels&&(y=this.handle.width()/this.slider.width()*100,x=d&&y+(100-y)*d/100,k=100===d?0:Math.min(y+100-x,100),this._labels.each(function(){var t=e(this).hasClass("ui-slider-label-a");e(this).width((t?x:k)+"%")})),!n)){if($=!1,h?($=parseFloat(u.val())!==v,u.val(v)):($=u[0].selectedIndex!==v,u[0].selectedIndex=v),this._trigger("beforechange",t)===!1)return!1;!a&&$&&u.trigger("change")}},_setHighlight:function(e){e=!!e,e?(this.options.highlight=!!e,this.refresh()):this.valuebg&&(this.valuebg.remove(),this.valuebg=!1)},_setTheme:function(e){this.handle.removeClass("ui-btn-"+this.options.theme).addClass("ui-btn-"+e);var t=this.options.theme?this.options.theme:"inherit",i=e?e:"inherit";this.control.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setTrackTheme:function(e){var t=this.options.trackTheme?this.options.trackTheme:"inherit",i=e?e:"inherit";this.slider.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setMini:function(e){e=!!e,this.isToggleSwitch||this.isRangeslider||(this.slider.parent().toggleClass("ui-mini",e),this.element.toggleClass("ui-mini",e)),this.slider.toggleClass("ui-mini",e)},_setCorners:function(e){this.slider.toggleClass("ui-corner-all",e),this.isToggleSwitch||this.control.toggleClass("ui-corner-all",e)},_setDisabled:function(e){e=!!e,this.element.prop("disabled",e),this.slider.toggleClass("ui-state-disabled",e).attr("aria-disabled",e),this.element.toggleClass("ui-state-disabled",e)}},e.mobile.behaviors.formReset))}(e),function(e,t){function i(){return a||(a=e("<div></div>",{"class":"ui-slider-popup ui-shadow ui-corner-all"})),a.clone()}var a;e.widget("mobile.slider",e.mobile.slider,{options:{popupEnabled:!1,showValue:!1},_create:function(){this._super(),e.extend(this,{_currentValue:null,_popup:null,_popupVisible:!1}),this._setOption("popupEnabled",this.options.popupEnabled),this._on(this.handle,{vmousedown:"_showPopup"}),this._on(this.slider.add(this.document),{vmouseup:"_hidePopup"}),this._refresh()},_positionPopup:function(){var e=this.handle.offset();this._popup.offset({left:e.left+(this.handle.width()-this._popup.width())/2,top:e.top-this._popup.outerHeight()-5})},_setOption:function(e,t){this._super(e,t),"showValue"===e?this.handle.html(t&&!this.options.mini?this._value():""):"popupEnabled"===e&&t&&!this._popup&&(this._popup=i().addClass("ui-body-"+(this.options.theme||"a")).hide().insertBefore(this.element))},refresh:function(){this._super.apply(this,arguments),this._refresh()},_refresh:function(){var e,t=this.options;t.popupEnabled&&this.handle.removeAttr("title"),e=this._value(),e!==this._currentValue&&(this._currentValue=e,t.popupEnabled&&this._popup&&(this._positionPopup(),this._popup.html(e)),t.showValue&&!this.options.mini&&this.handle.html(e))},_showPopup:function(){this.options.popupEnabled&&!this._popupVisible&&(this.handle.html(""),this._popup.show(),this._positionPopup(),this._popupVisible=!0)},_hidePopup:function(){var e=this.options;e.popupEnabled&&this._popupVisible&&(e.showValue&&!e.mini&&this.handle.html(this._value()),this._popup.hide(),this._popupVisible=!1)}})}(e),function(e,t){e.widget("mobile.flipswitch",e.extend({options:{onText:"On",offText:"Off",theme:null,enhanced:!1,wrapperClass:null,corners:!0,mini:!1},_create:function(){this.options.enhanced?e.extend(this,{flipswitch:this.element.parent(),on:this.element.find(".ui-flipswitch-on").eq(0),off:this.element.find(".ui-flipswitch-off").eq(0),type:this.element.get(0).tagName}):this._enhance(),this._handleFormReset(),this._originalTabIndex=this.element.attr("tabindex"),null!=this._originalTabIndex&&this.on.attr("tabindex",this._originalTabIndex),this.element.attr("tabindex","-1"),this._on({focus:"_handleInputFocus"}),this.element.is(":disabled")&&this._setOptions({disabled:!0}),this._on(this.flipswitch,{click:"_toggle",swipeleft:"_left",swiperight:"_right"}),this._on(this.on,{keydown:"_keydown"}),this._on({change:"refresh"})},_handleInputFocus:function(){this.on.focus()},widget:function(){return this.flipswitch},_left:function(){this.flipswitch.removeClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=0:this.element.prop("checked",!1),this.element.trigger("change")},_right:function(){this.flipswitch.addClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=1:this.element.prop("checked",!0),this.element.trigger("change")},_enhance:function(){var t=e("<div>"),i=this.options,a=this.element,n=i.theme?i.theme:"inherit",o=e("<a></a>",{href:"#"}),s=e("<span></span>"),r=a.get(0).tagName,l="INPUT"===r?i.onText:a.find("option").eq(1).text(),c="INPUT"===r?i.offText:a.find("option").eq(0).text();o.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit").text(l),s.addClass("ui-flipswitch-off").text(c),t.addClass("ui-flipswitch ui-shadow-inset ui-bar-"+n+" "+(i.wrapperClass?i.wrapperClass:"")+" "+(a.is(":checked")||a.find("option").eq(1).is(":selected")?"ui-flipswitch-active":"")+(a.is(":disabled")?" ui-state-disabled":"")+(i.corners?" ui-corner-all":"")+(i.mini?" ui-mini":"")).append(o,s),a.addClass("ui-flipswitch-input").after(t).appendTo(t),e.extend(this,{flipswitch:t,on:o,off:s,type:r})},_reset:function(){this.refresh()},refresh:function(){var e,t=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";e="SELECT"===this.type?this.element.get(0).selectedIndex>0?"_right":"_left":this.element.prop("checked")?"_right":"_left",e!==t&&this[e]()},_toggle:function(){var e=this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right";this[e]()},_keydown:function(t){t.which===e.mobile.keyCode.LEFT?this._left():t.which===e.mobile.keyCode.RIGHT?this._right():t.which===e.mobile.keyCode.SPACE&&(this._toggle(),t.preventDefault())},_setOptions:function(e){if(e.theme!==t){var i=e.theme?e.theme:"inherit",a=e.theme?e.theme:"inherit";this.widget().removeClass("ui-bar-"+i).addClass("ui-bar-"+a)}e.onText!==t&&this.on.text(e.onText),e.offText!==t&&this.off.text(e.offText),e.disabled!==t&&this.widget().toggleClass("ui-state-disabled",e.disabled),e.mini!==t&&this.widget().toggleClass("ui-mini",e.mini),e.corners!==t&&this.widget().toggleClass("ui-corner-all",e.corners),this._super(e)},_destroy:function(){this.options.enhanced||(null!=this._originalTabIndex?this.element.attr("tabindex",this._originalTabIndex):this.element.removeAttr("tabindex"),this.on.remove(),this.off.remove(),this.element.unwrap(),this.flipswitch.remove(),this.removeClass("ui-flipswitch-input"))}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.rangeslider",e.extend({options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!0},_create:function(){var t=this.element,i=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",a=t.find("input").first(),n=t.find("input").last(),o=t.find("label").first(),s=e.data(a.get(0),"mobile-slider")||e.data(a.slider().get(0),"mobile-slider"),r=e.data(n.get(0),"mobile-slider")||e.data(n.slider().get(0),"mobile-slider"),l=s.slider,c=r.slider,d=s.handle,u=e("<div class='ui-rangeslider-sliders' />").appendTo(t);a.addClass("ui-rangeslider-first"),n.addClass("ui-rangeslider-last"),t.addClass(i),l.appendTo(u),c.appendTo(u),o.insertBefore(t),d.prependTo(c),e.extend(this,{_inputFirst:a,_inputLast:n,_sliderFirst:l,_sliderLast:c,_label:o,_targetVal:null,_sliderTarget:!1,_sliders:u,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(d,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var e=this;setTimeout(function(){e._updateHighlight()},0)},_dragFirstHandle:function(t){return e.data(this._inputFirst.get(0),"mobile-slider").dragging=!0,e.data(this._inputFirst.get(0),"mobile-slider").refresh(t),e.data(this._inputFirst.get(0),"mobile-slider")._trigger("start"),!1},_slidedrag:function(t){var i=e(t.target).is(this._inputFirst),a=i?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&i||"last"===this._proxy&&!i?(e.data(a.get(0),"mobile-slider").dragging=!0,e.data(a.get(0),"mobile-slider").refresh(t),!1):void 0},_slidestop:function(t){var i=e(t.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",i?1:"")},_slidebeforestart:function(t){this._sliderTarget=!1,e(t.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=e(t.target).val())},_setOptions:function(e){e.theme!==t&&this._setTheme(e.theme),e.trackTheme!==t&&this._setTrackTheme(e.trackTheme),e.mini!==t&&this._setMini(e.mini),e.highlight!==t&&this._setHighlight(e.highlight),e.disabled!==t&&this._setDisabled(e.disabled),this._super(e),this.refresh()},refresh:function(){var e=this.element,t=this.options;(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled"))&&(this.options.disabled=!0),e.find("input").slider({theme:t.theme,trackTheme:t.trackTheme,disabled:t.disabled,corners:t.corners,mini:t.mini,highlight:t.highlight}).slider("refresh"),this._updateHighlight()},_change:function(t){if("keyup"===t.type)return this._updateHighlight(),!1;var i=this,a=parseFloat(this._inputFirst.val(),10),n=parseFloat(this._inputLast.val(),10),o=e(t.target).hasClass("ui-rangeslider-first"),s=o?this._inputFirst:this._inputLast,r=o?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===t.type&&!e(t.target).hasClass("ui-slider-handle"))s.blur();else if("mousedown"===t.type)return;return a>n&&!this._sliderTarget?(s.val(o?n:a).slider("refresh"),this._trigger("normalize")):a>n&&(s.val(this._targetVal).slider("refresh"),setTimeout(function(){r.val(o?a:n).slider("refresh"),e.data(r.get(0),"mobile-slider").handle.focus(),i._sliderFirst.css("z-index",o?"":1),i._trigger("normalize")},0),this._proxy=o?"first":"last"),a===n?(e.data(s.get(0),"mobile-slider").handle.css("z-index",1),e.data(r.get(0),"mobile-slider").handle.css("z-index",0)):(e.data(r.get(0),"mobile-slider").handle.css("z-index",""),e.data(s.get(0),"mobile-slider").handle.css("z-index","")),this._updateHighlight(),a>=n?!1:void 0},_updateHighlight:function(){var t=parseInt(e.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),i=parseInt(e.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10),a=i-t;this.element.find(".ui-slider-bg").css({"margin-left":t+"%",width:a+"%"})},_setTheme:function(e){this._inputFirst.slider("option","theme",e),this._inputLast.slider("option","theme",e)},_setTrackTheme:function(e){this._inputFirst.slider("option","trackTheme",e),this._inputLast.slider("option","trackTheme",e)},_setMini:function(e){this._inputFirst.slider("option","mini",e),this._inputLast.slider("option","mini",e),this.element.toggleClass("ui-mini",!!e)},_setHighlight:function(e){this._inputFirst.slider("option","highlight",e),this._inputLast.slider("option","highlight",e)},_setDisabled:function(e){this._inputFirst.prop("disabled",e),this._inputLast.prop("disabled",e)},_destroy:function(){this._label.prependTo(this.element),this.element.removeClass("ui-rangeslider ui-mini"),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.textinput",e.mobile.textinput,{options:{clearBtn:!1,clearBtnText:"Clear text"},_create:function(){this._super(),this.isSearch&&(this.options.clearBtn=!0),this.options.clearBtn&&this.inputNeedsWrap&&this._addClearBtn()},clearButton:function(){return e("<a href='#' tabindex='-1' aria-hidden='true' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all'></a>").attr("title",this.options.clearBtnText).text(this.options.clearBtnText)},_clearBtnClick:function(e){this.element.val("").focus().trigger("change"),this._clearBtn.addClass("ui-input-clear-hidden"),e.preventDefault()},_addClearBtn:function(){this.options.enhanced||this._enhanceClear(),e.extend(this,{_clearBtn:this.widget().find("a.ui-input-clear")}),this._bindClearEvents(),this._toggleClear()},_enhanceClear:function(){this.clearButton().appendTo(this.widget()),this.widget().addClass("ui-input-has-clear")},_bindClearEvents:function(){this._on(this._clearBtn,{click:"_clearBtnClick"}),this._on({keyup:"_toggleClear",change:"_toggleClear",input:"_toggleClear",focus:"_toggleClear",blur:"_toggleClear",cut:"_toggleClear",paste:"_toggleClear"})},_unbindClear:function(){this._off(this._clearBtn,"click"),this._off(this.element,"keyup change input focus blur cut paste")},_setOptions:function(e){this._super(e),e.clearBtn===t||this.element.is("textarea, :jqmData(type='range')")||(e.clearBtn?this._addClearBtn():this._destroyClear()),e.clearBtnText!==t&&this._clearBtn!==t&&this._clearBtn.text(e.clearBtnText).attr("title",e.clearBtnText)},_toggleClear:function(){this._delay("_toggleClearClass",0)},_toggleClearClass:function(){this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val())},_destroyClear:function(){this.widget().removeClass("ui-input-has-clear"),this._unbindClear(),this._clearBtn.remove()},_destroy:function(){this._super(),this.options.clearBtn&&this._destroyClear()}})}(e),function(e,t){e.widget("mobile.textinput",e.mobile.textinput,{options:{autogrow:!0,keyupTimeoutBuffer:100},_create:function(){this._super(),this.options.autogrow&&this.isTextarea&&this._autogrow()},_autogrow:function(){this.element.addClass("ui-textinput-autogrow"),this._on({keyup:"_timeout",change:"_timeout",input:"_timeout",paste:"_timeout"}),this._on(!0,this.document,{pageshow:"_handleShow",popupbeforeposition:"_handleShow",updatelayout:"_handleShow",panelopen:"_handleShow"})},_handleShow:function(t){e.contains(t.target,this.element[0])&&this.element.is(":visible")&&("popupbeforeposition"!==t.type&&this.element.addClass("ui-textinput-autogrow-resize").animationComplete(e.proxy(function(){this.element.removeClass("ui-textinput-autogrow-resize")},this),"transition"),this._prepareHeightUpdate())},_unbindAutogrow:function(){this.element.removeClass("ui-textinput-autogrow"),this._off(this.element,"keyup change input paste"),this._off(this.document,"pageshow popupbeforeposition updatelayout panelopen")},keyupTimeout:null,_prepareHeightUpdate:function(e){this.keyupTimeout&&clearTimeout(this.keyupTimeout),e===t?this._updateHeight():this.keyupTimeout=this._delay("_updateHeight",e)},_timeout:function(){this._prepareHeightUpdate(this.options.keyupTimeoutBuffer)},_updateHeight:function(){var e,t,i,a,n,o,s,r,l,c=this.window.scrollTop();this.keyupTimeout=0,"onpage"in this.element[0]||this.element.css({height:0,"min-height":0,"max-height":0}),a=this.element[0].scrollHeight,n=this.element[0].clientHeight,o=parseFloat(this.element.css("border-top-width")),s=parseFloat(this.element.css("border-bottom-width")),r=o+s,l=a+r+15,0===n&&(e=parseFloat(this.element.css("padding-top")),t=parseFloat(this.element.css("padding-bottom")),i=e+t,l+=i),this.element.css({height:l,"min-height":"","max-height":""}),this.window.scrollTop(c)},refresh:function(){this.options.autogrow&&this.isTextarea&&this._updateHeight()},_setOptions:function(e){this._super(e),e.autogrow!==t&&this.isTextarea&&(e.autogrow?this._autogrow():this._unbindAutogrow())}})}(e),function(e,a){e.widget("mobile.selectmenu",e.extend({initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",options:{theme:null,icon:"carat-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!1,overlayTheme:null,dividerTheme:null,hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,mini:!1},_button:function(){return e("<div/>")},_setDisabled:function(e){return this.element.attr("disabled",e),this.button.attr("aria-disabled",e),this._setOption("disabled",e)},_focusButton:function(){var e=this;setTimeout(function(){e.button.focus()},40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var t=this.options.inline||this.element.jqmData("inline"),i=this.options.mini||this.element.jqmData("mini"),a="";~this.element[0].className.indexOf("ui-btn-left")&&(a=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(a=" ui-btn-right"),t&&(a+=" ui-btn-inline"),i&&(a+=" ui-mini"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+a+"'>"),this.selectId=this.select.attr("id")||"select-"+this.uuid,this.buttonId=this.selectId+"-button",this.label=e("label[for='"+this.selectId+"']"),this.isMultiple=this.select[0].multiple},_destroy:function(){var e=this.element.parents(".ui-select");e.length>0&&(e.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(e.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(e),e.remove())},_create:function(){this._preExtension(),this.button=this._button();var i=this,a=this.options,n=a.icon?a.iconpos||this.select.jqmData("iconpos"):!1,o=this.button.insertBefore(this.select).attr("id",this.buttonId).addClass("ui-btn"+(a.icon?" ui-icon-"+a.icon+" ui-btn-icon-"+n+(a.iconshadow?" ui-shadow-icon":""):"")+(a.theme?" ui-btn-"+a.theme:"")+(a.corners?" ui-corner-all":"")+(a.shadow?" ui-shadow":""));this.setButtonText(),a.nativeMenu&&t.opera&&t.opera.version&&o.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=e("<span>").addClass("ui-li-count ui-body-inherit").hide().appendTo(o.addClass("ui-li-has-count"))),(a.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change(function(){i.refresh(),a.nativeMenu&&i._delay(function(){i.select.blur()})}),this._handleFormReset(),this._on(this.button,{keydown:"_handleKeydown"}),this.build()},build:function(){var t=this;this.select.appendTo(t.button).bind("vmousedown",function(){t.button.addClass(e.mobile.activeBtnClass)}).bind("focus",function(){t.button.addClass(e.mobile.focusClass)}).bind("blur",function(){t.button.removeClass(e.mobile.focusClass)}).bind("focus vmouseover",function(){t.button.trigger("vmouseover")}).bind("vmousemove",function(){t.button.removeClass(e.mobile.activeBtnClass)}).bind("change blur vmouseout",function(){t.button.trigger("vmouseout").removeClass(e.mobile.activeBtnClass)}),t.button.bind("vmousedown",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.label.bind("click focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.select.bind("focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.button.bind("mouseup",function(){t.options.preventFocusZoom&&setTimeout(function(){e.mobile.zoom.enable(!0)},0)}),t.select.bind("blur",function(){t.options.preventFocusZoom&&e.mobile.zoom.enable(!0)})},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var e=this;return this.selected().map(function(){return e._selectOptions().index(this)}).get()},setButtonText:function(){var t=this,a=this.selected(),n=this.placeholder,o=e(i.createElement("span"));this.button.children("span").not(".ui-li-count").remove().end().end().prepend(function(){return n=a.length?a.map(function(){return e(this).text()}).get().join(", "):t.placeholder,n?o.text(n):o.html("&#160;"),o.addClass(t.select.attr("class")).addClass(a.attr("class")).removeClass("ui-screen-hidden")}())},setButtonCount:function(){var e=this.selected();this.isMultiple&&this.buttonCount[e.length>1?"show":"hide"]().text(e.length)},_handleKeydown:function(){this._delay("_refreshButton")},_reset:function(){this.refresh()},_refreshButton:function(){this.setButtonText(),this.setButtonCount()},refresh:function(){this._refreshButton()},open:e.noop,close:e.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-state-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-state-disabled")}},e.mobile.behaviors.formReset))}(e),function(e,t){e.mobile.links=function(t){e(t).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each(function(){var e=this,t=e.getAttribute("href").substring(1);t&&(e.setAttribute("aria-haspopup",!0),e.setAttribute("aria-owns",t),e.setAttribute("aria-expanded",!1))}).end().not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")}}(e),function(e,i){function a(e,t,i,a){var n=a;return n=t>e?i+(e-t)/2:Math.min(Math.max(i,a-t/2),i+e-t)}function n(e){return{x:e.scrollLeft(),y:e.scrollTop(),cx:e[0].innerWidth||e.width(),cy:e[0].innerHeight||e.height()}}e.widget("mobile.popup",{options:{wrapperClass:null,theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,enhanced:!1,history:!e.mobile.browser.oldIE},_handleDocumentVmousedown:function(t){this._isOpen&&e.contains(this._ui.container[0],t.target)&&this._ignoreResizeEvents()},_create:function(){var t=this.element,i=t.attr("id"),a=this.options;a.history=a.history&&e.mobile.ajaxEnabled&&e.mobile.hashListeningEnabled,this._on(this.document,{vmousedown:"_handleDocumentVmousedown"}),e.extend(this,{_scrollTop:0,_page:t.closest(".ui-page"),_ui:null,_fallbackTransition:"",_currentTransition:!1,_prerequisites:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),0===this._page.length&&(this._page=e("body")),a.enhanced?this._ui={container:t.parent(),screen:t.parent().prev(),placeholder:e(this.document[0].getElementById(i+"-placeholder"))}:(this._ui=this._enhance(t,i),this._applyTransition(a.transition)),this._setTolerance(a.tolerance)._ui.focusElement=this._ui.container,this._on(this._ui.screen,{vclick:"_eatEventAndClose"}),this._on(this.window,{orientationchange:e.proxy(this,"_handleWindowOrientationchange"),resize:e.proxy(this,"_handleWindowResize"),keyup:e.proxy(this,"_handleWindowKeyUp")}),this._on(this.document,{focusin:"_handleDocumentFocusIn"})},_enhance:function(t,i){var a=this.options,n=a.wrapperClass,o={screen:e("<div class='ui-screen-hidden ui-popup-screen "+this._themeClassFromOption("ui-overlay-",a.overlayTheme)+"'></div>"),placeholder:e("<div style='display: none;'><!-- placeholder --></div>"),container:e("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+(n?" "+n:"")+"'></div>")},s=this.document[0].createDocumentFragment();return s.appendChild(o.screen[0]),s.appendChild(o.container[0]),i&&(o.screen.attr("id",i+"-screen"),o.container.attr("id",i+"-popup"),o.placeholder.attr("id",i+"-placeholder").html("<!-- placeholder for "+i+" -->")),this._page[0].appendChild(s),o.placeholder.insertAfter(t),t.detach().addClass("ui-popup "+this._themeClassFromOption("ui-body-",a.theme)+" "+(a.shadow?"ui-overlay-shadow ":"")+(a.corners?"ui-corner-all ":"")).appendTo(o.container),o},_eatEventAndClose:function(e){return e.preventDefault(),e.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var e=this._ui.screen,t=this._ui.container.outerHeight(!0),i=e.removeAttr("style").height(),a=this.document.height()-1;a>i?e.height(a):t>i&&e.height(t)},_handleWindowKeyUp:function(t){return this._isOpen&&t.keyCode===e.mobile.keyCode.ESCAPE?this._eatEventAndClose(t):void 0},_expectResizeEvent:function(){var e=n(this.window);if(this._resizeData){if(e.x===this._resizeData.windowCoordinates.x&&e.y===this._resizeData.windowCoordinates.y&&e.cx===this._resizeData.windowCoordinates.cx&&e.cy===this._resizeData.windowCoordinates.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:this._delay("_resizeTimeout",200),windowCoordinates:e},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_stopIgnoringResizeEvents:function(){this._ignoreResizeTo=0},_ignoreResizeEvents:function(){this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(t){var i,a=t.target,n=this._ui;if(this._isOpen){if(a!==n.container[0]){if(i=e(a),!e.contains(n.container[0],a))return e(this.document[0].activeElement).one("focus",e.proxy(function(){this._safelyBlur(a)},this)),n.focusElement.focus(),t.preventDefault(),t.stopImmediatePropagation(),!1;n.focusElement[0]===n.container[0]&&(n.focusElement=i)}this._ignoreResizeEvents()}},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:e+"inherit"},_applyTransition:function(t){return t&&(this._ui.container.removeClass(this._fallbackTransition),"none"!==t&&(this._fallbackTransition=e.mobile._maybeDegradeTransition(t),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))),this},_setOptions:function(e){var t=this.options,a=this.element,n=this._ui.screen;return e.wrapperClass!==i&&this._ui.container.removeClass(t.wrapperClass).addClass(e.wrapperClass),e.theme!==i&&a.removeClass(this._themeClassFromOption("ui-body-",t.theme)).addClass(this._themeClassFromOption("ui-body-",e.theme)),e.overlayTheme!==i&&(n.removeClass(this._themeClassFromOption("ui-overlay-",t.overlayTheme)).addClass(this._themeClassFromOption("ui-overlay-",e.overlayTheme)),this._isOpen&&n.addClass("in")),e.shadow!==i&&a.toggleClass("ui-overlay-shadow",e.shadow),e.corners!==i&&a.toggleClass("ui-corner-all",e.corners),e.transition!==i&&(this._currentTransition||this._applyTransition(e.transition)),e.tolerance!==i&&this._setTolerance(e.tolerance),e.disabled!==i&&e.disabled&&this.close(),this._super(e)},_setTolerance:function(t){var a,n={t:30,r:15,b:30,l:15};if(t!==i)switch(a=String(t).split(","),e.each(a,function(e,t){a[e]=parseInt(t,10)}),a.length){case 1:isNaN(a[0])||(n.t=n.r=n.b=n.l=a[0]);break;case 2:isNaN(a[0])||(n.t=n.b=a[0]),isNaN(a[1])||(n.l=n.r=a[1]);break;case 4:isNaN(a[0])||(n.t=a[0]),isNaN(a[1])||(n.r=a[1]),isNaN(a[2])||(n.b=a[2]),isNaN(a[3])||(n.l=a[3])}return this._tolerance=n,this},_clampPopupWidth:function(e){var t,i=n(this.window),a={x:this._tolerance.l,y:i.y+this._tolerance.t,cx:i.cx-this._tolerance.l-this._tolerance.r,cy:i.cy-this._tolerance.t-this._tolerance.b};return e||this._ui.container.css("max-width",a.cx),t={cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)},{rc:a,menuSize:t}},_calculateFinalLocation:function(e,t){var i,n=t.rc,o=t.menuSize;return i={left:a(n.cx,o.cx,n.x,e.x),top:a(n.cy,o.cy,n.y,e.y)},i.top=Math.max(0,i.top),i.top-=Math.min(i.top,Math.max(0,i.top+o.cy-this.document.height())),i},_placementCoords:function(e){return this._calculateFinalLocation(e,this._clampPopupWidth())},_createPrerequisites:function(t,i,a){var n,o=this;n={screen:e.Deferred(),container:e.Deferred()},n.screen.then(function(){n===o._prerequisites&&t()}),n.container.then(function(){n===o._prerequisites&&i()}),e.when(n.screen,n.container).done(function(){n===o._prerequisites&&(o._prerequisites=null,a())}),o._prerequisites=n},_animate:function(t){return this._ui.screen.removeClass(t.classToRemove).addClass(t.screenClassToAdd),t.prerequisites.screen.resolve(),t.transition&&"none"!==t.transition&&(t.applyTransition&&this._applyTransition(t.transition),this._fallbackTransition)?void this._ui.container.addClass(t.containerClassToAdd).removeClass(t.classToRemove).animationComplete(e.proxy(t.prerequisites.container,"resolve")):(this._ui.container.removeClass(t.classToRemove),void t.prerequisites.container.resolve())},_desiredCoords:function(t){var i,a=null,o=n(this.window),s=t.x,r=t.y,l=t.positionTo;if(l&&"origin"!==l)if("window"===l)s=o.cx/2+o.x,
r=o.cy/2+o.y;else{try{a=e(l)}catch(c){a=null}a&&(a.filter(":visible"),0===a.length&&(a=null))}return a&&(i=a.offset(),s=i.left+a.outerWidth()/2,r=i.top+a.outerHeight()/2),("number"!==e.type(s)||isNaN(s))&&(s=o.cx/2+o.x),("number"!==e.type(r)||isNaN(r))&&(r=o.cy/2+o.y),{x:s,y:r}},_reposition:function(e){e={x:e.x,y:e.y,positionTo:e.positionTo},this._trigger("beforeposition",i,e),this._ui.container.offset(this._placementCoords(this._desiredCoords(e)))},reposition:function(e){this._isOpen&&this._reposition(e)},_safelyBlur:function(t){t!==this.window[0]&&"body"!==t.nodeName.toLowerCase()&&e(t).blur()},_openPrerequisitesComplete:function(){var t=this.element.attr("id"),i=this._ui.container.find(":focusable").first();this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),e.contains(this._ui.container[0],this.document[0].activeElement)||this._safelyBlur(this.document[0].activeElement),i.length>0&&(this._ui.focusElement=i),this._ignoreResizeEvents(),t&&this.document.find("[aria-haspopup='true'][aria-owns='"+t+"']").attr("aria-expanded",!0),this._trigger("afteropen")},_open:function(t){var i=e.extend({},this.options,t),a=function(){var e=navigator.userAgent,t=e.match(/AppleWebKit\/([0-9\.]+)/),i=!!t&&t[1],a=e.match(/Android (\d+(?:\.\d+))/),n=!!a&&a[1],o=e.indexOf("Chrome")>-1;return null!==a&&"4.0"===n&&i&&i>534.13&&!o?!0:!1}();this._createPrerequisites(e.noop,e.noop,e.proxy(this,"_openPrerequisitesComplete")),this._currentTransition=i.transition,this._applyTransition(i.transition),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-truncate"),this._reposition(i),this._ui.container.removeClass("ui-popup-hidden"),this.options.overlayTheme&&a&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:i.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prerequisites:this._prerequisites})},_closePrerequisiteScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrerequisiteContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style")},_closePrerequisitesDone:function(){var t=this._ui.container,a=this.element.attr("id");e.mobile.popup.active=i,e(":focus",t[0]).add(t[0]).blur(),a&&this.document.find("[aria-haspopup='true'][aria-owns='"+a+"']").attr("aria-expanded",!1),this._trigger("afterclose")},_close:function(t){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrerequisites(e.proxy(this,"_closePrerequisiteScreen"),e.proxy(this,"_closePrerequisiteContainer"),e.proxy(this,"_closePrerequisitesDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:t?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prerequisites:this._prerequisites})},_unenhance:function(){this.options.enhanced||(this._setOptions({theme:e.mobile.popup.prototype.options.theme}),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove())},_destroy:function(){return e.mobile.popup.active===this?(this.element.one("popupafterclose",e.proxy(this,"_unenhance")),this.close()):this._unenhance(),this},_closePopup:function(i,a){var n,o,s=this.options,r=!1;i&&i.isDefaultPrevented()||e.mobile.popup.active!==this||(t.scrollTo(0,this._scrollTop),i&&"pagebeforechange"===i.type&&a&&(n="string"==typeof a.toPage?a.toPage:a.toPage.jqmData("url"),n=e.mobile.path.parseUrl(n),o=n.pathname+n.search+n.hash,this._myUrl!==e.mobile.path.makeUrlAbsolute(o)?r=!0:i.preventDefault()),this.window.off(s.closeEvents),this.element.undelegate(s.closeLinkSelector,s.closeLinkEvents),this._close(r))},_bindContainerClose:function(){this.window.on(this.options.closeEvents,e.proxy(this,"_closePopup"))},widget:function(){return this._ui.container},open:function(t){var i,a,n,o,s,r,l=this,c=this.options;return e.mobile.popup.active||c.disabled?this:(e.mobile.popup.active=this,this._scrollTop=this.window.scrollTop(),c.history?(r=e.mobile.navigate.history,a=e.mobile.dialogHashKey,n=e.mobile.activePage,o=n?n.hasClass("ui-dialog"):!1,this._myUrl=i=r.getActive().url,(s=i.indexOf(a)>-1&&!o&&r.activeIndex>0)?(l._open(t),l._bindContainerClose(),this):(-1!==i.indexOf(a)||o?i=e.mobile.path.parseLocation().hash+a:i+=i.indexOf("#")>-1?a:"#"+a,this.window.one("beforenavigate",function(e){e.preventDefault(),l._open(t),l._bindContainerClose()}),this.urlAltered=!0,e.mobile.navigate(i,{role:"dialog"}),this)):(l._open(t),l._bindContainerClose(),l.element.delegate(c.closeLinkSelector,c.closeLinkEvents,function(e){l.close(),e.preventDefault()}),this))},close:function(){return e.mobile.popup.active!==this?this:(this._scrollTop=this.window.scrollTop(),this.options.history&&this.urlAltered?(e.mobile.back(),this.urlAltered=!1):this._closePopup(),this)}}),e.mobile.popup.handleLink=function(t){var i,a=e.mobile.path,n=e(a.hashToSelector(a.parseUrl(t.attr("href")).hash)).first();n.length>0&&n.data("mobile-popup")&&(i=t.offset(),n.popup("open",{x:i.left+t.outerWidth()/2,y:i.top+t.outerHeight()/2,transition:t.jqmData("transition"),positionTo:t.jqmData("position-to")})),setTimeout(function(){t.removeClass(e.mobile.activeBtnClass)},300)},e.mobile.document.on("pagebeforechange",function(t,i){"popup"===i.options.role&&(e.mobile.popup.handleLink(i.options.link),t.preventDefault())})}(e),function(e,t){var a=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",n=function(e,t,i){var n=e[i+"All"]().not(a).first();n.length&&(t.blur().attr("tabindex","-1"),n.find("a").first().focus())};e.widget("mobile.selectmenu",e.mobile.selectmenu,{_create:function(){var e=this.options;return e.nativeMenu=e.nativeMenu||this.element.parents(":jqmData(role='popup'),:mobile-popup").length>0,this._super()},_handleSelectFocus:function(){this.element.blur(),this.button.focus()},_handleKeydown:function(e){this._super(e),this._handleButtonVclickKeydown(e)},_handleButtonVclickKeydown:function(t){this.options.disabled||this.isOpen||this.options.nativeMenu||("vclick"===t.type||t.keyCode&&(t.keyCode===e.mobile.keyCode.ENTER||t.keyCode===e.mobile.keyCode.SPACE))&&(this._decideFormat(),"overlay"===this.menuType?this.button.attr("href","#"+this.popupId).attr("data-"+(e.mobile.ns||"")+"rel","popup"):this.button.attr("href","#"+this.dialogId).attr("data-"+(e.mobile.ns||"")+"rel","dialog"),this.isOpen=!0)},_handleListFocus:function(t){var i="focusin"===t.type?{tabindex:"0",event:"vmouseover"}:{tabindex:"-1",event:"vmouseout"};e(t.target).attr("tabindex",i.tabindex).trigger(i.event)},_handleListKeydown:function(t){var i=e(t.target),a=i.closest("li");switch(t.keyCode){case 38:return n(a,i,"prev"),!1;case 40:return n(a,i,"next"),!1;case 13:case 32:return i.trigger("click"),!1}},_handleMenuPageHide:function(){this._delayedTrigger(),this.thisPage.page("bindRemove")},_handleHeaderCloseClick:function(){return"overlay"===this.menuType?(this.close(),!1):void 0},_handleListItemClick:function(t){var i=e(t.target).closest("li"),a=this.select[0].selectedIndex,n=e.mobile.getAttribute(i,"option-index"),o=this._selectOptions().eq(n)[0];o.selected=this.isMultiple?!o.selected:!0,this.isMultiple&&i.find("a").toggleClass("ui-checkbox-on",o.selected).toggleClass("ui-checkbox-off",!o.selected),this.isMultiple||a===n||(this._triggerChange=!0),this.isMultiple?(this.select.trigger("change"),this.list.find("li:not(.ui-li-divider)").eq(n).find("a").first().focus()):this.close(),t.preventDefault()},build:function(){var i,a,n,o,s,r,l,c,d,u,h,p,f,g,m,v,b,w,_,y=this.options;return y.nativeMenu?this._super():(i=this.selectId,a=i+"-listbox",n=i+"-dialog",o=this.label,s=this.element.closest(".ui-page"),r=this.element[0].multiple,l=i+"-menu",c=y.theme?" data-"+e.mobile.ns+"theme='"+y.theme+"'":"",d=y.overlayTheme||y.theme||null,u=d?" data-"+e.mobile.ns+"overlay-theme='"+d+"'":"",h=y.dividerTheme&&r?" data-"+e.mobile.ns+"divider-theme='"+y.dividerTheme+"'":"",p=e("<div data-"+e.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+n+"'"+c+u+"><div data-"+e.mobile.ns+"role='header'><div class='ui-title'></div></div><div data-"+e.mobile.ns+"role='content'></div></div>"),f=e("<div"+c+u+" id='"+a+"' class='ui-selectmenu'></div>").insertAfter(this.select).popup(),g=e("<ul class='ui-selectmenu-list' id='"+l+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+c+h+"></ul>").appendTo(f),m=e("<div class='ui-header ui-bar-"+(y.theme?y.theme:"inherit")+"'></div>").prependTo(f),v=e("<h1 class='ui-title'></h1>").appendTo(m),this.isMultiple&&(_=e("<a>",{role:"button",text:y.closeText,href:"#","class":"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"}).appendTo(m)),e.extend(this,{selectId:i,menuId:l,popupId:a,dialogId:n,thisPage:s,menuPage:p,label:o,isMultiple:r,theme:y.theme,listbox:f,list:g,header:m,headerTitle:v,headerClose:_,menuPageContent:b,menuPageClose:w,placeholder:""}),this.refresh(),this._origTabIndex===t&&(this._origTabIndex=null===this.select[0].getAttribute("tabindex")?!1:this.select.attr("tabindex")),this.select.attr("tabindex","-1"),this._on(this.select,{focus:"_handleSelectFocus"}),this._on(this.button,{vclick:"_handleButtonVclickKeydown"}),this.list.attr("role","listbox"),this._on(this.list,{focusin:"_handleListFocus",focusout:"_handleListFocus",keydown:"_handleListKeydown","click li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)":"_handleListItemClick"}),this._on(this.menuPage,{pagehide:"_handleMenuPageHide"}),this._on(this.listbox,{popupafterclose:"_popupClosed"}),this.isMultiple&&this._on(this.headerClose,{click:"_handleHeaderCloseClick"}),this)},_popupClosed:function(){this.close(),this._delayedTrigger()},_delayedTrigger:function(){this._triggerChange&&this.element.trigger("change"),this._triggerChange=!1},_isRebuildRequired:function(){var e=this.list.find("li"),t=this._selectOptions().not(".ui-screen-hidden");return t.text()!==e.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(t){var i,a;return this.options.nativeMenu?this._super(t):(i=this,(t||this._isRebuildRequired())&&i._buildList(),a=this.selectedIndices(),i.setButtonText(),i.setButtonCount(),void i.list.find("li:not(.ui-li-divider)").find("a").removeClass(e.mobile.activeBtnClass).end().attr("aria-selected",!1).each(function(t){var n=e(this);e.inArray(t,a)>-1?(n.attr("aria-selected",!0),i.isMultiple?n.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on"):n.hasClass("ui-screen-hidden")?n.next().find("a").addClass(e.mobile.activeBtnClass):n.find("a").addClass(e.mobile.activeBtnClass)):i.isMultiple&&n.find("a").removeClass("ui-checkbox-on").addClass("ui-checkbox-off")}))},close:function(){if(!this.options.disabled&&this.isOpen){var e=this;"page"===e.menuType?(e.menuPage.dialog("close"),e.list.appendTo(e.listbox)):e.listbox.popup("close"),e._focusButton(),e.isOpen=!1}},open:function(){this.button.click()},_focusMenuItem:function(){var t=this.list.find("a."+e.mobile.activeBtnClass);0===t.length&&(t=this.list.find("li:not("+a+") a.ui-btn")),t.first().focus()},_decideFormat:function(){var t=this,i=this.window,a=t.list.parent(),n=a.outerHeight(),o=i.scrollTop(),s=t.button.offset().top,r=i.height();n>r-80||!e.support.scrollTop?(t.menuPage.appendTo(e.mobile.pageContainer).page(),t.menuPageContent=t.menuPage.find(".ui-content"),t.menuPageClose=t.menuPage.find(".ui-header a"),t.thisPage.unbind("pagehide.remove"),0===o&&s>r&&t.thisPage.one("pagehide",function(){e(this).jqmData("lastScroll",s)}),t.menuPage.one({pageshow:e.proxy(this,"_focusMenuItem"),pagehide:e.proxy(this,"close")}),t.menuType="page",t.menuPageContent.append(t.list),t.menuPage.find("div .ui-title").text(t.label.getEncodedText()||t.placeholder)):(t.menuType="overlay",t.listbox.one({popupafteropen:e.proxy(this,"_focusMenuItem")}))},_buildList:function(){var t,a,n,o,s,r,l,c,d,u,h,p,f,g,m=this,v=this.options,b=this.placeholder,w=!0,_="false",y="data-"+e.mobile.ns,x=y+"option-index",k=y+"icon",$=y+"role",C=y+"placeholder",S=i.createDocumentFragment(),T=!1;for(m.list.empty().filter(".ui-listview").listview("destroy"),t=this._selectOptions(),a=t.length,n=this.select[0],s=0;a>s;s++,T=!1)r=t[s],l=e(r),l.hasClass("ui-screen-hidden")||(c=r.parentNode,h=[],d=l.text(),u=i.createElement("a"),u.setAttribute("href","#"),u.appendChild(i.createTextNode(d)),c!==n&&"optgroup"===c.nodeName.toLowerCase()&&(p=c.getAttribute("label"),p!==o&&(f=i.createElement("li"),f.setAttribute($,"list-divider"),f.setAttribute("role","option"),f.setAttribute("tabindex","-1"),f.appendChild(i.createTextNode(p)),S.appendChild(f),o=p)),!w||r.getAttribute("value")&&0!==d.length&&!l.jqmData("placeholder")||(w=!1,T=!0,null===r.getAttribute(C)&&(this._removePlaceholderAttr=!0),r.setAttribute(C,!0),v.hidePlaceholderMenuItems&&h.push("ui-screen-hidden"),b!==d&&(b=m.placeholder=d)),g=i.createElement("li"),r.disabled&&(h.push("ui-state-disabled"),g.setAttribute("aria-disabled",!0)),g.setAttribute(x,s),g.setAttribute(k,_),T&&g.setAttribute(C,!0),g.className=h.join(" "),g.setAttribute("role","option"),u.setAttribute("tabindex","-1"),this.isMultiple&&e(u).addClass("ui-btn ui-checkbox-off ui-btn-icon-right"),g.appendChild(u),S.appendChild(g));m.list[0].appendChild(S),this.isMultiple||b.length?this.headerTitle.text(this.placeholder):this.header.addClass("ui-screen-hidden"),m.list.listview()},_button:function(){return this.options.nativeMenu?this._super():e("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.options.nativeMenu||(this.close(),this._origTabIndex!==t&&(this._origTabIndex!==!1?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+e.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove()),this._super()}})}(e),function(e,t){function i(e,t){var i=t?t:[];return i.push("ui-btn"),e.theme&&i.push("ui-btn-"+e.theme),e.icon&&(i=i.concat(["ui-icon-"+e.icon,"ui-btn-icon-"+e.iconpos]),e.iconshadow&&i.push("ui-shadow-icon")),e.inline&&i.push("ui-btn-inline"),e.shadow&&i.push("ui-shadow"),e.corners&&i.push("ui-corner-all"),e.mini&&i.push("ui-mini"),i}function a(e){var i,a,n,s=!1,r=!0,l={icon:"",inline:!1,shadow:!1,corners:!1,iconshadow:!1,mini:!1},c=[];for(e=e.split(" "),i=0;i<e.length;i++)n=!0,a=o[e[i]],a!==t?(n=!1,l[a]=!0):0===e[i].indexOf("ui-btn-icon-")?(n=!1,r=!1,l.iconpos=e[i].substring(12)):0===e[i].indexOf("ui-icon-")?(n=!1,l.icon=e[i].substring(8)):0===e[i].indexOf("ui-btn-")&&8===e[i].length?(n=!1,l.theme=e[i].substring(7)):"ui-btn"===e[i]&&(n=!1,s=!0),n&&c.push(e[i]);return r&&(l.icon=""),{options:l,unknownClasses:c,alreadyEnhanced:s}}function n(e){return"-"+e.toLowerCase()}var o={"ui-shadow":"shadow","ui-corner-all":"corners","ui-btn-inline":"inline","ui-shadow-icon":"iconshadow","ui-mini":"mini"},s=function(){var i=e.mobile.getAttribute.apply(this,arguments);return null==i?t:i},r=/[A-Z]/g;e.fn.buttonMarkup=function(o,l){var c,d,u,h,p,f=e.fn.buttonMarkup.defaults;for(c=0;c<this.length;c++){if(u=this[c],d=l?{alreadyEnhanced:!1,unknownClasses:[]}:a(u.className),h=e.extend({},d.alreadyEnhanced?d.options:{},o),!d.alreadyEnhanced)for(p in f)h[p]===t&&(h[p]=s(u,p.replace(r,n)));u.className=i(e.extend({},f,h),d.unknownClasses).join(" "),"button"!==u.tagName.toLowerCase()&&u.setAttribute("role","button")}return this},e.fn.buttonMarkup.defaults={icon:"",iconpos:"left",theme:null,inline:!1,shadow:!0,corners:!0,iconshadow:!1,mini:!1},e.extend(e.fn.buttonMarkup,{initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button:not(:jqmData(role='navbar') button)"})}(e),function(e,t){e.widget("mobile.controlgroup",e.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var t=this.element,i=this.options,a=e.mobile.page.prototype.keepNativeSelector();e.fn.buttonMarkup&&this.element.find(e.fn.buttonMarkup.initSelector).not(a).buttonMarkup(),e.each(this._childWidgets,e.proxy(function(t,i){e.mobile[i]&&this.element.find(e.mobile[i].initSelector).not(a)[i]()},this)),e.extend(this,{_ui:null,_initialRefresh:!0}),i.enhanced?this._ui={groupLegend:t.children(".ui-controlgroup-label").children(),childWrapper:t.children(".ui-controlgroup-controls")}:this._ui=this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(e){return e?"none"===e?"":"ui-group-theme-"+e:""},_enhance:function(){var t=this.element,i=this.options,a={groupLegend:t.children("legend"),childWrapper:t.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===i.type?"horizontal":"vertical")+" "+this._themeClassFromOption(i.theme)+" "+(i.corners?"ui-corner-all ":"")+(i.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(i.shadow===!0?"ui-shadow":"")+"'></div>").children()};return a.groupLegend.length>0&&e("<div role='heading' class='ui-controlgroup-label'></div>").append(a.groupLegend).prependTo(t),a},_init:function(){this.refresh()},_setOptions:function(e){var i,a,n=this.element;return e.type!==t&&(n.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===e.type?"horizontal":"vertical")),i=!0),e.theme!==t&&n.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(e.theme)),e.corners!==t&&n.toggleClass("ui-corner-all",e.corners),e.mini!==t&&n.toggleClass("ui-mini",e.mini),e.shadow!==t&&this._ui.childWrapper.toggleClass("ui-shadow",e.shadow),e.excludeInvisible!==t&&(this.options.excludeInvisible=e.excludeInvisible,i=!0),a=this._super(e),i&&this.refresh(),a},container:function(){return this._ui.childWrapper},refresh:function(){var t=this.container(),i=t.find(".ui-btn").not(".ui-slider-handle"),a=this._initialRefresh;e.mobile.checkboxradio&&t.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(i,this.options.excludeInvisible?this._getVisibles(i,a):i,a),this._initialRefresh=!1},_destroy:function(){var e,t,i=this.options;return i.enhanced?this:(e=this._ui,t=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(i.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(t),e.groupLegend.unwrap(),void e.childWrapper.children().unwrap())}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e,t){e.widget("mobile.toolbar",{initSelector:":jqmData(role='footer'), :jqmData(role='header')",options:{theme:null,addBackBtn:!1,backBtnTheme:null,backBtnText:"Back"},_create:function(){var t,i,a=this.element.is(":jqmData(role='header')")?"header":"footer",n=this.element.closest(".ui-page");0===n.length&&(n=!1,this._on(this.document,{pageshow:"refresh"})),e.extend(this,{role:a,page:n,leftbtn:t,rightbtn:i}),this.element.attr("role","header"===a?"banner":"contentinfo").addClass("ui-"+a),this.refresh(),this._setOptions(this.options)},_setOptions:function(e){if(e.addBackBtn!==t&&this._updateBackButton(),null!=e.backBtnTheme&&this.element.find(".ui-toolbar-back-btn").addClass("ui-btn ui-btn-"+e.backBtnTheme),e.backBtnText!==t&&this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(e.backBtnText),e.theme!==t){var i=this.options.theme?this.options.theme:"inherit",a=e.theme?e.theme:"inherit";this.element.removeClass("ui-bar-"+i).addClass("ui-bar-"+a)}this._super(e)},refresh:function(){"header"===this.role&&this._addHeaderButtonClasses(),this.page||(this._setRelative(),"footer"===this.role?this.element.appendTo("body"):"header"===this.role&&this._updateBackButton()),this._addHeadingClasses(),this._btnMarkup()},_setRelative:function(){e("[data-"+e.mobile.ns+"role='page']").css({position:"relative"})},_btnMarkup:function(){this.element.children("a").filter(":not([data-"+e.mobile.ns+"role='none'])").attr("data-"+e.mobile.ns+"role","button"),this.element.trigger("create")},_addHeaderButtonClasses:function(){var e=this.element.children("a, button");this.leftbtn=e.hasClass("ui-btn-left")&&!e.hasClass("ui-toolbar-back-btn"),this.rightbtn=e.hasClass("ui-btn-right"),this.leftbtn=this.leftbtn||e.eq(0).not(".ui-btn-right,.ui-toolbar-back-btn").addClass("ui-btn-left").length,this.rightbtn=this.rightbtn||e.eq(1).addClass("ui-btn-right").length},_updateBackButton:function(){var t,i=this.options,a=i.backBtnTheme||i.theme;t=this._backButton=this._backButton||{},this.options.addBackBtn&&"header"===this.role&&e(".ui-page").length>1&&(this.page?this.page[0].getAttribute("data-"+e.mobile.ns+"url")!==e.mobile.path.stripHash(location.hash):e.mobile.navigate&&e.mobile.navigate.history&&e.mobile.navigate.history.activeIndex>0)&&!this.leftbtn?t.attached||(this.backButton=t.element=(t.element||e("<a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left "+(a?"ui-btn-"+a+" ":"")+"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-"+e.mobile.ns+"rel='back'>"+i.backBtnText+"</a>")).prependTo(this.element),t.attached=!0):t.element&&(t.element.detach(),t.attached=!1)},_addHeadingClasses:function(){this.element.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})},_destroy:function(){var e;this.element.children("h1, h2, h3, h4, h5, h6").removeClass("ui-title").removeAttr("role").removeAttr("aria-level"),"header"===this.role&&(this.element.children("a, button").removeClass("ui-btn-left ui-btn-right ui-btn ui-shadow ui-corner-all"),this.backButton&&this.backButton.remove()),e=this.options.theme?this.options.theme:"inherit",this.element.removeClass("ui-bar-"+e),this.element.removeClass("ui-"+this.role).removeAttr("role")}})}(e),function(e,t){e.widget("mobile.toolbar",e.mobile.toolbar,{options:{position:null,visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!e.support.fixedPosition}},_create:function(){this._super(),this.pagecontainer=e(":mobile-pagecontainer"),"fixed"!==this.options.position||this.options.supportBlacklist()||this._makeFixed()},_makeFixed:function(){this.element.addClass("ui-"+this.role+"-fixed"),this.updatePagePadding(),this._addTransitionClass(),this._bindPageEvents(),this._bindToggleHandlers()},_setOptions:function(i){if("fixed"===i.position&&"fixed"!==this.options.position&&this._makeFixed(),"fixed"===this.options.position&&!this.options.supportBlacklist()){var a=this.page?this.page:e(".ui-page-active").length>0?e(".ui-page-active"):e(".ui-page").eq(0);i.fullscreen!==t&&(i.fullscreen?(this.element.addClass("ui-"+this.role+"-fullscreen"),a.addClass("ui-page-"+this.role+"-fullscreen")):(this.element.removeClass("ui-"+this.role+"-fullscreen"),a.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed")))}this._super(i)},_addTransitionClass:function(){var e=this.options.transition;e&&"none"!==e&&("slide"===e&&(e=this.element.hasClass("ui-header")?"slidedown":"slideup"),this.element.addClass(e))},_bindPageEvents:function(){var e=this.page?this.element.closest(".ui-page"):this.document;this._on(e,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var t=this.options;t.disablePageZoom&&e.mobile.zoom.disable(!0),t.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this.page?this.page:".ui-page-active")},_handlePageShow:function(){this.updatePagePadding(this.page?this.page:".ui-page-active"),this.options.updatePagePadding&&this._on(this.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(t,i){var a,n,o,s,r=this.options;r.disablePageZoom&&e.mobile.zoom.enable(!0),r.updatePagePadding&&this._off(this.window,"throttledresize"),r.trackPersistentToolbars&&(a=e(".ui-footer-fixed:jqmData(id)",this.page),n=e(".ui-header-fixed:jqmData(id)",this.page),o=a.length&&i.nextPage&&e(".ui-footer-fixed:jqmData(id='"+a.jqmData("id")+"')",i.nextPage)||e(),s=n.length&&i.nextPage&&e(".ui-header-fixed:jqmData(id='"+n.jqmData("id")+"')",i.nextPage)||e(),(o.length||s.length)&&(o.add(s).appendTo(e.mobile.pageContainer),i.nextPage.one("pageshow",function(){s.prependTo(this),o.appendTo(this)})))},_visible:!0,updatePagePadding:function(i){var a=this.element,n="header"===this.role,o=parseFloat(a.css(n?"top":"bottom"));this.options.fullscreen||(i=i&&i.type===t&&i||this.page||a.closest(".ui-page"),i=this.page?this.page:".ui-page-active",e(i).css("padding-"+(n?"top":"bottom"),a.outerHeight()+o))},_useTransition:function(t){var i=this.window,a=this.element,n=i.scrollTop(),o=a.height(),s=this.page?a.closest(".ui-page").height():e(".ui-page-active").height(),r=e.mobile.getScreenHeight();return!t&&(this.options.transition&&"none"!==this.options.transition&&("header"===this.role&&!this.options.fullscreen&&n>o||"footer"===this.role&&!this.options.fullscreen&&s-o>n+r)||this.options.fullscreen)},show:function(e){var t="ui-fixed-hidden",i=this.element;this._useTransition(e)?i.removeClass("out "+t).addClass("in").animationComplete(function(){i.removeClass("in")}):i.removeClass(t),this._visible=!0},hide:function(e){var t="ui-fixed-hidden",i=this.element,a="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(e)?i.addClass(a).removeClass("in").animationComplete(function(){i.addClass(t).removeClass(a)}):i.addClass(t).removeClass(a),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var t,i,a=this,n=a.options,o=!0,s=this.page?this.page:e(".ui-page");s.bind("vclick",function(t){n.tapToggle&&!e(t.target).closest(n.tapToggleBlacklist).length&&a.toggle()}).bind("focusin focusout",function(s){screen.width<1025&&e(s.target).is(n.hideDuringFocus)&&!e(s.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==s.type||o?"focusin"===s.type&&o&&(clearTimeout(t),o=!1,i=setTimeout(function(){a.hide()},0)):(o=!0,clearTimeout(i),t=setTimeout(function(){a.show()},0)))})},_setRelative:function(){"fixed"!==this.options.position&&e("[data-"+e.mobile.ns+"role='page']").css({position:"relative"})},_destroy:function(){var t,i,a,n,o,s=this.pagecontainer.pagecontainer("getActivePage");this._super(),"fixed"===this.options.position&&(a=e("body>.ui-"+this.role+"-fixed").add(s.find(".ui-"+this.options.role+"-fixed")).not(this.element).length>0,o=e("body>.ui-"+this.role+"-fixed").add(s.find(".ui-"+this.options.role+"-fullscreen")).not(this.element).length>0,i="ui-header-fixed ui-footer-fixed ui-header-fullscreen in out ui-footer-fullscreen fade slidedown slideup ui-fixed-hidden",this.element.removeClass(i),o||(t="ui-page-"+this.role+"-fullscreen"),a||(n="header"===this.role,t+=" ui-page-"+this.role+"-fixed",s.css("padding-"+(n?"top":"bottom"),"")),s.removeClass(t))}})}(e),function(e,t){e.widget("mobile.toolbar",e.mobile.toolbar,{_makeFixed:function(){this._super(),this._workarounds()},_workarounds:function(){var e=navigator.userAgent,t=navigator.platform,i=e.match(/AppleWebKit\/([0-9]+)/),a=!!i&&i[1],n=null,o=this;if(t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1||t.indexOf("iPod")>-1)n="ios";else{if(!(e.indexOf("Android")>-1))return;n="android"}if("ios"===n)o._bindScrollWorkaround();else{if(!("android"===n&&a&&534>a))return;o._bindScrollWorkaround(),o._bindListThumbWorkaround()}},_viewportOffset:function(){var e=this.element,t=e.hasClass("ui-header"),i=Math.abs(e.offset().top-this.window.scrollTop());return t||(i=Math.round(i-this.window.height()+e.outerHeight())-60),i},_bindScrollWorkaround:function(){var e=this;this._on(this.window,{scrollstop:function(){var t=e._viewportOffset();t>2&&e._visible&&e._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var t=parseFloat(e(".ui-page-active").css("padding-bottom"));e(".ui-page-active").css("padding-bottom",t+1+"px"),setTimeout(function(){e(".ui-page-active").css("padding-bottom",t+"px")},0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}})}(e),function(e,t){function i(){var e=n.clone(),t=e.eq(0),i=e.eq(1),a=i.children();return{arEls:i.add(t),gd:t,ct:i,ar:a}}var a=e.mobile.browser.oldIE&&e.mobile.browser.oldIE<=8,n=e("<div class='ui-popup-arrow-guide'></div><div class='ui-popup-arrow-container"+(a?" ie":"")+"'><div class='ui-popup-arrow'></div></div>");e.widget("mobile.popup",e.mobile.popup,{options:{arrow:""},_create:function(){var e,t=this._super();return this.options.arrow&&(this._ui.arrow=e=this._addArrow()),t},_addArrow:function(){var e,t=this.options,a=i();return e=this._themeClassFromOption("ui-body-",t.theme),a.ar.addClass(e+(t.shadow?" ui-overlay-shadow":"")),a.arEls.hide().appendTo(this.element),a},_unenhance:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()},_tryAnArrow:function(e,t,i,a,n){var o,s,r,l={},c={};return a.arFull[e.dimKey]>a.guideDims[e.dimKey]?n:(l[e.fst]=i[e.fst]+(a.arHalf[e.oDimKey]+a.menuHalf[e.oDimKey])*e.offsetFactor-a.contentBox[e.fst]+(a.clampInfo.menuSize[e.oDimKey]-a.contentBox[e.oDimKey])*e.arrowOffsetFactor,l[e.snd]=i[e.snd],o=a.result||this._calculateFinalLocation(l,a.clampInfo),s={x:o.left,y:o.top},c[e.fst]=s[e.fst]+a.contentBox[e.fst]+e.tipOffset,c[e.snd]=Math.max(o[e.prop]+a.guideOffset[e.prop]+a.arHalf[e.dimKey],Math.min(o[e.prop]+a.guideOffset[e.prop]+a.guideDims[e.dimKey]-a.arHalf[e.dimKey],i[e.snd])),r=Math.abs(i.x-c.x)+Math.abs(i.y-c.y),(!n||r<n.diff)&&(c[e.snd]-=a.arHalf[e.dimKey]+o[e.prop]+a.contentBox[e.snd],n={dir:t,diff:r,result:o,posProp:e.prop,posVal:c[e.snd]}),n)},_getPlacementState:function(e){var t,i,a=this._ui.arrow,n={clampInfo:this._clampPopupWidth(!e),arFull:{cx:a.ct.width(),cy:a.ct.height()},guideDims:{cx:a.gd.width(),cy:a.gd.height()},guideOffset:a.gd.offset()};return t=this.element.offset(),a.gd.css({left:0,top:0,right:0,bottom:0}),i=a.gd.offset(),n.contentBox={x:i.left-t.left,y:i.top-t.top,cx:a.gd.width(),cy:a.gd.height()},a.gd.removeAttr("style"),n.guideOffset={left:n.guideOffset.left-t.left,top:n.guideOffset.top-t.top},n.arHalf={cx:n.arFull.cx/2,cy:n.arFull.cy/2},n.menuHalf={cx:n.clampInfo.menuSize.cx/2,cy:n.clampInfo.menuSize.cy/2},n},_placementCoords:function(t){var i,n,o,s,r,l=this.options.arrow,c=this._ui.arrow;return c?(c.arEls.show(),r={},i=this._getPlacementState(!0),o={l:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-i.arHalf.cx,arrowOffsetFactor:0},r:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:i.arHalf.cx+i.contentBox.cx,arrowOffsetFactor:1},b:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:i.arHalf.cy+i.contentBox.cy,arrowOffsetFactor:1},t:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-i.arHalf.cy,arrowOffsetFactor:0}},e.each((l===!0?"l,t,r,b":l).split(","),e.proxy(function(e,a){n=this._tryAnArrow(o[a],a,t,i,n)},this)),n?(c.ct.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b").addClass("ui-popup-arrow-"+n.dir).removeAttr("style").css(n.posProp,n.posVal).show(),a||(s=this.element.offset(),r[o[n.dir].fst]=c.ct.offset(),r[o[n.dir].snd]={left:s.left+i.contentBox.x,top:s.top+i.contentBox.y}),n.result):(c.arEls.hide(),
this._super(t))):this._super(t)},_setOptions:function(e){var i,a=this.options.theme,n=this._ui.arrow,o=this._super(e);if(e.arrow!==t){if(!n&&e.arrow)return void(this._ui.arrow=this._addArrow());n&&!e.arrow&&(n.arEls.remove(),this._ui.arrow=null)}return n=this._ui.arrow,n&&(e.theme!==t&&(a=this._themeClassFromOption("ui-body-",a),i=this._themeClassFromOption("ui-body-",e.theme),n.ar.removeClass(a).addClass(i)),e.shadow!==t&&n.ar.toggleClass("ui-overlay-shadow",e.shadow)),o},_destroy:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()}})}(e),function(e,i){e.widget("mobile.panel",{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pageContainer:"ui-panel-page-container",pageWrapper:"ui-panel-wrapper",pageFixedToolbar:"ui-panel-fixed-toolbar",pageContentPrefix:"ui-panel-page-content",animate:"ui-panel-animate"},animate:!0,theme:null,position:"left",dismissible:!0,display:"reveal",swipeClose:!0,positionFixed:!1},_closeLink:null,_parentPage:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbars:null,_create:function(){var t=this.element,i=t.closest(".ui-page, :jqmData(role='page')");e.extend(this,{_closeLink:t.find(":jqmData(rel='close')"),_parentPage:i.length>0?i:!1,_openedPage:null,_page:this._getPage,_panelInner:this._getPanelInner(),_fixedToolbars:this._getFixedToolbars}),"overlay"!==this.options.display&&this._getWrapper(),this._addPanelClasses(),e.support.cssTransform3d&&this.options.animate&&this.element.addClass(this.options.classes.animate),this._bindUpdateLayout(),this._bindCloseEvents(),this._bindLinkListeners(),this._bindPageEvents(),this.options.dismissible&&this._createModal(),this._bindSwipeEvents()},_getPanelInner:function(){var e=this.element.find("."+this.options.classes.panelInner);return 0===e.length&&(e=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent()),e},_createModal:function(){var t=this,i=t._parentPage?t._parentPage.parent():t.element.parent();t._modal=e("<div class='"+t.options.classes.modal+"'></div>").on("mousedown",function(){t.close()}).appendTo(i)},_getPage:function(){var t=this._openedPage||this._parentPage||e("."+e.mobile.activePageClass);return t},_getWrapper:function(){var e=this._page().find("."+this.options.classes.pageWrapper);0===e.length&&(e=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)").wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>").parent()),this._wrapper=e},_getFixedToolbars:function(){var t=e("body").children(".ui-header-fixed, .ui-footer-fixed"),i=this._page().find(".ui-header-fixed, .ui-footer-fixed"),a=t.add(i).addClass(this.options.classes.pageFixedToolbar);return a},_getPosDisplayClasses:function(e){return e+"-position-"+this.options.position+" "+e+"-display-"+this.options.display},_getPanelClasses:function(){var e=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed+" ui-body-"+(this.options.theme?this.options.theme:"inherit");return this.options.positionFixed&&(e+=" "+this.options.classes.panelFixed),e},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())},_handleCloseClick:function(e){e.isDefaultPrevented()||this.close()},_bindCloseEvents:function(){this._on(this._closeLink,{click:"_handleCloseClick"}),this._on({"click a:jqmData(ajax='false')":"_handleCloseClick"})},_positionPanel:function(t){var i=this,a=i._panelInner.outerHeight(),n=a>e.mobile.getScreenHeight();n||!i.options.positionFixed?(n&&(i._unfixPanel(),e.mobile.resetActivePageHeight(a)),t&&this.window[0].scrollTo(0,e.mobile.defaultHomeScroll)):i._fixPanel()},_bindFixListener:function(){this._on(e(t),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(e(t),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var e=this;e.element.on("updatelayout",function(){e._open&&e._positionPanel()})},_bindLinkListeners:function(){this._on("body",{"click a":"_handleClick"})},_handleClick:function(t){var a,n=this.element.attr("id");t.currentTarget.href.split("#")[1]===n&&n!==i&&(t.preventDefault(),a=e(t.target),a.hasClass("ui-btn")&&(a.addClass(e.mobile.activeBtnClass),this.element.one("panelopen panelclose",function(){a.removeClass(e.mobile.activeBtnClass)})),this.toggle())},_bindSwipeEvents:function(){var e=this,t=e._modal?e.element.add(e._modal):e.element;e.options.swipeClose&&("left"===e.options.position?t.on("swipeleft.panel",function(){e.close()}):t.on("swiperight.panel",function(){e.close()}))},_bindPageEvents:function(){var e=this;this.document.on("panelbeforeopen",function(t){e._open&&t.target!==e.element[0]&&e.close()}).on("keyup.panel",function(t){27===t.keyCode&&e._open&&e.close()}),this._parentPage||"overlay"===this.options.display||this._on(this.document,{pageshow:function(){this._openedPage=null,this._getWrapper()}}),e._parentPage?this.document.on("pagehide",":jqmData(role='page')",function(){e._open&&e.close(!0)}):this.document.on("pagebeforehide",function(){e._open&&e.close(!0)})},_open:!1,_pageContentOpenClasses:null,_modalOpenClasses:null,open:function(t){if(!this._open){var i=this,a=i.options,n=function(){i._off(i.document,"panelclose"),i._page().jqmData("panel","open"),e.support.cssTransform3d&&a.animate&&"overlay"!==a.display&&(i._wrapper.addClass(a.classes.animate),i._fixedToolbars().addClass(a.classes.animate)),!t&&e.support.cssTransform3d&&a.animate?(i._wrapper||i.element).animationComplete(o,"transition"):setTimeout(o,0),a.theme&&"overlay"!==a.display&&i._page().parent().addClass(a.classes.pageContainer+"-themed "+a.classes.pageContainer+"-"+a.theme),i.element.removeClass(a.classes.panelClosed).addClass(a.classes.panelOpen),i._positionPanel(!0),i._pageContentOpenClasses=i._getPosDisplayClasses(a.classes.pageContentPrefix),"overlay"!==a.display&&(i._page().parent().addClass(a.classes.pageContainer),i._wrapper.addClass(i._pageContentOpenClasses),i._fixedToolbars().addClass(i._pageContentOpenClasses)),i._modalOpenClasses=i._getPosDisplayClasses(a.classes.modal)+" "+a.classes.modalOpen,i._modal&&i._modal.addClass(i._modalOpenClasses).height(Math.max(i._modal.height(),i.document.height()))},o=function(){i._open&&("overlay"!==a.display&&(i._wrapper.addClass(a.classes.pageContentPrefix+"-open"),i._fixedToolbars().addClass(a.classes.pageContentPrefix+"-open")),i._bindFixListener(),i._trigger("open"),i._openedPage=i._page())};i._trigger("beforeopen"),"open"===i._page().jqmData("panel")?i._on(i.document,{panelclose:n}):n(),i._open=!0}},close:function(t){if(this._open){var i=this,a=this.options,n=function(){i.element.removeClass(a.classes.panelOpen),"overlay"!==a.display&&(i._wrapper.removeClass(i._pageContentOpenClasses),i._fixedToolbars().removeClass(i._pageContentOpenClasses)),!t&&e.support.cssTransform3d&&a.animate?(i._wrapper||i.element).animationComplete(o,"transition"):setTimeout(o,0),i._modal&&i._modal.removeClass(i._modalOpenClasses).height("")},o=function(){a.theme&&"overlay"!==a.display&&i._page().parent().removeClass(a.classes.pageContainer+"-themed "+a.classes.pageContainer+"-"+a.theme),i.element.addClass(a.classes.panelClosed),"overlay"!==a.display&&(i._page().parent().removeClass(a.classes.pageContainer),i._wrapper.removeClass(a.classes.pageContentPrefix+"-open"),i._fixedToolbars().removeClass(a.classes.pageContentPrefix+"-open")),e.support.cssTransform3d&&a.animate&&"overlay"!==a.display&&(i._wrapper.removeClass(a.classes.animate),i._fixedToolbars().removeClass(a.classes.animate)),i._fixPanel(),i._unbindFixListener(),e.mobile.resetActivePageHeight(),i._page().jqmRemoveData("panel"),i._trigger("close"),i._openedPage=null};i._trigger("beforeclose"),n(),i._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_destroy:function(){var t,i=this.options,a=e("body > :mobile-panel").length+e.mobile.activePage.find(":mobile-panel").length>1;"overlay"!==i.display&&(t=e("body > :mobile-panel").add(e.mobile.activePage.find(":mobile-panel")),0===t.not(".ui-panel-display-overlay").not(this.element).length&&this._wrapper.children().unwrap(),this._open&&(this._fixedToolbars().removeClass(i.classes.pageContentPrefix+"-open"),e.support.cssTransform3d&&i.animate&&this._fixedToolbars().removeClass(i.classes.animate),this._page().parent().removeClass(i.classes.pageContainer),i.theme&&this._page().parent().removeClass(i.classes.pageContainer+"-themed "+i.classes.pageContainer+"-"+i.theme))),a||this.document.off("panelopen panelclose"),this._open&&this._page().jqmRemoveData("panel"),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),i.classes.panelOpen,i.classes.animate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout"),this._modal&&this._modal.remove()}})}(e),function(e,t){e.widget("mobile.table",{options:{classes:{table:"ui-table"},enhanced:!1},_create:function(){this.options.enhanced||this.element.addClass(this.options.classes.table),e.extend(this,{headers:t,allHeaders:t}),this._refresh(!0)},_setHeaders:function(){var e=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children(),this.allHeaders=this.headers.add(e.children())},refresh:function(){this._refresh()},rebuild:e.noop,_refresh:function(){var t=this.element,i=t.find("thead tr");this._setHeaders(),i.each(function(){var a=0;e(this).children().each(function(){var n,o=parseInt(this.getAttribute("colspan"),10),s=":nth-child("+(a+1)+")";if(this.setAttribute("data-"+e.mobile.ns+"colstart",a+1),o)for(n=0;o-1>n;n++)a++,s+=", :nth-child("+(a+1)+")";e(this).jqmData("cells",t.find("tr").not(i.eq(0)).not(this).children(s)),a++})})}})}(e),function(e,t){e.widget("mobile.table",e.mobile.table,{options:{mode:"columntoggle",columnBtnTheme:null,columnPopupTheme:null,columnBtnText:"Columns...",classes:e.extend(e.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"})},_create:function(){this._super(),"columntoggle"===this.options.mode&&(e.extend(this,{_menu:null}),this.options.enhanced?(this._menu=e(this.document[0].getElementById(this._id()+"-popup")).children().first(),this._addToggles(this._menu,!0)):(this._menu=this._enhanceColToggle(),this.element.addClass(this.options.classes.columnToggleTable)),this._setupEvents(),this._setToggleState())},_id:function(){return this.element.attr("id")||this.widgetName+this.uuid},_setupEvents:function(){this._on(this.window,{throttledresize:"_setToggleState"}),this._on(this._menu,{"change input":"_menuInputChange"})},_addToggles:function(t,i){var a,n=0,o=this.options,s=t.controlgroup("container");i?a=t.find("input"):s.empty(),this.headers.not("td").each(function(){var t,r,l=e(this),c=e.mobile.getAttribute(this,"priority");c&&(r=l.add(l.jqmData("cells")),r.addClass(o.classes.priorityPrefix+c),t=(i?a.eq(n++):e("<label><input type='checkbox' checked />"+(l.children("abbr").first().attr("title")||l.text())+"</label>").appendTo(s).children(0).checkboxradio({theme:o.columnPopupTheme})).jqmData("header",l).jqmData("cells",r),l.jqmData("input",t))}),i||t.controlgroup("refresh")},_menuInputChange:function(t){var i=e(t.target),a=i[0].checked;i.jqmData("cells").toggleClass("ui-table-cell-hidden",!a).toggleClass("ui-table-cell-visible",a)},_unlockCells:function(e){e.removeClass("ui-table-cell-hidden ui-table-cell-visible")},_enhanceColToggle:function(){var t,i,a,n,o=this.element,s=this.options,r=e.mobile.ns,l=this.document[0].createDocumentFragment();return t=this._id()+"-popup",i=e("<a href='#"+t+"' class='"+s.classes.columnBtn+" ui-btn ui-btn-"+(s.columnBtnTheme||"a")+" ui-corner-all ui-shadow ui-mini' data-"+r+"rel='popup'>"+s.columnBtnText+"</a>"),a=e("<div class='"+s.classes.popup+"' id='"+t+"'></div>"),n=e("<fieldset></fieldset>").controlgroup(),this._addToggles(n,!1),n.appendTo(a),l.appendChild(a[0]),l.appendChild(i[0]),o.before(l),a.popup(),n},rebuild:function(){this._super(),"columntoggle"===this.options.mode&&this._refresh(!1)},_refresh:function(t){var i,a,n;if(this._super(t),!t&&"columntoggle"===this.options.mode)for(i=this.headers,a=[],this._menu.find("input").each(function(){var t=e(this),n=t.jqmData("header"),o=i.index(n[0]);o>-1&&!t.prop("checked")&&a.push(o)}),this._unlockCells(this.element.find(".ui-table-cell-hidden, .ui-table-cell-visible")),this._addToggles(this._menu,t),n=a.length-1;n>-1;n--)i.eq(a[n]).jqmData("input").prop("checked",!1).checkboxradio("refresh").trigger("change")},_setToggleState:function(){this._menu.find("input").each(function(){var t=e(this);this.checked="table-cell"===t.jqmData("cells").eq(0).css("display"),t.checkboxradio("refresh")})},_destroy:function(){this._super()}})}(e),function(e,t){e.widget("mobile.table",e.mobile.table,{options:{mode:"reflow",classes:e.extend(e.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"})},_create:function(){this._super(),"reflow"===this.options.mode&&(this.options.enhanced||(this.element.addClass(this.options.classes.reflowTable),this._updateReflow()))},rebuild:function(){this._super(),"reflow"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"reflow"!==this.options.mode||this._updateReflow()},_updateReflow:function(){var t=this,i=this.options;e(t.allHeaders.get().reverse()).each(function(){var a,n,o=e(this).jqmData("cells"),s=e.mobile.getAttribute(this,"colstart"),r=o.not(this).filter("thead th").length&&" ui-table-cell-label-top",l=e(this).clone().contents();l.length>0&&(r?(a=parseInt(this.getAttribute("colspan"),10),n="",a&&(n="td:nth-child("+a+"n + "+s+")"),t._addLabels(o.filter(n),i.classes.cellLabels+r,l)):t._addLabels(o,i.classes.cellLabels,l))})},_addLabels:function(t,i,a){1===a.length&&"abbr"===a[0].nodeName.toLowerCase()&&(a=a.eq(0).attr("title")),t.not(":has(b."+i+")").prepend(e("<b class='"+i+"'></b>").append(a))}})}(e),function(e,i){var a=function(t,i){return-1===(""+(e.mobile.getAttribute(this,"filtertext")||e(this).text())).toLowerCase().indexOf(i)};e.widget("mobile.filterable",{initSelector:":jqmData(filter='true')",options:{filterReveal:!1,filterCallback:a,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"},_create:function(){var t=this.options;e.extend(this,{_search:null,_timer:0}),this._setInput(t.input),t.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_onKeyUp:function(){var i,a,n=this._search;if(n){if(i=n.val().toLowerCase(),a=e.mobile.getAttribute(n[0],"lastval")+"",a&&a===i)return;this._timer&&(t.clearTimeout(this._timer),this._timer=0),this._timer=this._delay(function(){return this._trigger("beforefilter",null,{input:n})===!1?!1:(n[0].setAttribute("data-"+e.mobile.ns+"lastval",i),this._filterItems(i),void(this._timer=0))},250)}},_getFilterableItems:function(){var t=this.element,i=this.options.children,a=i?e.isFunction(i)?i():i.nodeName?e(i):i.jquery?i:this.element.find(i):{length:0};return 0===a.length&&(a=t.children()),a},_filterItems:function(t){var i,n,o,s,r=[],l=[],c=this.options,d=this._getFilterableItems();if(null!=t)for(n=c.filterCallback||a,o=d.length,i=0;o>i;i++)s=n.call(d[i],i,t)?l:r,s.push(d[i]);0===l.length?d[c.filterReveal&&0===t.length?"addClass":"removeClass"]("ui-screen-hidden"):(e(l).addClass("ui-screen-hidden"),e(r).removeClass("ui-screen-hidden")),this._refreshChildWidget(),this._trigger("filter",null,{items:d})},_refreshChildWidget:function(){var t,i,a=["collapsibleset","selectmenu","controlgroup","listview"];for(i=a.length-1;i>-1;i--)t=a[i],e.mobile[t]&&(t=this.element.data("mobile-"+t),t&&e.isFunction(t.refresh)&&t.refresh())},_setInput:function(i){var a=this._search;this._timer&&(t.clearTimeout(this._timer),this._timer=0),a&&(this._off(a,"keyup change input"),a=null),i&&(a=i.jquery?i:i.nodeName?e(i):this.document.find(i),this._on(a,{keydown:"_onKeyDown",keypress:"_onKeyPress",keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=a},_onKeyDown:function(t){t.keyCode===e.ui.keyCode.ENTER&&(t.preventDefault(),this._preventKeyPress=!0)},_onKeyPress:function(e){this._preventKeyPress&&(e.preventDefault(),this._preventKeyPress=!1)},_setOptions:function(e){var t=!(e.filterReveal===i&&e.filterCallback===i&&e.children===i);this._super(e),e.input!==i&&(this._setInput(e.input),t=!0),t&&this.refresh()},_destroy:function(){var e=this.options,t=this._getFilterableItems();e.enhanced?t.toggleClass("ui-screen-hidden",e.filterReveal):t.removeClass("ui-screen-hidden")},refresh:function(){this._timer&&(t.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}})}(e),function(e,t){var i=function(e,t){return function(i){t.call(this,i),e._syncTextInputOptions(i)}},a=/(^|\s)ui-li-divider(\s|$)/,n=e.mobile.filterable.prototype.options.filterCallback;e.mobile.filterable.prototype.options.filterCallback=function(e,t){return!this.className.match(a)&&n.call(this,e,t)},e.widget("mobile.filterable",e.mobile.filterable,{options:{filterPlaceholder:"Filter items...",filterTheme:null},_create:function(){var t,i,a=this.element,n=["collapsibleset","selectmenu","controlgroup","listview"],o={};for(this._super(),e.extend(this,{_widget:null}),t=n.length-1;t>-1;t--)if(i=n[t],e.mobile[i]){if(this._setWidget(a.data("mobile-"+i)))break;o[i+"create"]="_handleCreate"}this._widget||this._on(a,o)},_handleCreate:function(e){this._setWidget(this.element.data("mobile-"+e.type.substring(0,e.type.length-6)))},_trigger:function(e,t,i){return this._widget&&"mobile-listview"===this._widget.widgetFullName&&"beforefilter"===e&&this._widget._trigger("beforefilter",t,i),this._super(e,t,i)},_setWidget:function(e){return!this._widget&&e&&(this._widget=e,this._widget._setOptions=i(this,this._widget._setOptions)),this._widget&&(this._syncTextInputOptions(this._widget.options),"listview"===this._widget.widgetName&&(this._widget.options.hideDividers=!0,this._widget.element.listview("refresh"))),!!this._widget},_isSearchInternal:function(){return this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal")},_setInput:function(t){var i=this.options,a=!0,n={};if(!t){if(this._isSearchInternal())return;a=!1,t=e("<input data-"+e.mobile.ns+"type='search' placeholder='"+i.filterPlaceholder+"'></input>").jqmData("ui-filterable-"+this.uuid+"-internal",!0),e("<form class='ui-filterable'></form>").append(t).submit(function(e){e.preventDefault(),t.blur()}).insertBefore(this.element),e.mobile.textinput&&(null!=this.options.filterTheme&&(n.theme=i.filterTheme),t.textinput(n))}this._super(t),this._isSearchInternal()&&a&&this._search.attr("placeholder",this.options.filterPlaceholder)},_setOptions:function(i){var a=this._super(i);return i.filterPlaceholder!==t&&this._isSearchInternal()&&this._search.attr("placeholder",i.filterPlaceholder),i.filterTheme!==t&&this._search&&e.mobile.textinput&&this._search.textinput("option","theme",i.filterTheme),a},_refreshChildWidget:function(){this._refreshingChildWidget=!0,this._superApply(arguments),this._refreshingChildWidget=!1},refresh:function(){this._refreshingChildWidget||this._superApply(arguments)},_destroy:function(){this._isSearchInternal()&&this._search.remove(),this._super()},_syncTextInputOptions:function(i){var a,n={};if(this._isSearchInternal()&&e.mobile.textinput){for(a in e.mobile.textinput.prototype.options)i[a]!==t&&("theme"===a&&null!=this.options.filterTheme?n[a]=this.options.filterTheme:n[a]=i[a]);this._search.textinput("option",n)}}}),e.widget("mobile.listview",e.mobile.listview,{options:{filter:!1},_create:function(){return this.options.filter!==!0||this.element.data("mobile-filterable")||this.element.filterable(),this._super()},refresh:function(){var e;this._superApply(arguments),this.options.filter===!0&&(e=this.element.data("mobile-filterable"),e&&e.refresh())}})}(e),function(e,t){function i(){return++n}function a(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var n=0,o=/#.*$/;e.widget("ui.tabs",{version:"fadf2b312a05040436451c64bbfaf4814bc62c56",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(i.active):this.active=e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,a=location.hash.substring(1);return null===t&&(a&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===a?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),a=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:a++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,a--;break;case e.ui.keyCode.END:a=this.anchors.length-1;break;case e.ui.keyCode.HOME:a=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(a);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(a===this.options.active?!1:a);default:return}t.preventDefault(),clearTimeout(this.activating),a=this._focusNextTab(a,n),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(a).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",a)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function a(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(a(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,n){var o,s,r,l=e(n).uniqueId().attr("id"),c=e(n).closest("li"),d=c.attr("aria-controls");a(n)?(o=n.hash,s=t.element.find(t._sanitizeSelector(o))):(r=t._tabId(c),o="#"+r,s=t.element.find(o),s.length||(s=t._createPanel(r),s.insertAfter(t.panels[i-1]||t.tablist)),s.attr("aria-live","polite")),s.length&&(t.panels=t.panels.add(s)),d&&c.data("ui-tabs-aria-controls",d),c.attr({"aria-controls":o.substring(1),"aria-labelledby":l}),s.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,a=0;i=this.tabs[a];a++)t===!0||-1!==e.inArray(a,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,a=this.element.parent();"fill"===t?(i=a.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),a=t.css("position");"absolute"!==a&&"fixed"!==a&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,a=this.active,n=e(t.currentTarget),o=n.closest("li"),s=o[0]===a[0],r=s&&i.collapsible,l=r?e():this._getPanelForTab(o),c=a.length?this._getPanelForTab(a):e(),d={oldTab:a,oldPanel:c,newTab:r?e():o,newPanel:l};t.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||this._trigger("beforeActivate",t,d)===!1||(i.active=r?!1:this.tabs.index(o),this.active=s?e():o,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(o),t),this._toggle(t,d))},_toggle:function(t,i){function a(){o.running=!1,o._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),s.length&&o.options.show?o._show(s,o.options.show,a):(s.show(),a())}var o=this,s=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),s.length&&r.length?i.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var i,a=this._findActive(t);a[0]!==this.active[0]&&(a.length||(a=this.active),i=a.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var a=this.options.disabled;a!==!1&&(i===t?a=!1:(i=this._getIndex(i),a=e.isArray(a)?e.map(a,function(e){return e!==i?e:null}):e.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(a))},disable:function(i){var a=this.options.disabled;if(a!==!0){if(i===t)a=!0;else{if(i=this._getIndex(i),-1!==e.inArray(i,a))return;a=e.isArray(a)?e.merge([i],a).sort():[i]}this._setupDisabled(a)}},load:function(t,i){t=this._getIndex(t);var n=this,o=this.tabs.eq(t),s=o.find(".ui-tabs-anchor"),r=this._getPanelForTab(o),l={tab:o,panel:r};a(s[0])||(this.xhr=e.ajax(this._ajaxSettings(s,i,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){r.html(e),n._trigger("load",i,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&n.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),e===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(t,i,a){var n=this;return{url:t.attr("href"),beforeSend:function(t,o){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:o},a))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(e),function(e,t){}(e),function(e,t){
function i(e){n=e.originalEvent,l=n.accelerationIncludingGravity,o=Math.abs(l.x),s=Math.abs(l.y),r=Math.abs(l.z),!t.orientation&&(o>7||(r>6&&8>s||8>r&&s>6)&&o>5)?a.enabled&&a.disable():a.enabled||a.enable()}e.mobile.iosorientationfixEnabled=!0;var a,n,o,s,r,l,c=navigator.userAgent;return/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(c)&&c.indexOf("AppleWebKit")>-1?(a=e.mobile.zoom,void e.mobile.document.on("mobileinit",function(){e.mobile.iosorientationfixEnabled&&e.mobile.window.bind("orientationchange.iosorientationfix",a.enable).bind("devicemotion.iosorientationfix",i)})):void(e.mobile.iosorientationfixEnabled=!1)}(e,this),function(e,t,a){function n(){o.removeClass("ui-mobile-rendering")}var o=e("html"),s=e.mobile.window;e(t.document).trigger("mobileinit"),e.mobile.gradeA()&&(e.mobile.ajaxBlacklist&&(e.mobile.ajaxEnabled=!1),o.addClass("ui-mobile ui-mobile-rendering"),setTimeout(n,5e3),e.extend(e.mobile,{initializePage:function(){var t=e.mobile.path,o=e(":jqmData(role='page'), :jqmData(role='dialog')"),r=t.stripHash(t.stripQueryParams(t.parseLocation().hash)),l=e.mobile.path.parseLocation(),c=r?i.getElementById(r):a;o.length||(o=e("body").wrapInner("<div data-"+e.mobile.ns+"role='page'></div>").children(0)),o.each(function(){var i=e(this);i[0].getAttribute("data-"+e.mobile.ns+"url")||i.attr("data-"+e.mobile.ns+"url",i.attr("id")||t.convertUrlToDataUrl(l.pathname+l.search))}),e.mobile.firstPage=o.first(),e.mobile.pageContainer=e.mobile.firstPage.parent().addClass("ui-mobile-viewport").pagecontainer(),e.mobile.navreadyDeferred.resolve(),s.trigger("pagecontainercreate"),e.mobile.loading("show"),n(),e.mobile.hashListeningEnabled&&e.mobile.path.isHashValid(location.hash)&&(e(c).is(":jqmData(role='page')")||e.mobile.path.isPath(r)||r===e.mobile.dialogHashKey)?e.event.special.navigate.isPushStateEnabled()?(e.mobile.navigate.history.stack=[],e.mobile.navigate(e.mobile.path.isPath(location.hash)?location.hash:location.href)):s.trigger("hashchange",[!0]):(e.event.special.navigate.isPushStateEnabled()&&e.mobile.navigate.navigator.squash(t.parseLocation().href),e.mobile.changePage(e.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),e(function(){e.support.inlineSVG(),e.mobile.hideUrlBar&&t.scrollTo(0,1),e.mobile.defaultHomeScroll=e.support.scrollTop&&1!==e.mobile.window.scrollTop()?1:0,e.mobile.autoInitializePage&&e.mobile.initializePage(),e.mobile.hideUrlBar&&s.load(e.mobile.silentScroll),e.support.cssPointerEvents||e.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",function(e){e.preventDefault(),e.stopImmediatePropagation()})}))}(e,this)}),function(e){window.g_uiData={},e.fn.htmlEntities=function(t){var i=function(e){for(var t={10:"\n"},i=[],a=e.length-1;a>=0;a--){var n=e[a].charCodeAt();t.char_code?i.unshift(t.char_code):i.unshift(["&#",n,";"].join(""))}return i.join("")},a=i(t);return this.each(function(){e(this).html(a)})},e.lStorage=function(t,i){if(0==t.indexOf("U")){if(!i)return window.g_uiData;window.g_uiData=i}else{if(!i&&i!==!1)return localStorage[t]?e.parseJSON(localStorage[t]):!1;"object"==typeof i&&(i=JSON.stringify(i)),localStorage[t]=i}},e.extend({getUrlVars:function(){for(var e,t=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),a=0;a<i.length;a++)e=i[a].split("="),t.push(e[0]),t[e[0]]=e[1];return t},getUrlVar:function(t){return e.getUrlVars()[t]}}),Date.prototype.customFormat=function(e){var t,i,a,n,o,s,r,l,c,d,u,h,p,f,g,m,v,b,w,_,y,x=this;return i=((t=x.getFullYear())+"").slice(-2),o=(s=x.getMonth()+1)<10?"0"+s:s,n=(a=["January","February","March","April","May","June","July","August","September","October","November","December"][s-1]).substring(0,3),c=(d=x.getDate())<10?"0"+d:d,l=(r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][x.getDay()]).substring(0,3),CD=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"][x.getDay()],y=d>=10&&20>=d?"th":1==(_=d%10)?"st":2==_?"nd":3==_?"rd":"th",e=e.replace("#YYYY#",t).replace("#YY#",i).replace("#MMMM#",a).replace("#MMM#",n).replace("#MM#",o).replace("#M#",s).replace("#CD#",CD).replace("#DDDD#",r).replace("#DDD#",l).replace("#DD#",c).replace("#D#",d).replace("#th#",y),p=u=x.getHours(),0==p&&(p=24),p>12&&(p-=12),h=10>p?"0"+p:p,w=(b=12>u?"am":"pm").toUpperCase(),f=(g=x.getMinutes())<10?"0"+g:g,m=(v=x.getSeconds())<10?"0"+v:v,e.replace("#hhh#",u).replace("#hh#",h).replace("#h#",p).replace("#mm#",f).replace("#m#",g).replace("#ss#",m).replace("#s#",v).replace("#ampm#",b).replace("#AMPM#",w)},Array.prototype.last=function(){return this[this.length-1]},Array.prototype.unique=function(e){return function(){return this.filter(e)}}(function(e,t,i){return i.indexOf(e,t+1)<0});var t=["&#55356;&#57(0(8[89]|9[0-9])|[12][0-9]{2}|3([0-3][0-9]|4[0-3]));","&#55357;&#5(6(3[2-9][0-9]|[4-9][0-9]{2})|7([0-2][0-9]{2}|3([0-3][0-9]|4[0-3])));","&#9(6(3[2-9]|[4-9][0-9])|[78][0-9]{2}|9([0-7][0-9]|8[0-3]));&#65039;","&#(99(8[4-9]|9[0-9])|10(0[0-9]{2}|1([0-6][0-9]|7[0-5])));&#65039;","&#(11(0(0[89]|[1-9][0-9])|1[0-9]{2}|2([0-5][0-9]|6[0-3])));&#65039;"],i=["&#(99(8[4-9]|9[0-9])|10(0[0-9]{2}|1([0-6][0-9]|7[0-5])));"];String.prototype.replaceEmoji=function(){var e=this.replace(new RegExp(t.join("|"),"g"),function(e,t,i,a){var n=[],o=e.lastIndexOf(";&#");if(0>o?(o=e.lastIndexOf(";"),n.push(parseInt(e.substring(2,o)))):(n.push(parseInt(e.substring(2,o))),n.push(parseInt(e.substring(o+3,e.length-1)))),n[0]>=55296){var s=4294967295;s=n[0]-55296<<10>>>0;var r=n[1]-56320>>>0;return s=s|r|65536,"<img style='max-height:20px' class='emoji' src='../images/emojis/"+s.toString(16)+".png' alt='emoji' />"}return"<img style='max-height:20px' class='emoji' src='../images/emojis/"+n[0].toString(16)+".png' alt='emoji' />"});return e=e.replace(new RegExp(i.join("|"),"g"),function(e,t,i,a){var n=e.lastIndexOf(";"),o=parseInt(e.substring(2,n));return"<img style='max-height:20px' class='emoji' src='../images/emojis/"+o.toString(16)+".png' alt='emoji' />"})},String.prototype.replaceOriEmojiCode=function(){return this.replace(new RegExp("([⬀-⯿]️|([☀-⛿])|([✀-➿]$)|[�-�][�-�])","g"),function(e,t,i,a){var n=[];if(n.push(e.charCodeAt(0)),n.push(e.charCodeAt(1)),n[0]>=55296){var o=4294967295;o=n[0]-55296<<10>>>0;var s=n[1]-56320>>>0;return o=o|s|65536,"<img style='max-height:20px' class='emoji' src='../images/emojis/"+o.toString(16)+".png' alt='emoji' />"}return"<img style='max-height:20px' class='emoji' src='../images/emojis/"+n[0].toString(16)+".png' alt='emoji' />"})};String.prototype.replaceUtf16=function(){return this.replace(new RegExp(t.join("|"),"g"),function(e,t,i,a){var n=[],o=e.lastIndexOf(";&#");n.push(parseInt(e.substring(2,o))),n.push(parseInt(e.substring(o+3,e.length-1)));var s=4294967295;s=n[0]-55296<<10>>>0;var r=n[1]-56320>>>0;return s=s|r|65536,String.fromCharCode(n[0],n[1])})},String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,i){return"undefined"!=typeof e[i]?e[i]:t})},String.prototype.startsWith=function(e){return 0==this.indexOf(e)},String.prototype.parseHtmlString=function(){return this.replace(/&#([0-9]{1,5});/gi,function(e,t){var i=parseInt(t,10);return String.fromCharCode(i)})}}(jQuery);var ui,at,lang,gi;$(function(){function e(e){if(e)window.cns={log:window.console.log.bind(window.console,"%s: %s"),error:window.console.error.bind(window.console,"error: %s"),info:window.console.info.bind(window.console,"info: %s"),warn:window.console.warn.bind(window.console,"warn: %s"),debug:window.console.debug.bind(window.console,"debug: %s")};else{var t=function(){};window.cns={log:t,error:t,warn:t,info:t,debug:t}}}if(gi=null,base_url="https://qaap.qmi.emome.net/apiv1/",debug_flag=!1,window.location.href.match(/^http:\/\/localhost|10.1.17.114/)&&(debug_flag=!0),window.location.href.match(/main.html/)){var t=localStorage.uiData;t&&$.lStorage("UXXX",$.parseJSON(t))}countrycode="+886",lang="en_US";var i=navigator.language||navigator.userLanguage;i=i.replace(/-/g,"_").toLowerCase(),0==i.indexOf("zh")&&(lang="zh_cn"==i?"zh_CN":"zh_TW"),content_limit=400,proportion=1.7,$(document).data("page-history",[["login"],["#page-group-menu","團體列表"]]),back_button=!1,back_exception=!1,back_hash=!1,window.parent&&window.parent.login_time?login_time=window.parent.login_time:login_time=(new Date).getTime(),timeline_detail_exception=[".st-sub-box-2-content-detail a",".st-sub-box-2-more-desc-detail a",".st-box2-more-task-area-detail",".audio-play",".st-sub-box-more-btn",".st-more-close",".st-user-pic",".st-sub-box-more",".st-sub-box-2-attach-area"],not_attach_type_arr=[0,1,12,13,14,15],load_show=!1,s_load_show=!1,ajax_msg=!1,no_pic="images/common/others/empty_img_personal_xl.png",avatar_size=60,ajax_count=0,gallery_movement=360,compose_timer=!1,img_total=9,attach_mtp_arr=[1,6],max_w=500,max_h=500,quality=.5,top_timer_ms=5e3,polling_interval=5e3,update_alert_interval=1e4,initTabMap={0:{act:"feed-public",textId:"LEFT_FEED_GROUP"},1:{act:"feed-post",textId:"LEFT_FEED_MEMBER"},2:{act:"feeds",textId:"LEFT_FEED","class":["polling-cnt","polling-local"],pollingType:"A1"},3:{act:"chat",textId:"LEFT_CHAT","class":["polling-cnt","polling-local"],pollingType:"A3"},6:{act:"memberslist",textId:"LEFT_MEMBER","class":["polling-cnt","polling-local"],pollingType:"A2"},7:{act:"groupSetting",textId:"GROUPSETTING_TITLE"},9:{act:"addressBook",textId:"ADDRESSBOOK_TITLE"},10:{act:"fileSharing",textId:"FILESHARING_TITLE"}},initPenMap={0:{fcBox:"announcement",textId:"FEED_BULLETIN",imgNm:"bulletin"},1:{fcBox:"feedback",textId:"FEED_REPORT",imgNm:"report"},2:{fcBox:"work",textId:"FEED_TASK",imgNm:"task"},3:{fcBox:"vote",textId:"FEED_VOTE",imgNm:"vote"},4:{fcBox:"check",textId:"FEED_LOCATION",imgNm:"location"},5:{fcBox:"post",textId:"FEED_POST",imgNm:"post"}},g_Qmi_title="Qmi",$("title").html(g_Qmi_title),myRand=Math.floor(1e3*Math.random()+1),$.ajaxSetup({timeout:3e4}),$(document).ajaxSend(function(){return load_show||s_load_show?($(".ui-loader").is(":visible")||$(".ui-loader").css("display","block"),void $(".ajax-screen-lock").show()):!1}),$(document).ajaxComplete(function(e,t,i){return s_load_show?!1:($(".ui-loader").hide(),void $(".ajax-screen-lock").hide())}),$(document).ajaxError(function(e,t,i){return s_load_show=!1,i.url.match(/sys\/polling/)||($(".ui-loader").hide(),$(".ajax-screen-lock").hide()),i.errHide?!1:"timeout"==t.statusText?(toastShow($.i18n.getString("COMMON_TIMEOUT_ALERT")),!1):401==t.status?(window.location.href.match(/po\/app\/chat.html/)&&window.close(),localStorage.removeItem("_loginData"),popupShowAdjust("",$.i18n.getString("LOGIN_AUTO_LOGIN_FAIL"),!0,!1,[reLogin]),!1):void(ajax_msg||!window.location.href.match(/.html/)||window.location.href.match(/index.html/)?(ajax_msg=!1,popupShowAdjust("",errorResponse(t),!0)):toastShow(errorResponse(t)))}),$(document).on("pagebeforeshow",function(e,t){var i=window.location.hash;if(back_exception)return back_exception=!1,!1;var a=$(i+" .page-title").html(),n=[i,a];$(document).data("page-history").push(n),"#page-group-main"==i&&$(document).data("group-avatar")&&($(".sm-group-area").each(function(e,t){var i=$(this).find(".sm-group-area-l img:eq(0)"),a=new Image;a.src=i.attr("src")}),$(document).data("group-avatar",!1))}),$(".page-back").click(function(){if("undefined"!=typeof g_room)return!1;back_exception=!0;$(document).data("page-history");$(document).data("page-history").pop(),"login"==$(document).data("page-history").last()[0]&&(document.location="index.html"),$.mobile.changePage($(document).data("page-history").last()[0],{transition:"slide",reverse:!0})}),$(document).on("click","a",function(e){if(!$(this).is("[download]")){var t="undefined"!=typeof require;if(cns.debug(t),t){var i=require("nw.gui");return i.Shell.openExternal($(this).attr("href")),!1}}}),errorResponse=function(e){try{return e&&e.responseText&&e.responseText.length>0?$.parseJSON(e.responseText).rsp_msg:(cns.debug("errorResponse:",e),$.i18n.getString("COMMON_CHECK_NETWORK"))}catch(t){return cns.debug("catch error",{e:t,data:e}),$.i18n.getString("COMMON_UNKNOWN_ERROR")}},e(debug_flag)}),$(function(){function e(e,t){var i="groups/"+gi+"/chats/"+e+"/users",a={ui:ui,at:at,li:lang},n=ajaxDo(i,a,"delete",!0,null,null,!0);n.error(function(e,t,i){console.debug(1)}),n.complete(function(e){if(200==e.status){var i=$.parseJSON(e.responseText);t&&t(i)}})}groupListToLStorage=function(){var e=$.lStorage(ui)||{};$.each($.lStorage("_groupList"),function(t,i){$.lStorage(ui).hasOwnProperty(i.gi)?$.extend(e[i.gi],i):(i.guAll={},i.gu=i.me,$.each(i.tl,function(e,t){switch(t.tp){case 1:i.ti_cal=t.ti;break;case 2:i.ti_feed=t.ti;break;case 3:i.ti_chat=t.ti;break;case 4:i.ti_file=t.ti}}),e[i.gi]=i)});var t=$.lStorage("_pri_group");$.each(t,function(i,a){if(a){if(!a.tmp_groups)return void(t[i].groups=[]);var n=[];$.each(a.tmp_groups,function(t,i){n.push(i.gi),i.ori_gi=i.gi,i.gi=getPrivateGi(a.ci,i.gi),$.lStorage(ui).hasOwnProperty(i.gi)?$.extend(e[i.gi],i):(i.guAll={},i.gu=i.me,i.ci=a.ci,$.each(i.tl,function(e,t){switch(t.tp){case 1:i.ti_cal=t.ti;break;case 2:i.ti_feed=t.ti;break;case 3:i.ti_chat=t.ti;break;case 4:i.ti_file=t.ti}}),e[i.gi]=i)}),delete t[i].tmp_groups,t[i].groups=n}}),$.lStorage("_pri_group",t),$.lStorage(ui,e)},getGroupCombo=function(e,t){var e=e||gi;getGroupData(e,!1,1).complete(function(i){if(200==i.status){var a=$.parseJSON(i.responseText);clearGroupPollingCnt(),setGroupAttributes(e,a),initOfficialGroup(e),setGroupUser(e,a),setBranchList(e,a),setTabList(e,a),t&&t()}else groupSwitchEnable()})},setGroupUser=function(e,t){var i=t.ul,a={};$.each(i,function(e,t){a[t.gu]=t}),updateGuAll(e,a)},updateGuAll=function(e,t){var i=$.lStorage(ui);i[e].guAll&&$.each(i[e].guAll,function(a,n){t.hasOwnProperty(a)?$.extend(n,t[a]):delete i[e].guAll[a]}),$.extend(t,i[e].guAll);var a={};$.each(t,function(e,i){0==t[e].st&&(a[e]=t[e],delete t[e])}),i[e].inviteGuAll=a,i[e].guAll=t,$.lStorage(ui,i)},setTabList=function(e,t){var i=!1;(null==t||null==t.set)&&(i=!0);var a=$.lStorage(ui),n=a[e];1==n.isOfficial?(n.tab=[{tp:0,sw:!1},{tp:1,sw:!1},{tp:2,sw:!0},{tp:3,sw:!0},{tp:4,sw:!1},{tp:5,sw:!1},{tp:6,sw:!1},{tp:7,sw:!0},{tp:8,sw:!1},{tp:9,sw:!1}],1==n.ad&&(n.tab[6].sw=!0)):!i&&t.set.tab?n.tab=t.set.tab:n.tab=[{tp:0,sw:!1},{tp:1,sw:!1},{tp:2,sw:!0},{tp:3,sw:!0},{tp:4,sw:!1},{tp:5,sw:!1},{tp:6,sw:!0},{tp:7,sw:!0},{tp:8,sw:!1},{tp:9,sw:!1}],!i&&t.set.pen?n.pen=t.set.pen:n.pen=[{tp:0,sw:!0},{tp:1,sw:!0},{tp:2,sw:!0},{tp:3,sw:!0},{tp:4,sw:!0}],a[e]=n,window.g_uiData=a,updateTab(e)},setThisGroup=function(e){try{var t=$.lStorage(ui)[e];gi=e,gu=t.me,gn=htmlFormat(t.gn),ti_cal=t.ti_cal,ti_feed=t.ti_feed,ti_chat=t.ti_chat,$(".sm-user-area.namecard").data("gu",gu),$(".header-group-name div:eq(1)").html(gn),$(".feed-subarea.no-data").removeClass("no-data"),updateGroupAllInfoDom(e)}catch(i){return void errorReport(i)}},updateTab=function(e){var t;try{t=$.lStorage(ui)[e]}catch(i){return void errorReport(i)}try{var a='<div class="sm-small-area"><div class="sm-small-area-r"></div></div>',n=$(".header-menu").html("");for(d=0;d<t.tab.length;d++){var o=t.tab[d];if(o.sw!==!1&&"undefined"!=typeof initTabMap[o.tp]){var s=$(a);if(s.attr("data-sm-act",initTabMap[o.tp].act),initTabMap[o.tp].hasOwnProperty("class")){for(j=0;j<initTabMap[o.tp]["class"].length;j++)s.addClass(initTabMap[o.tp]["class"][j]);s.attr("data-polling-cnt",initTabMap[o.tp].pollingType).append('<div class="sm-count" style="display:none;"></div>')}n.append(s);var r=s.find(".sm-small-area-r");o.nm&&o.nm.length>0?r.html(o.nm):r.html($.i18n.getString(initTabMap[o.tp].textId))}}}catch(i){errorReport(i)}0==initGroupSetting(e)&&(dom=n.find(".sm-small-area[data-sm-act=groupSetting]"),dom.hide());try{var l='<div class="fc-area-subbox"><img class="fc-icon-size"/><div name="func-name"></div></div>',n=$(".feed-compose-area").html(""),c=!1;for(var d in t.pen){var u=t.pen[d];if(u["switch"]!==!1&&"undefined"!=typeof initPenMap[u.tp]){var h=$(l);5==u.tp&&(c=!0),h.attr("data-fc-box",initPenMap[u.tp].fcBox).find("img").attr("src","images/icon/icon_compose_"+initPenMap[u.tp].imgNm+".png"),n.append(h),h.addClass("active");var r=h.find("div[name=func-name]");u.nm&&u.nm.length>0?r.html(u.nm):r.html($.i18n.getString(initPenMap[u.tp].textId))}}0==c&&(dom=n.find(".fc-area-subbox[data-fc-box=post]"),dom.detach(),n.append(dom),dom.addClass("active"))}catch(i){errorReport(i)}},initGroupSetting=function(e){try{var t=$.lStorage(ui),i=t[e],a=0;return 1==i.ad?($(".gs-row[data-type=permission]").show(),$(".gs-row[data-type=info]").show()):($(".gs-row[data-type=permission]").hide(),$(".gs-row[data-type=info]").hide(),a+=2),!i.set||0!=i.set.s11&&2!=i.set.s11?($(".gs-leave").hide(),a+=1):$(".gs-leave").show(),a>=3?!1:!0}catch(n){errorReport(n)}},initOfficialGroup=function(t){var i,a;try{i=$.lStorage(ui),a=i[t]}catch(n){return void errorReport(n)}try{var o=a.tp.toLowerCase();a.isOfficial=0==o.indexOf("c")||0==o.indexOf("d"),$.lStorage(ui,i),a.isOfficial&&1!=a.ad&&updateChatList(t,function(){try{a.chatAll&&Object.keys(a.chatAll).length>1&&($.each(a.chatAll,function(t,i){i&&1==i.tp&&i.other&&a.guAll.hasOwnProperty(i.other)&&1!=a.guAll[i.other].ad&&(delete a.chatAll[t],e(t))}),$.lStorage(ui,i))}catch(n){errorReport(n)}if(null==a.chatAll||Object.keys(a.chatAll).length<=1){var o;for(var s in a.guAll){var r=a.guAll[s];if(1==r.ad){o=r;break}}null!=o?(cns.debug("[initOfficialGroup] create an official chat",t,o.nk,o.gu),requestNewChatRoomApi(t,o.nk,[{gu:o.gu}],null,null,!1)):cns.debug("[initOfficialGroup] has no admin in official group",t)}})}catch(n){errorReport(n)}},clearGroupPollingCnt=function(){for(var e=["A1","A2","A3","A4"],t=0;t<e.length;t++){var i=e[t];$(".polling-cnt[data-polling-cnt="+i+"] .sm-count").hide()}}}),$(function(){function e(e,t,i,a,n,o){e.save(),e.drawImage(t,i,a,n,o),e.restore()}function t(e,t,i,a,n,o,s){if(a&&!(a.length<=0)){o=o||44;var r=(t+i)/1.41421356237,l=i/2,c=Math.ceil(r/o)+2;e.font=n+" Microsoft JhengHei",a+="  ";var d=e.measureText(a).width,u=Math.ceil(r/d)+2;e.save(),e.translate(-l,l),e.rotate(-.25*Math.PI);var h=0;e.strokeStyle="rgba(128,128,128,0.3)",e.lineWidth=1,e.fillStyle=s||"rgba(255,255,255,0.3)";for(var p="",f=0;u>f;f++)p+=a;for(var g=0;c>g;g++){var m=0;e.strokeText(p,m,h),e.fillText(p,m,h),h+=o}e.restore()}}ajaxDo=function(e,t,i,a,n,o,s,r){load_show=a,o&&(ajax_msg=!0);var l=base_url+e;if(r)l="https://"+r+"/apiv1/"+e;else{var c,d,u,h,p;if(c=parsePrivateGi(e),t&&t.gi&&(d=parsePrivateGi(t.gi)),n&&n.gi&&(u=parsePrivateGi(t.gi)),c||d||u){if(c){var f=c.ci;p=c.gi;var g=$.lStorage("_pri_group");g.hasOwnProperty(f)&&(h=g[f],h&&(t.ui&&(t.ui=h.ui),t.at&&(t.at=h.at))),l="https://"+h.cl+"/apiv1/"+c.newStr}if(d)if(p)t.gi=p;else{var f=d.ci;p=d.gi;var g=$.lStorage("_pri_group");g.hasOwnProperty(f)&&(h=g[f],h&&(t.ui&&(t.ui=h.ui),t.at&&(t.at=h.at),h.hasOwnProperty(giTmp)&&(pri_group=h[giTmp]))),t.gi=giTmp,l="https://"+h.cl+"/apiv1/"+e}if(u)if(p)n.gi=p;else{var f=u.ci;p=u.gi;var g=$.lStorage("_pri_group");g.hasOwnProperty(f)&&(h=g[f],h&&(t.ui&&(t.ui=h.ui),t.at&&(t.at=h.at),h.hasOwnProperty(giTmp)&&(pri_group=h[giTmp]))),t.gi=giTmp,l="https://"+h.cl+"/apiv1/"+e}}}n&&(n=JSON.stringify(n));var m={url:l,type:i,headers:t,data:n,errHide:s||!1};return this!=window&&($.extend(this,m),m=this),$.ajax(m)},AjaxTransfer=function(){this.headers={ui:ui,at:at,li:lang}},AjaxTransfer.prototype={STRIP_COMMENTS:/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,ARGUMENT_NAMES:/([^\s,]+)/g,ajaxArgs:{method:"get",timeout:3e4},getParamNames:function(e){var t=e.toString().replace(this.STRIP_COMMENTS,""),i=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(this.ARGUMENT_NAMES);return null===i&&(i=[]),i},execute:function(e){e.headers=e.headers||{};var t=JSON.parse(JSON.stringify(this.ajaxArgs));return $.extend(e.headers,this.headers),$.extend(t,e),ajaxDo.apply(t,[t.url,t.headers,t.method,t.load_show_chk,t.body,t.ajax_msg_chk,t.err_hide,t.privateUrl])}},_pri_split_chat="#",getPrivateGi=function(e,t){return _pri_split_chat+e+_pri_split_chat+t+_pri_split_chat},parsePrivateGi=function(e){if(!e)return null;var t=e.split(_pri_split_chat);if(t.length>1){var i={ci:t[1],gi:t[2]};return t[1]="",i.newStr=t.join(""),i}return null},reLogin=function(){document.location="index.html"},imgResizeByCanvas=function(e,t,i,a,n,o){var s=a,r=n,l=e.width,c=e.height;l>c?l>s&&(c*=s/l,l=s):c>r&&(l*=r/c,c=r);var d=document.createElement("canvas");d.width=l,d.height=c;var u=d.getContext("2d");u.drawImage(e,t,i,l,c);var h=d.toDataURL("image/png",o),p={w:Math.floor(l),h:Math.floor(c),blob:dataURItoBlob(h)};return p},dataURItoBlob=function(e){var t;try{t=e.split(";")[0],t=t.substring(5,t.length)}catch(i){t="image/png",errorReport(i)}for(var a=atob(e.split(",")[1]),n=[],o=0;o<a.length;o++)n.push(a.charCodeAt(o));return new Blob([new Uint8Array(n)],{type:t})},getVideoBlob=function(e,t,i,a,n,o){if(null==e||e.length<=0)return null;var s=e[0];if(null==s)return null;var r={l:Math.floor(1e3*s.duration),blob:dataURItoBlob(e.attr("src"))};return r},avatarPos=function(e,t){},mathAvatarPos=function(e,t,i,a,n){if(n&&(a=n>t?t:n),0==t||0==i)return!1;if(e.removeAttr("style"),i>=t){e.attr("width",a);var o=(i/(t/a)-a)/2*-1;e.css("margin-top",o+"px")}else{e.attr("height",a);var o=(t/(i/a)-a)/2*-1;e.css("margin-left",o+"px")}},toSha1Encode=function(e){var t=CryptoJS.SHA1(e),i=t.toString(CryptoJS.enc.Base64);return i},htmlFormat=function(e){return e=e.replace(/\n/g," \n ").split(" "),$.each(e,function(t,i){"http://"==i.substring(0,7)||"https://"==i.substring(0,8)?encode_val='<a href="'+encodeHtmlEntity(i)+'" target="_blank">'+encodeHtmlEntity(i)+"</a>":encode_val=encodeHtmlEntity(i),encode_val&&e.splice(t,1,encode_val)}),e.join(" ").replaceEmoji()},encodeHtmlEntity=function(e){if(!e)return!1;for(var t={10:"<br/>"},i=[],a=e.length-1;a>=0;a--){var n=e[a].charCodeAt();t[n]?i.unshift(t[n]):i.unshift(["&#",n,";"].join(""))}return i.join("")},secondsToTime=function(e){var t=(Math.floor(e/3600),e%3600),i=Math.floor(t/60),a=t%60,n=Math.ceil(a);return i+":"+(10>n?"0"+n:n)},toastShow=function(e){$(".toast div").html(e),$(".toast").css("bottom","0px"),$(".toast").css("opacity","0"),setTimeout(function(){$(".toast").show(),$(".toast").animate({bottom:"30px",opacity:"1.0"},100)},100),setTimeout(function(){$(".toast").fadeOut("fast",function(){$(this).css("bottom","0px"),$(this).css("opacity","0")})},4e3)},$(".popup-confirm").click(function(){if($(".popup").data("callback")){var e=$(".popup").data("callback")[0],t=$(".popup").data("callback")[1];e(t)}$(".popup-screen").trigger("close")}),$(".popup-cancel").click(function(){$(".popup-screen").trigger("close")}),$(".popup-screen").bind("close",function(){$(".popup").fadeOut("fast",function(){$(".popup-screen").hide()}),$(".ui-loader").hide(),$(".ajax-screen-lock").hide(),$("body").removeClass("screen-lock")}),popupShowAdjust=function(e,t,i,a,n){$(".popup-confirm").html($.i18n.getString("COMMON_OK")),$(".popup-cancel").html($.i18n.getString("COMMON_CANCEL")),e?$(".popup-title").html(e):$(".popup-title").html(""),t?($(".popup-text").show(),$(".popup-text").html(t)):$(".popup-text").hide(),i?($(".popup-confirm").show(),$(".popup-cancel").removeClass("full-width"),"string"==typeof i&&(i.split("+")[2]&&$(".popup-confirm").html(i.split("+")[2]),$(".popup-confirm").data("todo",i))):($(".popup-confirm").hide(),$(".popup-cancel").addClass("full-width")),a?($(".popup-cancel").show(),$(".popup-confirm").removeClass("full-width"),"string"==typeof a&&(a.split("+")[2]&&$(".popup-cancel").html(a.split("+")[2]),$(".popup-confirm").data("todo",i))):($(".popup-cancel").hide(),$(".popup-confirm").addClass("full-width")),null==n?$(".popup").removeData("callback"):$(".popup").data("callback",n),i||a||setTimeout(function(){$(".popup-screen").trigger("close"),$("body").removeClass("screen-lock")},2e3),$(".popup-screen").show(),$(".popup").show(),$(".popup-frame").css("margin-left",0),$(".popup-frame").css("margin-left",($(document).width()-$(".popup-frame").width())/2)},changePageAfterPopUp=function(e){$.mobile.changePage(e)},updateLanguage=function(e){$.i18n.load(e,function(){$("body")._i18n()})},uploadToS3=function(e,t,i,a,n){var o={ui:ui,at:at,li:lang},s="put";s_load_show=!0;var r=ajaxDo(t,o,s,!1);r.complete(function(o){if(200==o.status){var s=$.parseJSON(o.responseText),r=s.fi,l=s.ou,c=s.tu,d=new FileReader;d.onloadend=function(){var e=new Image;e.src=d.result,e.onload=function(){var e=imgResizeByCanvas(this,0,0,i[0],i[1],i[2]),o=imgResizeByCanvas(this,0,0,a[0],a[1],a[2]);$.ajax({url:l,type:"PUT",contentType:" ",data:e.blob,processData:!1,complete:function(i){200==i.status?$.ajax({url:c,type:"PUT",contentType:" ",data:o.blob,processData:!1,complete:function(i){if(200==i.status){t+="/commit";var a={ui:ui,at:at,li:lang},o="put",s={fi:r,si:e.blob.size};ajaxDo(t,a,o,!0,s).complete(function(e){200==e.status?n&&n(!0):n&&n(!1)})}else cns.debug("小圖上傳 錯誤"),n&&n(!1)}}):(cns.debug("大圖上傳 錯誤"),n&&n(!1))}})}},d.readAsDataURL(e)}else cns.debug("取得s3網址 錯誤"),n&&n(!1)})},resetDB=function(){clearBadgeLabel(),"undefined"!=typeof idb_timeline_events&&idb_timeline_events.clear(),"undefined"!=typeof g_idb_chat_msgs&&g_idb_chat_msgs.clear(),"undefined"!=typeof g_idb_chat_cnts&&g_idb_chat_cnts.clear();var e=localStorage._ver,t=localStorage._loginRemeber;localStorage.clear(),e&&(localStorage._ver=e),t&&(localStorage._loginRemeber=t)},getFilePermissionIdWithTarget=function(e,t,i){var a=$.parseJSON(t),n=[];$.each(a,function(e,t){var i={gu:e,n:t};n.push(i)});var o=$.parseJSON(i),s=[];$.each(o,function(e,t){var i={bi:e,bn:t};s.push(i)});({ti:ti_feed,tu:{gul:n,bl:s}});return getFilePermissionId(e,{gul:n,bl:s})},getFilePermissionId=function(e,t){var i="groups/"+e+"/permissions",a={ui:ui,at:at,li:lang},n={ti:ti_feed,tu:t},o="post",s=ajaxDo(i,a,o,!1,n);return s},getS3UploadUrl=function(e,t,i,a,n){var o="groups/"+e+"/files",s={ui:ui,at:at,li:lang},r="post",l={tp:i,ti:t,pi:a};return n&&(l.wm=1),ajaxDo(o,s,r,!1,l)},uploadImgToS3=function(e,t){return $.ajax({url:e,type:"PUT",contentType:" ",data:t,processData:!1})},uploadVideoToS3=function(e,t){return cns.debug(t.type),$.ajax({url:e,type:"PUT",contentType:"video/mp4",data:t,processData:!1})},uploadCommit=function(e,t,i,a,n,o,s,r){var l="groups/"+e+"/files/"+t+"/commit",c={ui:ui,at:at,li:lang},d="put",u={ti:i,pi:a,tp:n,mt:o,si:s,md:r};return ajaxDo(l,c,d,!1,u)},uploadGroupImage=function(e,t,i,a,n,o,s,r){var l=new FileReader;l.onloadend=function(){var a=new Image;a.src=l.result,a.onload=function(){var a=imgResizeByCanvas(this,0,0,n[0],n[1],n[2]),l=imgResizeByCanvas(this,0,0,o[0],o[1],o[2]);getS3UploadUrl(e,i,1,s).complete(function(n){if(cns.debug("!"),200==n.status){var o=$.parseJSON(n.responseText),c=o.fi,d=o.s3,u=o.s32;uploadImgToS3(u,a.blob).complete(function(n){200==n.status?uploadImgToS3(d,l.blob).complete(function(n){if(200==n.status){var o=(this.width,this.height,{});o.w=a.w,o.h=a.h,uploadCommit(e,c,i,s,1,t.type,a.blob.size,o).complete(function(e){if(200==e.status){var e=($.parseJSON(e.responseText),{fi:c,s3:d,s32:u});r&&r(e)}else r&&r()})}else r&&r()}):r&&r()})}else r&&r()})}},l.readAsDataURL(t)},uploadGroupVideo=function(e,t,i,a,n,o,s,r,l){var c=getVideoBlob(i,0,0,o[0],o[1],o[2]),d=getVideoThumbnail(i,0,0,s[0],s[1],s[2]);getS3UploadUrl(e,a,2,r).complete(function(i){if(cns.debug("!"),200==i.status){var n=$.parseJSON(i.responseText),o=n.fi,s=n.s3,u=n.s32;uploadVideoToS3(u,c.blob).complete(function(i){200==i.status?uploadVideoToS3(s,d.blob).complete(function(i){if(200==i.status){var n=(this.width,this.height,{});n.l=c.l,uploadCommit(e,o,a,r,2,t.type,c.blob.size,n).complete(function(e){if(200==e.status){var e=($.parseJSON(e.responseText),{fi:o,s3:s,s32:u});l&&l(e)}else l&&l()})}else l&&l()}):l&&l()})}else l&&l()})},getVideoThumbnail=function(e,t,i,a,n,o){if(!e)return null;var s=e[0];if(!s)return null;var r=document.createElement("canvas"),l=n/s.videoHeight,c=a/s.videoWidth,d=c>l?l:c,u=s.videoWidth*d,h=s.videoHeight*d;r.width=u,r.height=h;var p=r.getContext("2d");p.drawImage(s,t,i,u,h);var f=r.toDataURL("image/png",o),g={w:Math.floor(u),h:Math.floor(h),blob:dataURItoBlob(f)};return g},randomHash=function(e){if(0>=e)return"";for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;e>a;a++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},Date.prototype.toFormatString=function(e){var t=new Date,i=(t.getTime()-this.getTime())/1e3,a=window.navigator.userLanguage||window.navigator.language;if(60>i)return $.i18n.getString("COMMON_JUST_NOW");if(3600>i)return $.i18n.getString("COMMON_NMINUTES_AGO",Math.floor(i/60));if(t.getYear()==this.getYear()){if(this.getMonth()==t.getMonth()&&t.getDate()==this.getDate())return $.i18n.getString("COMMON_NHOURS_AGO",Math.floor(i/3600));if(this.getMonth()==t.getMonth()&&this.getDate()==t.getDate()-1){var n={hour:"2-digit",minute:"2-digit",hour12:!1};return $.i18n.getString("COMMON_YESTERDAY")+" "+this.toLocaleTimeString(a,n)}if(this.getWeek()==t.getWeek()){var n={weekday:"short"};return this.toLocaleTimeString(a,n).split(" ")[0]+" "+this.getHours()+":"+this.getMinutes()}return this.getMonth()+1+"/"+this.getDate()+" "+this.getHours()+":"+padStringToTwoChar(this.getMinutes())}if(e){var n={year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return this.toLocaleTimeString(a,n)}return this.toLocaleDateString(a)},padStringToTwoChar=function(e){return 10>e?"0"+e.toString():e.toString()},Date.prototype.getWeek=function(){var e=new Date(this.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var t=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},Date.prototype.getRandomString=function(e){(!e||1>e)&&(e=4);var t=(new Date).getTime().toString(),i=t.length;return t.substring(i-e,i)},textSomeonesHtmlFormat=function(e){switch(lang){case"zh_TW":case"zh_CN":return"<label class='name'>"+e+"</label><label class='someone-s'>的</label>";case"en_US":return"<label class='name'>"+e+"</label><label class='someone-s'>'s</label>"}return e},textAndHtmlFormat=function(e){switch(lang){case"zh_TW":case"zh_CN":return"<label>"+e.replace(/(並|和|跟|以及)/g,function(e){return"</label><label class='and'>"+e+"</label><label>"})+"</label>";case"en_US":return e.replace(/and/g,function(e){return"<label class='and'>"+e+"</label>"})}return name},getStickerPath=function(e){return"sticker/"+e.split("_")[1]+"/"+e+".png"},setStickerUrl=function(e,t){null!=initStickerArea&&initStickerArea.setStickerSrc(e,t)},showGallery=function(e,t,i,a,n,o,s){a=a||0;var r=$(document).data("gallery");if(null!=r&&0==r.closed){r.focus(),r.ui=ui,r.at=at,r.lang=lang,r.this_gi=e,r.this_ti=t,r.list=i,r.startIndex=a,r.title=n,r.isWatermark=o,r.watermarkText=s;var l=$(r.document).find(".dataDom");l.click()}else r=window.open("layout/general_gallery.html","","width=480, height=730"),$(document).data("gallery",r),$(r.document).ready(function(){setTimeout(function(){r.ui=ui,r.at=at,r.lang=lang,r.this_gi=e,r.this_ti=t,r.list=i,r.startIndex=a,r.title=n,r.isWatermark=o,r.watermarkText=s;var l=$(r.document).find(".dataDom");l.click()},1e3)})},showAlbumPage=function(e,t,i,a){if(null!=window&&(gallery=window.opener,gallery&&0==gallery.closed)){var n=$(gallery.document).find(".al-single .dataDom");gallery.focus(),n.attr("data-gi",e),n.attr("data-ti",t),n.attr("data-gai",i),n.attr("data-name",a),n.click()}},getAlbum=function(e,t,i,a){try{var a=a||!1,n="groups/"+e+"/galleries/"+t+"/images",o={ui:ui,at:at,li:lang},s="get";return ajaxDo(n,o,s,i,!1,!1,a)}catch(r){return errorReport(r),null}},getGroupData=function(e,t,i,a){var a=a||!1,n="groups/"+e;i&&(n=n+"?tp="+i);var o={ui:ui,at:at,li:lang},s="get";return ajaxDo(n,o,s,t,!1,!1,a)},setGroupAttributes=function(e,t){try{var i=$.lStorage(ui);if(!i.hasOwnProperty(e))return i[e]=t,void $.lStorage(ui,i);var a=i[e],n=["auo","aut","cnt"],o=["rsp_code"];for(var s in t)if(n.indexOf(s)>=0)a[s]=t[s];else if(!a.hasOwnProperty(s)){if("object"==typeof t[s])continue;if(o.indexOf(s)>=0)continue;a[s]=t[s]}a.gn=t.gn||"",a.gd=t.gd||"",a.set=t.set,$.lStorage(ui,i)}catch(r){errorReport(r)}
},updateGroupAllInfoDom=function(e){try{var t=$.lStorage(ui),i=t[e],a="images/common/others/name_card_nophoto_profile.png",n="images/common/others/empty_img_all_l.png";i.auo?$(".polling-group-pic-o[data-gi="+e+"]").attr("src",i.auo):$(".polling-group-pic-o[data-gi="+e+"]").attr("src",a),i.aut?$(".polling-group-pic-t[data-gi="+e+"]").attr("src",i.aut):$(".polling-group-pic-t[data-gi="+e+"]").attr("src",n);var o=htmlFormat(i.gn),s=htmlFormat(i.gd);$(".polling-group-name[data-gi="+e+"]").html(o),$(".polling-group-description[data-gi="+e+"]").html(s),gi==e&&(i.auo?$(".polling-group-pic-o.currentGroup").attr("src",i.auo):$(".polling-group-pic-o.currentGroup").attr("src",a),i.aut?$(".polling-group-pic-t.currentGroup").attr("src",i.aut):$(".polling-group-pic-t.currentGroup").attr("src",n),$(".polling-group-name.currentGroup").html(o),$(".polling-group-description.currentGroup").html(s))}catch(r){errorReport(r)}},updateGroupIconDom=function(e){try{var t=$.lStorage(ui),i=t[e],a="images/common/others/name_card_nophoto_profile.png",n="images/common/others/empty_img_all_l.png";i.auo?$(".polling-group-pic-o[data-gi="+e+"]").attr("src",i.auo):$(".polling-group-pic-o[data-gi="+e+"]").attr("src",a),i.aut?$(".polling-group-pic-t[data-gi="+e+"]").attr("src",i.aut):$(".polling-group-pic-t[data-gi="+e+"]").attr("src",n)}catch(o){errorReport(o)}},updateBranchList=function(e,t){var e=e||gi;if(e){var i="groups/"+e+"/branches",a={ui:ui,at:at,li:lang},n="get";ajaxDo(i,a,n,!1).complete(function(i){if(200==i.status){var a=$.parseJSON(i.responseText);setBranchList(e,a,t)}})}},setBranchList=function(e,t,a){var e=e||gi;if(e){window.testBl=t,console.debug("branch_list",t);var n={},o={},s=$.lStorage(ui),r=s[e].guAll;if(t.bl.length){$.each(t.bl,function(e,t){if(null!=t.bp&&0!=t.bp.length){var i=t.bp.replace(/^\./,"").split("."),a="";i.length>1&&(a=i[i.length-2]),n[i.last()]={lv:i.length,bn:t.bn,cl:[],cnt:0,pi:a,bp_arr:i}}}),$.each(n,function(e,t){if(t.lv>1){var i=t.bp_arr[t.bp_arr.length-2];n[i]&&n[i].cl.push(e)}delete t.bp_arr}),window.testNewBl=n;for(var l in n){var c=0;for(var d in r){var u=r[d];if(u&&1==u.st&&u.bl.indexOf(l)>=0)for(i=0;i<u.bl.split(",").length;i++)if(void 0!==n[u.bl.split(",")[i].split(".").last()]){c++;break}}n[l].cnt=c}}t.fbl.length&&$.each(t.fbl,function(e,t){o[t.fi]={fn:t.fn,cnt:0}});var h=0;$.each(r,function(e,t){if(null!=t&&1==t.st){if(t.fbl&&t.fbl.length>0)for(var e=0;e<t.fbl.length;e++){var i=t.fbl[e];o[i]&&o[i].cnt++}1==t.fav&&h++}}),s[e].favCnt=h,s[e].bl=n,s[e].fbl=o,$.lStorage(ui,s),a&&a(e)}},getGroupCompetence=function(e){var t={isAdmin:!1,isOfficial:!1};try{var i=$.lStorage(ui)[e];1==i.ad&&(t.isAdmin=!0),i.isOfficial&&(t.isOfficial=i.isOfficial)}catch(a){errorReport(a)}return t},getS3FileNameWithExtension=function(e,t){var i="qmi_file";if(e){var a=e.indexOf("?");a>=0&&(i=e.substring(a-38,a))}switch(t){case 6:i+=".png"}return i},getQRCodeFileNameWithExtension=function(e){var t="qmi_qrcode.png";if(e){var i=e.lastIndexOf("/");i>=0&&(t=e.substring(i+1,e.length)+".png")}return t},renderVideoFile=function(e,t,i,a){var n=new FileReader;n.onload=function(e){if(t.addClass("loaded"),t.length>0){var o=t[0];o.oncanplay=function(e){t.addClass("loaded"),i&&i(t)},o.onerror=function(e){t.addClass("error"),a&&a(t)}}else i&&i(t);t.attr("src",n.result)},n.onerror=function(e){t.addClass("error"),a&&a(t)},n.readAsDataURL(e)},renderVideoUrl=function(e,t,i,a){t.length>0&&(t[0].oncanplay=function(e){t.addClass("loaded"),i&&i(t)},t[0].onerror=function(e){t.addClass("error"),a&&a(t)},t.attr("src",e))},renderImageWithWatermark=function(i,a,n,o){var s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=function(){var n=document.createElement("canvas"),r=n.getContext("2d");n.width=s.width,n.height=s.height,e(r,s,0,0,n.width,n.height),t(r,n.width,n.height,a,"48px",68),i.attr("src",n.toDataURL("image/png",o))},s.src=n},"undefined"!=typeof require?getWatermarkImage=function(i,a,n,o,s){if(o){s||(s="24px");var r=new Image;r.crossOrigin="*",r.onload=function(){var a=document.createElement("canvas"),n=a.getContext("2d");a.width=r.width,a.height=r.height,e(n,r,0,0,a.width,a.height),t(n,a.width,a.height,i,s,68);for(var l=a.toDataURL("image/png",1),c=atob(l.split(",")[1]),d=new ArrayBuffer(c.length),u=new Uint8Array(d),h=0;h<c.length;h++)u[h]=255&c.charCodeAt(h);try{var p=new Blob([d],{type:"application/octet-stream"})}catch(f){var g=new(window.WebKitBlobBuilder||window.MozBlobBuilder);g.append(d);var p=g.getBlob("application/octet-stream")}var m=window.URL.createObjectURL(p);o(m)},r.src=a}}:(drawCanvasBgColor=function(e,t,i,a,n,o){e.save(),e.rect(i,a,n,o),e.fillStyle=t,e.fill(),e.restore()},getWatermarkImage=function(e,i,a,n,o){if(n){o||(o="24px");var s=document.createElement("canvas"),r=s.getContext("2d");s.width=300,s.height=300,e="watermark not supported.",drawCanvasBgColor(r,"white",0,0,s.width,s.height),t(r,s.width,s.height,e,o,68,"gray");for(var l=s.toDataURL("image/png",1),c=atob(l.split(",")[1]),d=new ArrayBuffer(c.length),u=new Uint8Array(d),h=0;h<c.length;h++)u[h]=255&c.charCodeAt(h);try{var p=new Blob([d],{type:"application/octet-stream"})}catch(f){var g=new(window.WebKitBlobBuilder||window.MozBlobBuilder);g.append(d);var p=g.getBlob("application/octet-stream")}var m=window.URL.createObjectURL(p);n(m)}}),checkPhoneValidation=function(e,t){if(null!=e&&null!=t){switch(e){case"+886":return 10==t.length&&"09"==t.substring(0,2);case"+86":return 11==t.length&&"1"==t.substring(0,1);case"+852":return 8==t.length;case"+853":return 8==t.length&&"6"==t.substring(0,1);case"+1":return 10==t.length}return!0}},getInternationalPhoneNumber=function(e,t){if(null==e||null==t)return"";if(checkPhoneValidation(e,t))switch(e){case"+886":return t.substring(1,t.length);default:return t}return""},copyTextToClipboard=function(e){try{var t=require("nw.gui"),i=t.Clipboard.get();i.set(e,"text"),toastShow($.i18n.getString("FEED_COPY_CONTENT_SUCC"))}catch(a){}},errorReport=function(e){if(e){if(0==e.message.indexOf("riseNotification"))return;console.debug("----- errorReport --------------------"),e.stack?console.debug(e.stack):console.debug(arguments.callee.caller,e.message),console.debug("-------------------- errorReport -----")}},deleteFolderRecursive=function(e,t){e.existsSync(t)&&(e.readdirSync(t).forEach(function(i,a){var n=t+"/"+i;e.lstatSync(n).isDirectory()?deleteFolderRecursive(e,n):e.unlinkSync(n)}),e.rmdirSync(t))},clearCache=function(){try{var e=require("nw.gui");return e.App.clearCache(),e.Window.get().reload(),cns.debug("update successed"),!0}catch(t){cns.debug(t.stack)}return!1},setBadgeLabel=function(e){try{require("nw.gui").Window.get().setBadgeLabel(e)}catch(t){}},clearBadgeLabel=function(){try{require("nw.gui").Window.get().setBadgeLabel("")}catch(e){}},loadScript=function(e){var t=e.split("/"),i=t[t.length-1].split(".")[0],a=i.substring(0,1).toUpperCase()+i.substring(1),n=$.Deferred();return"undefined"==typeof window[a]?$.get(e,function(){n.resolve(a)}):n.resolve(a),n.promise()}}),$(function(){init=function(){idb_timeline_events=new IDBStore({dbVersion:5,storeName:"timeline_events",keyPath:"ei",indexes:[{name:"gi_ct",keyPath:["gi","ct"]},{name:"gi_tp_ct",keyPath:["gi","tp","ct"]}]})},init()}),function(e,t,i){"function"==typeof define?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():i[e]=t()}("IDBStore",function(){"use strict";var e=function(e){throw e},t={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:e,indexes:[]},i=function(e,i){"undefined"==typeof i&&"function"==typeof e&&(i=e),"[object Object]"!=Object.prototype.toString.call(e)&&(e={});for(var a in t)this[a]="undefined"!=typeof e[a]?e[a]:t[a];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,i&&(this.onStoreReady=i);var n="object"==typeof window?window:self;this.idb=n.indexedDB||n.webkitIndexedDB||n.mozIndexedDB,this.keyRange=n.IDBKeyRange||n.webkitIDBKeyRange||n.mozIDBKeyRange,this.features={hasAutoIncrement:!n.mozIndexedDB},this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()};i.prototype={constructor:i,version:"1.4.1",db:null,dbName:null,dbVersion:null,store:null,storeName:null,keyPath:null,autoIncrement:null,indexes:null,features:null,onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var e=this.idb.open(this.dbName,this.dbVersion),t=!1;e.onerror=function(e){var t=!1;"error"in e.target?t="VersionError"==e.target.error.name:"errorCode"in e.target&&(t=12==e.target.errorCode),t?this.onError(new Error("The version number provided is lower than the existing one.")):this.onError(e)}.bind(this),e.onsuccess=function(e){if(!t){if(this.db)return void this.onStoreReady();if(this.db=e.target.result,"string"==typeof this.db.version)return void this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."));if(!this.db.objectStoreNames.contains(this.storeName))return void this.onError(new Error("Something is wrong with the IndexedDB implementation in this browser. Please upgrade your browser."));var i=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=i.objectStore(this.storeName);var a=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(e){var i=e.name;if(!i)return t=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(e),this.hasIndex(i)){var n=this.store.index(i),o=this.indexComplies(n,e);o||(t=!0,this.onError(new Error('Cannot modify index "'+i+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),a.splice(a.indexOf(i),1)}else t=!0,this.onError(new Error('Cannot create new index "'+i+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))},this),a.length&&(t=!0,this.onError(new Error('Cannot delete index(es) "'+a.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),t||this.onStoreReady()}}.bind(this),e.onupgradeneeded=function(e){if(this.db=e.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=e.target.transaction.objectStore(this.storeName);else{var i={autoIncrement:this.autoIncrement};null!==this.keyPath&&(i.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,i)}var a=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(e){var i=e.name;if(i||(t=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(e),this.hasIndex(i)){var n=this.store.index(i),o=this.indexComplies(n,e);o||(this.store.deleteIndex(i),this.store.createIndex(i,e.keyPath,{unique:e.unique,multiEntry:e.multiEntry})),a.splice(a.indexOf(i),1)}else this.store.createIndex(i,e.keyPath,{unique:e.unique,multiEntry:e.multiEntry})},this),a.length&&a.forEach(function(e){this.store.deleteIndex(e)},this)}.bind(this)},deleteDatabase:function(){this.idb.deleteDatabase&&this.idb.deleteDatabase(this.dbName)},put:function(t,i,n,o){null!==this.keyPath&&(o=n,n=i,i=t),o||(o=e),n||(n=a);var s,r=!1,l=null,c=this.db.transaction([this.storeName],this.consts.READ_WRITE);return c.oncomplete=function(){var e=r?n:o;e(l)},c.onabort=o,c.onerror=o,null!==this.keyPath?(this._addIdPropertyIfNeeded(i),s=c.objectStore(this.storeName).put(i)):s=c.objectStore(this.storeName).put(i,t),s.onsuccess=function(e){r=!0,l=e.target.result},s.onerror=o,c},get:function(t,i,n){n||(n=e),i||(i=a);var o=!1,s=null,r=this.db.transaction([this.storeName],this.consts.READ_ONLY);r.oncomplete=function(){var e=o?i:n;e(s)},r.onabort=n,r.onerror=n;var l=r.objectStore(this.storeName).get(t);return l.onsuccess=function(e){o=!0,s=e.target.result},l.onerror=n,r},remove:function(t,i,n){n||(n=e),i||(i=a);var o=!1,s=null,r=this.db.transaction([this.storeName],this.consts.READ_WRITE);r.oncomplete=function(){var e=o?i:n;e(s)},r.onabort=n,r.onerror=n;var l=r.objectStore(this.storeName)["delete"](t);return l.onsuccess=function(e){o=!0,s=e.target.result},l.onerror=n,r},batch:function(t,i,n){n||(n=e),i||(i=a),"[object Array]"!=Object.prototype.toString.call(t)&&n(new Error("dataArray argument must be of type Array."));var o=this.db.transaction([this.storeName],this.consts.READ_WRITE);o.oncomplete=function(){var e=l?i:n;e(l)},o.onabort=n,o.onerror=n;var s=t.length,r=!1,l=!1,c=function(){s--,0!==s||r||(r=!0,l=!0)};return t.forEach(function(e){var t=e.type,i=e.key,a=e.value,s=function(e){o.abort(),r||(r=!0,n(e,t,i))};if("remove"==t){var l=o.objectStore(this.storeName)["delete"](i);l.onsuccess=c,l.onerror=s}else if("put"==t){var d;null!==this.keyPath?(this._addIdPropertyIfNeeded(a),d=o.objectStore(this.storeName).put(a)):d=o.objectStore(this.storeName).put(a,i),d.onsuccess=c,d.onerror=s}},this),o},putBatch:function(e,t,i){var a=e.map(function(e){return{type:"put",value:e}});return this.batch(a,t,i)},removeBatch:function(e,t,i){var a=e.map(function(e){return{type:"remove",key:e}});return this.batch(a,t,i)},getBatch:function(t,i,n,o){n||(n=e),i||(i=a),o||(o="sparse"),"[object Array]"!=Object.prototype.toString.call(t)&&n(new Error("keyArray argument must be of type Array."));var s=this.db.transaction([this.storeName],this.consts.READ_ONLY);s.oncomplete=function(){var e=d?i:n;e(u)},s.onabort=n,s.onerror=n;var r=[],l=t.length,c=!1,d=!1,u=null,h=function(e){e.target.result||"dense"==o?r.push(e.target.result):"sparse"==o&&r.length++,l--,0===l&&(c=!0,d=!0,u=r)};return t.forEach(function(e){var t=function(e){c=!0,u=e,n(e),s.abort()},i=s.objectStore(this.storeName).get(e);i.onsuccess=h,i.onerror=t},this),s},getAll:function(t,i){i||(i=e),t||(t=a);var n=this.db.transaction([this.storeName],this.consts.READ_ONLY),o=n.objectStore(this.storeName);return o.getAll?this._getAllNative(n,o,t,i):this._getAllCursor(n,o,t,i),n},_getAllNative:function(e,t,i,a){var n=!1,o=null;e.oncomplete=function(){var e=n?i:a;e(o)},e.onabort=a,e.onerror=a;var s=t.getAll();s.onsuccess=function(e){n=!0,o=e.target.result},s.onerror=a},_getAllCursor:function(e,t,i,a){var n=[],o=!1,s=null;e.oncomplete=function(){var e=o?i:a;e(s)},e.onabort=a,e.onerror=a;var r=t.openCursor();r.onsuccess=function(e){var t=e.target.result;t?(n.push(t.value),t["continue"]()):(o=!0,s=n)},r.onError=a},clear:function(t,i){i||(i=e),t||(t=a);var n=!1,o=null,s=this.db.transaction([this.storeName],this.consts.READ_WRITE);s.oncomplete=function(){var e=n?t:i;e(o)},s.onabort=i,s.onerror=i;var r=s.objectStore(this.storeName).clear();return r.onsuccess=function(e){n=!0,o=e.target.result},r.onerror=i,s},_addIdPropertyIfNeeded:function(e){this.features.hasAutoIncrement||"undefined"!=typeof e[this.keyPath]||(e[this.keyPath]=this._insertIdCount++ +Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(e){return this.store.indexNames.contains(e)},normalizeIndexData:function(e){e.keyPath=e.keyPath||e.name,e.unique=!!e.unique,e.multiEntry=!!e.multiEntry},indexComplies:function(e,t){var i=["keyPath","unique","multiEntry"].every(function(i){if("multiEntry"==i&&void 0===e[i]&&t[i]===!1)return!0;if("keyPath"==i&&"[object Array]"==Object.prototype.toString.call(t[i])){var a=t.keyPath,n=e.keyPath;if("string"==typeof n)return a.toString()==n;if("function"!=typeof n.contains&&"function"!=typeof n.indexOf)return!1;if(n.length!==a.length)return!1;for(var o=0,s=a.length;s>o;o++)if(!(n.contains&&n.contains(a[o])||n.indexOf(-1!==a[o])))return!1;return!0}return t[i]==e[i]});return i},iterate:function(t,i){i=o({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:e},i||{});var a="desc"==i.order.toLowerCase()?"PREV":"NEXT";i.filterDuplicates&&(a+="_NO_DUPLICATE");var n=!1,s=this.db.transaction([this.storeName],this.consts[i.writeAccess?"READ_WRITE":"READ_ONLY"]),r=s.objectStore(this.storeName);i.index&&(r=r.index(i.index)),s.oncomplete=function(){return n?void(i.onEnd?i.onEnd():t(null)):void i.onError(null)},s.onabort=i.onError,s.onerror=i.onError;var l=r.openCursor(i.keyRange,this.consts[a]);return l.onerror=i.onError,l.onsuccess=function(e){var a=e.target.result;a?(t(a.value,a,s),i.autoContinue&&a["continue"]()):n=!0},s},query:function(e,t){var i=[];return t=t||{},t.onEnd=function(){e(i)},this.iterate(function(e){i.push(e)},t)},limit:function(e,t){var i=[],a=0;return t=t||{},t.limit=t.limit||0,t.autoContinue=!1,t.onEnd=function(){e(i)},t.onError=function(t){console.debug("error:",t),e(i)},this.iterate(function(e,n){a<=t.limit-1&&(i.push(e),a++,n["continue"]())},t)},count:function(t,i){i=o({index:null,keyRange:null},i||{});var a=i.onError||e,n=!1,s=null,r=this.db.transaction([this.storeName],this.consts.READ_ONLY);r.oncomplete=function(){var e=n?t:a;e(s)},r.onabort=a,r.onerror=a;var l=r.objectStore(this.storeName);i.index&&(l=l.index(i.index));var c=l.count(i.keyRange);return c.onsuccess=function(e){n=!0,s=e.target.result},c.onError=a,r},makeKeyRange:function(e){var t,i="undefined"!=typeof e.lower,a="undefined"!=typeof e.upper,n="undefined"!=typeof e.only;switch(!0){case n:t=this.keyRange.only(e.only);break;case i&&a:t=this.keyRange.bound(e.lower,e.upper,e.excludeLower,e.excludeUpper);break;case i:t=this.keyRange.lowerBound(e.lower,e.excludeLower);break;case a:t=this.keyRange.upperBound(e.upper,e.excludeUpper);break;default:throw new Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return t}};var a=function(){},n={},o=function(e,t){var i,a;for(i in t)a=t[i],a!==n[i]&&a!==e[i]&&(e[i]=a);return e};return i.version=i.prototype.version,i},this);var this_gi,this_gai,this_ti,name,list=[],scrollVal=0,scrollPercent=0,isCheckPosi=!1,checkTime=0,nextScrollTime=0,bIsScrollPage=!0,viewInterval=null;initGallery=function(){$(".al-category").hide(),$(".al-single").hide(),$(".al-all").fadeIn()},initChatGallery=function(){var e=$('<div class="grid" data-type="chatroom"><div class="img"><img src="images/icon/icon_chatroom_more_albums_normal.png"/></div><div class="text"></div></div>');try{$(".al-category .title").html($.i18n.getString("CHAT_TITLE"));var t=$.lStorage(ui),i=t[gi],a=$(".al-category .container");a.html("");for(var n in i.chatAll){var o=e.clone(),s=i.chatAll[n];0!=s.tp&&(o.data("ci",n),o.data("cn",s.cn),o.find(".text").html(s.cn),a.append(o))}$(".al-category").fadeIn(),$(".al-single").hide(),$(".al-all").fadeOut()}catch(r){return errorReport(r),void toastShow("some error occured.")}},$(document).ready(function(){$(document).on("click",".subpage-album .back",function(){$(".al-category").fadeOut(),$(".al-single").fadeOut(),$(".al-all").fadeIn()}),$(document).on("click",".al-all .grid",function(){$(".al-all").fadeOut(),$(".al-category").fadeIn(),$(".al-single").hide();var e=$(this).data("type");switch(e){case"chatroom":initChatGallery()}}),$(document).on("click",".al-category .grid",function(){$(".al-all").hide(),$(".al-category").fadeOut(),$(".al-single").fadeIn();var e=$(this).data("ci"),t=$(this).data("cn");return null==e?(cns.debug("null ci"),void toastShow("some error occured.")):(this_gi=gi,this_gai=e,this_ti=e,name=t,void initSingleChatGallery())}),$(".dataDom").off("click").click(function(){var e=$(this);e.attr("data-gi")&&(this_gi=e.attr("data-gi")),e.attr("data-gai")&&(this_gai=e.attr("data-gai")),e.attr("data-ti")&&(this_ti=e.attr("data-ti")),e.attr("data-name")&&(name=e.attr("data-name")),$('.sm-small-area[data-sm-act="album"]').trigger("click"),$(".al-all").hide(),$(".al-category").hide(),$(".al-single").show(),initSingleChatGallery()}),$(document).on("click",".al-single .imgGrid",function(){if(!($(".ct-imgList .img.loading").length>0)){var e=$(this).find("img").data("index");cns.debug(e),showGallery(null,null,list,e,name)}})}),minetypeToTypeID=function(e){return null==e?-1:(e=e.toLowerCase(),e.indexOf("text")>=0?0:e.indexOf("image")>=0?6:e.indexOf("audio")>=0?8:-1)};var bl,guAll,inviteGuAll,guAllExsit,fbl,isList=!0,g_group,g_contactWaitLoadImgs,g_newMemList;$(document).ready(function(){$(document).off("click",".contact-add"),$(document).on("click",".contact-add",function(e){showAddMemberPage()}),$("#page-contact-addmem .ca-content-area").niceScroll({cursorcolor:"rgba(107, 107, 107,0.8)",cursorwidth:"10",cursorborderradius:"10px",background:"rgba(255,255,255,0)",cursorborder:"",boxzoom:!1,zindex:999,scrollspeed:90,mousescrollstep:40})}),initContactList=function(){if($(".subpage-contact .contact-search .clear").trigger("click"),0!=initContactData()){var e=$(".subpage-contact .contact-rows");if(e&&!(e.length<=0)){e.html("");var t=$(".contact-subpages");t.is(":visible")&&t.find(".page-back").trigger("click"),$("#page-contact_all").data("gi",null);var i=$("<div class='row all'><div class='left'></div><div class='right'></div></div>"),a=i.find(".left");a.append("<div class='name'>"+$.i18n.getString("COMMON_ALL_MEMBERS")+"</div>"),a.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",Object.keys(guAllExsit).length)+"</div>"),i.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),e.append(i),e.find(".row.all").off("click").click(function(){showAllMemberPage(g_group.gn)});var n=Object.keys(g_newMemList).length;n>0&&i.find(".right").prepend("<div class='new'>"+n+"</div>");var i=$("<div class='row favorite'><div class='left'></div><div class='right'></div></div>"),a=i.find(".left"),o=Object.keys(fbl).length;a.append("<div class='name'>"+$.i18n.getString("COMMON_FAVORIATE")+"</div>"),a.append("<div class='detail mem'>"+$.i18n.getString("COMPOSE_N_MEMBERS",g_group.favCnt?g_group.favCnt:0)+"</div>"),o>0&&a.append("<div class='detail branch'>"+$.i18n.getString("COMPOSE_N_SUBGROUP",o)+"</div>"),i.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),e.append(i),e.find(".row.favorite").off("click").click(showFavoritePage),$("#page-group-main").find(".page-title").html(g_group.gn),Object.keys(bl).length>0&&$.each(bl,function(t,i){if(1==i.lv){var a=$("<div class='row branch'><div class='left'></div><div class='right'></div></div>"),n=a.find(".left");n.append("<div class='name'>"+i.bn+"</div>"),n.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",i.cnt)+"</div>"),i.cl.length>0&&n.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_SUBGROUP",i.cl.length)+"</div>"),a.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),a.data("bi",t),e.append(a)}}),e.find(".row.branch").off("click").click(function(){console.debug("???"),showSubContactPage("page-group-main",$(this).data("bi"),JSON.stringify([]))});var s=$(".contact-search .content"),r=s.find(".input");r.data("searchText",""),r.off("keyup").keyup(onSearchInput),s.find(".clear").off("click").click(deactiveSearch),r.off("focusout").focusout(function(){var e=r.val();e&&0!=e.length||deactiveSearch()});var l=$(".contact-search .hintDiv");l.off("click").click(function(){$(this).hide(),s.show(),r.focus()}),$(window).off("resize").resize(function(){$(".contact-branchList").height($(window).height()-105),$(".contact-scroll").height($(window).height()-112)})}}},deactiveSearch=function(){var e=$(".contact-search .content");e.hide();var t=e.find(".input");t.data("searchText",""),t.val(""),$(".contact-search .hintDiv").show(),$(".subpage-contact .contact-rows").show(),$(".contact-searchResult").hide()},onSearchInput=function(e){var t=$(this);t.val().indexOf("\n")>=0&&t.val(t.val().replace("/\n/g",""));var i=t.val();if(!i||0==i.length)return $(".contact-searchResult").hide(),void $(".subpage-contact .contact-rows").show();if(t.data("searchText")!=i){t.data("searchText",i),cns.debug(i);var a=$(".subpage-contact .contact-rows"),n=$(".subpage-contact .contact-searchResult");if(!i||0==i.length)return $(".contact-searchResult").hide(),void $(".subpage-contact .contact-rows").show();n&&0!=n.length||(n=$('<div class="contact-searchResult" style="display:none;"></div>'),a.after(n)),n.show().scrollTop(0),a.hide(),i=i.toLowerCase();var o={},s=0;for(var r in guAllExsit){var l=guAllExsit[r];null==l.nk?cns.debug(JSON.stringify(l)):l.nk.toLowerCase().indexOf(i)>=0&&(o[r]=l,s++)}var c=[];for(var r in bl){var d=bl[r];d.bn.toLowerCase().indexOf(i)>=0&&c.push(r)}var u=c.length,h=$(".contact-searchResult .memTitle"),p=$(".contact-searchResult .branchTitle");if(0==u&&0==s)return $(".contact-searchResult .noResult").show(),h.hide(),p.hide(),$(".contact-searchResult .contact-memLists").hide(),void $(".contact-searchResult .contact-rows").hide();if($(".contact-searchResult .noResult").hide(),s>0){h.show();var f=$(".contact-searchResult .contact-memLists");f&&f.length>0&&f.remove(),f=generateMemberList(o),h.after(f),setOnMemListScroll()}else h.hide();if(u>0){p.show();var g=$(".contact-searchResult .contact-rows");g&&g.length>0&&g.remove(),g=generateBranchList(c),g.find(".row.branch").off("click").click(function(){showSubContactPage("page-group-main",$(this).data("bi"),JSON.stringify([]))}),p.after(g)}else p.hide()}},showSubContactPage=function(e,t,i,a){null==a&&(a=!0);var n=$.parseJSON(i),o=bl[t];if(o){n.push(o.bn);var s=o.lv,r=o.cl,l="page-contact_sub"+s,c=$("#"+l);if(c&&0!=c.length||(c=$('<div data-role="page" id="'+l+'" class="subPage contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/common/icon/bt_close_activity.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-contact"></div></div>'),$("#"+e).after(c)),!a)return c.data("gen",!1),c.data("parentPageID",e),c.data("bi",t),c.data("lvStackString",i),void cns.debug(c.data("gen"),c.data("parentPageID"),c.data("bi"),c.data("lvStackString"));c.data("gen",!0),c.data("gi",gi),c.find(".page-title").html(o.bn),c.find(".page-back").off("click").click(function(){$(".contact-branchList").remove(),showMainContact()});var d=c.find(".subpage-contact");d.html("");var u=$("<div class='contact-titleBar'></div>"),h=$("<div class='nameArea list'></div>");h.append("<div class='name'>"+o.bn+"</div>"),h.append("<div class='arrow'></div>"),u.append(h),u.append("<div class='btn'></div>"),d.append(u),u.find(".btn").off("click").click(function(){switchListAndGrid($(this),m)}),cns.debug(s);var p=$(".contact-branchList");if(0==p.length||1==s)p.remove(),p=$('<div class="contact-branchList" style="display:none;"></div>'),showSubbranchListBox(p,o.lv,t,JSON.stringify([])),p.find(".row:nth-child(1)").addClass("current"),p.find(".row.list").off("click").click(function(){cns.debug($(this).data("bi"));var e=$(this).data("stack"),t=n.slice(0);if(e&&e.length>0){var i=$.parseJSON(e),a=s,o="page-contact_sub"+a;showSubContactPage(o,i[i.length-1],JSON.stringify(t))}p.css("display","none"),u.find(".arrow").removeClass("open")}),c.after(p);else{var f=p.find(".row.current");f.removeClass("current");var g=p.find(".row."+t);g.addClass("current")}h.off("click").click(function(){p.slideToggle(400,function(){var e=$(this).find(".row.current"),t=$(this),i=e.position().top;cns.debug(e.position().top,t.scrollTop()),(i>t.height()||0>i)&&t.scrollTop(t.scrollTop()+e.position().top)}),u.find(".arrow").toggleClass("open")});var m=$('<div class="contact-scroll"></div>');if(d.append(m),n.length>1){var v=$("<div class='contact-lvStack'></div>");if(n.length<=3)for(var b=0;b<n.length;b++)cns.debug(n[b]),v.append("<div>"+n[b]+"</div><img src='images/common/icon/icon_arrow_grey_right.png'>");else{v.append("<div>...</div>");for(var b=n.length-3;b<n.length;b++)cns.debug(n[b]),v.append("<div>"+n[b]+"</div><img src='images/common/icon/icon_arrow_grey_right.png'>")}var w=v.find("img:last-child");w.remove(),m.append(v)}var _=$("<div class='contact-mems-title'></div>");_.append('<div class="count">0</div>'),_.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),m.append(_);var y={},x=0;$.each(guAllExsit,function(e,i){for(b=0;b<i.bl.split(",").length;b++)[i.bl.split(",")[b].split(".").last()],i.bl.split(",")[b].split(".").last()==t&&(x++,y[e]=i)});var k=generateMemberGrid(y);m.append(k);var C=generateMemberList(y);if(m.append(C),isList?(u.find(".btn").addClass("list"),k.css("display","none"),setOnMemListScroll()):(C.css("display","none"),setOnMemGridScroll()),0==x?(_.hide(),C.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",o.bn)+"</div>"),k.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",o.bn)+"</div>")):_.find(".count").html(x),r.length>0){var _=$("<div class='contact-rows-title'></div>");_.append('<div class="text">'+$.i18n.getString("COMPOSE_N_SUBGROUP","<b class='count'>"+r.length+"</b>")+"</div>"),m.append(_);var S=generateBranchList(r);m.append(S),m.find(".row.branch").off("click").click(function(){showSubContactPage(l,$(this).data("bi"),JSON.stringify(n))})}$("#"+l+" .contact-branchList").height($(window).height()-110),$("#"+l+" .contact-scroll").height($(window).height()-112),"page-group-main"==e?$.mobile.changePage("#"+l,{transition:"slide",reverse:!1}):$.mobile.changePage("#"+l)}},showSubbranchListBox=function(e,t,i,a){if(i&&e&&!(e.length<0)){var n=$.parseJSON(a);n.push(i),a=JSON.stringify(n);var o=bl[i],s=$("<div class='row list _"+(o.lv-t+1)+" "+i+"'><div class='left'></div><div class='right'>"+o.lv+"</div></div>"),r=s.find(".left");if(r.append("<div class='name'>"+o.bn+"</div>"),r.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",o.cnt)+"</div>"),s.data("stack",a),s.data("bi",i),s.css("padding-left",20*(Math.min(11,o.lv-t)+1)+"px"),t==o.lv?e.append(s):e.after(s),o.cl.length>0)for(var l=0;l<o.cl.length;l++)showSubbranchListBox(s,t,o.cl[l],a)}},showAllMemberPage=function(e){var t="page-contact_all",i=$("#"+t);if(i&&0!=i.length){if(gi==i.data("gi"))return void $.mobile.changePage("#"+t,{transition:"slide"})}else i=$('<div data-role="page" id="'+t+'" class="contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/navi/navi_icon_back.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-contact"></div></div>'),$("#page-group-main").after(i);i.data("gi",gi),i.find(".page-title").html($.i18n.getString("MEMBER_ALL")),i.find(".page-back").off("click").click(showMainContact);var a=i.find(".subpage-contact");a.html("");var n=$("<div class='contact-titleBar'></div>"),o=$("<div class='nameArea'></div>");o.append("<div class='name'>"+$.i18n.getString("MEMBER_ALL")+"</div>"),n.append(o),n.append("<div class='btn'></div>"),a.append(n);var s=$('<div class="contact-scroll"></div>');a.append(s),n.find(".btn").off("click").click(function(){switchListAndGrid($(this),s)});var r=$("<div class='contact-mems-title'></div>");r.append('<div class="count">0</div>'),r.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),s.append(r);var l=Object.keys(guAllExsit).length,c=generateMemberGrid(guAllExsit);s.append(c);var d=generateMemberList(guAllExsit);s.append(d),isList?(n.find(".btn").addClass("list"),c.css("display","none"),setOnMemListScroll()):(d.css("display","none"),setOnMemGridScroll()),0==l?(r.hide(),c.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",e)+"</div>"),d.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",e)+"</div>")):r.find(".count").html(l),$("#"+t+" .contact-scroll").height($(window).height()-112),$.mobile.changePage("#"+t,{transition:"slide"})},switchListAndGrid=function(e,t){isList=!isList;var i=$.lStorage(ui);i.isMemberShowList=isList,$.lStorage(ui,i);var a=t.find(".contact-mems"),n=t.find(".contact-memLists");isList?(a.fadeOut("fast",function(){n.show(0)}),e.addClass("list"),setOnMemListScroll(),updateNewMemTag(n)):(n.fadeOut("fast",function(){a.show(0)}),e.removeClass("list"),setOnMemGridScroll(),updateNewMemTag(a))},generateMemberGrid=function(e){var t=$("<div class='contact-mems'></div>");try{var i=Object.keys(e);i.sort(function(t,i){return e[t].nk<e[i].nk?-1:e[t].nk>e[i].nk?1:0});for(var a=0;a<i.length;a++){var n=i[a],o=e[n];if(null==o)cns.debug(n);else{var s=$("<div class='mem namecard'></div>");
if(o.aut&&o.aut.length>0?s.append("<div class='img waitLoad' data-url='"+o.aut+"'><div class='new' style='display:none;'>NEW</div></div>"):s.append("<div class='img'><div class='new' style='display:none;'>NEW</div></div>"),s.append("<div class='name'>"+o.nk.replaceOriEmojiCode()+"</div>"),s.data("gu",n),isNewMem(o)){s.addClass("new-mem");var r=t.find(".new-mem");r.length>0?$(r[r.length-1]).after(s):t.prepend(s),setNewMemTag(s)}else if(1==o.ad){s.addClass("admin");var l=t.find(".admin");if(l.length>0)$(l[l.length-1]).after(s);else{var r=t.find(".new-mem");r.length>0?$(r[r.length-1]).after(s):t.prepend(s)}}else t.append(s)}}var s=t.find(".img.waitLoad:lt(30)");$.each(s,function(e,t){var i=$(t);i.css("background-image","url("+i.attr("data-url")+")").removeClass("waitLoad").removeAttr("data-url")}),g_contactWaitLoadImgs=t.find(".img.waitLoad")}catch(c){errorReport(c)}return t},generateMemberList=function(e,t){var i=$("<div class='contact-memLists'></div>");try{var a=Object.keys(e);a.sort(function(t,i){return e[t].nk<e[i].nk?-1:e[t].nk>e[i].nk?1:0});for(var n=0;n<a.length;n++){var o=a[n],s=e[o],r=$("<div class='row mem namecard'><div class='left'></div><div class='mid'></div><div class='right'>&nbsp</div></div>"),l=r.find(".left");s.aut&&s.aut.length>0?l.append("<div class='img waitLoad' data-url='"+s.aut+"'><div class='new' style='display:none;'>NEW</div></div>"):l.append("<div class='img'></div>");var c=r.find(".mid");c.append("<div class='name'>"+s.nk.replaceOriEmojiCode()+"</div>");var d="";try{d=bl[s.bl.split(",")[0].split(".")[0]].bn}catch(u){}var h=$("<div class='detail'>"+d+"</div>");0==d.length&&h.css("display","none"),c.append(h);var p=s.sl?s.sl:"";if(h=$("<div class='detail'>"+p+"</div>"),0==p.length&&h.css("display","none"),c.append(h),d&&0!=d.length||c.find(".detail:last-child").addClass("twoLine"),r.data("gu",o),isNewMem(s)){r.addClass("new-mem");var f=i.find(".new-mem");f.length>0?$(f[f.length-1]).after(r):i.prepend(r),setNewMemTag(r)}else if(1==s.ad){r.addClass("admin");var g=i.find(".admin");if(g.length>0)$(g[g.length-1]).after(r);else{var f=i.find(".new-mem");f.length>0?$(f[f.length-1]).after(r):i.prepend(r)}}else i.append(r)}var r=i.find(".img.waitLoad:lt(8)");$.each(r,function(e,t){var i=$(t);i.css("background-image","url("+i.attr("data-url")+")").removeClass("waitLoad").removeAttr("data-url")})}catch(u){errorReport(u)}return i},isNewMem=function(e){return g_newMemList.hasOwnProperty(e.gu)},setNewMemTag=function(e){e.find(".new").show()},updateNewMemTag=function(e){var t=e.find(".mem.namecard");$.each(t,function(e,t){var i=$(t),a=i.data("gu"),n=i.find(".new");"block"==n.css("display")&&0==g_newMemList.hasOwnProperty(a)&&n.hide().unbind("click")})},setOnMemGridScroll=function(){var e=$(".contact-scroll");g_contactWaitLoadImgs=e.find(".contact-mems .img.waitLoad"),e.unbind("scroll").scroll(function(){if(null!=g_contactWaitLoadImgs)for(var e=$(this).height()+128,t=g_contactWaitLoadImgs.length-1;t>=0;t--){var i=$(g_contactWaitLoadImgs[t]);i.offset().top<e&&(i.css("background-image","url("+i.attr("data-url")+")"),i.removeAttr("data-url").removeClass("waitLoad"),g_contactWaitLoadImgs.splice(t,1))}})},setOnMemListScroll=function(){var e=$(".contact-scroll, .subpage-contact .contact-searchResult");g_contactWaitLoadImgs=e.find(".contact-memLists .img.waitLoad"),e.unbind("scroll").scroll(function(){if(null!=g_contactWaitLoadImgs)for(var e=$(this).height()+99,t=g_contactWaitLoadImgs.length-1;t>=0;t--){var i=$(g_contactWaitLoadImgs[t]);i.offset().top<e&&(i.css("background-image","url("+i.attr("data-url")+")"),i.removeAttr("data-url").removeClass("waitLoad"),g_contactWaitLoadImgs.splice(t,1))}})},generateBranchList=function(e){for(var t=$("<div class='contact-rows'></div>"),i=0;i<e.length;i++){var a=e[i],n=bl[a];if(n){var o=$("<div class='row branch'><div class='left'></div><div class='right'></div></div>"),s=o.find(".left");s.append("<div class='name'>"+n.bn+"</div>"),s.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",n.cnt)+"</div>"),n.cl.length>0&&s.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_SUBGROUP",n.cl.length)+"</div>"),o.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),o.data("bi",a),t.append(o)}}return t},showMainContact=function(){$.mobile.changePage("#page-group-main",{transition:"slide",reverse:!0})},initContactData=function(){if("undefined"!=typeof ui){var e=$.lStorage(ui);if(e&&(isList=e.isMemberShowList?e.isMemberShowList:!1,"undefined"!=typeof gi&&(g_group=e[gi],g_group&&(bl=g_group.bl,bl&&(fbl=g_group.fbl,guAll=g_group.guAll))))){inviteGuAll=g_group.inviteGuAll,guAllExsit={},$.each(guAll,function(e,t){t&&1==t.st&&(guAllExsit[e]=t)});var t=(new Date).getTime(),i=$.lStorage("_newMemList");i&&i.hasOwnProperty(gi)?(g_newMemList=i[gi],$.each(g_newMemList,function(e,i){t>=i&&delete g_newMemList[e]}),$.lStorage("_newMemList",i)):g_newMemList={}}}},showFavoritePage=function(e){var t="page-contact_favorite";updateFavoritePage(),$("#"+t+" .contact-scroll").height($(window).height()-112),1==e?$.mobile.changePage("#"+t,{transition:"slide",reverse:!0}):$.mobile.changePage("#"+t,{transition:"slide"})},updateFavoritePage=function(){var e="page-contact_favorite",t=$("#"+e);t&&0!=t.length||(t=$('<div data-role="page" id="'+e+'" class="contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/navi/navi_icon_back.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-contact"></div></div>'),$("#page-group-main").after(t)),t.find(".page-title").html($.i18n.getString("COMMON_FAVORIATE")),t.find(".page-back").off("click").click(showMainContact);var i=t.find(".subpage-contact");i.html("");var a=$("<div class='contact-titleBar'></div>"),n=$("<div class='nameArea'></div>");n.append("<div class='name'>"+$.i18n.getString("COMMON_FAVORIATE")+"</div>"),a.append(n),a.append("<div class='btnExtra'></div>"),a.append("<div class='btn'></div>"),i.append(a);var o=$("<div class='contact-extra'></div>");i.append(o),o.css("display","none");var s=$("<div class='content'></div>");s.append("<div class='btn addGroup' align='center'><div class='img'></div><div class='text'>"+$.i18n.getString("MEMBER_CREATE_CUSTOMIZE_GROUP")+"</div></div>"),o.append(s),o.off("click").click(function(){o.fadeToggle("fast")}),s.off("click").click(function(e){e.stopPropagation(),cns.debug("!")}),s.find(".btn.addGroup").off("click").click(function(e){e.stopPropagation(),showAddFavGroupBox(i)});var r=$('<div class="contact-scroll"></div>');i.append(r),a.find(".btn").off("click").click(function(){switchListAndGrid($(this),r)}),a.find(".btnExtra").off("click").click(function(){o.fadeToggle("fast")});var l=$("<div class='contact-mems-title'></div>");l.append('<div class="count">0</div>'),l.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),r.append(l);var c={},d=0;$.each(guAllExsit,function(e,t){t.fav&&(d++,c[e]=t)});var u=generateMemberGrid(c);r.append(u);var h=generateMemberList(c,showFavoritePage);if(r.append(h),isList?(a.find(".btn").addClass("list"),u.css("display","none"),setOnMemListScroll()):(h.css("display","none"),setOnMemGridScroll()),0==d?(l.hide(),u.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",$.i18n.getString("COMMON_FAVORIATE"))+"</div>"),h.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",$.i18n.getString("COMMON_FAVORIATE"))+"</div>")):l.find(".count").html(d),fbl){var p=Object.keys(fbl).length;if(p>0){var l=$("<div class='contact-rows-title'></div>");l.append('<div class="count">'+p+"</div>"),l.append('<div class="text">'+$.i18n.getString("COMPOSE_N_SUBGROUP","")+"</div>"),r.append(l);var f=generateFavBranchList(fbl);r.append(f)}}},showSubFavoritePage=function(e){var t=fbl[e],i="page-contact_favorite",a="page-contact_sub_favorite",n=$("#"+a);n&&0!=n.length||(n=$('<div data-role="page" id="'+a+'" class="subPage contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/common/icon/bt_close_activity.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-contact"></div></div>'),$("#"+i).after(n)),n.find(".page-title").html(t.fn),n.find(".page-back").off("click").click(function(){showFavoritePage(!0)});var o=n.find(".subpage-contact");o.html("");var s=$("<div class='contact-titleBar'></div>"),r=$("<div class='nameArea'></div>");r.append("<div class='name'>"+t.fn+"</div>"),s.append(r),s.append("<div class='btnExtra'></div>"),s.append("<div class='btn'></div>"),o.append(s),s.find(".btn").off("click").click(function(){switchListAndGrid($(this),d)});var l=$("<div class='contact-extra'></div>");o.append(l),l.css("display","none");var c=$("<div class='content'></div>");c.append("<div class='btn editGroup disable' align='center'><div class='img'></div><div class='text'>"+$.i18n.getString("MEMBER_EDIT_CUSTOMIZE_GROUP_NAME")+"</div></div>"),c.append("<div class='btn editMem' align='center'><div class='img'></div><div class='text'>"+$.i18n.getString("MEMBER_EDIT_CUSTOMIZE_GROUP_MEMBER")+"</div></div>"),c.append("<div class='btn delete' align='center'><div class='img'></div><div class='text'>"+$.i18n.getString("MEMBER_DELETE_CUSTOMIZE_GROUP")+"</div></div>"),l.append(c);var d=$('<div class="contact-scroll"></div>');o.append(d);var u=$("<div class='contact-mems-title'></div>");u.append('<div class="count">0</div>'),u.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),d.append(u);var h={},p={},f=0;$.each(guAllExsit,function(t,i){if(i.fbl&&i.fbl.length>0)for(var a=0;a<i.fbl.length;a++)if(i.fbl[a]==e){h[t]=i,p[t]=i.nk,f++;break}});var g=generateMemberGrid(h);d.append(g);var m=generateMemberList(h);d.append(m),isList?(s.find(".btn").addClass("list"),g.css("display","none"),setOnMemListScroll()):(m.css("display","none"),setOnMemGridScroll()),0==f?(u.hide(),m.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",t.fn)+"</div>"),g.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",t.fn)+"</div>")):u.find(".count").html(f),l.off("click").click(function(){l.fadeToggle("fast")}),c.off("click").click(function(e){e.stopPropagation(),cns.debug("!")}),c.find(".btn.editMem").off("click").click(function(t){$(this).data("fi",e),$(this).data("object_str",JSON.stringify(p)),t.stopPropagation(),showEditFavGroupBox($(this))}),c.find(".btn.delete").off("click").click(function(i){$(this).data("fi",e),i.stopPropagation(),popupShowAdjust($.i18n.getString("MEMBER_DELETE_CUSTOMIZE_GROUP"),$.i18n.getString("MEMBER_DELETE_CUSTOMIZE_GROUP_CONFIRM",t.fn),$.i18n.getString("COMMON_OK"),$.i18n.getString("COMMON_CANCEL"),[deleteFavGroup,$(this)])}),s.find(".btnExtra").off("click").click(function(){l.fadeToggle("fast")}),$("#"+a+" .contact-scroll").height($(window).height()-112),$.mobile.changePage("#"+a,{transition:"slide",reverse:!1})},generateFavBranchList=function(e){var t=$("<div class='contact-rows'></div>");for(var i in e){var a=e[i];if(a){var n=$("<div class='row fav'><div class='left'></div><div class='right'></div></div>"),o=n.find(".left");o.append("<div class='name'>"+a.fn+"</div>"),o.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",a.cnt)+"</div>"),n.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),n.data("fi",i),t.append(n)}}return t.find(".row.fav").off("click").click(function(){showSubFavoritePage($(this).data("fi"))}),t},showAddFavGroupBox=function(e){var t=e.find(".contact-createSubgroup");if(0==t.length){t=generateInputBox(e,$.i18n.getString("MEMBER_CREATE_CUSTOMIZE_GROUP"),$.i18n.getString("MEMBER_CUSTOMIZE_GROUP_NAME"),$.i18n.getString("COMMON_CANCEL"),$.i18n.getString("MEMBER_CREATE"),function(e){t.fadeOut(),e.val("")},function(e){var i=t.find(".create"),a=e.val();if(null==a||0==a.length)return void toastShow($.i18n.getString("MEMBER_ENTER_CUSTOMIZE_GROUP_NAME"));cns.debug("create",a);var n={isShowBranch:!1,isShowAll:!1,isShowFav:!0};composeObjectShowDelegate(i,i,n,function(){var n=i.data("object_str");cns.debug(n);var o="groups/"+gi+"/favorites",s={ui:ui,at:at,li:lang},r=$.parseJSON(n),l=Object.keys(r),c={fn:a,gul:l};ajaxDo(o,s,"post",!0,c).complete(function(n){if(200==n.status){var o=$.parseJSON(n.responseText);cns.debug(n.responseText);var n={},s=$.lStorage(ui);g_group=s[gi],guAll=g_group.guAll;for(var c in r)guAll[c].fbl.push(o.fi);fbl=g_group.fbl,fbl[o.fi]={cnt:l.length,fn:a},n[o.fi]=fbl[o.fi],$.lStorage(ui,s);var d=generateFavBranchList(n),u=$("#page-contact_favorite .contact-rows");u.length>0?d.find(".row").appendTo(u):d.appendTo("#page-contact_favorite .contact-scroll"),t.fadeOut(),initContactData(),toastShow($.i18n.getString("MEMBER_CREATE_CUSTOMIZE_SUCC")),e.val(""),i.data("object_str","");var h=$(".subpage-contact .row.favorite");if(h.length>0){var p=h.find(".detail:eq(1)"),f=Object.keys(fbl).length;if(0>=f)p.hide();else{var g=$.i18n.getString("COMPOSE_N_SUBGROUP",f);p.length>0?p.text(g):h.find("left").append("<div class='detail'>"+g+"</div>")}}}else toastShow($.i18n.getString("MEMBER_CREATE_CUSTOMIZE_FAIL"))})})});var i=t.find(".create");i.data("object_str","")}t.fadeToggle();var a=e.find(".contact-extra");a.fadeToggle("fast")},showEditFavGroupBox=function(e){var t=e.data("object_str");t=$.parseJSON(t);var i={isShowBranch:!1,isShowAll:!1,isShowFav:!0,isShowSelf:!0};composeObjectShowDelegate(e,e,i,function(){var i=e.data("object_str"),a=$.parseJSON(i),n=Object.keys(a),o=e.data("fi");if(cns.debug(i),0==n.length)popupShowAdjust($.i18n.getString("MEMBER_DELETE_CUSTOMIZE_GROUP"),$.i18n.getString("MEMBER_CUSTOMIZE_GROUP_NO_MEMBER"),$.i18n.getString("COMMON_OK"),$.i18n.getString("COMMON_CANCEL"),[deleteFavGroup,e]);else{var s="groups/"+gi+"/favorites/"+o,r={ui:ui,at:at,li:lang},l={al:[],dl:[]};for(var c in t)null==a[c]&&l.dl.push(c);for(var c in a)null==t[c]&&l.al.push(c);if(0==l.al.length&&0==l.dl.length)return;ajaxDo(s,r,"put",!0,l).complete(function(t){if(200==t.status){var i=$.lStorage(ui);g_group=i[gi],guAll=g_group.guAll;for(var a=0;a<l.al.length;a++){var s=l.al[a];guAll[s].fbl.push(o)}for(var a=0;a<l.dl.length;a++){var s=l.dl[a],r=guAll[s].fbl.indexOf(o);r>=0&&delete guAll[s].fbl[r]}fbl=g_group.fbl,fbl[o].cnt=n.length,$.lStorage(ui,i),initContactData(),e.parent().fadeOut(),showSubFavoritePage(o),toastShow($.i18n.getString("MEMBER_EDIT_CUSTOMIZE_GROUP_MEMBER_SUCC"))}else toastShow($.i18n.getString("MEMBER_EDIT_CUSTOMIZE_GROUP_MEMBER_FAIL"))})}})},generateInputBox=function(e,t,i,a,n,o,s){var r=$(".contact-createSubgroup");if(0==r.length){e.append("<div class='contact-createSubgroup' style='display:none;' data-init='f'><table class='innerContainer'><tr><td class='title'>"+t+"</td></tr><tr><td><input class='input'/></td></tr><tr><td class='cancel'>"+a+"</td><td class='create cp-custom-subgroup'>"+n+"</td></tr></table></div>"),r=e.find(".contact-createSubgroup");var l=r.find(".input");l.attr("placeholder",i),r.off("click").click(function(){r.fadeOut()}),r.find("table").off("click").click(function(e){e.stopPropagation()}),r.find(".cancel").off("click").click(function(e){e.stopPropagation(),o(l)});var c=r.find(".create");c.off("click").click(function(e){e.stopPropagation(),s(l)})}return r},deleteFavGroup=function(e){var t=e.data("fi"),i="groups/"+gi+"/favorites/"+t,a={ui:ui,at:at,li:lang};ajaxDo(i,a,"delete",!0,null).complete(function(e){if(200==e.status){var e=($.parseJSON(e.responseText),{}),i=$.lStorage(ui);g_group=i[gi],guAll=g_group.guAll;for(var a in guAll)for(var n in guAll[a].fbl)if(n.indexOf(t)>=0){delete guAll[a];break}fbl=g_group.fbl,delete fbl[t],$.lStorage(ui,i),initContactData(),showFavoritePage(!0),toastShow($.i18n.getString("MEMBER_DELETE_CUSTOMIZE_GROUP_SUCC"))}else toastShow($.i18n.getString("MEMBER_DELETE_CUSTOMIZE_GROUP_FAIL"))})},$(document).ready(function(){$(".addressBook-refresh").off("click").on("click",function(e){AddressBook.initAddressBookList()}),$("#page-addressbook-addmem .ca-content-area").niceScroll({cursorcolor:"rgba(107, 107, 107,0.8)",cursorwidth:"10",cursorborderradius:"10px",background:"rgba(255,255,255,0)",cursorborder:"",boxzoom:!1,zindex:999,scrollspeed:90,mousescrollstep:40})});var AddressBook=AddressBook||{bl:null,guAll:null,inviteGuAll:null,guAllExsit:null,ucl:null,customCnt:0,isList:!0,group:null,contactWaitLoadImgs:null,newMemList:null,favGuAll:null,favCnt:0,groupName:"",initAddressBookList:function(){var e=this,t="groups/"+gi+"/contacts",i={ui:ui,at:at,li:lang};ajaxDo(t,i,"get",!0).complete(function(t){if(200==t.status){var i=$.parseJSON(t.responseText);try{e.groupName=$.lStorage(ui)[gi].gn}catch(a){errorReport(a)}if(!i)return void alert("no data");(!i.gcl||i.gcl.length<=0)&&(cns.debug("no gcl data"),i.gcl={}),e.favGuAll={},e.guAll={},e.guAllExsit={};for(var n=0,o=0;o<i.gcl.length;o++){var s=i.gcl[o].ci;e.guAll[s]=i.gcl[o],2==e.guAll[s].tp?(e.guAll[s].fav=!0,e.favGuAll[s]=i.gcl[o],n++):e.guAll[s].fav=!1,e.guAllExsit[s]=e.guAll[s]}e.inviteGuAll={},e.newMemList={},(!i.ucl||i.ucl.length<=0)&&(cns.debug("no ucl data"),i.gcl={}),e.ucl={};for(var o=0;o<i.ucl.length;o++){var t=i.ucl[o],s=t.ci;t.isCustom=!0,e.guAll[s]=t,e.ucl[s]=t,2==e.guAll[s].tp?(e.guAll[s].fav=!0,e.favGuAll[s]=i.gcl[o],n++):e.guAll[s].fav=!1}if(e.favCnt=n,e.customCnt=Object.keys(e.ucl).length,!i.bl||i.bl.length<=0)return void alert("no branch data");e.bl={},$.each(i.bl,function(t,i){if(null!=i.bp&&0!=i.bp.length){var a=i.bp.replace(/^\./,"").split("."),n="";a.length>1&&(n=a[a.length-2]),e.bl[a.last()]={lv:a.length,bn:i.bn,cl:[],cnt:0,pi:n,bp_arr:a}}}),$.each(e.bl,function(t,i){if(i.lv>1){var a=i.bp_arr[i.bp_arr.length-2];e.bl[a]&&e.bl[a].cl.push(t)}delete i.bp_arr});for(var r in e.bl){var n=0;$.each(e.guAll,function(e,t){t&&t.bl&&t.bl.indexOf(r)>=0&&n++}),e.bl[r].cnt=n}e.onGetAddressBookData()}})},onGetAddressBookData:function(){var e=this;$(".subpage-addressBook .contact-search .clear").trigger("click");var t=$(".subpage-addressBook .contact-rows");if(t&&!(t.length<=0)){t.html("");var i=$(".contact-subpages");i.is(":visible")&&i.find(".page-back").trigger("click"),$("#page-addressbook_all").data("gi",null);var a=$("<div class='row all'><div class='left'></div><div class='right'></div></div>"),n=a.find(".left");n.append("<div class='name'>"+$.i18n.getString("COMMON_ALL_MEMBERS")+"</div>"),n.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",Object.keys(e.guAllExsit).length)+"</div>"),a.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),t.append(a),t.find(".row.all").off("click").click(function(){e.showAllMemberPage(e.groupName)});var o=Object.keys(e.newMemList).length;o>0&&a.find(".right").prepend("<div class='new'>"+o+"</div>");var a=$("<div class='row custom'><div class='left'></div><div class='right'></div></div>"),n=a.find(".left");n.append("<div class='name'>"+$.i18n.getString("ADDRESSBOOK_CUSTOM")+"</div>"),n.append("<div class='detail mem'>"+$.i18n.getString("COMPOSE_N_MEMBERS",e.customCnt?e.customCnt:0)+"</div>"),a.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),a.off("click").click({instance:e},e.showCustomPage),t.append(a);var a=$("<div class='row favorite'><div class='left'></div><div class='right'></div></div>"),n=a.find(".left");n.append("<div class='name'>"+$.i18n.getString("COMMON_FAVORIATE")+"</div>"),n.append("<div class='detail mem'>"+$.i18n.getString("COMPOSE_N_MEMBERS",e.favCnt?e.favCnt:0)+"</div>"),a.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),a.off("click").click({instance:e},e.showFavoritePage),t.append(a),$("#page-group-main").find(".page-title").html(e.groupName),Object.keys(e.bl).length>0&&$.each(e.bl,function(e,i){if(1==i.lv){var a=$("<div class='row branch'><div class='left'></div><div class='right'></div></div>"),n=a.find(".left");n.append("<div class='name'>"+i.bn+"</div>"),n.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",i.cnt)+"</div>"),i.cl.length>0&&n.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_SUBGROUP",i.cl.length)+"</div>"),a.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),a.data("bi",e),t.append(a)}}),t.find(".row.branch").off("click").click(function(){e.showSubContactPage("page-group-main",$(this).data("bi"),JSON.stringify([]))});var s=$(".subpage-addressBook .contact-search .content"),r=s.find(".input");r.data("searchText",""),r.off("keyup").keyup({instance:e},e.onSearchInput),s.find(".clear").off("click").click(e.deactiveSearch),r.off("focusout").focusout(function(){var t=r.val();r.data("searchText",""),t&&0!=t.length||e.deactiveSearch()});var l=$(".contact-search .hintDiv");l.off("click").click(function(){$(this).hide(),s.show(),r.focus()}),$(window).off("resize").resize(function(){$(".contact-branchList").height($(window).height()-105),$(".contact-scroll").height($(window).height()-112)})}},deactiveSearch:function(){var e=$(".contact-search .content");e.hide();var t=e.find(".input");t.data("searchText",""),t.val(""),$(".contact-search .hintDiv").show(),$(".subpage-addressBook .contact-rows").show(),$(".contact-searchResult").hide()},onSearchInput:function(e){var t=e.data.instance,i=$(this);i.val().indexOf("\n")>=0&&i.val(i.val().replace("/\n/g",""));var a=i.val();if(!a||0==a.length)return $(".contact-searchResult").hide(),void $(".subpage-addressBook .contact-rows").show();if(i.data("searchText")!=a){i.data("searchText",a),cns.debug(a);var n=$(".subpage-addressBook .contact-rows"),o=$(".subpage-addressBook .contact-searchResult");if(!a||0==a.length)return $(".contact-searchResult").hide(),void $(".subpage-addressBook .contact-rows").show();o&&0!=o.length||(o=$('<div class="contact-searchResult" style="display:none;"></div>'),n.after(o)),o.show(),n.hide(),a=a.toLowerCase();var s={},r=0;for(var l in t.guAllExsit){var c=t.guAllExsit[l];null==c.nk?cns.debug(JSON.stringify(c)):c.nk.toLowerCase().indexOf(a)>=0&&(s[l]=c,r++)}var d=[];for(var l in t.bl){var u=t.bl[l];u.bn.toLowerCase().indexOf(a)>=0&&d.push(l)}var h=d.length,p=$(".contact-searchResult .memTitle"),f=$(".contact-searchResult .branchTitle");if(0==h&&0==r)return $(".contact-searchResult .noResult").show(),p.hide(),f.hide(),$(".contact-searchResult .contact-memLists").hide(),void $(".contact-searchResult .contact-rows").hide();if($(".contact-searchResult .noResult").hide(),r>0){p.show();var g=$(".contact-searchResult .contact-memLists");g&&g.length>0&&g.remove(),g=t.generateMemberList(s),p.after(g),t.setOnMemListScroll()}else p.hide();if(h>0){f.show();var m=$(".contact-searchResult .contact-rows");m&&m.length>0&&m.remove(),m=t.generateBranchList(d),f.after(m),m.find(".row.branch").off("click").click(function(){t.showSubContactPage("page-group-main",$(this).data("bi"),JSON.stringify([]))})}else f.hide()}},showSubContactPage:function(e,t,i,a){var n=this;null==a&&(a=!0);var o=$.parseJSON(i),s=n.bl[t];if(s){o.push(s.bn);var r=s.lv,l=s.cl,c="page-addressbook_sub"+r,d=$("#"+c);if(d&&0!=d.length||(d=$('<div data-role="page" id="'+c+'" class="subPage contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/common/icon/bt_close_activity.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-addressBook"></div></div>'),$("#"+e).after(d)),!a)return d.data("gen",!1),d.data("parentPageID",e),d.data("bi",t),d.data("lvStackString",i),void cns.debug(d.data("gen"),d.data("parentPageID"),d.data("bi"),d.data("lvStackString"));d.data("gen",!0),d.data("gi",gi),d.find(".page-title").html(s.bn),d.find(".page-back").off("click").click(function(){$(".contact-branchList").remove(),n.showMainContact()});var u=d.find(".subpage-addressBook");u.html("");var h=$("<div class='contact-titleBar'></div>"),p=$("<div class='nameArea list'></div>");p.append("<div class='name'>"+s.bn+"</div>"),p.append("<div class='arrow'></div>"),h.append(p),h.append("<div class='btn'></div>"),u.append(h),h.find(".btn").off("click").click(function(){n.switchListAndGrid($(this),v)}),cns.debug(r);var f=$(".contact-branchList");if(0==f.length||1==r)f.remove(),f=$('<div class="contact-branchList" style="display:none;"></div>'),n.showSubbranchListBox(f,s.lv,t,JSON.stringify([])),f.find(".row:nth-child(1)").addClass("current"),f.find(".row.list").off("click").click(function(){cns.debug($(this).data("bi"));var e=$(this).data("stack"),t=o.slice(0);if(e&&e.length>0){var i=$.parseJSON(e),a=r,s="page-addressbook_sub"+a;n.showSubContactPage(s,i[i.length-1],JSON.stringify(t))}f.css("display","none"),h.find(".arrow").removeClass("open")}),d.after(f);else{var g=f.find(".row.current");g.removeClass("current");var m=f.find(".row."+t);m.addClass("current")}p.off("click").click(function(){f.slideToggle(400,function(){var e=$(this).find(".row.current"),t=$(this),i=e.position().top;cns.debug(e.position().top,t.scrollTop()),(i>t.height()||0>i)&&t.scrollTop(t.scrollTop()+e.position().top)}),h.find(".arrow").toggleClass("open")});var v=$('<div class="contact-scroll"></div>');if(u.append(v),o.length>1){var b=$("<div class='contact-lvStack'></div>");if(o.length<=3)for(var w=0;w<o.length;w++)cns.debug(o[w]),b.append("<div>"+o[w]+"</div><img src='images/common/icon/icon_arrow_grey_right.png'>");else{b.append("<div>...</div>");for(var w=o.length-3;w<o.length;w++)cns.debug(o[w]),b.append("<div>"+o[w]+"</div><img src='images/common/icon/icon_arrow_grey_right.png'>")}var _=b.find("img:last-child");_.remove(),v.append(b)}var y=$("<div class='contact-mems-title'></div>");y.append('<div class="count">0</div>'),y.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),v.append(y);var x={},k=0;$.each(n.guAllExsit,function(e,i){var a=i.bl.substring(i.bl.length-11,i.bl.length);a==t&&(k++,x[e]=i)});var C=n.generateMemberGrid(x);v.append(C);var S=n.generateMemberList(x);if(v.append(S),n.isList?(h.find(".btn").addClass("list"),C.css("display","none"),n.setOnMemListScroll()):(S.css("display","none"),n.setOnMemGridScroll()),0==k?(y.hide(),S.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",s.bn)+"</div>"),C.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",s.bn)+"</div>")):y.find(".count").html(k),l.length>0){var y=$("<div class='contact-rows-title'></div>");y.append('<div class="text">'+$.i18n.getString("COMPOSE_N_SUBGROUP","<b class='count'>"+l.length+"</b>")+"</div>"),v.append(y);var T=n.generateBranchList(l);v.append(T),v.find(".row.branch").off("click").click(function(){n.showSubContactPage(c,$(this).data("bi"),JSON.stringify(o))})}$("#"+c+" .contact-branchList").height($(window).height()-110),$("#"+c+" .contact-scroll").height($(window).height()-112),"page-group-main"==e?$.mobile.changePage("#"+c,{transition:"slide",reverse:!1}):$.mobile.changePage("#"+c)}},showSubbranchListBox:function(e,t,i,a){var n=this;if(i&&e&&!(e.length<0)){var o=$.parseJSON(a);o.push(i),a=JSON.stringify(o);var s=n.bl[i],r=$("<div class='row list _"+(s.lv-t+1)+" "+i+"'><div class='left'></div><div class='right'>"+s.lv+"</div></div>"),l=r.find(".left");if(l.append("<div class='name'>"+s.bn+"</div>"),l.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",s.cnt)+"</div>"),r.data("stack",a),r.data("bi",i),r.css("padding-left",20*(Math.min(11,s.lv-t)+1)+"px"),t==s.lv?e.append(r):e.after(r),s.cl.length>0)for(var c=0;c<s.cl.length;c++)n.showSubbranchListBox(r,t,s.cl[c],a)}},showAllMemberPage:function(e){var t=this,i="page-addressbook_all",a=$("#"+i);if(a&&0!=a.length){if(gi==a.data("gi"))return void $.mobile.changePage("#"+i,{transition:"slide"})}else a=$('<div data-role="page" id="'+i+'" class="contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/navi/navi_icon_back.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-addressBook"></div></div>'),$("#page-group-main").after(a);a.data("gi",gi),a.find(".page-title").html($.i18n.getString("MEMBER_ALL")),a.find(".page-back").off("click").click(t.showMainContact);var n=a.find(".subpage-addressBook");n.html("");var o=$("<div class='contact-titleBar'></div>"),s=$("<div class='nameArea'></div>");s.append("<div class='name'>"+$.i18n.getString("MEMBER_ALL")+"</div>"),o.append(s),o.append("<div class='btn'></div>"),n.append(o);var r=$('<div class="contact-scroll"></div>');n.append(r),o.find(".btn").off("click").click(function(){t.switchListAndGrid($(this),r)});var l=$("<div class='contact-mems-title'></div>");l.append('<div class="count">0</div>'),l.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),r.append(l);var c=Object.keys(t.guAllExsit).length,d=t.generateMemberGrid(t.guAllExsit);r.append(d);var u=t.generateMemberList(t.guAllExsit);r.append(u),t.isList?(o.find(".btn").addClass("list"),d.css("display","none"),t.setOnMemListScroll()):(u.css("display","none"),t.setOnMemGridScroll()),0==c?(l.hide(),d.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",e)+"</div>"),u.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",e)+"</div>")):l.find(".count").html(c),$("#"+i+" .contact-scroll").height($(window).height()-112),$.mobile.changePage("#"+i,{transition:"slide"})},switchListAndGrid:function(e,t){var i=this;i.isList=!i.isList;var a=$.lStorage(ui);a.isMemberShowList=i.isList,$.lStorage(ui,a);var n=t.find(".contact-mems"),o=t.find(".contact-memLists");i.isList?(n.fadeOut("fast",function(){o.show(0)}),e.addClass("list"),i.setOnMemListScroll(),i.updateNewMemTag(o)):(o.fadeOut("fast",function(){n.show(0)}),e.removeClass("list"),i.setOnMemGridScroll(),i.updateNewMemTag(n))},generateMemberGrid:function(e){var t=this,i=$("<div class='contact-mems'></div>");$.each(e,function(e,a){if(null==a)cns.debug(e);else{var n=$("<div class='mem ab_namecard'></div>");a.aut&&a.aut.length>0?n.append("<div class='img waitLoad' data-url='"+a.aut+"'><div class='new' style='display:none;'>NEW</div></div>"):n.append("<div class='img'><div class='new' style='display:none;'>NEW</div></div>"),n.append("<div class='name'>"+a.nk.replaceOriEmojiCode()+"</div>"),n.data("gu",e),1==a.ad?(n.addClass("admin"),i.prepend(n)):i.append(n),t.setNewMemTag(n,a)}});var a=i.find(".img.waitLoad:lt(30)");return $.each(a,function(e,t){var i=$(t);i.css("background-image","url("+i.attr("data-url")+")").removeClass("waitLoad").removeAttr("data-url")}),t.contactWaitLoadImgs=i.find(".img.waitLoad"),i},generateMemberList:function(e,t){var i=this,a=$("<div class='contact-memLists'></div>");$.each(e,function(e,t){var n=$("<div class='row mem ab_namecard'><div class='left'></div><div class='mid'></div><div class='right'>&nbsp</div></div>"),o=n.find(".left");t.aut&&t.aut.length>0?o.append("<div class='img waitLoad' data-url='"+t.aut+"'><div class='new' style='display:none;'>NEW</div></div>"):o.append("<div class='img'></div>");var s=n.find(".mid");s.append(t.nk.replaceOriEmojiCode());var r="";try{r=i.bl[t.bl.split(",")[0].split(".")[0]].bn}catch(l){}var c=$("<div class='detail'>"+r+"</div>");0==r.length&&c.css("display","none"),s.append(c);var d=t.sl?t.sl:"";c=$("<div class='detail'>"+d+"</div>"),0==d.length&&c.css("display","none"),s.append(c),r&&0!=r.length||s.find(".detail:last-child").addClass("twoLine"),n.data("gu",e),1==t.ad?(n.addClass("admin"),a.prepend(n)):a.append(n),i.setNewMemTag(n,t)});var n=a.find(".img.waitLoad:lt(8)");return $.each(n,function(e,t){var i=$(t);i.css("background-image","url("+i.attr("data-url")+")").removeClass("waitLoad").removeAttr("data-url")}),a},setNewMemTag:function(e,t){var i=this;i.newMemList.hasOwnProperty(t.gu)&&(e.find(".new").show(),e.click(function(){if(i.newMemList.hasOwnProperty(t.gu)){delete i.newMemList[t.gu];var e=$.lStorage("_newMemList");e[gi]=i.newMemList,$.lStorage("_newMemList",e),$(".subpage-addressBook.main-subpage > .contact-rows > .row.all > .right .new").html(Object.keys(i.newMemList).length)}$(this).find(".new").hide(),$(this).unbind("click")}))},updateNewMemTag:function(e){var t=this,i=e.find(".mem.ab_namecard");
$.each(i,function(e,i){var a=$(i),n=a.data("gu"),o=a.find(".new");"block"==o.css("display")&&0==t.newMemList.hasOwnProperty(n)&&o.hide().unbind("click")})},setOnMemGridScroll:function(){var e=this,t=$(".contact-scroll");e.contactWaitLoadImgs=t.find(".contact-mems .img.waitLoad"),t.unbind("scroll").scroll(function(){if(null!=e.contactWaitLoadImgs)for(var t=$(this).height()+128,i=e.contactWaitLoadImgs.length-1;i>=0;i--){var a=$(e.contactWaitLoadImgs[i]);a.offset().top<t&&(a.css("background-image","url("+a.attr("data-url")+")"),a.removeAttr("data-url").removeClass("waitLoad"),e.contactWaitLoadImgs.splice(i,1))}})},setOnMemListScroll:function(){var e=this,t=$(".contact-scroll");e.contactWaitLoadImgs=t.find(".contact-memLists .img.waitLoad"),t.unbind("scroll").scroll(function(){if(null!=e.contactWaitLoadImgs)for(var t=$(this).height()+99,i=e.contactWaitLoadImgs.length-1;i>=0;i--){var a=$(e.contactWaitLoadImgs[i]);a.offset().top<t&&(a.css("background-image","url("+a.attr("data-url")+")"),a.removeAttr("data-url").removeClass("waitLoad"),e.contactWaitLoadImgs.splice(i,1))}})},generateBranchList:function(e){for(var t=this,i=$("<div class='contact-rows'></div>"),a=0;a<e.length;a++){var n=e[a],o=t.bl[n];if(o){var s=$("<div class='row branch'><div class='left'></div><div class='right'></div></div>"),r=s.find(".left");r.append("<div class='name'>"+o.bn+"</div>"),r.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_MEMBERS",o.cnt)+"</div>"),o.cl.length>0&&r.append("<div class='detail'>"+$.i18n.getString("COMPOSE_N_SUBGROUP",o.cl.length)+"</div>"),s.find(".right").append("<img src='images/icon/icon_arrow_right.png'/>"),s.data("bi",n),i.append(s)}}return i},showMainContact:function(){$.mobile.changePage("#page-group-main",{transition:"slide",reverse:!0})},showFavoritePage:function(e){var t=e.data.instance,i="page-addressbook_favorite";t.updateFavoritePage(),$("#"+i+" .contact-scroll").height($(window).height()-112),$.mobile.changePage("#"+i,{transition:"slide"})},updateFavoritePage:function(){var e=AddressBook,t="page-addressbook_favorite",i=$("#"+t);i&&0!=i.length||(i=$('<div data-role="page" id="'+t+'" class="contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/navi/navi_icon_back.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-addressBook"></div></div>'),$("#page-group-main").after(i)),i.find(".page-title").html($.i18n.getString("COMMON_FAVORIATE")),i.find(".page-back").off("click").click(e.showMainContact);var a=i.find(".subpage-addressBook");a.html("");var n=$("<div class='contact-titleBar'></div>"),o=$("<div class='nameArea'></div>");o.append("<div class='name'>"+$.i18n.getString("COMMON_FAVORIATE")+"</div>"),n.append(o),n.append("<div class='btn'></div>"),a.append(n);var s=$('<div class="contact-scroll"></div>');a.append(s),n.find(".btn").off("click").click(function(){e.switchListAndGrid($(this),s)});var r=$("<div class='contact-mems-title'></div>");r.append('<div class="count">0</div>'),r.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),s.append(r);var l=e.generateMemberGrid(e.favGuAll);s.append(l);var c=e.generateMemberList(e.favGuAll,e.showFavoritePage);s.append(c),e.isList?(n.find(".btn").addClass("list"),l.css("display","none"),e.setOnMemListScroll()):(c.css("display","none"),e.setOnMemGridScroll()),0==e.favCnt?(r.hide(),l.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",$.i18n.getString("COMMON_FAVORIATE"))+"</div>"),c.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",$.i18n.getString("COMMON_FAVORIATE"))+"</div>")):r.find(".count").html(e.favCnt)},generateInputBox:function(e,t,i,a,n,o,s){var r=$(".contact-createSubgroup");if(0==r.length){e.append("<div class='contact-createSubgroup' style='display:none;' data-init='f'><table class='innerContainer'><tr><td class='title'>"+t+"</td></tr><tr><td><input class='input'/></td></tr><tr><td class='cancel'>"+a+"</td><td class='create cp-custom-subgroup'>"+n+"</td></tr></table></div>"),r=e.find(".contact-createSubgroup");var l=r.find(".input");l.attr("placeholder",i),r.off("click").click(function(){r.fadeOut()}),r.find("table").off("click").click(function(e){e.stopPropagation()}),r.find(".cancel").off("click").click(function(e){e.stopPropagation(),o(l)});var c=r.find(".create");c.off("click").click(function(e){e.stopPropagation(),s(l)})}return r},updateContactBranchList:function(){if($(".subpage-addressBook").is(":visible"))$(".sm-small-area[data-sm-act=memberslist]").trigger("click");else{var e=$(".contact-subpages");e.is(":visible")&&e.find(".page-back").trigger("click")}},updateContactFavorite:function(){var e=this;e.initAddressBookList();var t=$(".subpage-addressBook");if(t.length>0){var i=t.find(".row.favorite .left");if(i.length>0){var a=Object.keys(fbl).length;i.find(".detail.mem").html($.i18n.getString("COMPOSE_N_MEMBERS",e.favCnt?e.favCnt:0));var n=i.find(".detail.branch");a>0?n.html($.i18n.getString("COMPOSE_N_SUBGROUP",a)):n.hide()}}var o=$("#page-addressbook_favorite");o.length>0&&e.updateFavoritePage(!1)},userInfoShow:function(e,t){var i=this;if(!t)return!1;var e=e||gi;$(".screen-lock").show(),$(".user-info-load-area").fadeIn("fast"),$(".user-info-load-area .user").load("layout/layout.html .user-info-load",function(){var a=$(this).find(".user-info-load");a._i18n(),a.find(".user-avatar-bar").hide();var n=i.guAll[t];if(n){if(a.data("isCustom",n.isCustom),n.isCustom){$(".user-info-load-area .me").addClass("me-rotate"),$(".user-info-load-area .me").addClass("backface-visibility"),a.find(".action-chat").hide(),$(".user-avatar-bar-favorite").hide(),a.data("ci",n.ci),a.find(".user-info-delete").show();var o=a.find(".action");o.find(".action-edit").show(),o.find(".action-bar,.action-main,.action-chat").hide()}else $(".user-info-load-area .me").removeClass("me-rotate"),$(".user-info-load-area .me").removeClass("backface-visibility"),a.find(".action-edit").hide(),a.find(".action-chat").off("click").click(function(){requestNewChatRoomApi(e,"",[{gu:t}],function(e){})}),$(".user-avatar-bar-favorite").show(),1==n.fav?$(".user-avatar-bar-favorite .active").show():$(".user-avatar-bar-favorite .deactive").show(),a.find(".action").hide();$("body").addClass("user-info-adjust"),a.find(".user-avatar-bar").show(),a.data("this-info-gu",t),a.data("this-info-gi",e),n.aut&&(a.find(".user-avatar .user-pic").attr("src",n.auo),a.find(".user-avatar").data("auo",n.auo),i.userInfoAvatarPos($(".user-avatar .user-pic"))),n.isCustom&&i.showCustomInfo(n),i.userInfoDataShow(e,a,n),i.userInfoEvent(a)}else cns.debug("no user_data",t,isCustom),a.data("avatar-chk",!1),$(".screen-lock").fadeOut("fast"),a.fadeOut("fast"),$(".user-info-load-area").hide()})},userInfoDataShow:function(e,t,i,a){var n=this;cns.debug("user_data",i),2==i.st?(t.find(".user-info-list-area").hide(),t.find(".user-info-leave-area").show()):(t.find(".user-info-list-area").show(),t.find(".user-info-leave-area").hide());var o="html";a&&(o="val");var s,r=["nk","sl","bd","bl","tt"],l=["em","pn","pn1","ext","mv"];for(item in i)if(i[item].length>0){if("bd"==item&&a&&(i[item]=i[item].substring(0,4)+"/"+i[item].substring(4,6)+"/"+i[item].substring(6)),s=$.inArray(item,r)>=0?t.find(".user-avatar-bar"):t.find(".user-info-list"),a||"bd"!=item||(i.bd=i.bd.substring(4,6)+"."+i.bd.substring(6,8),o="append"),"bl"==item)try{var c=i.bl.split(",")[0].split("."),d="",u=n.bl,h=s.find(".bl");h.show(),h=h[0];for(var p=!1,f=c.length-1;f>=0;f--){var g=c[f];if(u[g]){if(d=u[g].bn+"-"+d,h.innerHTML=d,h.offsetHeight>42){for(d=d.substring(0,d.length-1)+"......",h.innerHTML=d;h.offsetHeight>40;)d=d.substring(1,d.length),h.innerHTML=d;d="..."+d.substring(0,d.length-6),p=!0;break}}else cns.debug("no branch data",g)}0==p&&d.length>0?i.bl=d.substring(0,d.length-1):i.bl=d}catch(m){errorReport(m);continue}if(s.find("."+item)[o](i[item]).show(),!a&&$.inArray(item,l)>=0){var v=s.find("img."+item);v.attr("src","images/icon/bt_"+v.data("name")+"_normal.png")}}var b=t.find(".user-avatar-bar .nk").html();b&&b.length>0&&t.find(".user-avatar-bar .nk").html(b.replaceOriEmojiCode()),i.mkp&&t.find(".user-info-list .pn").val("******"),i.mke&&t.find(".user-info-list .em").val("******"),i.mkb?(t.find(".user-avatar-bar .bd").hide(),t.find(".user-info-list .bd").val("******")):t.find(".user-avatar-bar .user-name").addClass("hidden"),2==i.st&&t.find(".action, .sl, .bd, .bl").hide()},showCustomInfo:function(e){var t=this;gu;$(".screen-lock").show(),$(".user-info-load-area").fadeIn("fast"),$(".user-info-load-area").addClass("transition1s"),$(".user-info-load-area .me").load("layout/layout.html .me-info-load",function(){var i=$(this).find(".me-info-load");if(i._i18n(),i.find("input").removeAttr("readonly"),i.find(".bd").attr("readonly","true").off("click").click({instance:t},function(){cns.debug("todo: trigger datePicker")}),i.find(".dp,.mv,.sl").parent().hide(),i.find(".bd").parent().parent().hide(),i.find(".user-info-back").hide(),i.find(".em, .pn1").parent().addClass("no-status"),e){i.data("isCustom",e.isCustom),i.data("ci",e.ci);for(item in e)e[item]&&i.find(".user-info-list ."+item).val(e[item]);i.find(".user-info-submit").text($.i18n.getString("COMMON_DONE"))}else i.find(".user-info-submit").text($.i18n.getString("ADDRESSBOOK_ADD")),i.parent().removeClass("me-rotate");t.userInfoEvent(i,!0)})},userInfoEvent:function(e,t){var i=this;e.unbind(),e.find(".user-avatar").click(function(){var e=$(this).find(".user-pic").attr("src");if(!e)return!1;var t=new Image;t.onload=function(){var e=this_height=500,t="width",i="before1";this.width<this.height&&(t="height",i="before2"),this.width>500&&(e=this.width),this.height>500&&(this_height=this.height);var a=window.open("layout/img_show.html","","width="+e+", height="+this_height),n=this.src;$(a.document).ready(function(){setTimeout(function(){var e=$(a.document).find("img.gallery");e.css(t,"100%"),e.parent().addClass(i),e.attr("src",n)},300)})},t.src=e}),e.find(".user-avatar-bar:not(.me)").click(function(e){e.stopPropagation()}),t?(e.find(".user-info-list input").bind("input",function(){e.find(".user-info-submit").addClass("user-info-submit-ready")}),$(document).off("click",".user-info-submit-ready"),$(document).on("click",".user-info-submit-ready",function(){e.data("isCustom")?i.editCustomInfo(e):i.addNewCustom(e)})):(e.find(".action-edit").click(function(){$(".user-info-load-area").addClass("user-info-flip"),$(".user-info-load , .me-info-load").stop().animate({opacity:0},400),setTimeout(function(){$(".user-info-load-area .me").removeClass("backface-visibility"),$(document).find(".user-info-load-area .user").hide(),$(".user-info-load , .me-info-load").stop().animate({opacity:1},400)},400),setTimeout(function(){$(".user-info-load-area").removeClass("transition1s"),$(".user-info-load-area").removeClass("user-info-flip"),$(".user-info-load-area .me").addClass("adjust")},1e3)}),e.find(".user-info-delete").click(function(){i.removeCustomInfo(e)})),e.find(".user-avatar-bar-favorite .fav").mouseup(function(){i.clickUserInfoFavorite($(this))})},editCustomInfo:function(e){var t=this,i=e.find(".user-info-list .nk").val().trim().replace(/( +)/g," ").replace(/[&\|\\\\:\/!*^%$#@\-]/g,"");if(""==i)return toastShow($.i18n.getString("USER_PROFILE_EMPTY_NAME")),!1;var a=e.data("ci");if(!a)return void cns.debug("editCustomInfo, no ci");s_load_show=!0;var n="groups/"+gi+"/contact_users/"+a,o={ui:ui,at:at,li:lang},s={nk:i},r={};r.sl=e.find(".user-info-list .sl").val(),r.tt=e.find(".user-info-list .ti").val(),r.pn1=e.find(".user-info-list .pn1").val(),r.pn2=e.find(".user-info-list .pn2").val(),r.ext=e.find(".user-info-list .et").val(),r.em=e.find(".user-info-list .em").val(),$.each(r,function(e,t){t&&(s[e]=t)});var l="put";ajaxDo(n,o,l,!1,s).complete(function(i){if(200==i.status){s_load_show=!1,$(".ui-loader").hide(),$(".ajax-screen-lock").hide();for(var n=["nk","tt","pn1","pn2","ext","em"],o=0;o<n.length;o++){var r=n[o];s.hasOwnProperty(r)&&(t.guAll[a][r]=s[r])}t.updateCustomPage(),e.find(".user-info-close").trigger("mouseup")}})},addNewCustom:function(e){var t=this,i=e.find(".user-info-list .nk").val().trim().replace(/( +)/g," ").replace(/[&\|\\\\:\/!*^%$#@\-]/g,"");if(""==i)return toastShow($.i18n.getString("USER_PROFILE_EMPTY_NAME")),!1;s_load_show=!0;var a="groups/"+gi+"/contact_users",n={ui:ui,at:at,li:lang},o={nk:i,sl:e.find(".user-info-list .sl").val()},s={};s.tt=e.find(".user-info-list .ti").val(),s.pn1=e.find(".user-info-list .pn1").val(),s.pn2=e.find(".user-info-list .pn2").val(),s.ext=e.find(".user-info-list .et").val(),s.em=e.find(".user-info-list .em").val(),$.each(s,function(e,t){t&&(o[e]=t)});var r="post";ajaxDo(a,n,r,!1,o).complete(function(i){if(200==i.status){s_load_show=!1,$(".ui-loader").hide(),$(".ajax-screen-lock").hide();var i=$.parseJSON(i.responseText);if(!i||!i.cl)return;i=i.cl,i.isCustom=!0,t.guAll[i.ci]=i,t.ucl[i.ci]=i,t.guAll[i.ci].fav=!1,t.customCnt=Object.keys(t.ucl).length,t.updateCustomPage(),t.updateCustomCount(),e.find(".user-info-close").trigger("mouseup")}})},removeCustomInfo:function(e){var t=this,i=e.data("ci");if(!i)return void cns.debug("removeCustomInfo, no ci");s_load_show=!0;var a="groups/"+gi+"/contact_users/"+i,n={ui:ui,at:at,li:lang},o="DELETE";ajaxDo(a,n,o,!1,null).complete(function(a){200==a.status&&(s_load_show=!1,$(".ui-loader").hide(),$(".ajax-screen-lock").hide(),t.ucl.hasOwnProperty(i)&&delete t.ucl[i],t.customCnt=Object.keys(t.ucl).length,t.guAll.hasOwnProperty(i)&&delete t.guAll[i],t.favGuAll.hasOwnProperty(i)&&(delete t.favGuAll[a.ci],t.favCnt--),t.updateCustomPage(),t.updateCustomCount(),e.find(".user-info-close").trigger("mouseup"))})},userInfoAvatarPos:function(e){var t=1.6,i=$(".user-info-load-area .width-chk").width()||400;e.load(function(){this.width/this.height>t?(e.css("height",250),e.css("margin-left",(e.width()-i)/2*-1),e.css("opacity",0)):(e.css("width",i),e.css("margin-top",(e.height()-250)/2*-1),e.css("opacity",0)),e.stop().animate({opacity:1},300)})},clickUserInfoFavorite:function(e){var t=AddressBook,i=e.parents(".user-info-load"),a=i.data("this-info-gu"),n=i.data("this-info-gi");if(null!=a&&null!=n){var o,s;e.hasClass("active")?(o=updateAddressbookFavoriteStatusApi(n,null,[a]),s=!1):(o=updateAddressbookFavoriteStatusApi(n,[a],null),s=!0),o.complete(function(i){if(200==i.status&&t.guAll&&t.guAll.hasOwnProperty(a)){var n=t.guAll[a];n.fav=s,s?(e.parent().find(".active").show(),e.parent().find(".deactive").hide(),t.favGuAll.hasOwnProperty(a)||(t.favGuAll[a]=n,t.favCnt++)):(t.favCnt<0&&(t.favCnt=0),e.parent().find(".active").hide(),e.parent().find(".deactive").show(),t.favGuAll.hasOwnProperty(a)&&(delete t.favGuAll[a],t.favCnt--)),$(".subpage-addressBook .favorite .detail").html($.i18n.getString("COMPOSE_N_MEMBERS",t.favCnt?t.favCnt:0)),t.updateFavoritePage()}})}},showCustomPage:function(e){var t=e.data.instance,i="page-addressbook_Custom";t.updateCustomPage(),$("#"+i+" .contact-scroll").height($(window).height()-112),$.mobile.changePage("#"+i,{transition:"slide"})},updateCustomPage:function(){var e=AddressBook,t="page-addressbook_Custom",i=$("#"+t);i&&0!=i.length||(i=$('<div data-role="page" id="'+t+'" class="contact-subpages"><div data-theme="c" data-role="header" data-position="fixed" data-tap-toggle="false"><div class="page-back"><img src="images/navi/navi_icon_back.png"/></div><h3 class="page-title">成員列表</h3></div><div class="subpage-addressBook"></div></div>'),$("#page-group-main").after(i)),i.find(".page-title").html($.i18n.getString("ADDRESSBOOK_CUSTOM")),i.find(".page-back").off("click").click(e.showMainContact);var a=i.find(".subpage-addressBook");a.html("");var n=$("<div class='contact-titleBar'></div>"),o=$("<div class='nameArea'></div>");o.append("<div class='name'>"+$.i18n.getString("ADDRESSBOOK_CUSTOM")+"</div>"),n.append(o),n.append("<div class='btn'></div>"),n.append("<div class='addressBook-add'><img></div>"),a.append(n);var s=$('<div class="contact-scroll"></div>');a.append(s),n.find(".btn").off("click").click(function(){e.switchListAndGrid($(this),s)}),n.find(".addressBook-add").off("click").click(function(e){AddressBook.showCustomInfo()});var r=$("<div class='contact-mems-title'></div>");r.append('<div class="count">0</div>'),r.append('<div class="text">'+$.i18n.getString("COMPOSE_N_MEMBERS","")+"</div>"),s.append(r);var l=e.generateMemberGrid(e.ucl);s.append(l);var c=e.generateMemberList(e.ucl,e.showCustomPage);s.append(c),e.isList?(n.find(".btn").addClass("list"),l.css("display","none"),e.setOnMemListScroll()):(c.css("display","none"),e.setOnMemGridScroll()),$(".contact-scroll").height($(window).height()-112),0==e.customCnt?(r.hide(),l.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",$.i18n.getString("ADDRESSBOOK_CUSTOM"))+"</div>"),c.append("<div class='noMem'>"+$.i18n.getString("MEMBER_X_GROUP_NO_MEMBER",$.i18n.getString("ADDRESSBOOK_CUSTOM"))+"</div>")):r.find(".count").html(e.customCnt)},updateCustomCount:function(){var e=this,t=$(".subpage-addressBook .contact-rows");!t||t.length<=0||t.find(".row.custom .mem").html($.i18n.getString("COMPOSE_N_MEMBERS",e.customCnt?e.customCnt:0))}};$(document).ready(function(){$(document).on("click",".gs-row",function(e){var t=$(this).data("type");switch(t){case"permission":showUpdatePermissionPage();break;case"info":showGroupInfoPage()}}),$(document).on("click",".gs-leave",function(){popupShowAdjust($.i18n.getString("GROUPSETTING_LEAVE_ALERT_TITLE"),$.i18n.getString("GROUPSETTING_LEAVE_ALERT_CONTENT"),!0,!0,[function(){requestLeaveGroup(gi,gu)},null])}),$(document).on("click",".ga-header-back",function(e){var t=$(".subpage-groupAbout").data("lastPage");t&&$(t).show(),$(".subpage-groupAbout").data("lastPage",null),$(".subpage-groupAbout").off("animate").animate({marginLeft:"100%"},1e3,function(){$(".subpage-groupAbout").hide()})}),$(document).on("click",".ga-avatar-photo.admin",function(e){$(".ga-avatar input").trigger("click")}),$(document).on("change",".ga-avatar input",function(e){var t=$(this);t.removeClass("ready");var i=/image.*/,a=$(this)[0].files[0];if(a.type.match(i)){var n=new FileReader;n.onload=function(e){var i=$(".ga-avatar-img");i.hide();var a=i.filter(".upload");a.attr("src",n.result),a.show(),t.addClass("ready"),checkGroupInfoChange()},n.readAsDataURL(a)}else{var o=$(this);o.replaceWith(o=o.clone(!0)),popupShowAdjust("",$.i18n.getString("COMMON_NOT_IMAGE"))}}),$(document).on("dragover","body",function(e){e.preventDefault(),e.stopPropagation()}),$(document).on("drop","body",function(e){e.preventDefault(),e.stopPropagation()}),$(document).on("drop",".ga-avatar.admin",function(e){e.preventDefault(),e.stopPropagation(),$(".ga-avatar input")[0].files=e.originalEvent.dataTransfer.files}),$(document).on("input",".ga-info.edit .ga-info-row .content",function(e){var t=$(this);t.val()&&t.val().length>0&&t.data("oriText")!=t.val()?t.addClass("ready"):t.removeClass("ready"),checkGroupInfoChange()}),$(document).on("keydown keyup",".ga-info.edit .ga-info-row .autoHeight",function(e){$(this).height("0px").height($(this).prop("scrollHeight")+"px")}),$(document).on("click",".ga-header-done.ready",function(e){var t=$(".ga-info.edit"),i=null,a=null,n=t.find(".ga-info-row .content");$.each(n,function(e,t){var n=$(t),o=n.parent().data("type");switch(o){case"name":i=n.hasClass("ready")?n.val():n.data("oriText");break;case"info":a=n.hasClass("ready")?n.val():n.data("oriText")}});var o=null,s=$(".ga-avatar input.ready");s.length>0&&(o=s[0].files[0]),requestUpdateGroupInfo(gi,i,a,o,resetGroupInfo)}),$(document).on("click",".ga-info.view.admin",function(){$(this).hide(),$(".ga-info.edit").show()})});var g_idb_chat_msgs,g_idb_chat_cnts;$(function(){function e(e,t,i,a,n,o){var s=[1280,1280,.9],r=[160,160,.4];uploadGroupVideo(gi,e,t,ti_feed,0,s,r,o,function(t){var n=$(document).find(".cp-content"),s=n.data("uploaded-vid-num");if(n.data("uploaded-vid-num",s+=1),!t)return n.data("uploaded-vid-err").push(i+1),uploadErrorCnt(n,i,a),!1;var r=[t.fi,o,e.name];n.data("video-compose-arr")[i]=r,checkIsUploadFinished(n)})}setGroupInitial=function(e){setThisGroup(e),setSmUserData(gi,gu,gn),$(".header-group-name div:eq(1)").html(gn),groupMenuListArea(),topEvent(),initOfficialGroup(gi),updateTab(gi),setTimeout(function(){var e=$(".sm-small-area:not(.setting):visible");e.length>0?($(e[0]).addClass("active"),timelineSwitch($(e[0]).data("sm-act")||"feeds",!0)):timelineSwitch("feeds",!0)},500)},logout=function(){var e="logout",t={ui:ui,at:at,li:lang},i="delete";ajaxDo(e,t,i,!0).complete(function(e){resetDB(),document.location="index.html"})},chkBranch=function(){if("object"!=typeof $.lStorage(ui)[gi].bl)return!0;var e=Object.keys($.lStorage(ui)[gi].bl)[0];return"undefined"!=typeof e&&"undefined"==typeof $.lStorage(ui)[gi].bl[e].lv?!0:!1},createGroup=function(e,t){var i="groups",a={ui:ui,at:at,li:lang},n={gn:e,gd:t},o="post";return ajaxDo(i,a,o,!0,n)},getMeInvite=function(){var e="me/invitations",t={ui:ui,at:at,li:lang},i="get";ajaxDo(e,t,i,!0).complete(function(e){if(200==e.status){var t=$.parseJSON(e.responseText);if($(".gmi-div-area").html(""),!(0!=t.gl.length||t.cl&&0!=t.cl.length))return $(".gmi-coachmake").show(),!1;$(".gm-invite-area").data("cnt",t.gl.length),$(".gmi-coachmake").hide(),$.each(t.gl,function(e,t){$(".gmi-div-area").append($("<div>").load("layout/layout.html .gmi-div",function(){var e=$(this).find(".gmi-div");e._i18n(),e.data("invite-data",t),e.find(".gmi-div-data div:eq(0)").html($.i18n.getString("GROUP_GROUP_INVITATION","<span>"+t.gn+"</span>")),e.find(".gmi-div-data div:eq(1)").html($.i18n.getString("GROUP_MEMBERS","<span>"+t.cnt+"</sapn>")),t.aut&&(e.find(".gmi-div-avatar .aut").attr("src",t.aut),e.find(".group-pic").data("auo",t.auo),avatarPos(e.find(".gmi-div-avatar .aut"),70)),e.find(".gmi-div-desc-area").html(t.gd)}))}),t.cl&&t.cl.length>0&&$.each(t.cl,function(e,t){getPrivateInviteData(t)})}})},getPrivateInviteData=function(e){var t="me/invitations",i={ui:e.ui,at:e.at,li:lang},a="get";ajaxDo(t,i,a,!0,null,null,null,e.cl).complete(function(t){if(200==t.status){var i=$.parseJSON(t.responseText);if(0==i.gl.length)return!1;var a=$(".gm-invite-area");a.data("cnt")?a.data("cnt",a.data("cnt")+i.gl.length):a.data("cnt",i.gl.length),$(".gmi-coachmake").hide(),$.each(i.gl,function(t,i){$(".gmi-div-area").append($("<div>").load("layout/layout.html .gmi-div",function(){var t=$(this).find(".gmi-div");t._i18n(),t.data("invite-data",i),t.data("pri-invite-data",e),t.find(".gmi-div-data div:eq(0)").html($.i18n.getString("GROUP_GROUP_INVITATION","<span>"+i.gn+"</span>")),t.find(".gmi-div-data div:eq(1)").html($.i18n.getString("GROUP_MEMBERS","<span>"+i.cnt+"</sapn>")),i.aut&&(t.find(".gmi-div-avatar .aut").attr("src",i.aut),t.find(".group-pic").data("auo",i.auo),avatarPos(t.find(".gmi-div-avatar .aut"),70)),t.find(".gmi-div-desc-area").html(i.gd)}))})}})},agreeMeInvite=function(e){var t=($.Deferred(),e.data("pri-invite-data"));if(t){var i=e.data("invite-data"),a="me/groups",n={ui:t.ui,at:t.at,li:lang,uui:ui,uat:at},o="post",s={id:i.ik,tp:i.tp,gi:i.gi};i.gi="__"+t.cl+"__"+i.gi+"__",ajaxDo(a,n,o,!0,s,null,null,t.cl).complete(function(t){200==t.status&&(groupMenuListArea(i.gi,!0),e.remove())})}else{var i=e.data("invite-data"),a="me/groups",n={ui:ui,at:at,li:lang},o="post",s={id:i.ik,tp:i.tp,gi:i.gi};ajaxDo(a,n,o,!0,s).complete(function(t){200==t.status&&(groupMenuListArea(i.gi,!0).then(function(e){1==Object.keys(e).length&&(setGroupInitial(e[Object.keys(e)[0]].gi),$.mobile.changePage("#page-group-main"),$("#page-group-menu .page-back").show())}),e.remove())})}},deleteMeInvite=function(e){var t=e.data("invite-data"),i="me/invitations?ik="+t.ik+"&tp="+t.tp+"&gi="+t.gi,a={ui:ui,at:at,li:lang},n="delete";ajaxDo(i,a,n,!0).complete(function(t){200==t.status&&e.hide("fast",function(){e.remove(),0==$(".gmi-div").length&&$(".gmi-coachmake").show()})})},getUserAvatarName=function(e,t,i,a){var n=$.lStorage(ui),o="",s="",r="";if(!n.hasOwnProperty(e))return getGroupCombo(e,function(){getUserAvatarName(e,t,i,a)}),!1;try{o=n[e].guAll[t].aut,s=n[e].guAll[t].auo,r=n[e].guAll[t].nk.replaceOriEmojiCode(),a&&(o?a.attr("src",o):a.attr("src","images/common/others/empty_img_personal_l.png")),i.html(r)}catch(l){errorReport(l)}},setGroupAllUser=function(e,t,i){var t=t||gi;getGroupData(t,!1,1).complete(function(a){if(200==a.status){var n=$.parseJSON(a.responseText);setGroupAttributes(t,n),setGroupUser(t,n),setBranchList(t,n),setTabList(t,n),initOfficialGroup(t),updateGroupAllInfoDom(t),i&&i(t)}else cns.debug("groups/gi 發生錯誤:",t+" : "+e[2]),groupSwitchEnable()})},timelineChangeGroup=function(e){setThisGroup(e),setSmUserData(gi,gu,gn),initOfficialGroup(gi),updateTab(gi),updateGroupAllInfoDom(gi)},timelineSwitch=function(e,t,i){var a=$("#page-group-main").data("currentAct");$("#page-group-main").data("currentAct",e),t&&($(".feed-subarea").removeData(),$("#page-group-main .switch-reset").html(""));var n=$.i18n.getString("LEFT_FEED");"system-setting"!=e&&$("#page-group-main .main-subpage").hide(),$(".header-menu .sm-small-area.active").removeClass("active"),$('.header-menu .sm-small-area[data-sm-act="'+e+'"]').addClass("active");var o=$("#page-group-main"),s=o.find(".gm-header");switch(s.find(".header-icon").hide(),s.find(".navi-alert").show(),$(".st-filter-area").andSelf().find(".st-filter-list-active").removeClass("st-filter-list-active").end().find("[data-navi=home]").addClass("st-filter-list-active"),e){case"feeds":var r=$(".st-filter-action");r.find("[data-status='all']").show().addClass("st-filter-list-active").end().find("[data-navi='announcement']").show().end().find("[data-navi='feedback']").show().end().find("[data-navi='task']").show().end().find("[data-navi='feed-post']").hide().end().find("[data-navi='feed-public']").hide();var l=$(".st-navi-area");l.data("currentHome","home"),$(".subpage-addressBook").hide();var c=$(".st-filter-area");c.data("filter","all"),c.children(".st-filter-hide.right").show(),c.children(".st-filter-hide.left").hide(),c.scrollLeft(0),i||l.find(".main").trigger("click"),s.find(".page-title").html(n),s.find(".feed-compose").show(),$(".subpage-timeline").show(),$.lStorage("_pollingData")&&pollingCountsWrite(),updatePollingCnts($(".sm-small-area[data-sm-act=feeds]").find(".sm-count"),"A1"),updatePollingCnts(r.filter("[data-status=all]").find(".sm-count"),"B1");break;case"memberslist":groupSwitchEnable(),$(".subpage-contact").show(),s.find(".feed-compose").hide(),s.find(".chatList-add").hide();try{var d=$.lStorage(ui),u=d[gi];1==u.ad&&s.find(".contact-add").show()}catch(h){errorReport(h)}n=$.i18n.getString("LEFT_MEMBER"),initContactList();break;case"addressBook":groupSwitchEnable(),$(".subpage-addressBook").show(),s.find(".addressBook-refresh").show(),n=$.i18n.getString("ADDRESSBOOK_TITLE"),AddressBook.initAddressBookList();break;case"chat":if(groupSwitchEnable(),onClickOfficialGeneralChat(gi))switch(o.data("currentAct",a),a){case"feeds":case"feed-post":case"feed-public":$(".subpage-timeline").show();break;case"memberslist":$(".subpage-contact").show();break;case"album":$(".subpage-album").show();break;case"groupSetting":$(".subpage-groupSetting").show();break;case"calendar":case"help":case"news":case"system-setting":}else $(".subpage-chatList").show(),n=$.i18n.getString("CHAT_TITLE"),initChatList(),s.find(".feed-compose").hide(),s.find(".chatList-add").show(),s.find(".contact-add").hide();break;case"calendar":break;case"help":break;case"news":break;case"fileSharing":$(".subpage-fileSharing").show(),n=$.i18n.getString("GROUPSETTING_TITLE"),loadScript("js/fileSharing.js").done(function(){var e=new window[arguments[0]];return"undefined"==typeof e.ti?(alert("這是開發階段 此團體無檔案共享的ti"),!1):void e.getList()});break;case"system-setting":popupShowAdjust("",$.i18n.getString("SETTING_DO_LOGOUT"),!0,!0,[logout]);break;case"feed-post":var r=$(".st-filter-action");$(".st-navi-area").data("currentHome","feed-post"),r.filter(".st-filter-list-active").removeClass("st-filter-list-active"),r.filter("[data-status='all']").hide(),r.filter("[data-navi='announcement']").hide(),r.filter("[data-navi='feedback']").hide(),r.filter("[data-navi='task']").hide(),r.filter("[data-navi='feed-public']").hide(),r.filter("[data-navi='feed-post']").show().addClass("st-filter-list-active");var c=$(".st-filter-area");c.data("filter","all"),c.children(".st-filter-hide").hide(),c.scrollLeft(0),$(".st-navi-subarea[data-st-navi=feed-post]").trigger("click"),$(".subpage-timeline").show(),s.find(".page-title").html(n),s.find(".feed-compose").show(),$.lStorage("_pollingData")&&pollingCountsWrite(),updatePollingCnts($(".sm-small-area[data-sm-act=feeds]").find(".sm-count"),"A1"),updatePollingCnts(r.filter("[data-status=all]").find(".sm-count"),"B1");break;case"feed-public":$(".st-navi-area").data("currentHome","feed-public"),$(".st-filter-action.st-filter-list-active").removeClass("st-filter-list-active"),$(".st-filter-action[data-status='all']").hide(),$(".st-filter-action[data-navi='announcement']").show(),$(".st-filter-action[data-navi='feedback']").show(),$(".st-filter-action[data-navi='task']").show(),$(".st-filter-action[data-navi='feed-post']").hide(),$(".st-filter-action[data-navi='feed-public']").show().addClass("st-filter-list-active");var c=$(".st-filter-area");c.data("filter","all"),c.children(".st-filter-hide.right").show(),c.children(".st-filter-hide.left").hide(),c.scrollLeft(0),$(".st-navi-subarea[data-st-navi=feed-public]").trigger("click"),$(".subpage-timeline").show(),s.find(".page-title").html(n),s.find(".feed-compose").show(),$.lStorage("_pollingData")&&pollingCountsWrite(),updatePollingCnts($(".sm-small-area[data-sm-act=feeds]").find(".sm-count"),"A1"),updatePollingCnts($(".st-filter-action[data-status=all]").find(".sm-count"),"B1");break;case"album":$(".subpage-album").show(),n=$.i18n.getString("COMMON_ALBUM"),initGallery(),s.find(".feed-compose").hide(),s.find(".chatList-add").hide(),s.find(".contact-add").hide();break;case"groupSetting":groupSwitchEnable(),$(".subpage-groupSetting").show(),s.find(".feed-compose").hide(),s.find(".chatList-add").hide(),n=$.i18n.getString("GROUPSETTING_TITLE")}setTimeout(timelineScrollTop,1e3),$(".feed-compose-area").is(":visible")&&$(".feed-compose").trigger("click"),s.find(".page-title").html(n),setOfficialGroup(gi)},setSmUserData=function(e,t,i){$(".sm-user-area-r div").html(""),$(".sm-user-area.namecard").data("gu",t),$(".sm-user-area .update-avatar-all").data("update-id",t),getUserAvatarName(e,t,$(".sm-user-area-r div"),$(".sm-user-pic img"))},chkGroupAllUser=function(e){0==Object.keys($.lStorage(ui)[gi].guAll).length?setGroupAllUser(e):getUserAvatarName(e[1],e[2],e[3],e[4])},topEventChk=function(){topEventApi().complete(function(e){if(200!=e.status)return!1;var t=$.parseJSON(e.responseText).el;$.each(t,function(e,t){var i=t.ei,a=!1;return $(".st-top-event").each(function(e,t){return $(this).data("data-obj").ei==i?void(a=!0):void 0}),a?void 0:(cns.debug("[!!]topEventChk[!!]"),topEvent(),!1)})})},topEventApi=function(){var e="groups/"+gi+"/timelines/"+ti_feed+"/top_events",t={ui:ui,at:at,li:lang},i="get";return ajaxDo(e,t,i,!1)},topEvent=function(e){var t=$('<div class="st-top-area"><div class="st-top-event-block"><div class="st-top-left-arrow st-top-arrow" style="max-width:100px"><div><img src="images/arrow2.png"></div></div><div class="st-top-right-arrow st-top-arrow" style="max-width:100px"><div><img src="images/arrow2.png"></div></div><div class="st-top-event-area"><div class="st-top-event-default"><div>'+$.i18n.getString("FEED_UNTOP_AVAILABLE")+'</div></div><div class="st-top-event-set"></div><div class="st-top-bar-area"><div class="st-top-bar-selector" style="display:"></div><div class="st-top-bar-case"></div><div class="st-top-bar-case-click"></div></div></div></div></div>');$(".st-top-area-load").html(t);$.lStorage(ui);topEventApi().complete(function(i){if(e&&e(),200==i.status){var a=$.parseJSON(i.responseText).el,n=a.length;if(0==n)return!1;$(".st-top-event-default").hide(),$.each(a,function(e,i){
t.find(".st-top-event-set").append($('<div class="st-top-event">').load("layout/layout.html .st-top-event-load",function(){var a=$(this);a.find(".st-top-event-load")._i18n(),a.data("data-obj",i),a.data("pos",e);var o="FEED_MISSION";switch(i.meta.tp){case"00":o="FEED_POST";break;case"01":o="FEED_BULLETIN";break;case"02":o="FEED_REPORT"}a.find(".st-top-event-r-ttl span").html($.i18n.getString(o)),a.find(".st-top-event-r-ttl").append(i.meta.tt),a.find(".st-top-event-r-content").html(i.ml[0].c),setTopEventUserName(a,i.meta.gu);var s=new Date(i.meta.ct),r=s.customFormat("#M#/#D# #CD# #hhh#:#mm#");a.find(".st-top-event-r-footer span:eq(1)").html(r),e==n-1&&0!=e&&setTimeout(function(){topBarMake(t,n)},500),a.click(function(){$.mobile.changePage("#page-timeline-detail",{transition:"slide"}),eventDetailShow($(this).data("data-obj").ei)})}))})}else groupSwitchEnable()})},setTopEventUserName=function(e,t){var i=$.lStorage(ui)[gi].guAll;return i[t]?(e.find(".st-top-event-l img").attr("src",i[t].aut).data("update-id",t).parent().stop().animate({opacity:1},1e3),void e.find(".st-top-event-r-footer span:eq(0)").html(i[t].nk)):(cns.debug("[!]top event gi gu mismatched[!]"),!1)},topBarMake=function(e,t,a){e.find(".st-top-bar-selector").data("pos",0);var n=$('<span class="blue"></span>');e.find(".st-top-bar-case").html(n),n.data("pos",0);var o=$("<span></span>");for(e.find(".st-top-bar-case-click").html(o),o.data("pos",0),i=0;i<t-1;i++){var s=$("<span></span>");e.find(".st-top-bar-case").append(s),s.data("pos",i+1);var r=$("<span></span>");e.find(".st-top-bar-case-click").append(r),r.data("pos",i+1)}var l=e.find(".st-top-bar-case span:eq(0)");l.offset().left,l.offset().top,l.width();if(e.find(".st-top-bar-case-click span").unbind(),e.find(".st-top-bar-case-click span").mouseup(function(){var t=$(this).data("pos"),i=e.find(".st-top-bar-case span");i.removeClass("blue"),i.each(function(){$(this).data("pos")===t&&$(this).addClass("blue")}),e.find(".st-top-event").animate({right:100*t+"%"},500)}),a)return!1;e.find(".st-top-left-arrow, .st-top-right-arrow").show(),e.find(".st-top-left-arrow").data("direction",!1),e.find(".st-top-right-arrow").data("direction",!0),e.find(".st-top-left-arrow, .st-top-right-arrow, .st-top-arrow, st-top-event").unbind(),e.find(".st-top-event-block").hover(function(){e.find(".st-top-arrow div img").stop().fadeIn("fast")},function(){e.find(".st-top-arrow div img").stop().fadeOut("fast")}),e.find(".st-top-left-arrow, .st-top-right-arrow").hover(function(){$(this).stop().animate({opacity:1},200)},function(){$(this).stop().animate({opacity:.3},200)}),e.find(".st-top-left-arrow, .st-top-right-arrow").mouseup(function(){var i=$(this).data("direction"),a=e.find(".st-top-bar-selector").data("pos"),a=e.find(".st-top-bar-case span").filter(function(){return $(this).hasClass("blue")}).data("pos");if(i){var n=a+1;n>t-1&&(n=0)}else var n=a-1;e.find(".st-top-bar-case-click span:eq("+n+")").trigger("mouseup")});var c;clearInterval(c),c=setInterval(function(){e.find(".st-top-right-arrow").trigger("mouseup")},top_timer_ms),e.find(".st-top-bar-case-click span, .st-top-left-arrow, .st-top-right-arrow").click(function(){clearInterval(c),c=setInterval(function(){e.find(".st-top-right-arrow").trigger("mouseup")},top_timer_ms)})},chkEventStatus=function(e,t){var i=e.data("event-id"),a=e.data("event-status");return!a||a[i]&&!a[i][t]?!0:!1},getThisTimelinePart=function(e,t,i){if(0==e.length)return void cns.debug("no event");var a=e.data("event-id"),n=a.split("_")[0],o=a.split("_")[1],s="groups/"+n+"/timelines/"+o+"/events/"+a+"/participants2?tp="+t,r={ui:ui,at:at,li:lang},l="get",c=ajaxDo(s,r,l,!1);c.complete(function(e){200==e.status&&i&&i(e)})},getThisTimelineResponsePart=function(e,t,i){if(0==e.length)return void cns.debug("no event");var a=e.data("event-id"),n=e.data("event-path"),o=a.split("_")[0],s=a.split("_")[1],r="groups/"+o+"/timelines/"+s+"/events/"+n+"/participants2?tp="+t,l={ui:ui,at:at,li:lang},c="get",d=ajaxDo(r,l,c,!1);d.complete(function(e){200==e.status&&i&&i(e)})},detailLikeStringMake=function(e){var t=e.data("event-id").split("_")[0],i=e.data("parti-list"),a=$.lStorage(ui)[t],n=$.inArray(a.gu,i),o=a.guAll,s=o[i[n]],r="";e.find(".st-reply-like-area").show();try{switch(!0){case 0==i.length:r=$.i18n.getString("FEED_BE_FIRST_LIKE");break;case"undefined"!=typeof s&&1==i.length:r=$.i18n.getString("FEED_CLICK_LIKE_SELF",$.i18n.getString("COMMON_YOU"));break;case!s&&1==i.length:var l=o.hasOwnProperty(i[0])&&o[i[0]]&&o[i[0]].nk?o[i[0]].nk.replaceOriEmojiCode():"unknown";r=$.i18n.getString("FEED_CLICK_LIKE",l);break;case 2==i.length:var l=o.hasOwnProperty(i[0])&&o[i[0]]&&o[i[0]].nk?o[i[0]].nk.replaceOriEmojiCode():"unknown",c=o.hasOwnProperty(i[1])&&o[i[1]]&&o[i[1]].nk?o[i[1]].nk.replaceOriEmojiCode():"unknown";r="undefined"==typeof s?$.i18n.getString("FEED_CLICK_LIKE_2PEOPLE",l,c):$.i18n.getString("FEED_CLICK_LIKE_2PEOPLE",$.i18n.getString("COMMON_YOU"),n?l:c);break;case i.length>2:if("undefined"==typeof s){var l=o.hasOwnProperty(i[0])&&o[i[0]]&&o[i[0]].nk?o[i[0]].nk.replaceOriEmojiCode():"unknown";r=$.i18n.getString("FEED_3PEOPLE_LIKE",l,i.length-1)}else if(0==n){var c=o.hasOwnProperty(i[1])&&o[i[1]]&&o[i[1]].nk?o[i[1]].nk.replaceOriEmojiCode():"unknown";r=$.i18n.getString("FEED_YOU_AND_3PEOPLE_LIKE",$.i18n.getString("COMMON_YOU"),c,i.length-2)}else{var l=o.hasOwnProperty(i[0])&&o[i[0]]&&o[i[0]].nk?o[i[0]].nk.replaceOriEmojiCode():"unknown";r=$.i18n.getString("FEED_YOU_AND_3PEOPLE_LIKE",$.i18n.getString("COMMON_YOU"),l,i.length-2)}}}catch(d){errorReport(d)}e.find(".st-reply-like-area span:eq(0)").html(r),e.find(".st-reply-like-area span:eq(1)").html("").hide()},getEventDetail=function(e){var t=e.split("_")[0],i=e.split("_")[1],a="groups/"+t+"/timelines/"+i+"/events/"+e,n={ui:ui,at:at,li:lang},o="get";return ajaxDo(a,n,o,!1)},setOfficialGroup=function(e){var t;try{t=$.lStorage(ui)[e]}catch(i){return void errorReport(i)}try{if(!t.isOfficial)return $(document).data("official",!1),$(".header-menu").show(),$(".st-filter-area").show(),$(".official").hide(),$(".st-feedbox-area").removeClass("official-admin-adjust"),void $(".sm-small-area[data-sm-act=chat]").removeClass("official-general");$(".st-filter-area").hide(),$(document).data("official",!0),$("#page-group-main .header-menu [data-sm-act]:not([data-sm-act=feeds])").hide(),$(".feed-compose.header-icon._2").hide(),1==t.ad?($(".official.admin").show(),$(".official.general").hide(),$(".st-feedbox-area").addClass("official-admin-adjust"),$(".sm-small-area[data-sm-act=chat]").removeClass("official-general")):($(".feed-compose").hide(),$(".official.admin").hide(),$(".official.general").show(),$(".st-feedbox-area").removeClass("official-admin-adjust"),$(".sm-small-area[data-sm-act=chat]").addClass("official-general")),$(".st-official-tab[data-type=cnt] .text").html($.i18n.getString("OFFICIAL_N_FOLLOWER","<span class='cnt'>"+t.cnt+"</span>"))}catch(i){errorReport(i)}},onClickOfficialGeneralChat=function(e){try{var t=$.lStorage(ui)[e];if(isOfficialGroup(t)&&1!=t.ad&&null!=t.chatAll)for(var i in t.chatAll){var a=t.chatAll[i];if(1==a.tp)return openChatWindow(e,i),!0}return!1}catch(n){errorReport(n)}return!1},isOfficialGroup=function(e){if(!e)return!1;if(e.isOfficial)return!0;if(!e.tp)return!1;var t=e.tp.toLowerCase();return 0==t.indexOf("c")||0==t.indexOf("d")?!0:!1},eventContentDetail=function(e,t){var i=e.data("timeline-tp");switch(cns.debug("==================== 詳細內容 ================================"),cns.debug(JSON.stringify(t,null,2)),i){case 0:break;case 1:break;case 2:break;case 3:if(e.find(".st-box2-more-task-area").hide(),e.find(".st-box2-more-task-area-detail").show(),e.find(".st-task-work-detail").show(),e.data("task-over"))break;break;case 4:if(e.find(".st-box2-more-task-area").hide(),e.find(".st-box2-more-task-area-detail").show(),e.find(".st-task-vote-detail").show(),e.data("task-over"))break;var a=e.data("event-status");a&&a.ik&&(e.find(".st-vote-send").html($.i18n.getString("FEED_ALREADY_VOTED")),e.find(".st-vote-send").removeClass(".st-vote-send-blue"));break;case 5:break;case 6:}e.find(".st-sub-box-3 div:eq(0)").html(t[0].meta.lct),e.find(".st-sub-box-3 div:eq(2)").html(t[0].meta.rct)},detailTimelineContentMake=function(e,t,i){var a=e.data("event-id").split("_")[0],n=e.data("event-id");e.data("event-status");e.data("event-path",n),e.find(".st-sub-box-3 img:eq(2)").attr("src","images/icon/icon_view_activity.png");var o=0;$.each(t,function(n,s){var r=!1;e.find(".st-reply-all-content-area").append($("<div>").load("layout/timeline_event.html .st-reply-content-area",function(){var n=$(this).find(".st-reply-content-area"),l=n.find(".st-reply-content"),c=null;s.meta&&(c={tu:s.meta.tu,pu:s.meta.gu}),$.each(s.ml,function(t,a){switch(a.tp){case 0:l.prepend(htmlFormat(a.c));break;case 1:break;case 5:var n=l.find(".sticker");n.show(),console.debug("yoyoyo"),setStickerUrl(n,a.c);break;case 6:console.debug("picture~~~"),l.find(".au-area").show(),getS3file(a,l,a.tp,280,c);break;case 7:getS3file(a,l.find("video"),a.tp,280,c);break;case 8:getS3file(a,l.find("audio"),a.tp,280,c);break;case 9:break;case 12:if(i)break;workContentMake(e,a.li);break;case 13:if(i)break;e.find(".st-work-option").each(function(e,t){var i=$(this);i.data("item-index")==a.k&&(a.a?(i.data("mine")&&i.addClass("work-mine-finished"),i.data("work-status",!0),i.addClass("st-work-option-gray"),i.find(".st-work-option-tu img").attr("src","images/common/icon/icon_work_member_lightgray.png"),i.find("img:eq(0)").attr("src","images/common/icon/icon_check_red_l.png")):(i.data("mine")&&i.removeClass("work-mine-finished"),i.data("work-status",!1),i.removeClass("st-work-option-gray"),i.find(".st-work-option-tu img").attr("src","images/common/icon/icon_work_member_gray.png"),i.find("img:eq(0)").attr("src","images/common/icon/icon_check_round_white.png")))}),r=!0;break;case 14:if(i)break;voteContentMake(e,a);break;case 15:r=!0;var o=e.data("vote-result");return o[s.meta.gu]&&s.meta.ct<o[s.meta.gu].time||(o[s.meta.gu]={},o[s.meta.gu].time=s.meta.ct,o[s.meta.gu].li=a.li),e.data("vote-result",o),!1;case 18:r=!0}});var d=!1;if(i){var u=e.find(".st-reply-content-area").filter(function(){return $(this).data("event-id")===s.ei});u.length>0&&(d=!0)}if(r||s.meta.del||1*s.meta.tp.substring(0,1)==0||d)n.parent().remove();else{var h=!1,p=$.lStorage(ui);try{var f=p[a].guAll[s.meta.gu].nk.replaceOriEmojiCode();p[a].guAll[s.meta.gu].aut&&(n.find(".st-user-pic img").attr("src",p[a].guAll[s.meta.gu].aut),n.find(".st-user-pic.namecard").data("auo",p[a].guAll[s.meta.gu].auo),n.find(".update-avatar-all").data("update-id",s.meta.gu),avatarPos(n.find(".st-user-pic img")))}catch(g){errorReport(g),n.parent().remove(),h=!0,cns.debug("get unknown reply user",a,s.meta.gu)}if(!h){n.find(".st-user-pic.namecard").data("gi",a),n.find(".st-user-pic.namecard").data("gu",s.meta.gu),n.find(".st-reply-username").html(f.replaceOriEmojiCode()),n.find(".st-reply-footer-time").html(new Date(s.meta.ct).toFormatString()).data("ct",s.meta.ct),n.data("event-val",s);var m=s.ei;if(n.data("event-id",m),n.data("event-path",e.data("event-id")+"."+n.data("event-id")),s.meta.lct&&(n.find(".st-reply-footer img").show(),n.find(".st-reply-footer img").attr("src","images/timeline/timeline_feedbox_icon_like.png"),n.find(".st-reply-footer span:eq(2)").html(s.meta.lct),s.meta.il)){n.find(".st-reply-footer img").attr("src","images/icon/icon_like1_activity.png");var v=n.find(".st-reply-footer span:eq(1)");v.html($.i18n.getString("FEED_UNLIKE")),v.removeAttr("data-textid"),v.data("like",!0)}}}o++,o==t.length-1&&e.find(".st-reply-all-content-area").slideDown().data("show",!0),e._i18n();var b=getGroupCompetence(a);0==b.isAdmin&&1==b.isOfficial&&e.find(".namecard").removeClass("namecard")}))})},timelineDetailClose=function(e,t){var i;switch(t){case 0:break;case 1:break;case 2:break;case 3:i=".st-box2-more-task-area";break;case 4:i=".st-box2-more-task-area";break;case 5:i=".st-box2-more-task-area",e.find(i).toggle(),e.find(i+"-detail").toggle()}var a=".st-sub-box-2-content";return e.find(".st-box2-more-desc").html()&&(a=".st-box2-more-desc"),e.find(a).toggle(),e.find(a+"-detail").toggle(),e.find(i).toggle(),e.find(i+"-detail").toggle(),1==e.find(".st-reply-all-content-area").data("show")?e.find(".st-reply-all-content-area").slideUp("",function(){$(this).html(""),e.find(".st-reply-like-area").toggle()}).data("show",!1):e.find(".st-reply-like-area").toggle(),e.data("detail-content")?(e.data("detail-content",!1),!1):(e.data("detail-content",!0),!0)},workContentMake=function(e,t){var i=[],a=[];$.each(t,function(e,t){var n=t.u.split(",");$.inArray(gu,n)>=0?(t.m=!0,a.push(t)):i.push(t)});var n=a.concat(i),o=$.lStorage(ui);e.find(".st-task-work-detail").html(""),cns.debug("new_li:",n),$.each(n,function(t,i){var a=$('<div class="st-work-option" data-item-index="'+i.k+'"><img class="check" src="images/common/icon/icon_check_round_white.png"><span>'+i.d+'</span><div class="st-work-option-tu"><img src="images/common/icon/icon_work_member_gray.png"/><span>'+o[gi].guAll[i.u].nk+"</span></div></div>");e.find(".st-task-work-detail").append(a),i.m&&(a.data("mine",!0),a.addClass("work-mine-chk"))}),bindWorkEvent(e)},bindWorkEvent=function(e){e.find(".st-work-option").click(function(){var t=$(this),i=!1,a=e.find(".work-mine-chk").length,n=e.find(".work-mine-finished").length;if(!t.data("mine")||e.data("task-over"))return!1;if(t.data("work-status"))var o=!1;else{var o=!0;n==a-1&&(i=!0)}var s="groups/"+gi+"/timelines/"+ti_feed+"/events?ep="+e.data("event-id"),r={ui:ui,at:at,li:lang},l="post",c={meta:{lv:"1",tp:"13",fin:i},ml:[{tp:13,k:t.data("item-index"),a:o}]},d=ajaxDo(s,r,l,!0,c);d.complete(function(a){o?(t.data("mine")&&t.addClass("work-mine-finished"),t.addClass("st-work-option-gray"),t.find(".st-work-option-tu img").attr("src","images/common/icon/icon_work_member_lightgray.png"),t.find("img:eq(0)").attr("src","images/common/icon/icon_check_red_l.png")):(t.data("mine")&&t.removeClass("work-mine-finished"),t.removeClass("st-work-option-gray"),t.find(".st-work-option-tu img").attr("src","images/common/icon/icon_work_member_gray.png"),t.find("img:eq(0)").attr("src","images/common/icon/icon_check_round_white.png")),i?(e.find(".st-task-status").html($.i18n.getString("FEED_FINISHED")),e.find(".st-task-status-area img").attr("src","images/common/icon/icon_check_red_l.png")):(e.find(".st-task-status").html($.i18n.getString("FEED_UNFINISHED")),e.find(".st-task-status-area img").attr("src","images/common/icon/icon_check_lightblue_l.png")),t.data("work-status",o)})})},voteContentMake=function(e,t){var i=t.li;$.each(i,function(a,n){e.find(".st-vote-all-ques-area").append($('<div class="st-vote-ques-area-div">').load("layout/timeline_event.html .st-vote-ques-area",function(){var o=$(this).find(".st-vote-ques-area");o.data("ques-index",n.k);var s="images/common/icon/icon_check_red_round.png";n.v>1&&(s="images/common/icon/icon_check_red.png"),o.data("vote-multi",n.v),o.data("tick-img",s),o.find(".st-vote-detail-top span:eq(0)").html(a+1);var r="";r=1==n.v?$.i18n.getString("FEED_VOTE_LIMIT_1"):$.i18n.getString("FEED_VOTE_LIMIT_N",n.v),o.find(".st-vote-detail-top span:eq(1)").html(r),n.t&&(o.find(".st-vote-detail-desc").show(),o.find(".st-vote-detail-desc").html(n.t)),$.each(n.i,function(e,t){o.append('<div class="st-vote-detail-option" data-item-index="'+t.k+'"><img class="check vote-do" src="images/common/icon/icon_check_round_white.png"/><span class="vote-do">'+t.o+'</span><img class="more vote-set" src="images/common/icon/icon_arrow_next.png"><span class="cnt vote-set">0</span><div class="clear-both"></div></div>'),o.data("multi-count",0)}),a==i.length-1&&(voteTypeSetting(e,t),setTimeout(function(){voteResultMake(e)},500))}))})},voteTypeSetting=function(e,t){var i=$.i18n.getString("FEED_VOTE_GENERAL");if(1==t.lv&&(i=$.i18n.getString("FEED_VOTE_PUBLIC")),2==t.lv&&(i=$.i18n.getString("FEED_VOTE_ANONYMOUS")),e.find(".st-task-vote-detail-count span.vote-type").html(i),e.data("event-val").meta.gu==gu)return!1;var a=!0,n=!0;(new Date).getTime()>t.e?2==t.lv&&(n=!1):1!=t.lv&&(a=!1,n=!1),0==a&&e.find(".st-vote-detail-option .cnt").hide(),0==n&&e.find(".st-vote-detail-option .more").hide()},voteResultMake=function(e){var t=e.data("vote-result"),i=e.find(".st-vote-ques-area");e.find(".st-task-vote-detail-count").show(),e.find(".st-task-vote-detail-count span:first").html(Object.keys(t).length+"人已投票"),e.find(".st-vote-detail-option").data("vote-chk",!1),$.each(t,function(e,t){$.each(t.li,function(a,n){$.each(i,function(i,a){var o=$(this);n.k==o.data("ques-index")&&n.i.length>0&&$.each(n.i,function(i,a){$.each(o.find(".st-vote-detail-option"),function(i,n){var s=$(this);if(s.data("item-index")==a.k){var r=s.find("span:eq(1)").html();s.find("span:eq(1)").html(1*r+1);var l=s.data("member-list")||[];if(l.push({gu:e,rt:t.time}),s.data("member-list",l),e==gu){var c=1*o.data("multi-count");o.data("multi-count",c+1),s.data("vote-chk",!0),s.find("img.check").attr("src",o.data("tick-img"))}}})})})})}),setTimeout(function(){bindVoteEvent(e)},100)},bindVoteEvent=function(e){return e.find(".st-vote-detail-option .vote-do").click(function(){if(e.data("task-over"))return!1;var t=$(this).parent(),i=t.parent(),a=i.data("multi-count");if(i.data("vote-multi")>1){var n=1*t.find("span:eq(1)").html();if(t.data("vote-chk")){t.data("vote-chk",!1),t.find("img.check").attr("src","images/common/icon/icon_check_round_white.png"),n-=1,i.data("multi-count",a-1);var o=t.data("member-list")||[];if(o.length>0)for(var s in o)o[s].gu==gu&&o.splice(s,1)}else if(a<i.data("vote-multi")){t.data("vote-chk",!0),i.data("multi-count",a+1),n+=1;var o=t.data("member-list")||[];o.push({gu:gu,rt:(new Date).getTime()}),t.data("member-list",o),t.find("img.check").attr("src",i.data("tick-img"))}}else{$.each(i.find(".st-vote-detail-option"),function(e,t){if($(this).data("vote-chk")){$(this).data("vote-chk",!1),$(this).find("img.check").attr("src","images/common/icon/icon_check_round_white.png");var i=1*$(this).find("span:eq(1)").html();$(this).find("span:eq(1)").html(i-1);var a=$(this).data("member-list")||[];if(a.length>0)for(var e in a)a[e].gu==gu&&a.splice(e,1)}});var n=1*t.find("span:eq(1)").html();t.data("vote-chk",!0),t.find("img.check").attr("src",i.data("tick-img")),n+=1;var o=t.data("member-list")||[];o.push({gu:gu,rt:(new Date).getTime()}),t.data("member-list",o),0==a&&i.data("multi-count",a+1)}t.find("span:eq(1)").html(n),e.find(".st-vote-send").hasClass("st-vote-send-blue")||(e.find(".st-vote-send").addClass("st-vote-send-blue"),e.find(".st-vote-send").html($.i18n.getString("COMMON_SUBMIT")))}),e.data("vote-bind-chk")?!1:(e.find(".st-vote-send").click(function(){if(e.data("vote-bind-chk",!0),!$(this).hasClass("st-vote-send-blue"))return!1;e.find(".st-vote-send").removeClass("st-vote-send-blue");var t={};t.li=[],t.tp=15;var i,a=!1;if($.each(e.find(".st-vote-ques-area"),function(e,n){var o=$(this);if(0==o.data("multi-count"))return a=!0,i=o.find(".st-vote-detail-top span:eq(0)").html(),!1;var s={};s.k=o.data("ques-index"),s.i=[],$.each($(this).find(".st-vote-detail-option"),function(e,t){var i=$(this);if(i.data("vote-chk")){var a={};a.k=i.data("item-index"),s.i.push(a)}}),t.li.push(s)}),a)return popupShowAdjust("",$.i18n.getString("FEED_VOTE_LIMIT")),!1;var n={meta:{lv:1,tp:"14"},ml:[t]},o="groups/"+gi+"/timelines/"+ti_feed+"/events?ep="+e.data("event-id"),s={ui:ui,at:at,li:lang},r="post";ajaxDo(o,s,r,!1,n).complete(function(t){200==t.status?(toastShow($.i18n.getString("FEED_VOTE_SENDED")),$(".popup-close").bind("reload",function(){eventStatusWrite(e),e.data("detail-content",!1),e.find(".st-vote-all-ques-area").html(""),e.find(".st-reply-area").hide(),e.data("switch-chk",!1),e.find(".st-sub-box-1").trigger("click"),$(".popup-close").unbind("reload")})):toastShow($.i18n.getString("FEED_VOTE_FAILED"))})}),void e.find(".st-vote-detail-option .vote-set").click(function(){var t=$(this).parent(),i=t.parent();if(0==t.data("member-list").length)return!1;var a=i.find(".st-vote-detail-desc").html()+" - "+t.find(".vote-do:not(.check)").html(),n=[{title:a,ml:t.data("member-list")}],o=e.data("event-id"),s=o.split("_")[0];cns.debug("list",n),showObjectTabShow(s,a,n)}))},composeContentMake=function(e){$(".cp-content-load").html($("<div>").load("layout/compose.html .cp-content",function(){var t=$(this).find(".cp-content");t._i18n(),t.data("send-chk",!0),t.css("min-height",$(window).height()),t.data("message-list",[0]),t.data("upload-obj",{}),t.data("upload-video",{}),t.data("upload-ai",0),t.data("body",{}),t.data("ml-order-obj",{}),t.data("attach",!1),t.find(".cp-textarea-desc, .cp-vote-area textarea").autosize({append:"\n"});var i,a,n=$("#page-compose .stickerArea");if(1==n.data("open")){var o=$("#page-compose .cp-addfile[data-cp-addfile='sticker']");o.trigger("click")}switch(n.html(""),n.data("isCreate",null),t.attr("data-type",e),e){case"post":ctp=0,i=".cp-content-object";break;case"announcement":ctp=1,i=".cp-content-title ,.cp-content-object, .cp-content-apt , .cp-content-top";try{var s=$.lStorage(ui)[gi];console.debug(s.tp),"A1"!=s.tp&&(i+=", .cp-content-watermark")}catch(r){errorReport(r)}break;case"feedback":ctp=2,i=".cp-content-title ,.cp-content-object, .cp-content-apt";try{var s=$.lStorage(ui)[gi];console.debug(s.tp),"A1"!=s.tp&&(i+=", .cp-content-watermark")}catch(r){errorReport(r)}break;case"work":ctp=3,i=".cp-content-title ,.cp-work-area,.cp-content-addcal,.cp-time-area",composeWorkEvent(t),a=!0;break;case"vote":ctp=4,i=".cp-content-title,.cp-content-object, .cp-content-object ,.cp-vote-area,.cp-vote-type-area,.cp-content-addcal,.cp-time-area",t.data("ques-total",0),a=!0,composeVoteQuesMake(t),composeVoteEvent(t);break;case"check":ctp=5,i=".cp-content-title,.cp-content-object, .cp-content-object ,.cp-content-addcal,.cp-time-area",a=!0}composeObjectShow(t),t.data("compose-tp",ctp),t.find(i).show(),t.find(".cp-content-top").click(function(){t.data("cp-top")?($(this).find(".cp-top-btn").attr("src","images/compose/compose_form_icon_check_none.png"),t.data("cp-top",!1)):($(this).find(".cp-top-btn").attr("src","images/compose/compose_form_icon_check.png"),t.data("cp-top",!0))}),t.find(".cp-content-watermark").click(function(){t.data("cp-watermark")?($(this).find(".cp-watermark-btn").attr("src","images/compose/compose_form_icon_check_none.png"),t.data("cp-watermark",!1)):($(this).find(".cp-watermark-btn").attr("src","images/compose/compose_form_icon_check.png"),t.data("cp-watermark",!0))}),t.find(".cp-textarea-desc").bind("input",function(){if(t.data("url-chk"))return!1;var e=t.find(".cp-textarea-desc").val().replace(/\n|\r/g," <br/> ").split(" ");$.each(e,function(e,i){return"http://"==i.substring(0,7)||"https://"==i.substring(0,8)||"www."==i.substring(0,4)?(t.data("parse-error",!1),t.data("url-chk",!0),t.data("parse-waiting",!0),t.data("parse-resend")||$(".cp-attach-area").show().find(".url-loading").css("display","block"),getLinkMeta(t,i),!1):void 0})}),a&&setDateTimePicker(t)}))},composeObjectShow=function(e){$(document).off("click",".cp-content-object ,.cp-work-item-object"),$(document).on("click",".cp-content-object ,.cp-work-item-object",function(){composeObjectShowDelegate(e,$(this))})},composeObjectShowDelegate=function(e,t,i,a){$(".header-cp-object span:eq(1)").html(0);var n=$(".obj-selected").outerHeight();$(".obj-cell-area").css("padding-top",n),$(".obj-cell-area").css("height",$(window).height()-57-n),$.mobile.changePage("#page-object",{transition:"slide"});var o=$.lStorage(ui)[gi],s=o.guAll,r=o.bl,l=o.fbl;if(null!=s){$(".obj-cell-area").html("");var c,d=!1,u=!1,h=!0,p=!0,f=!0,g=!0,m=!1;null==i?t.parent().hasClass("cp-work-item")?(d=!1,u=!0,h=!1,p=!0,f=!1):(d=!0,u=!0):(d=null==i.isShowBranch?d:i.isShowBranch,u=null==i.isShowSelf?u:i.isShowSelf,h=null==i.isShowAll?h:i.isShowAll,p=null==i.isShowFav?p:i.isShowFav,f=null==i.isShowFavBranch?f:i.isShowFavBranch,g=null==i.isBack?g:i.isBack,m=null==i.isShowLeftMem?m:i.isShowLeftMem);var v=Object.keys(s);if(null==v||u&&v.length<=0||0==u&&v.length<=1)return $("#page-object .obj-content").hide(),$("#page-object .obj-coach-noMember").show(),void $(".obj-done").hide();if($("#page-object .obj-content").show(),$("#page-object .obj-coach-noMember").hide(),$(".obj-done").show(),c=t.parent().hasClass("cp-work-item")?t.data("object_str"):e.data("object_str"),$(".obj-content").data("selected-branch",{}),$(".obj-content").data("selected-obj",{}),$(".obj-content").data("selected-fav",{}),$(".obj-content").data("isBack",g),updateSelectedObj(),h){var b=$('<div class=\'obj-cell all\'><div class="obj-cell-chk"><div class="img"></div></div><div class="obj-cell-user-pic"><img src="images/common/others/select_empty_all_photo.png" style="width:60px"/></div><div class="obj-cell-subgroup-data"><div class="obj-user-name">'+$.i18n.getString("COMMON_SELECT_ALL")+"</div></div>");$(".obj-cell-area").append(b),b.data("chk",!0),b.find(".img").addClass("chk"),b.off("click").click(selectTargetAll)}if(p){var w=$("<div class='subgroup-row fav-parent'></div>"),_=$("<div class='subgroup-parent'></div>"),y=$('<div class=\'obj-cell fav\'><div class="obj-cell-chk"><div class="img"></div></div><div class="obj-cell-user-pic"><img src="images/common/others/empty_img_favor.png" style="width:60px"/></div><div class="obj-cell-subgroup-data"><div class="obj-user-name">'+$.i18n.getString("COMMON_FAVORIATE")+"</div></div>");_.html(y),_.append('<div class="obj-cell-arrow"></div>'),w.append(_);var x=$("<div></div>");x.css("display","none");for(var k in s){var C=s[k];if(1==C.fav){var S=getMemObjectRow(C,r);S.addClass("_2"),x.append(S)}}if(f)for(var T in l){var E=l[T],S=$('<div class="obj-cell fav-branch _2" data-gu="'+T+'"><div class="obj-cell-chk"><div class="img"></div></div><div class="obj-cell-user-pic"><img src="images/common/others/select_empty_all_photo.png" style="width:60px"/></div><div class="obj-cell-subgroup-data"><div class="obj-user-name">'+E.fn.replaceOriEmojiCode()+'</div><div class="obj-user-title"></div></div></div>');S.data("fi",T),S.data("fn",E.fn),x.append(S)}x.find(".obj-cell").length>0&&(w.append(x),$(".obj-cell-area").append(w),w.find(".obj-cell.fav + .obj-cell-arrow").off("click").click(function(e){return $(".obj-content").hasClass("on-search")?($(this).previous().trigger("click"),void e.stopPropagation()):($(this).toggleClass("open"),void $(this).parent().next().toggle())}))}if(r&&d&&Object.keys(r).length>0){$(".obj-content").data("selected-branch",{});var O=$("<div class='obj-cell-subTitle group' data-chk='false'></div>");O.append('<div class="obj-cell-subTitle-chk"><div class="img"></div><div class="select">'+$.i18n.getString("COMMON_SELECT_ALL")+"</div></div>"),O.append("<div class='text'>"+$.i18n.getString("COMPOSE_SUBGROUP")+"</div>"),$(".obj-cell-area").append(O),$.each(r,function(e,t){if(1==t.lv){var i=$("<div class='subgroup-row'></div>"),a=$("<div class='subgroup-parent'></div>"),n=$("<div class='obj-cell subgroup branch' data-bl='"+e+"' data-bl-name='"+t.bn+'\'><div class="obj-cell-chk"><div class="img"></div></div><div class="obj-cell-user-pic"><img src="images/common/others/select_empty_all_photo.png" style="width:60px"/></div><div class="obj-cell-subgroup-data"><div class="obj-user-name">'+t.bn.replaceOriEmojiCode()+"</div></div>");n.data("bl-name",t.bn),n.data("bl",e),a.html(n),i.html(a),t.cl.length>0&&(a.append('<div class="obj-cell-arrow"></div>'),createChild(r,i,t)),$(".obj-cell-area").append(i),$(".obj-cell-area").append('<hr color="#F3F3F3">')}}),$(".obj-cell-area .obj-cell-arrow").off("click").click(function(e){if($(".obj-content").hasClass("on-search"))return $(this).prev().trigger("click"),void e.stopPropagation();var t=$(this).parent().next();$(this).hasClass("open")?($(this).removeClass("open"),t.slideUp()):($(this).addClass("open"),t.slideDown())}),O.off("click").click(function(){if(!$(".obj-content").hasClass("on-search")){if(clearMeAndAllSelect(),$(this).data("chk"))$(this).data("chk",!1),$(this).find(".img").removeClass("chk"),$(".obj-cell-area").find(".obj-cell.branch").each(function(){var e=$(this);e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk")}),$(".obj-content").data("selected-branch",{});else{$(this).data("chk",!0),$(this).find(".img").addClass("chk");var e={};$(".obj-cell-area").find(".obj-cell.branch").each(function(){var t=$(this);t.data("chk",!0),t.find(".obj-cell-chk .img").addClass("chk"),t.data("bl-name")&&(e[t.data("bl")]=t.data("bl-name"))}),$(".obj-content").data("selected-branch",e)}updateSelectedObj()}})}var O=$("<div class='obj-cell-subTitle mem'></div>");t.parent().hasClass("cp-work-item")||(O.append('<div class="obj-cell-subTitle-chk"><div class="img"></div><div class="select">'+$.i18n.getString("COMMON_SELECT_ALL")+"</div></div>"),O.click(function(){if(!$(".obj-content").hasClass("on-search")){if(clearMeAndAllSelect(),$(this).data("chk"))$(this).data("chk",!1),$(this).find(".img").removeClass("chk"),$(".obj-cell-area").find(".obj-cell.mem").each(function(){var e=$(this);e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk")}),$(".obj-content").data("selected-obj",{});else{$(this).data("chk",!0),$(this).find(".img").addClass("chk");var e={};$(".obj-cell-area").find(".obj-cell.mem").each(function(){var t=$(this);t.data("chk",!0),t.find(".obj-cell-chk .img").addClass("chk"),t.data("gu-name")&&(e[t.data("gu")]=t.data("gu-name"))}),$(".obj-content").data("selected-obj",e)}updateSelectedObj()}})),O.append("<div class='text'>"+$.i18n.getString("COMMON_MEMBER")+"</div>"),$(".obj-cell-area").append(O),$.each(s,function(e,t){if(!(0==u&&e==o.gu||0==m&&1!=t.st)){var i=getMemObjectRow(t,r);$(".obj-cell-area").append(i)}}),console.debug("obj_data:",c),c?(c=$.parseJSON(c),Object.keys(c).length&&($(".obj-content").data("selected-obj",c),$(document).find(".obj-cell").each(function(e,t){var i=$(this);$.inArray(i.data("gu"),Object.keys(c))>=0?(i.data("chk",!0),i.find(".obj-cell-chk .img").addClass("chk")):(i.data("chk",!1),i.find(".obj-cell-chk .img").removeClass("chk"))}),updateSelectedObj())):$(".obj-content").data("selected-obj",{}),$(document).off("click",".obj-cell.mem"),$(document).on("click",".obj-cell.mem",function(){clearMeAndAllSelect();var e=".obj-cell.mem[data-gu="+$(this).data("gu")+"]",i=$(e);0==i.length&&(i=$(this));var a=$(".obj-content").data("selected-obj");t.parent().hasClass("cp-work-item")?(cns.debug("work"),$(document).find(".obj-cell-chk").data("chk",!1),$(document).find(".obj-cell-chk .img").removeClass("chk"),i.data("chk",!0),i.find(".obj-cell-chk .img").addClass("chk"),$(".obj-selected .list .text").html("<span>"+i.data("gu-name")+"</span>"),a={},a[i.data("gu")]=i.data("gu-name")):i.data("chk")?(i.data("chk",!1),i.find(".obj-cell-chk .img").removeClass("chk"),delete a[i.data("gu")]):(i.data("chk",!0),i.find(".obj-cell-chk .img").addClass("chk"),i.data("gu-name")&&(a[i.data("gu")]=i.data("gu-name"))),$(".obj-content").data("selected-obj",a),updateSelectedObj()}),$(document).off("click",".obj-cell.branch:not(.subgroup)"),$(document).on("click",".obj-cell.branch:not(.subgroup)",function(){clearMeAndAllSelect();var e=$(this),t=$(".obj-content").data("selected-branch");e.data("chk")?(e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk"),delete t[e.data("bl")]):(e.data("chk",!0),e.find(".obj-cell-chk .img").addClass("chk"),e.data("bl-name")&&(t[e.data("bl")]=e.data("bl-name"))),$(".obj-content").data("selected-branch",t),updateSelectedObj()}),$(document).off("click",".obj-cell.subgroup"),$(document).on("click",".obj-cell.subgroup",function(){clearMeAndAllSelect();var e=$(this),t=$(".obj-content").data("selected-branch");if(e.data("chk")){e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk"),delete t[e.data("bl")];var i=e.parent().next().find(".obj-cell.branch"),a=!0;i.each(function(){return $(this).data("chk")?void 0:(a=!1,!1)}),a&&i.each(function(){$(this).data("chk",!1),$(this).find(".obj-cell-chk .img").removeClass("chk"),delete t[$(this).data("bl")]})}else{e.data("chk",!0),e.find(".obj-cell-chk .img").addClass("chk"),
e.data("bl-name")&&(t[e.data("bl")]=e.data("bl-name"));var i=e.parent().next().find(".obj-cell.branch"),n=!0;i.each(function(){return 1==$(this).data("chk")?(n=!1,!1):void 0}),n&&i.each(function(){$(this).data("chk",!0),$(this).find(".obj-cell-chk .img").addClass("chk"),$(this).data("bl-name")&&(t[$(this).data("bl")]=$(this).data("bl-name"))})}$(".obj-content").data("selected-branch",t),updateSelectedObj()}),$(document).off("click",".obj-cell.fav-branch"),$(document).on("click",".obj-cell.fav-branch",function(){clearMeAndAllSelect();var e=$(this),t=$(".obj-content").data("selected-fav");e.data("chk")?(e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk"),delete t[e.data("fi")]):(e.data("chk",!0),e.find(".obj-cell-chk .img").addClass("chk"),e.data("fn")&&(t[e.data("fi")]=e.data("fn"))),$(".obj-content").data("selected-fav",t),updateSelectedObj()}),$(document).off("click",".obj-cell.fav"),$(document).on("click",".obj-cell.fav",function(){clearMeAndAllSelect();var e=$(this),t=$(".obj-content").data("selected-fav"),i=$(".obj-content").data("selected-obj");if(e.data("chk")){e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk");var a=e.parent().next().find(".obj-cell"),n=!0;a.each(function(){return $(this).data("chk")?void 0:(n=!1,!1)}),n&&a.each(function(){if($(this).data("fi"))$(this).data("chk",!1),$(this).find(".obj-cell-chk .img").removeClass("chk"),delete t[$(this).data("fi")];else if($(this).data("gu")){var e=$(".obj-cell.mem[data-gu="+$(this).data("gu")+"]");e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk"),delete i[$(this).data("gu")]}})}else{e.data("chk",!0),e.find(".obj-cell-chk .img").addClass("chk"),e.data("fn")?t[e.data("fi")]=e.data("fn"):e.data("gu-name")&&(i[e.data("gu")]=e.data("gu-name"));var a=e.parent().next().find(".obj-cell"),o=!0;a.each(function(){return 1==$(this).data("chk")?(o=!1,!1):void 0}),o&&a.each(function(){if($(this).data("fi"))$(this).data("chk",!0),$(this).find(".obj-cell-chk .img").addClass("chk"),t[$(this).data("fi")]=$(this).data("fn");else if($(this).data("gu")){var e=$(".obj-cell.mem[data-gu="+$(this).data("gu")+"]");e.data("chk",!0),e.find(".obj-cell-chk .img").addClass("chk"),i[$(this).data("gu")]=$(this).data("gu-name")}})}$(".obj-content").data("selected-fav",t),$(".obj-content").data("selected-obj",i),updateSelectedObj()}),$(".obj-selected .clear").off("click").click(selectTargetAll),$(".obj-done").unbind("click"),$(".obj-done").click(function(){var i=Object.keys($(".obj-content").data("selected-obj")).length+Object.keys($(".obj-content").data("selected-branch")).length+Object.keys($(".obj-content").data("selected-fav")).length;if(t.parent().hasClass("cp-work-item")){var n=".cp-work-item-object span:eq("+t.parents(".cp-work-item").data("work-index")+")",o=$(".obj-content").data("selected-obj"),s="分派對象";if(i){var r=Object.keys(o)[0];s=o[r],$(n).css("color","red")}else $(n).removeAttr("style");$(n).html(s);var s=JSON.stringify(o);t.data("object_str",s)}else{0!=i?$(".cp-content-object span").html($.i18n.getString("GROUP_MEMBERS",i)):$(".cp-content-object span").html("");var s=JSON.stringify($(".obj-content").data("selected-obj"));e.data("object_str",s);var l=JSON.stringify($(".obj-content").data("selected-branch"));e.data("branch_str",l);var c=JSON.stringify($(".obj-content").data("selected-fav"));e.data("favorite_str",c)}var d=$(".obj-content").data("isBack");(null==d||1==d)&&$(".obj-done").parent().find(".page-back").trigger("click"),a&&a()}),$(".obj-selected").off("click").click(function(e){$(".obj-selected .search").focus()}),$(document).on("click",".obj-selected .list .text span",function(e){$(".obj-selected .list .search").html($(this).text()).trigger("input"),$(".obj-cell-area").scrollTop(0),e.stopPropagation()}),$(document).on("click",".on-search .obj-cell, .on-search .subgroup-parent",function(){$(".obj-selected .list .search").html("").trigger("input"),$(".obj-cell-area").scrollTop(0)}),$(".obj-selected .list .search").off("input").on("input",function(){var e=$(this).html(),t=$(".obj-cell");return e.length<=0?(t.show(),$(".obj-cell-arrow.open").removeClass("open"),$(".subgroup-parent").next().hide(),$(".obj-cell-arrow").css("opacity","1"),$(".obj-content").removeClass("on-search"),$(".obj-cell").show(),$(".subgroup-parent").show(),$(".subgroup-row.fav-parent").show(),$(this).html(""),$(".obj-cell-area hr").show(),void $(".obj-cell-subTitle .obj-cell-subTitle-chk").show()):(e=e.toLowerCase(),$(".obj-cell-area hr").hide(),$(".subgroup-parent").hide(),$(".subgroup-parent").next().show(),$(".obj-cell-arrow").css("opacity","0"),$(".obj-content").addClass("on-search"),$(".subgroup-row.fav-parent").hide(),$(".obj-cell-subTitle .obj-cell-subTitle-chk").hide(),void($(".obj-content").hasClass("on-search")&&t.each(function(t,i){var a=$(i);if(a.hasClass("self")||a.hasClass("all")||a.hasClass("fav"))return void a.hide();var n=a.parents(".subgroup-parent"),o=a.find(".obj-user-name").text(),s=a.find(".obj-user-title").text();return o&&o.toLowerCase().indexOf(e)>=0||s&&s.toLowerCase().indexOf(e)>=0?(n.show(),void a.show()):void(n.length>0?n.hide():a.hide())})))})}},updateSelectedObj=function(){var e=0,t=$(".obj-content").data("selected-branch"),i=$(".obj-content").data("selected-obj"),a=$(".obj-content").data("selected-fav");if($(".obj-selected .list .text").html(""),null!=t){e+=Object.keys(t).length,$.each(t,function(e,t){$(".obj-selected .list .text").append("<span>"+t.replaceOriEmojiCode()+"</span>")});var n=!0;$(".obj-cell.branch").each(function(){return $(this).data("chk")?void 0:(n=!1,!1)});var o=$(".obj-cell-subTitle.group");n?(o.data("chk",!0),o.find(".img").addClass("chk")):(o.data("chk",!1),o.find(".img").removeClass("chk"))}if(null!=i){var s=$(".obj-cell.self").data("gu");1==$(".obj-cell.mem[data-gu="+s+"]").data("chk")?($(".obj-cell.self").data("chk",!0),$(".obj-cell.self").find(".img").addClass("chk")):($(".obj-cell.self").data("chk",!1),$(".obj-cell.self").find(".img").removeClass("chk")),e+=Object.keys(i).length,$.each(i,function(e,t){$(".obj-selected .list .text").append("<span>"+t.replaceOriEmojiCode()+"</span>")});var n=!0;$(".obj-cell.mem").each(function(){return $(this).data("chk")?void 0:(n=!1,!1)});var o=$(".obj-cell-subTitle.mem");n?(o.data("chk",!0),o.find(".img").addClass("chk")):(o.data("chk",!1),o.find(".img").removeClass("chk"))}if(null!=a){e+=Object.keys(a).length,$.each(a,function(e,t){$(".obj-selected .list .text").append("<span>"+t.replaceOriEmojiCode()+"</span>")});var n=!0;$(".subgroup-row.fav-parent div:nth-child(2) .obj-cell").each(function(){return $(this).data("chk")?void 0:(n=!1,!1)});var o=$(".obj-cell.fav");n?(o.data("chk",!0),o.find(".img").addClass("chk")):(o.data("chk",!1),o.find(".img").removeClass("chk"))}$(".header-cp-object span:eq(1)").html(e);var r=$(".obj-selected").outerHeight();$(".obj-cell-area").css("padding-top",r),$(".obj-cell-area").css("height",$(window).height()-57-r)},createChild=function(e,t,i){var a=$("<div></div>");1==i.lv&&a.css("display","none");for(var n=0;n<i.cl.length;n++){var o=i.cl[n],s=e[o],r=$("<div class='obj-cell branch _2' data-bl='"+o+"' data-bl-name='"+s.bn+'\'><div class="obj-cell-chk"><div class="img"></div></div><div class="obj-cell-user-pic namecard"><img src="images/common/others/select_empty_all_photo.png" style="width:60px"/></div><div class="obj-cell-subgroup-data"><div class="obj-user-name">'+s.bn.replaceOriEmojiCode()+"</div></div>");a.append(r),s.cl.length>0&&createChild(e,a,s)}t.append(a)},clearMeAndAllSelect=function(){var e=$(".obj-cell.self, .obj-cell.all");e.each(function(){$(this).data("chk")&&($(this).data("chk",!1),$(this).find(".img").removeClass("chk"),$(".obj-content").data("selected-branch",{}),$(".obj-content").data("selected-obj",{}))})},clearMemAndBranchAll=function(){$(".obj-cell-subTitle").each(function(){$(this).data("chk")&&($(this).data("chk",!1),$(this).find(".img").removeClass("chk"))})},selectTargetAll=function(){clearMeAndAllSelect(),clearMemAndBranchAll(),$(".obj-cell.all").data("chk",!0),$(".obj-cell.all").find(".img").addClass("chk"),$(".obj-content").data("selected-branch",{}),$(".obj-content").data("selected-obj",{}),$(".obj-content").data("selected-fav",{}),$(".obj-cell-subTitle").data("chk",!1),$(".obj-cell-area").find(".obj-cell.branch").each(function(){var e=$(this);e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk")}),$(".obj-cell-area").find(".obj-cell.mem").each(function(){var e=$(this);e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk")}),$(".obj-cell-area").find(".obj-cell.fav").each(function(){var e=$(this);e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk")}),$(".obj-cell-area").find(".obj-cell.fav-branch").each(function(){var e=$(this);e.data("chk",!1),e.find(".obj-cell-chk .img").removeClass("chk")}),updateSelectedObj()},getMemObjectRow=function(e,t){var i=$('<div class="obj-cell mem" data-gu="'+e.gu+'"><div class="obj-cell-chk"><div class="img"></div></div><div class="obj-cell-user-pic namecard"><img src="images/common/others/empty_img_personal_xl.png" style="width:60px"/></div><div class="obj-cell-user-data"><div class="obj-user-name">'+e.nk.replaceOriEmojiCode()+'</div><div class="obj-user-title"></div></div>'),a=e.bl,n="";if(a&&a.length>0){var o=a.split(".");o&&o.length>0&&(a=o[o.length-1],t.hasOwnProperty(a)&&(n=t[a].bn))}n&&n.length>0&&(i.find(".obj-cell-user-data").addClass("extra"),i.find(".obj-user-title").html(n));var s=i.find(".obj-cell-user-pic img");return e.aut&&(s.attr("src",e.aut),avatarPos(s)),i.data("gu",e.gu),i.find(".obj-cell-user-pic.namecard").data("gu",e.gu),i.data("gu-name",e.nk),i},timelineObjectTabShowDelegate=function(e,t,i){var a=[],n="",o=e.data("event-id"),s=o.split("_")[0];switch(t){case 0:case 9:var r=!0;try{var l=$.lStorage(ui)[s];(1==l.set.s9||3==l.set.s9)&&(r=!1)}catch(c){return void errorReport(c)}var d=!1;a.push({title:$.i18n.getString("FEED_READ"),ml:null}),getThisTimelinePart(e,0,function(e){try{var t=$.parseJSON(e.responseText).epl;if(0==r)for(var o=0;o<t.length;o++)delete t[o].rt;a[0].ml=t,d?showObjectTabShow(s,n,a,i):d=!0}catch(l){errorReport(l)}}),r?(a.push({title:$.i18n.getString("FEED_UNREAD"),ml:null}),getThisTimelinePart(e,9,function(e){try{a[1].ml=$.parseJSON(e.responseText).epl,d?showObjectTabShow(s,n,a,i):d=!0}catch(t){errorReport(t)}})):(a.push({title:$.i18n.getString("FEED_UNREAD"),clickable:!1}),d&&showObjectTabShow(s,n,a,i),d=!0);break;case 1:var u=!0;try{var l=$.lStorage(ui)[s];l.isOfficial&&1!=l.ad&&(u=!1)}catch(c){return void errorReport(c)}var h=e.data("parti-like");if(null==h||0==h.length)return void cns.debug("null epl:",h);n=$.i18n.getString("FEED_LIKE")+"("+h.length+")",a.push({title:"",ml:h}),a.length>0&&showObjectTabShow(s,n,a,i,u)}},timelineShowResponseLikeDelegate=function(e,t,i){var a=[],n="";getThisTimelineResponsePart(e,t,function(t){if(200==t.status)try{var o=e.data("event-id"),s=o.split("_")[0],r=$.parseJSON(t.responseText);a.push({title:"",ml:r.epl}),n=$.i18n.getString("FEED_LIKE")+"("+r.epl.length+")",a.length>0&&showObjectTabShow(s,n,a,i)}catch(l){errorReport(l)}})},showObjectTabShow=function(e,t,i,a,n){var o=$("#page-tab-object");null==n&&(n=!0),o.find(".header-cp-object").html(t?t:"");var s=(i.length,o.find(".tabObj-tab-area")),r=$("#page-tab-object .tabObj-cell-area");s.html("");var l=100/i.length+"%",c=0;$.each(i,function(e,t){var i=$("<div class='tab'></div>");i.data("id",e),i.data("obj",t),i.css("width",l);var a="<div>"+(t.title&&t.title.length>0?t.title:" ")+"</div>";i.html(a),i.data("clickable",null==t.clickable?!0:t.clickable),s.append(i),c++}),1>=c?(s.hide(),r.addClass("noTitle")):(s.show(),r.removeClass("noTitle")),s.next().html(""),$(document).find("#page-tab-object .tab").click(function(){var t=$(this);if(0==t.data("clickable"))return void popupShowAdjust($.i18n.getString("COMMON_PAID_FEATURE_TITLE"),$.i18n.getString("COMMON_PAID_FEATURE_CONTENT"));$(window).scrollTop(0),$("body").addClass("user-info-adjust"),setTimeout(function(){$("body").removeClass("user-info-adjust")},100);var i=t.data("id"),a=r.find("._"+i);if($("#page-tab-object .tab").removeClass("current"),t.addClass("current"),a.length<=0){var o=t.data("obj");a=$("<div class='obj-cell-page _"+i+"'></div>"),r.append(a);for(var s=$.lStorage(ui)[e].guAll,l=$.lStorage(ui)[e].bl,c=0;c<o.ml.length;c++){var d=o.ml[c].gu,u=o.ml[c].rt;if(d&&s.hasOwnProperty(d)){var h=s[d],p=$('<div class="obj-cell mem" data-gu="'+d+'"><div class="obj-cell-user-pic"><img src="images/common/others/empty_img_personal_xl.png" style="width:60px"/></div><div class="obj-cell-time"></div><div class="obj-cell-user-data"><div class="obj-user-name">'+h.nk.replaceOriEmojiCode()+'</div><div class="obj-user-title"></div></div>');n&&p.find(".obj-cell-user-pic").addClass("namecard").data("gi",e);var f=h.bl,g="";if(f&&f.length>0){var m=f.split(".");m&&m.length>0&&(f=m[m.length-1],l.hasOwnProperty(f)&&(g=l[f].bn))}g&&g.length>0&&(p.find(".obj-cell-user-data").addClass("extra"),p.find(".obj-user-title").html(g));var v=p.find(".obj-cell-user-pic img");h.aut&&v.attr("src",h.aut),u&&p.find(".obj-cell-time").html(new Date(u).toFormatString()),p.find(".obj-cell-user-pic.namecard").data("gu",h.gu),p.data("gu",h.gu),p.data("gu-name",h.nk),a.append(p)}}}$("#page-tab-object .obj-cell-page.current").hide().removeClass("current"),a.show().addClass("current")}),s.find(".tab:nth-child(1)").trigger("click"),$.mobile.changePage("#page-tab-object",{transition:"slide"})},setDateTimePicker=function(e){var t=new Date,i=t.customFormat("#MM#月#DD#日,#CD#,#hhh#:#mm#"),a=i.split(",");e.find(".cp-setdate-l .cp-setdate-date").html(a[0]),e.find(".cp-setdate-l .cp-setdate-week").html(a[1]),e.find(".cp-setdate-l .cp-setdate-time").html(a[2]);var n=new Date((new Date).getTime()+864e5),o=n.customFormat("#MM#月#DD#日,#CD#,#hhh#:#mm#"),s=o.split(",");e.find(".cp-setdate-r .cp-setdate-date").html(s[0]),e.find(".cp-setdate-r .cp-setdate-week").html(s[1]),e.find(".cp-setdate-r .cp-setdate-time").html(s[2]);var r=(new Date).getTime(),l=Math.round(r/1e3);e.data("start-timestamp",1e3*l);var c=(new Date).getTime()+864e5,d=Math.round(c/1e3);e.data("end-timestamp",1e3*d),e.find(".cp-setdate-chk").click(function(){var t=e.data("start-time-chk");if(t){$(this).find("img").attr("src","images/common/icon/icon_check_gray.png"),$(this).find("span").removeClass("cp-start-time-text"),e.data("start-time-chk",!1);var i=new Date,a=i.customFormat("#MM#月#DD#日,#CD#,#hhh#:#mm#"),n=a.split(",");e.find(".cp-setdate-l .cp-setdate-date").html(n[0]),e.find(".cp-setdate-l .cp-setdate-week").html(n[1]),e.find(".cp-setdate-l .cp-setdate-time").html(n[2]);var o=e.find("input.cp-datetimepicker-start"),s=e.find("input.cp-datetimepicker-end"),r=(new Date).getTime(),l=Math.round(r/1e3);o.datetimepicker({minDate:0,format:"unixtime",value:l}),e.data("start-timestamp",1e3*l);var c=1*s.val();s.datetimepicker("destroy"),e.find("input.cp-datetimepicker-end").datetimepicker({minDate:0,format:"unixtime",value:c,onChangeDateTime:function(){onChangeDateTime(e,"end")}})}else $(this).find("img").attr("src","images/common/icon/icon_check_gray_check.png"),$(this).find("span").addClass("cp-start-time-text"),e.data("start-time-chk",!0);e.find(".cp-setdate-l-2 .cp-setdate-start-text").toggle(),e.find(".cp-setdate-l-2 .cp-setdate-content").toggle()}),e.find("input.cp-datetimepicker-start").datetimepicker({minDate:0,format:"unixtime",onChangeDateTime:function(){onChangeDateTime(e,"start")}}),e.find("input.cp-datetimepicker-end").datetimepicker({startDate:"+1970/01/01",minDate:"-1969/12/31",format:"unixtime",onChangeDateTime:function(){onChangeDateTime(e,"end")}}),e.find(".cp-setdate-l").click(function(){var t=e.data("start-time-chk");return t?void e.find("input.cp-datetimepicker-start").datetimepicker("show"):!1}),e.find(".cp-setdate-r").click(function(){e.find("input.cp-datetimepicker-end").datetimepicker("show")})},onChangeDateTime=function(e,t){var i=e.find("input.cp-datetimepicker-"+t);if(!i.val())return!1;var a=new Date(1e3*i.val()),n=a.customFormat("#MM#月#DD#日,#CD#,#hhh#:00"),o=n.split(",");if("start"==t){e.data("start-timestamp",1e3*i.val());var s=1*i.val(),r=e.find("input.cp-datetimepicker-end"),l=1*r.val();s>l&&(e.data("end-timestamp",1e3*i.val()),r.datetimepicker({minDate:a.customFormat("#YYYY#/#M#/#D#"),value:s}),e.find(".cp-setdate-r .cp-setdate-date").html(o[0]),e.find(".cp-setdate-r .cp-setdate-week").html(o[1]),e.find(".cp-setdate-r .cp-setdate-time").html(o[2])),r.datetimepicker({minDate:a.customFormat("#YYYY#/#M#/#D#")});var c=e.find(".cp-setdate-l")}else{e.data("end-timestamp",1e3*i.val());var c=e.find(".cp-setdate-r")}c.find(".cp-setdate-date").html(o[0]),c.find(".cp-setdate-week").html(o[1]),c.find(".cp-setdate-time").html(o[2])},composeWorkEvent=function(e){var t=e.find(".cp-work-area");t.find(".cp-work-item textarea").autosize({append:"\n"}),t.find(".cp-work-item textarea").attr("placeholder",$.i18n.getString("COMPOSE_TASK_DESC_EMPTY")),t.find(".cp-work-add-item").click(function(){var i=e.find(".cp-work-item").length,a=$('<div class="cp-work-item" data-work-index="'+i+'"><img src="images/common/icon/icon_compose_close.png"/><span>'+(i+1)+'</span><textarea class="cp-opt-textarea textarea-animated cp-work-empty-chk" placeholder="" data-role="none"></textarea><div class="cp-work-item-object"><span>分派對象</span><img src="images/ap_box_arrow.png"/></div></div>');$(this).before(a),a.find("textarea").autosize({append:"\n"}),a.find("textarea").attr("placeholder",$.i18n.getString("COMPOSE_TASK_DESC_EMPTY")),t.find(".cp-work-item > img").show()}),$(document).on("click",".cp-work-item > img",function(){$(this).parent().hide("fast",function(){$(this).remove();var a=e.find(".cp-work-item").length;for(1>=a&&t.find(".cp-work-item > img").hide(),i=0;i<a;i++)t.find(".cp-work-item:eq("+i+") > span").html(i+1),t.find(".cp-work-item:eq("+i+")").attr("data-work-index",i)})})},composeVoteQuesMake=function(e){e.find(".cp-vote-area").append($("<div>").load("layout/compose.html .cp-vote-ques-area",function(){var t=$(this).find(".cp-vote-ques-area");t._i18n();var i=e.data("ques-total");i+=1,e.data("ques-total",i),i>1&&(e.find(".cp-vote-ques-title img:eq(0)").show(),t.find(".cp-vote-ques-title img:eq(0)").show()),t.find(".cp-vote-ques-title span").html(i),t.data("opt-total",2),t.data("vote-count",1),t.data("opts-delete",!1),t.find(".cp-vq-textarea-title").bind("input",function(){$(this).val()?t.find(".cp-vote-ques-title img:eq(1)").css("opacity",0):t.find(".cp-vote-ques-title img:eq(1)").css("opacity",1)}),t.find("textarea").autosize({append:"\n"}),t.find(".cp-vote-add-opt").click(function(){var e=t.data("opt-total");cns.debug("opt total:",t.data("opt-total")),e+=1,t.data("opt-total",e),$(this).before('<div class="cp-vote-opt cp-new-opt-'+e+' "><img src="images/common/icon/icon_compose_close.png" style="display:block"/><span>'+e+'</span><textarea class="cp-opt-textarea textarea-animated cp-vote-empty-chk" placeholder="投票項目" data-role="none"></textarea></div>'),t.data("opts-delete")||(t.find(".cp-vote-opt img").show(),t.data("opts-delete",!0)),t.find(".cp-new-opt-"+e+" textarea").autosize({append:"\n"})}),t.find(".cp-vote-ques-title img:eq(0)").click(function(){var i=e.data("ques-total");return 1==i?!1:(i-=1,e.data("ques-total",i),t.hide("slow",function(){$(this).remove(),e.find(".cp-vote-ques-area").each(function(e,t){$(this).find(".cp-vote-ques-title span").html(e+1)})}),void(1==i&&e.find(".cp-vote-ques-title img:eq(0)").hide()))})}))},composeVoteEvent=function(e){e.find(".cp-vote-type").click(function(){e.find(".cp-vote-type").data("chk",!1),e.find(".cp-vote-type .tick img").attr("src","images/common/icon/icon_check_gray.png"),$(this).data("chk",!0),$(this).find(".tick img").attr("src","images/common/icon/icon_check_gray_check.png"),e.data("vote-type",$(this).data("vote-type"))}),$(document).on("click",".cp-vote-opt img",function(){var e=$(this).parents(".cp-vote-ques-area"),t=$(this).parent(),a=e.data("opt-total");a-=1,e.data("opt-total",a),t.hide("slow",function(){for($(this).remove(),i=0;i<a;i++)e.find(".cp-vote-opt:eq("+i+") span").html(i+1)});var n=e.data("vote-count");return n>=a&&(n=a-1,e.find(".cp-vote-count div:eq(0)").html(n),e.data("vote-count",n)),2==a?(e.find(".cp-vote-opt img").hide(),e.data("opts-delete",!1),!1):void 0}),console.debug("go"),$(document).off().on("click",".cp-vote-pm",function(){var e=$(this).parents(".cp-vote-ques-area"),t=e.data("vote-count"),i=$(this);if(i.hasClass("cp-vote-minus")){if(1==t)return!1;t-=1;var a="minus"}else{var n=e.data("opt-total");if(n-=1,t==n)return!1;t+=1;var a="plus"}var o="images/compose/vote/compose_post_vote_bt_"+a;i.find("img").attr("src",o+"_click.png"),setTimeout(function(){i.find("img").attr("src",o+".png")},100),e.data("vote-count",t),e.find(".cp-vote-count div:eq(0)").html(t)}),e.find(".cp-vote-add-ques").click(function(){composeVoteQuesMake(e)})},composeVoteObjMake=function(e,t){var i=!1;if(e.find(".cp-vote-empty-chk").each(function(){return $(this).val()?void 0:(i=!0,!1)}),i)return!0;var a={li:[],b:e.data("start-timestamp"),e:e.data("end-timestamp"),tp:14,lv:e.data("vote-type")};e.data("ques-total");e.find(".cp-vote-ques-area").each(function(){var e=$(this),t=(e.data("vote-count"),{k:1*e.find(".cp-vote-ques-title span").html()-1,t:e.find("textarea").val(),v:e.data("vote-count"),i:[]});e.find(".cp-vote-opt").each(function(){var e=$(this),i={k:1*e.find("span").html()-1,o:e.find(".cp-opt-textarea").val()};t.i.push(i)}),a.li.push(t)}),t.ml.push(a)},composeSend=function(t){var i,a=t.data("compose-tp"),n=t.data("compose-content"),o=t.data("message-list").unique(),s=!1,r={meta:{lv:1,tp:"0"+a},ml:[]},l=!1,c=!1;if(t.data("cp-watermark")){c=!0;var d={wm:1,tp:27};r.ml.push(d)}switch(a){case 0:break;case 1:r.meta.tt=t.data("compose-title"),t.data("cp-top")&&(r.meta.top=!0);break;case 2:r.meta.tt=t.data("compose-title");break;case 3:var u=[],h=[];r.meta.tt=t.data("compose-title"),t.find(".cp-work-item-object").each(function(e,t){var a=$(this).parent(),n={};if($(this).data("object_str")&&(n=$.parseJSON($(this).data("object_str"))),!$(this).data("object_str")||0==Object.keys(n).length)return l=!0,i=$.i18n.getString("COMPOSE_TASK_OWNER_EMPTY"),!1;if(!a.find("textarea").val())return l=!0,i=$.i18n.getString("COMPOSE_TASK_DESC_EMPTY"),!1;var o={u:Object.keys(n).join(","),k:a.data("work-index"),d:a.find("textarea").val()};u.push(o),$.each(n,function(e,t){var i={gu:e,n:t};h.push(i)})});var p={gu:gu,n:$.lStorage(ui)[gi].guAll[gu].nk};if(h.push(p),r.meta.tu={gul:h},l)break;var d={li:[],b:t.data("start-timestamp"),e:t.data("end-timestamp"),tp:12};d.li=u,r.ml.push(d);break;case 4:r.meta.tt=t.data("compose-title"),l=composeVoteObjMake(t,r),i=$.i18n.getString("COMPOSE_VOTE_EMPTY");break;case 5:r.meta.tt=t.data("compose-title");var d={b:t.data("start-timestamp"),e:t.data("end-timestamp"),li:lang,lng:0,lat:0,r:0,b:t.data("start-timestamp"),e:t.data("end-timestamp"),tp:17};r.ml.push(d)}if(3!=a){var f={};if(t.data("object_str")){var g=$.parseJSON(t.data("object_str"));if(Object.keys(g).length){var h=[];$.each(g,function(e,t){var i={gu:e,n:t};h.push(i)}),f.gul=h}}if(t.data("branch_str")){var g=$.parseJSON(t.data("branch_str"));if(Object.keys(g).length){var m=[];$.each(g,function(e,t){var i={bi:e,bn:t};m.push(i)}),f.bl=m}}if(t.data("favorite_str")){var g=$.parseJSON(t.data("favorite_str"));Object.keys(g).length&&(f.fl=Object.keys(g))}r.meta.tu={gul:h},Object.keys(f).length>0?r.meta.tu=f:delete r.meta.tu}if(l)return popupShowAdjust("",i,!0),!1;var v=!1,b=[];$.each(o,function(i,a){var o={tp:a},l=!0;switch(a){case 0:o.c=n,l=!1,r.ml.unshift(o);break;case 1:var d=t.data("url-content");o.c=d.url,o.t=d.title,o.d=d.description,o.i=d.img;break;case 2:var d=t.data("url-content");o.c=d.url,o.t=d.title,o.d=d.description,o.i=d.img;break;case 3:break;case 4:break;case 5:var u=t.data("stickerID");u?o.c=u:l=!1;break;case 6:l=!1;var h=/image.*/;s=!0;var p=Object.keys(t.data("upload-obj")).length,f=0;t.data("uploaded-num",0),t.data("uploaded-total",p),t.data("uploaded-err",[]),t.data("img-compose-arr",[]),s_load_show=!0,$.each(t.data("upload-obj"),function(e,t){v?b.push({file:t,mineType:h,cnt:f,total:p,type:6}):(uploadImg(t,h,f,p,6,0,c),f++)}),t.data("body",r);break;case 7:l=!1;var h=/video.mp4/;s=!0;var p=Object.keys(t.data("upload-video")).length;t.data("uploaded-vid-num",0),t.data("uploaded-vid-total",p),t.data("uploaded-vid-err",[]),t.data("video-compose-arr",[]),s_load_show=!0,$.each(t.data("upload-video"),function(i,a){var n=t.find("video[data-file-num="+i+"]");v?b.push({file:a,mineType:h,type:7,cnt:i,total:p,videoDom:n}):n.length>0&&(e(a,n,i,p,7,0),f++)}),t.data("body",r)}l&&r.ml.push(o)}),v&&(cns.debug(t.data("object_str"),t.data("branch_str")),getFilePermissionIdWithTarget(gi,t.data("object_str"),t.data("branch_str")).complete(function(i){if(200==i.status){var a=$.parseJSON(i.responseText);t.data("uploaded-num",0),t.data("uploaded-err",[]),t.data("img-compose-arr",[]);for(var n=0;n<b.length;n++){var o=b[n];switch(o.type){case 6:uploadImg(o.file,o.mineType,n,o.total,o.type,a.pi,c);break;case 7:e(o.file,o.videoDom,n,o.total,7,a.pi)}}}})),s||composeSendApi(r),cns.debug("good job",r)},composeSendApi=function(e){var t="groups/"+gi+"/timelines/"+ti_feed+"/events",i={ui:ui,at:at,li:lang},a="post",n=ajaxDo(t,i,a,!0,e);n.complete(function(e){200==e.status?($.mobile.changePage("#page-group-main"),polling(),topEventChk(),timelineSwitch($("#page-group-main").data("currentAct")||"feeds"),toastShow($.i18n.getString("COMPOSE_POST_SUCCESSED"))):setTimeout(function(){$(document).find(".cp-content").data("send-chk",!0)},2e3)})},composeCheckMessageList=function(){var e=$(document).find(".cp-content"),t=!1,i=e.data("message-list");null!=i&&($.each(i,function(e,i){return i>0?(t=!0,!1):void 0}),t||e.find(".cp-attach-area").fadeOut())},setThisGroup_bak=function(e,t){if(!t){var t;$.each($.lStorage("_groupList"),function(i,a){a.gi==e&&(t=a)})}gi=e,gu=t.me,gn=htmlFormat(t.gn),$(".sm-user-area.namecard").data("gu",gu),$(".header-group-name div:eq(1)").html(gn),$.each(t.tl,function(e,t){1==t.tp?ti_cal=t.ti:2==t.tp?ti_feed=t.ti:ti_chat=t.ti});var i={};$.lStorage(ui)&&(i=$.lStorage(ui)),"undefined"==typeof i[gi]&&(i[gi]={}),i[gi].gu=gu,i[gi].gn=gn,i[gi].ti_cal=ti_cal,i[gi].ti_feed=ti_feed,i[gi].ti_chat=ti_chat,i[gi].guAll={},$.lStorage(ui,i),$(".sm-small-area .sm-count").hide()},setSidemenuHeader=function(e){var t=e||gi,i=t.substring(t.length-1,t.length).charCodeAt()%10;$(".sm-header").css("background","url(images/common/cover/sidemeun_cover0"+i+".png)");var a=$.lStorage(ui);$(".sm-group-pic").css("background","url("+a[t].aut+")").stop().animate({opacity:1},1e3)},groupMenuListArea=function(e,t){var i=$.Deferred();return getGroupList().complete(function(a){if(200!=a.status)return $(".sm-loading").show(),setTimeout(groupMenuListArea.bind(this,e,t),1e3),!1;$(".sm-loading").hide();var n=$.parseJSON(a.responseText);if(!n)return console.debug("no group data"),!1;var o=n.cl,s=n.gl;$.lStorage("_groupList",s),getPrivateGroupFromList(o,function(){s_load_show=!1,$(".sm-group-list-area").html("");var a;groupListToLStorage();var n=$.lStorage(ui);$.each(n,function(i,n){if(0==i.indexOf("G")||0==i.indexOf(_pri_split_chat)){e&&e==n.gi&&!t&&setThisGroup(e),a=".sm-group-list-area";var o="images/common/others/empty_img_all_l.png",s="images/common/others/empty_img_all_l.png";n.aut&&(o=n.aut,s=n.auo);var r="";t&&(r="enable");var l='data-gi="'+n.gi+'" ',c=$('<div class="sm-group-area polling-cnt '+r+'" '+l+' data-polling-cnt="A5" data-gu="'+n.me+'"><img class="sm-icon-host" src="images/icon/icon_admin.png"/><div class="sm-group-area-l group-pic"><img class="aut polling-group-pic-t" src="'+o+'" '+l+'></div><div class="sm-group-area-r polling-group-name" '+l+">"+htmlFormat(n.gn)+'</div><div class="sm-count" style="display:none"></div></div>');c.find(".group-pic").data("auo",s),$(a).append(c),(e&&n.gi==e&&!t||n.gi==$.lStorage("_loginData").dgi)&&($(".sm-group-area.active").removeClass("active"),c.addClass("active")),1!=n.ad&&c.find(".sm-icon-host").hide();var d=c.find(".sm-group-area-l img:eq(0)");avatarPos(d)}}),s.length>2&&$(".sm-group-switch").show(),$(document).data("group-avatar",!0),e&&(s_load_show=!1,null==gi&&(gi=e),getGroupCombo(gi,function(){t?toastShow($.i18n.getString("GROUP_JOIN_SUCC")):(setSmUserData(gi,gu,gn),topEvent(),updateTab(gi),toastShow($.i18n.getString("FEED_GROUP_CREATED")),$.mobile.changePage("#page-group-main"),timelineSwitch("feeds",!0))})),i.resolve(n)})}),i.promise()},permissionControl=function(e){$(".fc-area-subbox[data-fc-box=announcement]").hide(),$.each(e,function(e,t){if(t.gi==gi)switch(t.ad){case 0:break;case 1:$(".fc-area-subbox[data-fc-box=announcement]").show();break;case 2:break;case 3:break;case 4:}})},idbPutTimelineEvent=function(e,t,i){var i=i||[],a=i[0]||gi,n=i[1]||ti_feed,o=$("#page-group-main").data("main-gu");o&&(a=$("#page-group-main").data("main-gi"),n=$.lStorage(ui)[a].tl[1].ti);var s=$("#page-group-main").data("navi")||"00",r="groups/"+a+"/timelines/"+n+"/events";e&&(r=r+"?ct="+e),o&&(s="00",r=r.match(/\?/)?r+"&gu="+o:r+"?gu="+o);var l={ui:ui,at:at,li:lang,tp:s},c="get",d=ajaxDo(r,l,c,!1);d.complete(function(n){var r=$(".st-feedbox-area-bottom");if(timelineUpdateTime(),t&&setTimeout(function(){$(".st-navi-area").removeClass("st-navi-fixed"),$(".st-top-area-load").removeClass("mt"),$(".st-refresh-top").slideUp("fast"),$(".st-refresh-top img").hide(),$(".st-refresh-top span").hide(),$(".st-navi-area").data("scroll-chk",!1)},1e3),200!=n.status)return groupSwitchEnable(),!1;var l=$.parseJSON(n.responseText).el;if(0==l.length)return $(".feed-subarea[data-feed="+s+"]").addClass("no-data"),groupSwitchEnable(),setTimeout(function(){r.children("img").hide(),r.children("div").show()},2e3),!1;for(var c=0;c<l.length;c++){var d=l[c].ei.split("_");d[0]=gi,l[c].ei=d.join("_")}return o?($("<div>").load("layout/timeline_event.html .st-sub-box",function(){timelineBlockMake($(this).find(".st-sub-box"),l,t,null,a),$(".st-filter-area").removeClass("st-filter-lock")}),!1):void idbRemoveTimelineEvent(l,e,i,function(){$(".st-filter-area").removeClass("st-filter-lock"),"00"==s&&$.each(l,function(e,t){t.ct=t.meta.ct,t.gi=a,t.tp=t.meta.tp;var i=1*t.meta.tp.substring(1,2);i>2&&(t.tp="03"),idb_timeline_events.put(t)}),0==i.length&&(l.length<10?($(".feed-subarea[data-feed="+s+"]").addClass("no-data"),setTimeout(function(){$(".st-feedbox-area-bottom > img").hide(),$(".st-feedbox-area-bottom > div").show()},2e3)):($(".st-feedbox-area-bottom > img").show(),$(".st-feedbox-area-bottom > div").hide()),$("<div>").load("layout/timeline_event.html .st-sub-box",function(){var e=$("#page-group-main").data("navi")||"00",i=$(".feed-subarea[data-feed="+e+"]");i.find(".st-sub-box[data-idb=true]").remove(),timelineBlockMake($(this).find(".st-sub-box"),l,t,null,a)})),setTimeout(function(){groupSwitchEnable()},500)})})},idbRemoveTimelineEvent=function(e,t,i,a){var i=i||[],n=i[0]||gi,t=t||9999999999999,o=$("#page-group-main").data("navi")||"00",s=[];for(obj in e)s.push(e[obj].ei);var r,l;if(o&&"00"!=o){r="gi_tp_ct";var c=0;e.last()&&(c=e.last().meta.ct),l=idb_timeline_events.makeKeyRange({upper:[n,o,t],lower:[n,o,c]})}else r="gi_ct",l=idb_timeline_events.makeKeyRange({upper:[n,t],lower:[n,e.last().meta.ct]});idb_timeline_events.iterate(function(e){if(e.ct!=t&&(idb_timeline_events.remove(e.ei),-1==$.inArray(e.ei,s))){var i=$(".feed-subarea").find("[data-event-id="+e.ei+"]");i.remove()}},{index:r,keyRange:l,order:"DESC",onEnd:function(e){a()},onError:function(e){console.debug("remove onError:",e)}})},timelineBlockMake=function(e,t,i,a,n){if(!a){var o=$("#page-group-main").data("navi")||"00";if($("#page-group-main").data("main-gu"))var s=$(".feed-subarea[data-feed=main]");else var s=$(".feed-subarea[data-feed="+o+"]");var r=s.find(".st-sub-box:eq(0)");t.length;$(".feed-subarea").hide(),s.show(),s.data("last-ct",t.last().meta.ct)}n&&n!=gi&&s.html("");var l=e,c=$(".timeline-detail"),d="html",u=0;$.each(t,function(t,i){if(null!=i){if(!a){d="append",c=s,setTimeout(function(){c.data("scroll-chk",!1);
},1e3);if(l=c.find("[data-event-id="+i.ei+"]"),l.length)return l.find(".st-sub-box-3 div:eq(0)").html(i.meta.lct),l.find(".st-sub-box-3 div:eq(1)").html(i.meta.pct),l.find(".st-sub-box-3 div:eq(2)").html(i.meta.rct),l.data("event-val",i),eventStatusWrite(l),eventFilter(l,$(".st-filter-area").data("filter"),i.meta),void(l.hasClass("filter-show")&&u++);l=e.clone()}var n=1*i.meta.tp.substring(1,2);a||r.length&&i.meta.ct>r.data("ct")&&(d="before",c=r),c[d](l),l.find(".st-reply-message-textarea textarea").autosize({append:"\n"}),l.attr("data-event-id",i.ei),l.data("event-val",i),l.data("timeline-tp",n),l.data("parti-list",[]),l.data("ct",i.meta.ct),l.find(".st-user-pic.namecard").data("gi",i.ei.split("_")[0]),l.find(".st-user-pic.namecard").data("gu",i.meta.gu),a&&($(".timeline-detail").fadeIn("fast"),setTimeout(function(){l.find(".st-sub-box-1").trigger("detailShow"),l.data("detail-page",!0)},100)),l.find(".st-sub-name label").data("update-id",i.meta.gu),l.find(".st-sub-box-1 .st-user-pic img").data("update-id",i.meta.gu),getUserAvatarName(i.ei.split("_")[0],i.meta.gu,l.find(".st-sub-name label"),l.find(".st-sub-box-1 .st-user-pic img")),l.find(".st-sub-time").append('<label class="text">'+new Date(i.meta.ct).toFormatString()+"</label>");var o=$.i18n.getString("MEMBER_ALL");if(l.data("object_str",JSON.stringify(i.meta.tu)),i.meta.tu){var h=[],p=[],f=[];i.meta.tu.gul&&$.each(i.meta.tu.gul,function(e,t){$.inArray(t.gu,h)<0&&(f.push(t.n),h.push(t.gu))}),i.meta.tu.bl&&$.each(i.meta.tu.bl,function(e,t){$.inArray(t.gu,p)<0&&(f.push(t.bn),p.push(t.bi))}),o=f.join("、")}l.find(".st-sub-box-1-footer").append(o.replaceOriEmojiCode()),l.find(".st-sub-box-3 div:eq(0)").html(i.meta.lct),l.find(".st-sub-box-3 div:eq(1)").html(i.meta.pct),l.find(".st-sub-box-3 div:eq(2)").html(i.meta.rct);var g,m=$.i18n.getString("FEED_POST");switch(n){case 0:l.find(".st-sub-box-2-more").hide();break;case 1:g=m=$.i18n.getString("FEED_BULLETIN");break;case 2:l.find(".st-box2-more-category").addClass("st-box2-more-category-fb"),g=m=$.i18n.getString("FEED_REPORT");break;case 3:l.find(".st-box2-more-category").addClass("st-box2-more-category-task"),g=$.i18n.getString("FEED_TASK"),m=$.i18n.getString("FEED_TASK"),l.find(".st-box2-more-task-area").show(),l.find(".st-box2-more-time").show(),l.find(".st-task-status-area").show(),l.find(".st-task-status").html($.i18n.getString("FEED_UNFINISHED"));break;case 4:l.find(".st-box2-more-category").addClass("st-box2-more-category-vote"),g=$.i18n.getString("FEED_VOTE"),m=$.i18n.getString("FEED_VOTE"),l.find(".st-box2-more-task-area").show(),l.find(".st-box2-more-time").show(),l.find(".st-task-status-area").show(),l.data("vote-result",{}),l.find(".st-task-status").html($.i18n.getString("FEED_NOT_VOTED"));break;case 5:l.find(".st-box2-more-category").addClass("st-box2-more-category-location"),g=$.i18n.getString("FEED_LOCATION"),m=$.i18n.getString("FEED_LOCATION"),l.find(".st-box2-more-task-area").hide(),l.find(".st-box2-more-time").show(),l.find(".st-task-status-area").show(),l.find(".st-task-status").html($.i18n.getString("COMMON_CONSTRUCTION"))}a&&$(".detail-title").html(m),0!=n&&(l.find(".st-box2-more-category").html(g),i.meta.tt&&l.find(".st-box2-more-title").html(i.meta.tt.replaceOriEmojiCode()));var v=".st-box2-more-desc";"0"==n&&(v=".st-sub-box-2-content"),eventStatusWrite(l),a||eventFilter(l,$(".st-filter-area").data("filter"),i.meta),l.hasClass("filter-show")&&u++;var b=null;i.meta.tu&&(b={},b.tu=i.meta.tu,b.pu=i.meta.gu),timelineContentMake(l,v,i.ml,!1,b)}}),showFeedboxNoContent(u>0)},timelineListWrite=function(e,t){if(!e&&!t){var i=$("#page-group-main").data("navi")||"00",a=$(".feed-subarea[data-feed="+i+"]");$(".feed-subarea").hide(),a.show(),a.append("<p class='load-chk'></p>")}var n=e-1||9999999999999;if(idbPutTimelineEvent(e,t),t||$("#page-group-main").data("main-gu"))return!1;var o,s;i&&"00"!=i?(o="gi_tp_ct",s=idb_timeline_events.makeKeyRange({upper:[gi,i,n],lower:[gi,i]})):(o="gi_ct",s=idb_timeline_events.makeKeyRange({upper:[gi,n],lower:[gi]})),idb_timeline_events.limit(function(e){return 0==e.length?!1:(load_show=!1,void $("<div>").load("layout/timeline_event.html .st-sub-box",function(){$(this).find(".st-sub-box").attr("data-idb",!0),timelineBlockMake($(this).find(".st-sub-box"),e)}))},{index:o,keyRange:s,limit:20,order:"DESC",onEnd:function(e){console.debug("onEnd:",e)},onError:function(e){console.debug("onError:",e)}})},eventStatusWrite=function(e,t){var i=e.data("event-val");if(null!=i){var a=e.data("event-id"),n=a.split("_")[0],o=!1,s=!1;try{var r=$.lStorage(ui)[n],l=r.guAll[r.gu];o=1==l.ad,s=i.meta.gu==r.gu}catch(c){errorReport(c)}var t=e.data("event-val").meta;if(t.il&&(e.find(".st-sub-box-3 img:eq(0)").attr("src","images/icon/icon_like1_activity.png"),e.find(".st-sub-box-4 .st-like-btn").html($.i18n.getString("FEED_UNLIKE"))),t.ip&&e.find(".st-sub-box-3 img:eq(1)").attr("src","images/icon/icon_meg_activity.png"),t.ir&&e.find(".st-sub-box-3 img:eq(2)").attr("src","images/icon/icon_view_activity.png"),t.ik){var d,u=e.data("timeline-tp");switch(u){case 3:d=$.i18n.getString("FEED_FINISHED");break;case 4:d=$.i18n.getString("FEED_ALREADY_VOTED");break;case 5:d=$.i18n.getString("FEED_REPORTED")}e.find(".st-task-status-area img").attr("src","images/common/icon/icon_check_red_l.png"),e.find(".st-task-status").html(d)}1==t.is?(e.find(".st-sub-subscribe").show(),e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='subscribe'] div").html($.i18n.getString("FEED_UNSUBSCRIBE"))):(e.find(".st-sub-subscribe").hide(),e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='subscribe'] div").html($.i18n.getString("FEED_SUBSCRIBE"))),"00"==t.tp||0==o?(e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='top']").addClass("deactive"),e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='top'] div").html($.i18n.getString("FEED_TOP"))):(e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='top']").removeClass("deactive"),1==t.top&&"00"!=t.tp?e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='top'] div").html($.i18n.getString("FEED_REMOVE_TOP")):e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='top'] div").html($.i18n.getString("FEED_TOP"))),o||s?e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='del']").removeClass("deactive"):e.find(".st-sub-box-more .st-sub-box-more-box[data-st-more='del']").addClass("deactive")}},eventFilter=function(e,t){var t=t||"all";"navi"==t&&(t="all"),e.hide();var i=(e.data("event-id"),e.data("event-val").meta);e.removeClass("filter-show");var a=!1;switch(t){case"all":a=!0;break;case"read":i.ir&&(a=!0);break;case"unread":i.ir||(a=!0);break;case"subscribe":i.is&&(a=!0)}a&&(e.addClass("filter-show"),e.show())},timelineTopRefresh=function(){$(".st-navi-area").addClass("st-navi-fixed"),$(".st-top-area-load").addClass("mt"),$(".st-refresh-top").slideDown("fast"),setTimeout(function(){$(".st-refresh-top img").show(),$(".st-refresh-top span").show()},500),timelineListWrite("",!0)},groupSwitchEnable=function(){$(".st-filter-area").removeClass("st-filter-lock"),$(".sm-group-area").addClass("enable")},mathAlignCenter=function(e,t){return(e-t)/2},timelineContentFormat=function(e,t,i){if(!e)return!1;var a=[];for(n=0;n<2;n++)0==n?a[n]=e.substring(0,t):a[n]=e,a[n]=htmlFormat(a[n]);return e.length>t&&(a[0]+="..."),a},timelineContentMake=function(e,t,i,a,n){var o=[],s=[],r=[],l=!1,c="--- ---";$.each(i,function(i,a){var n=!1;$.inArray(a.tp,not_attach_type_arr)<0&&!e.find(".st-sub-box-2-attach-area").is(":visible")&&e.find(".st-sub-box-2-attach-area").show();var d=timelineContentFormat(a.c,content_limit);switch(a.tp){case 0:if(!a.c)break;e.find(t).show(),e.find(t).html(d[0].replaceEmoji()),e.find(t+"-detail").html(d[1]);break;case 1:if(a.c&&e.find(".st-attach-url").click(function(){try{e.find(".st-sub-box-2-attach-area a")[0].click()}catch(t){errorReport(t)}}),!a.d&&!a.i&&!a.t)return!1;e.find(".st-attach-url").show(),e.find(".st-sub-box-2-attach-area").show(),a.i&&(e.find(".st-attach-url-img").show(),e.find(".st-attach-url-img img").attr("src",a.i).error(function(){$(this).attr("src","images/common/icon/icon_noPhoto.png")})),e.find(".st-attach-url-title").html(a.t),e.find(".st-attach-url-desc").html(a.d),e.find(".st-attach-url-link").attr("href",a.c);break;case 2:e.find(".st-attach-url").show();var u=e.find(".st-attach-url-img img");u.attr("src",a.i),u.css("width","100%"),u.error(function(){$(this).attr("src","images/common/icon/icon_noPhoto.png")});var h=getYoutubeCode(a.c);if(h)e.find(".st-attach-youtube").show(),e.find(".st-attach-youtube").html('<iframe width="100%" height="100%" src="//www.youtube.com/embed/'+h+'" frameborder="0" allowfullscreen></iframe>');else{var u=e.find(".st-attach-url-img");u.show(),u.attr("src",a.i),u.error(function(){$(this).attr("src","images/common/icon/icon_noPhoto.png")}),e.find(".st-attach-url").click(function(){window.open(a.c)})}e.find(".st-attach-url-title").html(a.t),e.find(".st-attach-url-desc").html(a.d);break;case 3:e.find(".st-attach-url").show(),e.find(".st-attach-url-title").hide(),e.find(".st-attach-url-desc").hide();var u=e.find(".st-attach-url-img").show().find("img");u.show(),u.attr("src",a.c),u.error(function(){$(this).attr("src","images/common/icon/icon_noPhoto.png")});e.find(".st-attach-url-img img").width(),e.find(".st-attach-url-img img").height();break;case 5:e.find(".st-attach-sticker").show(),initStickerArea.setStickerSrc(e.find(".st-attach-sticker img"),a.c);break;case 6:e.find(".st-attach-img").show(),o.push(a);break;case 7:e.find(".st-attach-video").show().addClass("attach-download"),r.push(a);break;case 8:e.find(".st-attach-audio").show(),s.push(a);break;case 9:try{e.find(".st-attach-google-map").show(),e.find(".st-attach-google-map").tinyMap({center:{x:a.lat,y:a.lng},zoomControl:0,mapTypeControl:0,scaleControl:0,scrollwheel:0,zoom:16,marker:[{addr:[a.lat,a.lng],text:a.a}]}),"G000000209m"==gi&&ccc}catch(p){cns.debug("google 失敗 換高德上",a.lat+":"+a.lng),e.find(".st-attach-google-map").hide(),e.find(".st-attach-amap-map").show();var f="amap-"+(new Date).getRandomString();e.find(".st-attach-amap-map").attr("id",f);var g=new AMap.Map(f,{rotateEnable:!1,dragEnable:!0,zoomEnable:!1,view:new AMap.View2D({center:new AMap.LngLat(a.lng,a.lat),zoom:15})}),m=new AMap.Marker({position:new AMap.LngLat(a.lng,a.lat)});m.setMap(g)}break;case 12:n=!0;break;case 14:n=!0;break;case 17:n=!0;break;case 27:if(0==l&&1==a.wm)try{var v=e.data("event-id"),b=v.split("_")[0],w=$.lStorage(ui)[b],_=w.guAll[w.gu].nk,y=w.gn;c=y+" "+_,l=!0}catch(p){errorReport(p)}}if(n){if(a.e){var x=new Date(a.e),k=x.customFormat("#M#/#D# #CD# #hhh#:#mm#"),C=new Date;a.e<C.getTime()?(e.find(".st-task-status").html($.i18n.getString("FEED_CLOSED")),e.find(".st-vote-send").html($.i18n.getString("FEED_CLOSED")),e.data("task-over",!0)):e.find(".st-vote-send").html($.i18n.getString("COMMON_SUBMIT"))}else var k=$.i18n.getString("FEED_CLOSE_TIME_NO_LIMIT");e.find(".st-box2-more-time span").html(k)}}),o.length>0&&timelineGalleryMake(e,o,l,c,n),s.length>0&&timelineAudioMake(e,s),r.length>0&&timelineVideoMake(e,r),e._i18n();var d=getGroupCompetence(gi);0==d.isAdmin&&1==d.isOfficial&&(e.find(".st-read").hide(),e.find(".namecard").removeClass("namecard"))},timelineAudioMake=function(e,t){$.each(t,function(t,i){var a=$("<audio controls></audio>");e.find(".st-attach-audio").prepend(a),getS3file(i,a,8)})},timelineVideoMake=function(e,t){$.each(t,function(t,i){var a=$('<video class="download"></video>');return e.find(".st-attach-video").prepend(a),getS3file(i,a,7),!1})},timelineGalleryMake=function(e,t,i,a,n){var o=e.find(".st-attach-img"),s=Math.min(5,Object.keys(t).length),r=e.find(".st-attach-img-area"),l=r.find("td:nth-child(1)"),c=l.next();0>=s||(1==s?l.css("width","100%"):l.css("width","50%"),5>s?(l.addClass("cnt_1"),c.addClass("cnt_"+(s-1)),$.each(t,function(e,o){var s=$('<span class="st-slide-img"/>');return 0==e?l.append(s):c.append(s),i?getS3fileBackgroundWatermark(o,s,6,a,n,function(i){t[e].s3=i.s3,t[e].s32=i.s32}):getS3fileBackground(o,s,6,n,function(i){t[e].s3=i.s3,t[e].s32=i.s32,s.addClass("loaded")}),e>=4?!1:void 0})):(l.addClass("cnt_2"),c.addClass("cnt_"+(s-2)),$.each(t,function(e,o){var s=$('<span class="st-slide-img"/>');return 2>e?l.append(s):c.append(s),i?getS3fileBackgroundWatermark(o,s,6,a,n,function(i){t[e].s3=i.s3,t[e].s32=i.s32}):getS3fileBackground(o,s,6,n,function(i){t[e].s3=i.s3,t[e].s32=i.s32,s.addClass("loaded")}),e>=4?!1:void 0})),o.attr("cnt",s),o.find(".st-attach-img-area").click(function(e){e.stopPropagation();var n=$(this),o=n.parents(".st-sub-box").data("event-id"),s=o.split("_")[0],r=o.split("_")[1];showGallery(s,r,t,null,null,i,a)}))},getS3file=function(e,t,i,a,n){var o=t.parents(".st-sub-box").data("event-id"),s=o.split("_")[0],r=o.split("_")[1];a=a||350;var l="groups/"+s+"/timelines/"+r+"/files/"+e.c+"/dl",c={ui:ui,at:at,li:lang},d="post",u=ajaxDo(l,c,d,!1,n,!1,!0);u.complete(function(e){if(200!=e.status)return!1;var a=$.parseJSON(e.responseText);if(a.api_name=l,!t||!i)return a.s3;switch(i){case 6:var n=t.find("img.aut");n.load(function(){n.removeAttr("style");n.width(),n.height()}),t.find("img.aut").attr("src",a.s3),t.find("img.auo").data("src",a.s32).hide();break;case 7:t.attr("src",a.s32).show();break;case 8:t.html('<source type="audio/mp4" yo src="'+a.s3+'">').show()}})},getS3fileBackground=function(e,t,i,a,n){var o=t.parents(".st-sub-box").data("event-id"),s=o.split("_")[0],r=o.split("_")[1],l="groups/"+s+"/timelines/"+r+"/files/"+e.c+"/dl",c={ui:ui,at:at,li:lang},d="post",u=ajaxDo(l,c,d,!1,a);u.complete(function(e){if(200!=e.status)return!1;var a=$.parseJSON(e.responseText);if(a.api_name=l,!t||!i)return a.s3;switch(i){case 6:t.attr("s3bg",a.s32),t.css("background-image","url('"+a.s32+"')"),t.data("auo",a.s32);break;case 8:t.attr("src",a.s3)}var o=new Image;$(o).error(function(){t.css("background-image",""),t.addClass("loadError")}),$(o).attr("src",a.s32),n&&n(a)})},getS3fileBackgroundWatermark=function(e,t,i,a,n,o){var s=t.parents(".st-sub-box").data("event-id"),r=s.split("_")[0],l=s.split("_")[1],c="groups/"+r+"/timelines/"+l+"/files/"+e.c+"/dl",d={ui:ui,at:at,li:lang},u="post",h=ajaxDo(c,d,u,!1,n);h.complete(function(e){if(200!=e.status)return t.addClass("loadError"),!1;var n=$.parseJSON(e.responseText);return n.api_name=c,t&&i?void(6==i&&getWatermarkImage(a,n.s32,1,function(e){t.css("background-image","url("+e+")"),t.addClass("loaded"),t.data("auo",e),n.s32=e,n.s3=e,o&&o(n)})):n.s3})},uploadErrorCnt=function(e,t,i){var a=e.data("uploaded-num");e.data("uploaded-num",a+=1),e.data("uploaded-err").push(t+1),e.data("uploaded-num")==i&&(s_load_show=!1,$(".ui-loader").hide(),clearTimeout(compose_timer),popupShowAdjust("",$.i18n.getString("COMMON_UPLOAD_FAIL")))},uploadImg=function(e,t,i,a,n,o,s){var r=$(document).find(".cp-content");if(!e.type.match(t)){var l=r.data("uploaded-num");return r.data("uploaded-num",l+=1),!1}var c=new FileReader;c.onloadend=function(){var t=new Image;t.src=c.result,t.onload=function(){var t=imgResizeByCanvas(this,0,0,1280,1280,.7),n=imgResizeByCanvas(this,0,0,480,480,.6);cns.debug("o_obj:",t),cns.debug("t_obj:",n),getS3UploadUrl(gi,ti_feed,1,o,s).complete(function(s){var l=$.parseJSON(s.responseText);if(200!=s.status)return!1;var c=l.fi,d=l.s3,u=l.s32;uploadImgToS3(u,t.blob).complete(function(s){return 200!=s.status?(uploadErrorCnt(r,i,a),!1):void uploadImgToS3(d,n.blob).complete(function(n){if(200!=n.status)return uploadErrorCnt(r,i,a),!1;var s=(this.width,this.height,{});s.w=t.w,s.h=t.h,uploadCommit(gi,c,ti_feed,o,1,e.type,t.blob.size,s).complete(function(t){var a=($.parseJSON(t.responseText),r.data("uploaded-num"));if(r.data("uploaded-num",a+=1),200!=t.status)r.data("uploaded-err").push(i+1);else{var n=[c,o,e.name];r.data("img-compose-arr")[i]=n}checkIsUploadFinished(r)})})})})}},c.readAsDataURL(e)},checkIsUploadFinished=function(e){var t=e.data("uploaded-vid-err"),i=e.data("uploaded-err");if(cns.debug(e.data("uploaded-vid-num"),e.data("uploaded-vid-total"),e.data("uploaded-num"),e.data("uploaded-total")),e.data("uploaded-vid-num")==e.data("uploaded-vid-total")&&e.data("uploaded-num")==e.data("uploaded-total"))if(s_load_show=!1,$(".ui-loader").hide(),t&&t.length>0||i&&i.length>0)popupShowAdjust("",$.i18n.getString("COMMON_UPLOAD_FAIL"),!0);else{clearTimeout(compose_timer);var a=e.data("body");e.data("video-compose-arr")&&$.each(e.data("video-compose-arr"),function(e,t){if(t){var i={};i.tp=7,i.c=t[0],i.p=t[1],a.ml.push(i)}}),e.data("img-compose-arr")&&$.each(e.data("img-compose-arr"),function(e,t){if(t){var i={};i.tp=6,i.c=t[0],i.p=t[1],a.ml.push(i)}}),composeSendApi(e.data("body"))}},putEventStatus=function(e,t,i,a){var n=e.selector,o=n.data("event-val"),s=e.act,r=e.order,l=n.data("event-id"),c=l.split("_")[0],d=l.split("_")[1],u=!1,h="groups/"+c+"/timelines/"+d+"/events/"+n.data("event-path"),p={ui:ui,at:at,li:lang,etp:t,est:i},f="put";ajaxDo(h,p,f,!1).complete(function(l){if(200==l.status){n.data("like-lock",!1);var d=($.parseJSON(l.responseText),$.lStorage(ui)[c].gu);if(e.reply){if(i){n.find(".st-reply-footer img").attr("src","images/icon/icon_like1_activity.png");var h=n.find(".st-reply-footer span:eq(1)");h.html($.i18n.getString("FEED_UNLIKE")),h.data("like",!0);var p=1*n.find(".st-reply-footer span:eq(2)").html()+1;u=!0}else{n.find(".st-reply-footer img").attr("src","images/icon/icon_like1_normal.png");var h=n.find(".st-reply-footer span:eq(1)");h.html($.i18n.getString("FEED_LIKE")),h.data("like",!1);var p=1*n.find(".st-reply-footer span:eq(2)").html()-1}n.find(".st-reply-footer span:eq(2)").html(p),0==p?(n.find(".st-reply-footer img").hide(),n.find(".st-reply-footer span:eq(2)").hide()):(n.find(".st-reply-footer img").show(),n.find(".st-reply-footer span:eq(2)").show())}else{var f=n.find(".st-sub-box-3 div:eq("+r+")"),g=n.find(".st-sub-box-3 img:eq("+r+")"),m=n.data("parti-list");if(i)g.attr("src","images/icon/icon_"+s+"_activity.png"),f.html(1*f.html()+1),u=!0,m.push(d);else{g.attr("src","images/icon/icon_"+s+"_normal.png"),f.html(1*f.html()-1);var v=$.inArray(d,m);m.splice(v,1)}n.data("parti-list",m);var b=n.data("parti-like");n.find(".st-reply-like-area").is(":visible")&&b&&(i?b.unshift({gu:d,rt:(new Date).getTime()}):$.each(b,function(e,t){return t&&t.gu==d?(b.splice(e,1),!1):void 0}))}switch(t){case 0:o.meta.ir=u;break;case 1:o.meta.il=u}n.data("event-val",o),a&&a(!0)}})},getLinkMeta=function(e,t){try{var i=5e3,a=$.Deferred();require("open-graph")(encodeURI(t),function(e,t){a.resolve(e,t)});setTimeout(function(){a.reject()},i);a.done(function(i,a){console.debug("done",a);var n={},o=$(".cp-ta-yql").html();if($(".cp-attach-area .url-loading").hide(),!a||i)return e.data("parse-waiting",!1),toastShow($.i18n.getString("COMPOSE_PARSE_ERROR")),!1;if(Array.isArray(a.title)?a.title.length>0&&(n.title=a.title[0]):n.title=a.title,Array.isArray(a.description)?a.description.length>0&&(n.description=a.description[0]):n.description=a.description,a.image&&a.image.url&&(Array.isArray(a.image.url)?a.image.url.length>0&&(n.img=a.image.url[0]):n.img=a.image.url),cns.debug(n.title,n.description,n.img),t.match(/youtube.com|youtu.be|m.youtube.com/)){e.data("message-list").push(2);var s=getYoutubeThumbnail(t);s&&(n.img=s)}else e.data("message-list").push(1);if(n.title||n.description||n.img)if(e.data("parse-resend"))e.data("parse-resend",!1),$(".cp-post").trigger("click");else{if(cns.debug("url:",n),n.title&&$(".cp-yql-title").html(n.title),n.description&&$(".cp-yql-desc").html(n.description.substring(0,200)),n.img){var r=$("<img src='"+n.img+"'/>");$(".cp-yql-img").show().append(r),r.error(function(){$(this).parent().hide(),$(this).remove(),console.debug("img preview failed.")})}$(".cp-ta-yql").fadeIn()}n.url=t,e.data("url-content",n),e.data("parse-waiting",!1),composeCheckMessageList(),$(".cp-ta-yql > img").off().click(function(){$(".cp-ta-yql").html(o).fadeOut(),e.data("url-chk",!1).data("url-content",!1);var t=e.data("message-list");for(key in t)(1==t[key]||2==t[key])&&t.splice(key,1);e.data("message-list",t),composeCheckMessageList()})}).fail(function(){console.debug("fail"),e.data("parse-waiting",!1),e.data("parse-resend",!1),$(".cp-attach-area .url-loading").hide(),composeCheckMessageList()})}catch(n){e.data("parse-waiting",!1),e.data("parse-resend",!1),$(".cp-attach-area .url-loading").hide(),composeCheckMessageList()}},getJsonFromUrl=function(e){var t={},i=e.split("?");return i&&i.length>1&&i[1]&&i[1].split("&").forEach(function(e){var i=e.split("=");cns.debug(e,i[0]),t[i[0]]=decodeURIComponent(i[1])}),t},getYoutubeThumbnail=function(e){var t=getJsonFromUrl(e);return t.hasOwnProperty("v")?"http://img.youtube.com/vi/"+t.v+"/0.jpg":null},getYoutubeCode=function(e){if(e.match(/youtube.com/))if(e.indexOf("?v=")>=0)var t=e.indexOf("?v=")+3;else{if(!(e.indexOf("&v=")>=0))return cns.debug("youtube code not find"),!1;var t=e.indexOf("&v=")+3}else if(e.match(/\/\/youtu.be/))var t=e.indexOf("youtu.be")+9;var i=e.substring(t,t+11);return i.length<11||i.match(/\&/)?!1:i},getLinkYoutube=function(e,t){s_load_show=!0,i&&clearTimeout(i);var i=setTimeout(function(){$(".cp-yql-img").html("");var i=getYoutubeCode(t);cns.debug("youtube_code",i),i?(load_show=!1,$.ajax({url:"https://gdata.youtube.com/feeds/api/videos/"+i+"?v=2&prettyprint=true&alt=jsonc",timeout:5e3,complete:function(){s_load_show=!1,$(".ui-loader").hide(),$(".ajax-screen-lock").hide(),$(".cp-attach-area .url-loading").hide(),e.data("parse-waiting",!1)},success:function(i){e.data("parse-resend")?(e.data("parse-resend",!1),$(".cp-post").trigger("click")):($(".cp-attach-area").show(),$(".cp-yql-title").html(i.data.title),$(".cp-yql-desc").html(i.data.description),$(".cp-yql-img").show().html("<img src='"+i.data.thumbnail.hqDefault+"'/>"),$(".cp-ta-yql").fadeIn());var a={c:t,t:i.data.title,d:i.data.description,i:i.data.thumbnail.hqDefault,v:""};e.data("url-content",a),e.data("message-list").push(2)},error:function(t,i,a){e.data("parse-resend",!1),composeCheckMessageList()}})):(post_tmp_url="",$(".cp-ta-yql").hide(),getLinkMeta(e,t))},1e3)},replySend=function(e){var t=e.data("event-id"),i=t.split("_")[0],a=t.split("_")[1],n=!1,o={meta:{lv:1,tp:"10"},ml:[]},s=e.data("object_str");s&&(s=$.parseJSON(s),o.meta.tu=s);var r=e.find(".st-reply-message-textarea textarea").val();r&&o.ml.push({c:r,tp:0});var l=e.find(".st-reply-message-img"),c=l.data("type");switch(c){case 5:var d=l.data("id");d&&o.ml.push({c:d,tp:5});break;case 6:n=!0;var u=e.find(".st-reply-message-img").data("file");if(u){var h=[1280,1280,.7],p=[480,480,.6];upload_chk=!0,s_load_show=!0,cns.debug("object str:",e.data("object_str"));var f="0";uploadGroupImage(i,u,a,null,h,p,f,function(n){cns.debug("yooeeooeoeoeoeoe");try{if(!n)return toastShow($.i18n.getString("COMMON_UPLOAD_FAIL")),s_load_show=!1,$(".ui-loader").hide(),void e.find(".st-reply-message-send").data("reply-chk",!1);o.ml.push({c:n.fi,p:f,tp:6}),replyApi(e,i,a,t,o)}catch(s){errorReport(s)}})}}n||replyApi(e,i,a,t,o)},replyApi=function(e,t,i,a,n){s_load_show=!1;var o="groups/"+t+"/timelines/"+i+"/events?ep="+a,s={ui:ui,at:at,li:lang},r="post",l=ajaxDo(o,s,r,!1,n);l.complete(function(t){e.find(".st-reply-message-send").data("reply-chk",!1);var i=e.find(".st-reply-message-textarea textarea");i.val("").parent().addClass("adjust").removeClass("textarea-animated"),setTimeout(function(){e.find(".st-reply-all-content-area").is(":visible")?replyReload(e):(e.find(".st-reply-message-img").is(":visible")&&e.find(".st-reply-message-img").html(""),e.find(".stickerArea").is(":visible")&&e.find(".stickerArea").hide(),e.find(".st-sub-box-2").trigger("detailShow"))},400)})},replyReload=function(e){e.find(".st-reply-message-textarea textarea").val(""),e.find(".st-reply-message-img").data("id",null),e.find(".st-reply-message-img").data("type",null),e.find(".st-reply-message-img").data("file",null),e.find(".st-reply-message-img").html("");var t=e.find(".st-reply-message-sticker");1==t.data("open")&&t.trigger("click"),eventStatusWrite(e),1==e.find(".st-reply-all-content-area").data("show")&&e.find(".st-reply-all-content-area").data("show",!1),e.find(".st-reply-like-area").show(),getEventDetail(e.data("event-id")).complete(function(t){if(200==t.status){var i=$.parseJSON(t.responseText).el;detailTimelineContentMake(e,i,!0)}})},zoomOut=function(e){e.css("zoom",zoom_out_cnt/100),zoom_out_cnt<100&&(zoom_out_cnt+=4,setTimeout(function(){zoomOut(e)},1))},zoomIn=function(e){e.css("zoom",zoom_in_cnt/100),zoom_in_cnt>10?(zoom_in_cnt-=5,setTimeout(function(){zoomIn(e)},1)):e.hide()},getGroupList=function(){var e="groups",t={ui:ui,at:at,li:lang},i="get";return ajaxDo(e,t,i,!1)},getPrivateGroupList=function(e,t){var i="groups",a={ui:e.ui,at:e.at,li:lang},n="get";ajaxDo(i,a,n,!0,!1,!1,!0,e.cl).complete(function(i){if(200==i.status){var a=$.parseJSON(i.responseText),n=$.lStorage("_pri_group")||{};n[e.ci]=e,n[e.ci].tmp_groups=a.gl,$.lStorage("_pri_group",n)}t&&t()})},getPrivateGroupFromList=function(e,t){e&&0!=e.length||t&&t();for(var i=0,a=0;a<e.length;a++){var n=e[a];getPrivateGroupList(n,function(a){i++,t&&i==e.length&&t()})}},polling=function(){$.lStorage("_pollingData")||$.lStorage("_pollingData",{cnts:{},ts:{pt:(new Date).getTime()}});var e=$.lStorage("_pollingData"),t=e.ts.pt,i="sys/polling?pt="+t,a={ui:ui,at:at,li:lang},n="get";ajaxDo(i,a,n,!1,!1,!1,!0).complete(function(t){if(200!=t.status)return 401==t.status?(localStorage.removeItem("_loginData"),popupShowAdjust("",$.i18n.getString("LOGIN_AUTO_LOGIN_FAIL"),!0,!1,[reLogin]),clearInterval(pc),!1):(cns.debug("polling err:",t),!1);var i=$.parseJSON(t.responseText),a=i.cnts||[];i.cnts=e.cnts||[],$.each(a,function(t,a){var n=$.extend(e.cnts[a.gi],a);i.cnts[a.gi]=n}),i.gcnts=$.extend(e.gcnts||{},i.gcnts||{}),$.lStorage("_tmpPollingData")||$.lStorage("_tmpPollingData",i),pollingCountsWrite(i),pollingCmds(i.cmds,i.msgs,i.ccs)})},pollingCountsWrite=function(e){var e=e||$.lStorage("_pollingData"),t=e.cnts,a=e.gcnts,n=[];if(t)for($.each(t,function(e,t){if(gi==t.gi)for(var i=["A1","A2","A3","A4"],e=0;e<i.length;e++){var a=i[e];if(t.hasOwnProperty(a)){var o=$(".polling-cnt[data-polling-cnt="+a+"] .sm-count");t[a]>0?(o.html(countsFormat(t[a])).show(),o.data("gi",gi)):o.hide()}}if(t.cl&&t.cl.length>0){var s=$.lStorage(ui);if(s.hasOwnProperty(t.gi)){g_group=s[t.gi];for(var r=!1,e=0;e<t.cl.length;e++)try{var l=t.cl[e];if(g_group.chatAll)if(g_group.chatAll.hasOwnProperty(l.ci)){if(g_room=g_group.chatAll[l.ci],g_room.unreadCnt!=l.B7&&(r=!0,g_room.unreadCnt=l.B7,gi==t.gi)){var o=$(".sm-cl-count[data-ci="+l.ci+"]");l.B7>0?o.html(countsFormat(l.B7)).show():o.hide()}}else if(l.B7>0&&t.gi==gi){cns.debug("[pollingCountsWrite] remove ghost cnt",t.gi,l.ci,l.B7);var c=$('<div class="sm-cl-count" data-gi="'+t.gi+'" data-ci="'+l.ci+'"></div>');updatePollingCnts(c,"B7")}}catch(d){errorReport(d)}r&&$.lStorage(ui,s)}}if(null!=t.A5){var u=$(".sm-group-area[data-gi="+t.gi+"]").find(".sm-count");t.A5>0?gi==t.gi?(u.hide(),updatePollingCnts(u,"A5")):(n.push([t.gi,t.A5]),u.html(countsFormat(t.A5)),u.show()):u.hide()}}),n.sort(function(e,t){return e[1]-t[1]}),i=0;i<n.length;i++){var o=$(".sm-group-list-area .sm-group-area[data-gi="+n[i][0]+"]"),s=o.clone();$(".sm-group-list-area").prepend(s),o.remove()}return a?(a.G1>0&&$(".hg-invite .sm-count").html(a.G1).show(),a.G2>0,void(a.G3>0&&"undefined"!=typeof showNewAlertIcon&&showNewAlertIcon(a.G3))):!1},pollingCmds=function(e,t,i){var a=[],n=[],o=!1;if(null==gi&&(gi=$(".sm-group-area.active").data("gi")),e&&e.length>0){var s=$.lStorage("_pollingData"),r=9999999999999;s&&(r=s.ts.pt);var l=!0;r+3e5>=login_time||(l=!1,cns.debug("(notification muted, login_time-currentPollingCt=",login_time-r," )")),$.each(e,function(e,t){switch(t.tp){case 1:t.pm.gi==gi&&"#page-group-main"==window.location.hash&&(polling_arr=!1,idbPutTimelineEvent("",!1,polling_arr));break;case 3:$("#page-group-menu").is(":visible")&&0==$("#page-group-main").is(":visible")&&$(".hg-invite").trigger("click");try{l&&riseNotification(null,g_Qmi_title,$.i18n.getString("GROUP_RECEIVE_INVITATION"),function(){$(".hg-invite").trigger("click")})}catch(i){cns.debug(i.message)}break;case 4:t.pm.isNewMem=!0,cns.debug(gi,t.pm.gi),t.pm.onGetMemData=function(e,t){try{if(l){var i=t.gn||g_Qmi_title;riseNotification(null,i,$.i18n.getString("GROUP_X_JOIN_GROUP",t.nk),function(){gi==e?$(".sm-small-area[data-sm-act=memberslist]").trigger("click"):$(".sm-group-area[data-gi="+e+"]").trigger("click")})}}catch(a){errorReport(a)}},a.push(t.pm),gi==t.pm.gi&&(o=!0);break;case 5:a.push(t.pm),gi==t.pm.gi&&(o=!0);break;case 6:t.pm.onGetMemData=function(e,t){try{if(l){var i=t.gn||g_Qmi_title;riseNotification(null,i,$.i18n.getString("GROUP_X_LEAVE_GROUP",t.nk),function(){gi==e?$(".sm-small-area[data-sm-act=memberslist]").trigger("click"):$(".sm-group-area[data-gi="+e+"]").trigger("click")})}}catch(a){errorReport(a)}};var s=$.lStorage(ui);s.hasOwnProperty(t.pm.gi)&&s[t.pm.gi]&&a.push(t.pm);break;case 7:n.push(t.pm);break;case 10:$.lStorage(ui).hasOwnProperty(t.pm.gi)&&setGroupAllUser(null,t.pm.gi,function(e){if(gi==e){var t=$(".sm-small-area:visible");t.length>0&&$(t[0]).trigger("click")}});break;case 11:0==$.lStorage(ui).hasOwnProperty(t.pm.gi)&&(cns.debug("polling~ create grouop"),groupMenuListArea(t.pm.gi,!1));break;case 12:removeGroup(t.pm.gi)}});try{a.length>1?getMultipleUserInfo(a,!0,!1,function(e){pollingUpdate(t,i),o&&updateBranchMemberCnt(gi)}):a.length>0?getUserInfo(a,!0,!1,function(e){pollingUpdate(t,i),o&&updateBranchMemberCnt(gi)}):pollingUpdate(t,i)}catch(c){pollingUpdate(t,i),errorReport(c)}try{if(n.length>0){var d=0;for(var u in n){var h=n[u].gi;null!=h&&updateBranchList(h,function(e){d++,d>=n.length&&gi==e&&updateContactBranchList()})}}}catch(c){errorReport(c)}}else pollingUpdate(t,i)},pollingUpdate=function(e,t){$.lStorage("_pollingData",$.lStorage("_tmpPollingData")),localStorage.removeItem("_tmpPollingData"),e&&e.length>0&&onReceivePollingChatMsg(e),t&&t.length>0&&onReceivePollingChatCnt(t)},countsFormat=function(e){return e>99?"99+":e},updatePollingCnts=function(e,t){var i="sys/counts",a=e.data("gi")||gi,n={cnts:[],gcnts:{}};if("G"==t.substring(0,1))n.gcnts[t]=0;else if(n.cnts[0]={gi:a},e.hasClass("sm-cl-count")){null==n.cnts[0].cl&&(n.cnts[0].cl=[]);var o={},s=e.data("ci");if(null==s)return;o[t]=0,o.ci=s,n.cnts[0].cl.push(o)}else n.cnts[0][t]=0;var r={ui:ui,at:at,li:lang},l="put";ajaxDo(i,r,l,!1,n).complete(function(e){200==e.status})},pollingInterval=function(e){$(document).data("polling-chk")?($(document).data("polling-chk",!1),e&&toastShow("關閉polling"),clearInterval(pc)):(pc=setInterval(polling,polling_interval),$(document).data("polling-chk",!0),e&&toastShow("開啓polling"))},getUserInfo=function(e,t,i,a){var i=i||!1,a=a||!1;if(e.length>0){var n=e.last(),o=$.lStorage(ui);if(!o.hasOwnProperty(n.gi))return cns.debug("[getUserInfo] no group data, getting..",n.gi),void getGroupCombo(n.gi,function(){getUserInfo(e,t,i,a)});null==n.isNewMem&&(n.isNewMem=!1);var s="groups/"+n.gi+"/users/"+n.gu;cns.debug("mom im here",s);var r={ui:ui,at:at,li:"zh_TW"},l="get";ajaxDo(s,r,l,i,!1,!1,!0).complete(function(o){if(cns.debug("user info result",o),200==o.status){var s=$.parseJSON(o.responseText);if(n.isNewMem){var r=$.lStorage("_newMemList");r||(r={}),0==r.hasOwnProperty(n.gi)&&(r[n.gi]={}),r[n.gi][n.gu]=(new Date).getTime()+2592e5,$.lStorage("_newMemList",r)}var l=$.lStorage(ui);try{if(l[n.gi].guAll&&Object.keys(l[n.gi].guAll).length>0){cns.debug("guall content exist");var c=l[n.gi].guAll[n.gu];l[n.gi].guAll[n.gu]=$.extend(c,s),$.lStorage(ui,l),t&&updateAllAvatarName(n.gi,n.gu)}else{cns.debug("[!!!] getUserInfo: no guAll");var d=["userInfo",s];setGroupAllUser(d,n.gi)}if(n.isNewMem){var u=l[n.gi].inviteGuAll;u&&$.each(u,function(e,t){return e==n.gu?(delete u[n.gu],$.lStorage(ui,l),"function"==typeof updateInvitePending&&updateInvitePending(),!1):void 0})}s.gn=l[n.gi].gn||"",n.onGetMemData&&n.onGetMemData(n.gi,s),e.pop(),0==e.length?a&&a(s):getUserInfo(e,t,i,a)}catch(h){errorReport(h)}}else a&&a(!1)})}},getMultipleUserInfo=function(e,t,i,a){
(null==e||0==e.length)&&cns.debug("[getMultipleUserInfo] null user array");for(var n={},o=[],s=$.lStorage(ui),r=0;r<e.length;r++){var l=e[r];n[l.gu]=l,s.hasOwnProperty(l.gi)&&o.push({gu:l.gu,gi:l.gi})}cns.debug("[getMultipleUserInfo] length:",e.length);var i=i||!1,a=a||!1,c="sys/group_users",d={ui:ui,at:at,li:lang},u="post",h={gul:o};ajaxDo(c,d,u,i,h,!1,!0).complete(function(e){if(200==e.status)try{var i=$.parseJSON(e.responseText);s=$.lStorage(ui);var o=(new Date).getTime()+2592e5;$.each(i.gul,function(e,i){if(0==n.hasOwnProperty(i.gu))return void cns.debug("[getMultipleUserInfo] get ?? gu",i.gu);var a=n[i.gu];if(null==a)return void cns.debug("[getMultipleUserInfo] null this_user_info",i.gu);if(a.isNewMem){var r=$.lStorage("_newMemList");r||(r={}),0==r.hasOwnProperty(a.gi)&&(r[a.gi]={}),r[a.gi][a.gu]=o,$.lStorage("_newMemList",r)}if(s[a.gi].guAll&&Object.keys(s[a.gi].guAll).length>0){cns.debug("guall content exist");var l=s[a.gi].guAll[a.gu];s[a.gi].guAll[a.gu]=$.extend(l,i),t&&updateAllAvatarName(a.gi,a.gu)}else{cns.debug("[!!!] getUserInfo: no guAll");var c=["userInfo",i];s[a.gi].guAll[a.gu]=i,setGroupAllUser(c,a.gi)}i.gn=s[a.gi].gn||"",a.onGetMemData&&a.onGetMemData(a.gi,i)}),$.lStorage(ui,s),a(!0)}catch(r){errorReport(r)}else a&&a(!1)})},updateAllAvatarName=function(e,t,i,a){$(".update-avatar-all").filter(function(){$(this).data("update-id")==t&&getUserAvatarName(e,t,$(this).parents(".update-parent-all").find(".update-name-all"),$(this))})},userInfoShow=function(e,t){if(!t)return!1;var e=e||gi;$(".screen-lock").show(),$(".user-info-load-area").fadeIn("fast"),$(".user-info-load-area .user").load("layout/layout.html .user-info-load",function(){var i=$(this).find(".user-info-load");if(i._i18n(),i.find(".user-avatar-bar").hide(),t==gu)$(".user-info-load-area .me").addClass("me-rotate"),$(".user-info-load-area .me").addClass("backface-visibility"),i.find(".action-chat").hide(),$(".user-avatar-bar-favorite").hide();else{$(".user-info-load-area .me").removeClass("me-rotate"),$(".user-info-load-area .me").removeClass("backface-visibility"),i.find(".action-edit").hide(),i.find(".action-chat").off("click").click(function(){requestNewChatRoomApi(e,"",[{gu:t}],function(e){})}),$(".user-avatar-bar-favorite").show();var a=$.lStorage(ui);a.hasOwnProperty(e)&&1==a[e].ad&&i.find(".user-info-delete").show()}getUserInfo([{gi:e,gu:t,isNewMem:!1}],!1,!1,function(a){if(a){$("body").addClass("user-info-adjust"),i.find(".user-avatar-bar").show(),i.data("this-info-gu",t),i.data("this-info-gi",e),a.aut&&(i.find(".user-avatar .user-pic").attr("src",a.auo),i.find(".user-avatar").data("auo",a.auo),userInfoAvatarPos($(".user-avatar .user-pic")));var n=$.lStorage(ui),o=n[e].guAll[t];1==o.fav?$(".user-avatar-bar-favorite .active").show():0==o.fav&&$(".user-avatar-bar-favorite .deactive").show();var s=t==n[e].gu;s&&meInfoShow(a),userInfoDataShow(e,i,a,1==n[e].ad),userInfoEvent(i)}else i.data("avatar-chk",!1),$(".screen-lock").fadeOut("fast"),i.fadeOut("fast")})})},userInfoDataShow=function(e,t,i,a,n){cns.debug("user_data",i),t.data("gu",i.gu),2==i.st?(t.find(".user-info-list-area").hide(),t.find(".user-info-leave-area").show()):(t.find(".user-info-list-area").show(),t.find(".user-info-leave-area").hide());var e=e||gi,o="html";n&&(o="val");var s,r=["nk","sl","bd","bl","ti"],l=["em","pn","pn1","ext","mv"];for(item in i)if(i[item].length>0){if("bd"==item&&n&&(i[item]=i[item].substring(0,4)+"/"+i[item].substring(4,6)+"/"+i[item].substring(6)),s=$.inArray(item,r)>=0?t.find(".user-avatar-bar"):t.find(".user-info-list"),n||"bd"!=item||(i.bd=i.bd.substring(4,6)+"."+i.bd.substring(6,8),o="append"),"bl"==item)try{var c=i.bl.split(",")[0].split("."),d="",u=$.lStorage(ui)[e].bl,h=s.find(".bl");h.show(),h=h[0];for(var p=!1,f=c.length-1;f>=0;f--){var g=c[f];if(d=u[g].bn+"-"+d,h.innerHTML=d,h.offsetHeight>42){for(d=d.substring(0,d.length-1)+"......",h.innerHTML=d;h.offsetHeight>40;)d=d.substring(1,d.length),h.innerHTML=d;d="..."+d.substring(0,d.length-6),p=!0;break}}0==p&&d.length>0?i.bl=d.substring(0,d.length-1):i.bl=d}catch(m){errorReport(m);continue}if(s.find("."+item)[o](i[item]).show(),!n&&$.inArray(item,l)>=0){var v=s.find("img."+item);v.attr("src","images/icon/bt_"+v.data("name")+"_normal.png")}}var b=t.find(".user-avatar-bar .nk").html();b&&b.length>0&&t.find(".user-avatar-bar .nk").html(b.replaceOriEmojiCode()),a?t.find(".user-avatar-bar .user-name").addClass("hidden"):(i.mkp&&t.find(".user-info-list .pn").html("******"),i.mke&&t.find(".user-info-list .em").html("******"),i.mkb?(t.find(".user-avatar-bar .bd").hide(),t.find(".user-info-list .bd").html("******")):t.find(".user-avatar-bar .user-name").addClass("hidden")),2==i.st&&t.find(".action, .sl, .bd, .bl").hide()},meInfoShow=function(e){gu;$(".screen-lock").show(),$(".user-info-load-area").fadeIn("fast"),$(".user-info-load-area").addClass("transition1s"),$(".user-info-load-area .me").load("layout/layout.html .me-info-load",function(){var t=$(this).find(".me-info-load");t._i18n(),t.find(".group-avatar img").attr("src",$.lStorage(ui)[gi].aut),avatarPos(t.find(".group-avatar img"),60),t.find(".group-name").html($.lStorage(ui)[gi].gn),e.aut&&(t.find(".user-avatar.me > img").attr("src",e.auo),t.find(".user-avatar").data("auo",e.auo),userInfoAvatarPos(t.find(".user-avatar.me > img")));for(item in e)e[item]&&t.find(".user-info-list ."+item).val(e[item]);var i={mkp:"pn1",mke:"em",mkb:"bd"};$.each(i,function(i,a){var n=t.find(".user-info-list ."+a),o=t.find(".me-info-status."+a+" .status-text");n.data("ori",n.val()),e[i]?(n.val("******"),o.text($.i18n.getString("COMMON_PRIVATE")).data("val",!0)):o.text($.i18n.getString("COMMON_PUBLIC")).data("val",!1)}),userInfoEvent(t,!0)})},userInfoEvent=function(e,t){e.unbind(),e.find(".user-avatar").click(function(){var e=$(this).find(".user-pic").attr("src");if(!e)return!1;var t=new Image;t.onload=function(){var e=this_height=500,t="width",i="before1";this.width<this.height&&(t="height",i="before2"),this.width>500&&(e=this.width),this.height>500&&(this_height=this.height);var a=window.open("layout/img_show.html","","width="+e+", height="+this_height),n=this.src;$(a.document).ready(function(){setTimeout(function(){var e=$(a.document).find("img.gallery");e.css(t,"100%"),e.parent().addClass(i),e.attr("src",n)},300)})},t.src=e}),e.find(".user-avatar-bar:not(.me)").click(function(e){e.stopPropagation()}),t?(e.find(".user-avatar.me").click(function(){e.find(".user-avatar-upload").trigger("click")}),e.find(".user-avatar-upload").change(function(){var t=/image.*/,i=$(this)[0].files[0];if(i)if(i.type.match(t)){var a=new FileReader;a.onload=function(t){$(".user-avatar.me > img").remove();var i=$("<img style='opacity:1' src=\"images/common/others/empty_img_personal_xl.png\"/>");$(".user-avatar.me").prepend(i);var n=$(".user-avatar.me > img");userInfoAvatarPos(n),n.attr("src",a.result);var o=[1280,1280,.7],s=[120,120,.6],r=e.find(".user-avatar-upload")[0].files[0],l="groups/"+gi+"/users/"+gu+"/avatar";uploadToS3(r,l,o,s,function(t){s_load_show=!1,t?getGroupCombo(gi,function(){e.find(".user-info-close").trigger("mouseup"),toastShow($.i18n.getString("USER_PROFILE_UPDATE_SUCC")),updateAllAvatarName(gi,gu)}):($(".ui-loader").hide(),$(".ajax-screen-lock").hide(),e.find(".user-info-close").trigger("mouseup"))})},a.readAsDataURL(i)}else{var n=$(this);n.replaceWith(n=n.clone(!0)),popupShowAdjust("",$.i18n.getString("COMMON_NOT_IMAGE"))}}),e.find(".me-info-status").click(function(){$(this).parent().siblings(".me-info-status-switch").toggle()}),e.find(".me-info-status-switch div").click(function(){var t="private"==$(this).data("type"),i=$(this).parent(),a=i.data("type"),n=e.find(".user-info-list ."+a),o=e.find(".me-info-status."+a+" .status-text"),s=o.data("val");cns.debug(t,s,a),s!=t&&(t?(n.val("******"),o.text($.i18n.getString("COMMON_PRIVATE")).data("val",!0)):(n.val(n.data("ori")),o.text($.i18n.getString("COMMON_PUBLIC")).data("val",!1)),e.find(".user-info-submit").addClass("user-info-submit-ready")),i.hide()}),e.find(".user-info-list input").bind("input",function(){e.find(".user-info-submit").addClass("user-info-submit-ready")}),$(document).off("click",".user-info-submit-ready"),$(document).on("click",".user-info-submit-ready",function(){userInfoSend(e)})):(e.find(".action-edit").click(function(){$(".user-info-load-area").addClass("user-info-flip"),$(".user-info-load , .me-info-load").stop().animate({opacity:0},400),setTimeout(function(){$(".user-info-load-area .me").removeClass("backface-visibility"),$(document).find(".user-info-load-area .user").hide(),$(".user-info-load , .me-info-load").stop().animate({opacity:1},400)},400),setTimeout(function(){$(".user-info-load-area").removeClass("transition1s"),$(".user-info-load-area").removeClass("user-info-flip"),$(".user-info-load-area .me").addClass("adjust")},1e3)}),e.find(".user-info-delete").click(function(){popupShowAdjust($.i18n.getString("USER_PROFILE_DELETE_MEMBER_CONFIRM"),$.i18n.getString("USER_PROFILE_DELETE_MEMBER_DESC"),$.i18n.getString("COMMON_OK"),$.i18n.getString("COMMON_CANCEL"),[function(){userInfoDelete(e)},null])})),e.find(".user-avatar-bar-favorite .fav").mouseup(function(){clickUserInfoFavorite($(this))}),e.find(".action-main").off("click").click(function(){$.mobile.changePage("#page-group-main"),timelineSwitch("feeds",!1,!0),timelineScrollTop();var t=e.data("this-info-gu"),i=e.data("this-info-gi");e.find(".user-info-close").trigger("mouseup"),$(".gm-user-main-area").fadeIn("fast",function(){var e=$.lStorage(ui)[i];$(".gm-user-main-area .background").css("background","url("+e.guAll[t].auo+")"),$(".gm-user-main-area .name").html(e.guAll[t].nk),$(".gm-user-main-area .group .pic").css("background","url("+e.aut+")"),$(".gm-user-main-area .group .name").html(e.gn)}),$(".alert-area").is(":visible")&&($(".alert").removeClass("alert-visit"),$(".alert-area-cover").hide(),$(".alert").removeClass("alert-click"),$(".alert-area").hide()),$(".user-main-toggle:not(.gm-header)").hide(),$(".gm-user-main-area").show(),$(".st-feedbox-area").hide(),$(".sm-small-area.active").removeClass("active"),setTimeout(function(){timelineScrollTop(),$(".st-feedbox-area div[data-feed=main]").html(""),$(".st-feedbox-area").show(),$(".feed-subarea").hide(),$("#page-group-main").data("main-gu",t),$("#page-group-main").data("main-gi",i),$("#page-group-main").data("navi","main"),$(".st-filter-area").data("filter","all"),timelineListWrite()},200)})},userInfoSend=function(e){var t=e.find(".user-info-list .nk").val().trim().replace(/( +)/g," ").replace(/[&\|\\\\:\/!*^%$#@\-]/g,"");if(""==t)return toastShow($.i18n.getString("USER_PROFILE_EMPTY_NAME")),!1;s_load_show=!0;var i="groups/"+gi+"/users/"+gu,a={ui:ui,at:at,li:lang},n={nk:t,sl:e.find(".user-info-list .sl").val(),mke:e.find(".me-info-status.em .status-text").data("val"),mkp:e.find(".me-info-status.pn1 .status-text").data("val"),mkb:e.find(".me-info-status.bd .status-text").data("val"),pn2:$.lStorage(ui)[gi].guAll[gu].pn2,ext:e.find(".user-info-list .et").val(),ti:e.find(".user-info-list .ti").val(),mv:e.find(".user-info-list .mv").val(),em:e.find(".user-info-list .em").val()},o="put";ajaxDo(i,a,o,!1,n).complete(function(t){if(s_load_show=!1,200==t.status){var i=$.lStorage(ui);i[gi].guAll[gu].nk=n.nk,i[gi].guAll[gu].sl=n.sl,$.lStorage(ui,i),s_load_show=!1,$(".ui-loader").hide(),$(".ajax-screen-lock").hide(),getGroupCombo(gi,function(){updateAllAvatarName(gi,gu),toastShow($.i18n.getString("USER_PROFILE_UPDATE_SUCC"))}),e.find(".user-info-close").trigger("mouseup")}})},userInfoDelete=function(e){var t=e.data("gu");if(!t)return cns.debug("userInfoDelete no gu"),!1;var i="groups/"+gi+"/users/"+t+"/status",a={ui:ui,at:at,li:lang},n="put",o={st:2};ajaxDo(i,a,n,!0,o).complete(function(i){if(s_load_show=!1,$(".ui-loader").hide(),$(".ajax-screen-lock").hide(),200==i.status){var a=$.lStorage(ui);a[gi].guAll[t].st=2,$.lStorage(ui,a),$(".subpage-contact").length>0&&(initContactData(),initContactList()),e.find(".user-info-close").trigger("mouseup")}else toastShow($.i18n.getString("COMMON_CHECK_NETWORK"))})},userInfoAvatarPos=function(e){var t=1.6,i=$(".user-info-load-area .width-chk").width()||400;e.load(function(){this.width/this.height>t?(e.css("height",250),e.css("margin-left",(e.width()-i)/2*-1),e.css("opacity",0)):(e.css("width",i),e.css("margin-top",(e.height()-250)/2*-1),e.css("opacity",0)),e.stop().animate({opacity:1},300)})},clickUserInfoFavorite=function(e){var t=e.parents(".user-info-load"),i=t.data("this-info-gu"),a=t.data("this-info-gi");if(null!=i&&null!=a){var n,o;e.hasClass("active")?(n=updateUserFavoriteStatusApi(a,null,[i]),o=!1):(n=updateUserFavoriteStatusApi(a,[i],null),o=!0),n.complete(function(t){if(200==t.status){var n=$.lStorage(ui);n.hasOwnProperty(a)&&n[a].guAll&&n[a].guAll.hasOwnProperty(i)&&(n[a].guAll[i].fav=o,o?(e.parent().find(".active").show(),e.parent().find(".deactive").hide()):(n[a].favCnt<0&&(n[a].favCnt=0),e.parent().find(".active").hide(),e.parent().find(".deactive").show()),$.lStorage(ui,n),updateFavoriteMember(a))}})}},updateFavoriteMember=function(e){try{var t=$.lStorage(ui),i=t[e].guAll,a=0;$.each(i,function(e,t){null!=t&&1==t.st&&1==t.fav&&a++}),t[e].favCnt=a,$.lStorage(ui,t),e==gi&&updateContactFavorite()}catch(n){errorReport(n)}},updateBranchMemberCnt=function(e){try{var t=$.lStorage(ui),i=t[e].guAll,a=t[e].bl;for(var n in a){var o=0;for(var s in i){var r=i[s];r&&1==r.st&&r.bl.indexOf(n)>=0&&o++}a[n].cnt=o}t[e].bl=a,$.lStorage(ui,t),e==gi&&$(".subpage-contact").length>0&&initContactList()}catch(l){errorReport(l)}},updateUserFavoriteStatusApi=function(e,t,i){var a="groups/"+e+"/favorite_users",n={ui:ui,at:at,li:lang},o={};null!=t&&(o.al=t),null!=i&&(o.dl=i);var s="put";return ajaxDo(a,n,s,!0,o)},updateAddressbookFavoriteStatusApi=function(e,t,i){var a="groups/"+e+"/contacts/favorites",n={ui:ui,at:at,li:lang},o={};null!=t&&(o.al=t),null!=i&&(o.dl=i);var s="put";return ajaxDo(a,n,s,!0,o)},eventDetailShow=function(e){e.split("_")[0];$("<div>").load("layout/timeline_event.html .st-sub-box",function(){var t=$(this).find(".st-sub-box");t.addClass("detail"),$(".timeline-detail").html(t).hide(),getEventDetail(e).complete(function(e){if(200==e.status){var i=$.parseJSON(e.responseText);try{1==i.el[0].meta.del?setTimeout(function(){popupShowAdjust($.i18n.getString("FEED_EVENT_DELETED"),"",$.i18n.getString("COMMON_OK"),"",[function(){$("#page-timeline-detail .page-back").trigger("click")},null])},100):timelineBlockMake(t,[i.el[0]],!1,!0)}catch(a){errorReport(a)}}})})},timelineMainClose=function(){$("#page-group-main").data("main-gu",!1),$(".user-main-toggle").show(),$(".gm-user-main-area").hide(),$(".st-feedbox-area div[data-feed=main]").html("")},timelineScrollTop=function(){$(".gm-content").scrollTop(0),$(".st-filter-area").removeClass("fixed")},timelineEditStatus=function(e,t,i){var a=e.data("event-val"),n=e.data("event-id"),o=n.split("_")[0],s=n.split("_")[1];try{var r=0,l="";switch(t){case 3:l="is";break;case 8:l="top"}l.length>0&&(1==a.meta[l]?(r=0,a.meta[l]=!1):(r=1,a.meta[l]=!0)),timelineEditStatusApi(o,s,n,"put",t,r,function(n){200==n.status&&i&&(e.data("event-val",a),eventStatusWrite(e),8==t&&topEvent(),i(n))})}catch(c){errorReport(c)}},timelineEditStatusApi=function(e,t,i,a,n,o,s){var r="groups/"+e+"/timelines/"+t+"/events/"+i,l={ui:ui,at:at,li:lang,etp:n,est:o},c=ajaxDo(r,l,a,!1);c.complete(function(e){s&&s(e)})},timelineDeleteEvent=function(e,t){var i=e.data("event-id"),a=i.split("_")[0],n=i.split("_")[1];try{var o="groups/"+a+"/timelines/"+n+"/events/"+i,s={ui:ui,at:at,li:lang},r=ajaxDo(o,s,"delete",!1);r.complete(function(a){if(200==a.status&&t){var n=e.parents("#page-timeline-detail");n.length>0?(n.find(".page-back").trigger("click"),$("#page-group-main .st-feedbox-area .st-sub-box[data-event-id='"+i+"']").remove()):e.remove(),idb_timeline_events.remove(i),topEvent(),t(a)}})}catch(l){errorReport(l)}},timelineUpdateTime=function(){var e=$("#page-group-main");$.each(e.find(".st-sub-box:visible"),function(e,t){var i=$(t),a=i.data("ct");i.find(".st-sub-time .text").html('<label class="text">'+new Date(a).toFormatString()+"</label>");var n=i.find(".st-reply-all-content-area:visible").find(".st-reply-footer-time");$.each(n,function(e,t){var i=$(t);a=i.data("ct"),i.html(new Date(a).toFormatString())})})},timelineUpdateAvatar=function(e){},clearCreateGroupPage=function(){var e=$("#page-group-menu .gm-create-area");e.find(".gmc-avatar").data("chk",!1),e.find(".gmc-avatar-wrap img").attr("src","images/icon/icon_build_photo.png"),e.find(".gmc-name input").val(""),e.find(".gmc-desc textarea").val("");var t=e.find(".gmc-file");t.replaceWith(t.clone(!0))},showFeedboxNoContent=function(e){e?$(".st-feebox-area-no-content").hide():($(".st-feebox-area-no-content").show().removeClass("disabled"),$(".gm-content > div:eq(1)").getNiceScroll(0).doScrollTop(0,500))},$.userStorage=function(e){return e?void(window.g_uiData=e):window.g_uiData}}),$(function(){function e(e){var t=$(".gm-content");if(t.is(":visible")){var i=$(".st-filter-area");!n&&t.scrollTop()>=163?(i.addClass("fixed"),n=!0):n&&t.scrollTop()<=163&&(i.removeClass("fixed"),n=!1)}}updateLanguage(lang);if(!$.lStorage("_loginData"))return document.location="index.html",!1;var t=$.lStorage("_loginData");ui=t.ui,at=t.at;var i=$.Deferred();$.lStorage("refreshChk")===!0?getGroupCombo(t.dgi,function(){i.resolve()}):i.resolve(),i.done(function(){$.lStorage("refreshChk",!0),$.lStorage("_loginAutoChk")||(delete t.at,$.lStorage("_loginData",t)),initChatDB(),initChatCntDB(),$.lStorage("_groupList")&&t.dgi&&""!=t.dgi?setGroupInitial(t.dgi):($("#page-group-menu .page-back").hide(),cns.debug("no group ")),pollingInterval()}),$(".currentGroup").click(function(){}),$(".page-group-name").click(function(){$(".cp-post").trigger("click")}),$(".subpage-timeline_no ").bind("mousewheel DOMMouseScroll",function(e){var t=$(this);if(!($(".feed-subarea:visible").length<=0||t.data("scroll-cnt")<0||$(".st-top-area-load").position().top<40)&&(e.originalEvent.wheelDelta>0||e.originalEvent.detail<0)){t.data("scroll-timer")&&clearTimeout(t.data("scroll-timer"));var i=setTimeout(function(){t.data("scroll-cnt",0)},500);t.data("scroll-timer",i);var a=t.data("scroll-cnt")||0;a+=e.originalEvent.wheelDelta,t.data("scroll-cnt",a),a>4100&&(t.data("scroll-cnt",-1e4),timelineTopRefresh(),topEventChk())}}),$(".feed-subarea ").bind("mousewheel DOMMouseScroll",function(){var e=$("#page-group-main").data("navi")||"00",t=$(".feed-subarea[data-feed="+e+"]");if(!t.hasClass("no-data")){var i=t.find(".filter-show").last();t.find(".st-sub-box").last();if(i.length){var a=$(window).scrollTop()+$(window).height(),n=i.offset().top+i.height()+25;a&&a>=n&&!t.data("scroll-chk")&&(t.data("scroll-chk",!0),cns.debug("last event ct:",t.data("last-ct")),timelineListWrite(t.data("last-ct")))}}}),$(".st-feebox-area-no-content ").bind("mousewheel DOMMouseScroll",function(){var e=$(this),t=$("#page-group-main").data("navi")||"00",i=$(".feed-subarea[data-feed="+t+"]");if(!i.hasClass("no-data")){var a=(e.siblings(".st-feedbox-area-bottom"),i.find(".st-sub-box").last(),$(window).scrollTop()+$(window).height()),n=i.offset().top+i.height()+25;a&&a>=n&&!i.data("scroll-chk")&&(e.addClass("disabled"),i.data("scroll-chk",!0),cns.debug("last event ct:",i.data("last-ct")),timelineListWrite(i.data("last-ct")),timelineScrollTop(),$(".gm-content > div:eq(1)").getNiceScroll(0).doScrollTop(0,500))}});var a,n=!1;$(".gm-content").bind("mousewheel DOMMouseScroll",function(){clearTimeout(a),e("onscroll"),a=setTimeout(e,10)}),$(document).on("click",".group-list-box",function(e){$.mobile.changePage("#page-group-main")}),$(".gm-nav-box").click(function(){$(".gm-nav-box").removeClass("gm-nav-active"),$(".gm-nav-box").each(function(e,t){$(this).find("img").attr("src","images/groupmenu/buildgroup_tab_bt_"+$(this).data("type")+".png")}),$(this).addClass("gm-nav-active"),$(this).find("img").attr("src","images/groupmenu/buildgroup_tab_bt_"+$(this).data("type")+"_click.png"),$(".gm-sub-area").hide()}),$(".gm-create").click(function(){$(".gm-create-area").show()}),$(".gmc-avatar").click(function(){$(".gmc-file").trigger("click")}),$(".gmc-file").change(function(e){var t=$(this),i=/image.*/,a=t[0].files[0];if(a.type.match(i)){$(".gmc-avatar").data("chk",!0);var n=new FileReader;n.onload=function(e){var t=$(".gmc-avatar-wrap img");t.attr("src",n.result)},n.readAsDataURL(a)}else popupShowAdjust("",$.i18n.getString("COMMON_NOT_IMAGE"),!0)}),$(".gm-create-submit").click(function(){if(!$(".gmc-avatar").data("chk"))return popupShowAdjust("",$.i18n.getString("GROUP_AVATAR_ALERT"),!0),!1;if(!$(".gmc-name input").val())return popupShowAdjust("",$.i18n.getString("GROUP_NAME_LIMIT"),!0),!1;if(!$(".gmc-desc textarea").val())return popupShowAdjust("",$.i18n.getString("GROUP_ABOUT_ALERT"),!0),!1;var e=$(".gmc-file")[0].files[0],t=$(".gmc-name input").val(),i=$(".gmc-desc textarea").val(),a=[1280,1280,.7],n=[120,120,.6];s_load_show=!0,createGroup(t,i).complete(function(t){if(s_load_show=!1,200==t.status){var i=$.parseJSON(t.responseText),o="groups/"+i.gi+"/avatar";uploadToS3(e,o,a,n,function(e){e||toastShow($.i18n.getString("GROUP_AVATAR_UPLOAD_ALERT"))})}})}),$(".gm-invite").click(function(){$(".gm-invite-area").show(),getMeInvite()}),$(document).on("click",".gmi-div-delete",function(){var e=$(this).parents(".gmi-div"),t=e.find(".gmi-div-data div:eq(0) span").html();popupShowAdjust("",$.i18n.getString("GROUP_REJECT_ALERT","<div class='popup-blue'>"+t+"</div>"),!0,!0,[deleteMeInvite,e])}),$(document).on("click",".gmi-div-agree",function(){agreeMeInvite($(this).parents(".gmi-div"))}),$(".hg-create").click(function(){$("#page-group-menu").data("type","create"),$(".gm-create").trigger("click"),clearCreateGroupPage(),$.mobile.changePage("#page-group-menu")}),$(".hg-join").click(function(){}),$(".hg-invite").click(function(){clearCreateGroupPage(),$("#page-group-menu").data("type","invite"),$(".gm-invite").trigger("click"),$.mobile.changePage("#page-group-menu")}),$(document).on("click",".sm-small-area,.sm-group-area.enable",function(){$(".sm-group-list-area").removeAttr("data-unlock");var e=$(this);if($(this).hasClass("sm-group-area"))timelineScrollTop(),timelineMainClose(),e=$(".sm-small-area[data-sm-act=feeds]");else{if($(".st-filter-area").hasClass("st-filter-lock"))return;timelineScrollTop(),timelineMainClose();var t=e.data("sm-act"),i=$(".feed-compose-area");switch($(".feed-compose").show(),t){case"feed-post":i.find(".fc-area-subbox.active[data-fc-box=post]").length<=0&&$(".feed-compose").hide();break;case"feed-public":i.find(".fc-area-subbox.active:not([data-fc-box=post])").length<=0&&$(".feed-compose").hide();break;default:i.find(".fc-area-subbox.active").length<=0&&$(".feed-compose").hide()}$(".sm-small-area.active").removeClass("active"),timelineSwitch(e.data("sm-act")),$(this).addClass("active")}e.addClass("sm-click-bg")}),$(document).on("click",".sm-group-area.enable",function(){var e=$(this),t=$(this).attr("data-gi"),i=$.lStorage(ui);try{Object.keys(i[t].guAll).length}catch(a){return a.special={error:"後台還原已退出團體 會出現左側選單團體點選時 guAll空的或是this_gi不存在的問題",_groupData:i,this_gi:t,code:"_groupData[this_gi].guAll"},errorReport(a),!1}if(0==Object.keys(i[t].guAll).length)return getGroupCombo(t,function(){e.trigger("click")}),!1;$(".sm-group-area").removeClass("enable"),$(".sm-group-area.active").removeClass("active"),$(this).addClass("active"),$(".st-top-event-default").show(),$(".st-top-event-set").hide(),$(".feed-subarea").html(""),$(".sm-small-area.active").removeClass("active"),timelineChangeGroup(t),updatePollingCnts(e.find(".sm-count"),e.data("polling-cnt"));var n=$(".sm-small-area:visible");n.length>0?($(n[0]).addClass("active"),timelineSwitch($(n[0]).data("sm-act")||"feeds",!0)):timelineSwitch("feeds",!0),topEvent()}),$(".st-navi-subarea").click(function(){if(!$(".st-filter-area").hasClass("st-filter-lock")){var e="images/timeline/timeline_tab_icon_",t=$(".st-navi-area [data-st-navi-group=navi]"),i=$(this);t.find("div").removeClass("color-white"),$("#page-group-main").data("navi",i.data("tp"));$("#page-group-main").data("navi")||"00";switch(i.data("st-navi")){case"home":$(".st-navi-tridiv-r").show(),$(".st-navi-tridiv-l").hide(),i.find("img").attr("src",e+"home_white.png"),i.find("div:eq(0)").addClass("color-white");break;case"announcement":$(".st-navi-tridiv-l").show(),$(".st-navi-tridiv-r").hide(),i.find("img").attr("src",e+"announcement_white.png"),i.find("div:eq(0)").addClass("color-white");break;case"feedback":$(".st-navi-tridiv-l").show(),$(".st-navi-tridiv-r").hide(),i.find("img").attr("src",e+"feedback_white.png"),i.find("div:eq(0)").addClass("color-white");break;case"task":$(".st-navi-tridiv-l").show(),$(".st-navi-tridiv-r").hide(),i.find("img").attr("src",e+"task_white.png"),i.find("div:eq(0)").addClass("color-white")}timelineListWrite(),timelineScrollTop()}}),$(".st-filter-main").click(function(){$(this).hide(),$(".st-filter-main-hide").show(),$(".st-filter-other").slideToggle()}),$(".st-filter-action").click(function(){var e=$(this),t=$(".st-navi-subarea"),i=$(this).parent();if(!i.hasClass("lock")){i.addClass("lock"),setTimeout(function(){i.removeClass("lock")},500),e.parent().children(".st-filter-list-active").removeClass("st-filter-list-active"),e.addClass("st-filter-list-active");var a=$(this).data("status");if("navi"==a||"all"==a)t.filter("[data-st-navi="+$(this).data("navi")+"]").trigger("click");else{var n=$(".st-navi-area").data("currentHome")||"home";t.filter("[data-st-navi="+n+"]").trigger("click")}var o=$("#page-group-main").data("navi")||"00",s=$(".feed-subarea[data-feed="+o+"]"),r=s.find(".st-sub-box"),l=$(".st-feedbox-area");l.hide(),$(".st-filter-area").data("filter",a),s.data("filter-name",$(this).find("span").html());var c=0;r.each(function(e,t){eventFilter($(this),a),$(t).hasClass("filter-show")&&c++}),showFeedboxNoContent(c>0),l.fadeIn("slow")}}),$(".st-filter-list-btn").click(function(){$(".st-filter-other").slideUp(function(){$(".st-filter-main-hide").hide(),$(".st-filter-main").show()})}),$(document).on("click",".st-sub-box-3 .st-like",function(){var e=$(this).parents(".st-sub-box");if(e.data("like-lock"))return!1;e.data("like-lock",!0);var t=(parseInt(e.find(".st-sub-box-3 div:eq(0)").html()),{});t.selector=e,t.act="like1",t.order=0;var i=e.data("event-id");if(e.data("event-path",i),e.data("event-val").meta.il)var a=0;else var a=1;putEventStatus(t,1,a,function(t){t&&e.data("detail-content")&&detailLikeStringMake(e)})}),$(document).on("click",".st-sub-box-3 .st-read",function(){cns.debug("read list");var e=$(this).parents(".st-sub-box");timelineObjectTabShowDelegate(e,0,function(){cns.debug("on back from read/unread")})}),$(document).on("click",".st-reply-message-like",function(){var e=$(this).parents(".st-reply-content-area");if(e.data("like-lock"))return!1;e.data("like-lock",!0);var t=(e.data("event-path"),$(this).parents(".st-sub-box"),0);0==$(this).data("like")&&(t=1);var i={};i.selector=e,i.reply=!0,putEventStatus(i,1,t)}),$(document).on("click",".st-reply-footer .cnt",function(){var e=$(this).parents(".st-reply-content-area");timelineShowResponseLikeDelegate(e,1,function(){cns.debug("on back from response like")})}),$(document).on("click",".img-show",function(e){var t=$(this),i=t.find(".auo").data("src");showGallery(null,null,[{s32:i}])}),$(document).on("click",".st-reply-message-sticker",function(){var e=$(this),t=e.parents(".st-sub-box").find(".stickerArea");"t"==e.attr("data-open")?(e.attr("data-open",""),t.hide(),e.attr("src","images/chatroom/chat_textbar_icon_emoticon.png")):(1!=t.data("isCreate")&&(t.data("isCreate",!0),initStickerArea.init(t,function(t){cns.debug(t);var i=e.parent().find(".st-reply-message-img");i.data("type",5),i.html("<div class='img'><img/></div>"),i.data("id",t),setStickerUrl(i.find("img"),t);var a=$(".stickerArea .imgArea");$.each(a,function(e){var t=$(this);initStickerArea.showHistory(t.parent())}),cns.debug("1")})),$('.st-reply-message-sticker[data-open="t"]').trigger("click"),e.attr("data-open","t"),t.show(),e.attr("src","images/chatroom/chat_textbar_icon_emoticon_activity.png"))}),$(document).on("click",".st-reply-message-img .img",function(){var e=$(this).parent();e.html(""),cns.debug(e.data("type")),e.removeData("type"),e.removeData("id"),e.removeData("file"),cns.debug(e.data("type"))}),$(document).on("click",".st-reply-message-attach",function(){$(this).siblings(".st-reply-message-file").trigger("click")}),$(document).on("change",".st-reply-message-file",function(e){var t=$(this);if(t[0].files.length>1)return toastShow("圖檔最多限制1個"),t.replaceWith(t.val("").clone(!0)),!1;var i=/image.*/;$.each(t[0].files,function(e,a){if(a.type.match(i)){var n=t.parent().find(".st-reply-message-img");n.data("type",6),n.html("<div class='img'><img/></div>"),n.data("file",a);var o=new FileReader;o.onload=function(e){var t=n.find("div img");t.attr("src",o.result),t.css("border","lightgray 1px solid")},o.readAsDataURL(a)}}),t.replaceWith(t.val("").clone(!0))}),$(document).on("input",".st-reply-message-textarea textarea",function(){var e=$(this);return e.height()>40&&e.parent().hasClass("adjust")?(e.parent().removeClass("adjust"),e.addClass("textarea-animated"),!1):e.val()?void setTimeout(function(){e.height()<40&&!e.parent().hasClass("adjust")&&(e.parent().addClass("adjust"),e.removeClass("textarea-animated"))},201):(e.parent().addClass("adjust"),e.removeClass("textarea-animated"),!1)}),$(document).on("click",".st-reply-message-send",function(){var e=$(this).parents(".st-sub-box"),t=e.find(".st-reply-message-textarea textarea").val(),i=e.find(".st-reply-message-img").data("type");return t||i?$(this).data("reply-chk")?!1:($(this).data("reply-chk",!0),void replySend(e)):!1}),$(document).on("click",".st-sub-box-more-btn",function(e){$(this).attr("src","images/timeline/timeline_feedbox_icon_list_click.png"),setTimeout(function(){$(this).attr("src","images/timeline/timeline_feedbox_icon_list.png")},100),$(".st-more-close").each(function(){$(this).is(":visible")&&$(this).trigger("click")}),zoom_out_cnt=8;$(".st-sub-box").width();$(this).next().css("width","100%"),$(this).next().css("zoom","0.05"),$(this).next().show(),zoomOut($(this).next()),$(this).parent().find(".st-sub-box-more-screen").fadeIn()}),$(document).on("click",".st-more-close",function(e){zoom_in_cnt=100,zoomIn($(this).parent()),$(this).parent().parent().find(".st-sub-box-more-screen").fadeOut()}),$(document).on("click",".st-sub-box-more-box:not(.deactive)",function(e){e.stopPropagation();var t=$(this);t.addClass("st-sub-box-more-box-click");var i=t.parents(".st-sub-box");try{var a=t.data("st-more");switch(a){case"top":timelineEditStatus(i,8,function(e){cns.debug(e.responseText)});break;case"subscribe":timelineEditStatus(i,3,function(e){cns.debug(e.responseText)});break;case"del":timelineDeleteEvent(i,function(e){cns.debug(e.responseText)});break;case"copyword":var n=i.data("event-val"),o=null;try{o=n.ml[0].c}catch(e){errorReport(e)}null!=o?(cns.debug(o),copyTextToClipboard(o)):toastShow("error occurred."),t.siblings(".st-more-close").trigger("click")}}catch(e){cns.debug(e)}}),$(".feed-compose").click(function(){if($(".feed-compose-area").is(":visible"))$(".feed-compose").removeClass("active"),$(".feed-compose-area-cover").hide(),setTimeout(function(){$(".feed-compose-area").slideUp()},100);else{1==$.lStorage(ui)[gi].guAll[gu].ad?$(".fc-area-subbox[data-fc-box=announcement]").removeClass("disabled"):$(".fc-area-subbox[data-fc-box=announcement]").addClass("disabled");var e=$(".header-menu .sm-small-area:visible.active").data("sm-act"),t=$(".feed-compose-area");switch(t.find(".fc-area-subbox").hide(),e){case"feed-public":t.find(".fc-area-subbox.active:not([data-fc-box=post])").show();break;case"feed-post":return $(".feed-compose-area").css("opacity","0"),$(".feed-compose-area").show(),$(".feed-compose-area-cover").show(),$(".feed-compose").addClass("active"),void t.find(".fc-area-subbox.active[data-fc-box=post]").click();default:t.find(".fc-area-subbox.active").show()}$(".feed-compose-area").css("opacity",""),
$(".feed-compose-area").slideDown(),$(".feed-compose-area-cover").show(),setTimeout(function(){$(".feed-compose").addClass("active")},100)}}),$(".st-filter-hide").click(function(e){var t=$(this),i=t.parent();e.stopPropagation(),t.hasClass("left")?(i.animate({scrollLeft:0},"fast"),t.siblings(".right").show()):(i.animate({scrollLeft:i.width()},"fast"),t.siblings(".left").show()),t.hide()}),$(document).on("mousedown",".st-sub-box-1, .st-sub-box-2, .st-sub-box-3 .st-response",function(e){var t=$(this);t.data("trigger",!0),setTimeout(function(){t.data("trigger",!1)},300)}),$(document).on("mouseup",".st-sub-box-1, .st-sub-box-2",function(e){$(this).data("trigger")&&$(this).trigger("detailShow")}),$(document).on("mouseup",".st-sub-box-3 .st-response",function(e){$(this).data("trigger")&&$(this).parent().trigger("detailShow")}),$(document).on("detailShow",".st-sub-box-1, .st-sub-box-2, .st-sub-box-3",function(){var e=$(this).parent();if(e.data("detail-page"))return!1;var t=e.data("event-id");if(0==e.data("event-val").meta.ir){var i=e.data("event-val");i.meta.ir=!0,e.data("event-val",i)}var a=e.data("timeline-tp");e.data("switch-chk")?(e.data("switch-chk",!1),e.find(".st-reply-message-bg").removeAttr("style"),e.find(".st-sub-box-1-footer").addClass("hideOverflow")):(e.data("switch-chk",!0),e.find(".st-reply-message-bg").css("border",0),e.find(".st-sub-box-1-footer").removeClass("hideOverflow"));var n=timelineDetailClose(e,a);return n?(getThisTimelinePart(e,1,function(t){if(!t.responseText)return!1;var i=$.parseJSON(t.responseText).epl;if("undefined"!=typeof i&&i.length>0){var a=[];$.each(i,function(e,t){a.push(t.gu)}),e.data("parti-list",a),e.data("parti-like",i),detailLikeStringMake(e)}}),void getEventDetail(t).complete(function(t){if(200!=t.status)return!1;var i=$.parseJSON(t.responseText).el;eventContentDetail(e,i),detailTimelineContentMake(e,i),timelineUpdateTime()})):(e.find(".st-vote-all-ques-area").html(""),!1)}),$(document).on("click",".st-reply-like-area",function(){var e=$(this).parents(".st-sub-box");cns.debug("gogoogg",e.data()),timelineObjectTabShowDelegate(e,1,function(){cns.debug("back from like list")})}),$(document).on("mouseup",timeline_detail_exception.join(","),function(e){e.stopPropagation()}),$(document).on("click",".fc-area-subbox:not(.disabled)",function(){var e=$(this).find("div").html();$("#page-compose .header-group-name div:eq(0)").html(e),$("#page-compose .header-group-name div:eq(1)").html(gn),$.mobile.changePage("#page-compose"),composeContentMake($(this).data("fc-box")),$(".feed-compose").trigger("click")}),$(".feed-compose-area-cover").click(function(){$(".feed-compose").trigger("click")}),$(".cp-post").click(function(){var e=$(document).find(".cp-content");if(!e.data("send-chk"))return!1;if(e.data("send-chk",!1),setTimeout(function(){e.data("send-chk",!0)},1500),e.data("parse-resend",!1),e.data("parse-waiting"))return setTimeout(function(){e.data("send-chk",!0),cns.debug("parse-retry",e.data("parse-waiting-retry"));var t=e.data("parse-waiting-retry")||0;3>t?(t++,e.data("parse-waiting-retry",t),console.debug("yooo",t),$(".cp-post").trigger("click")):(cns.debug("parse retry toast"),e.data("parse-waiting-retry",0),toastShow($.i18n.getString("COMPOSE_PARSE_ERROR")))},1e3),!1;e.data("compose-content",$(".cp-textarea-desc").val()),e.data("compose-title",$(".cp-textarea-title").val());var t=e.data("compose-tp"),i=!0,a=[];a[".cp-textarea-title"]=$.i18n.getString("COMPOSE_TITLE_EMPTY"),a[".cp-textarea-desc"]=$.i18n.getString("COMPOSE_DESCRIPTION_EMPTY");var n=[".cp-textarea-desc"];switch(t){case 0:break;case 1:n.push(".cp-textarea-title");break;case 2:break;case 3:n.push(".cp-textarea-title");break;case 4:n.push(".cp-textarea-title");break;case 5:n.push(".cp-textarea-title")}$.each(n,function(t,n){return $(n).val()?void 0:(i=!1,popupShowAdjust("",a[n],!0),e.data("send-chk",!0),!1)}),i&&composeSend(e)}),$(".cp-addfile").click(function(){var e="images/compose/compose_form_addfile_",t=$(this),i=t.data("cp-addfile");switch(i){case"video":$(".cp-file").data("img",!1).attr("accept","video/mp4").trigger("click"),t.find("img").attr("src",e+t.data("cp-addfile")+"_visit.png"),setTimeout(function(){t.find("img").attr("src",e+t.data("cp-addfile")+".png")},100);break;case"img":$(".cp-file").data("img",!0).attr("accept","image/*").trigger("click"),t.find("img").attr("src",e+t.data("cp-addfile")+"_visit.png"),setTimeout(function(){t.find("img").attr("src",e+t.data("cp-addfile")+".png")},100);break;case"sticker":var a=$("#page-compose .stickerArea");1==a.data("open")?(a.hide(),a.data("open",!1),t.find("img").attr("src",e+t.data("cp-addfile")+".png")):(1!=a.data("isCreate")&&(a.data("isCreate",!0),initStickerArea.init(a,function(e){var t=$(document).find(".cp-content"),i=$("#page-compose .cp-sticker-area");i.html("<div class='sticker'><img/></div>"),setStickerUrl(i.find("img"),e),t.data("stickerID",e),i.show(),null==t.data("message-list")&&t.data("message-list",[]),$.inArray(5,t.data("message-list"))<0&&t.data("message-list").push(5),$("#page-compose .cp-attach-area").show();var a=$(".stickerArea .imgArea");$.each(a,function(e){var t=$(this);initStickerArea.showHistory(t.parent())}),cns.debug("2")})),a.show(),a.data("open",!0),t.find("img").attr("src",e+t.data("cp-addfile")+"_visit.png"))}}),$(".cp-file").change(function(e){var t=$("#page-compose"),i=t.find(".cp-content"),a=[],n=[],o=$(this),s=/image.*/,r=/video.mp4/,l=!1;if($.each(o[0].files,function(e,t){t.type.match(s)?n.push(t):t.type.match(r)?a.push(t):!l&&t.type.match(/video.*/)&&(l=!0,toastShow($.i18n.getString("COMMON_NOT_MP4")))}),n.length>0){t.find(".cp-attach-area").show(),t.find(".cp-file-area").show();var c=t.find(".cp-file-img-area");c.html("").show();var d=i.find(".cp-file-video-area");d.is(":visible")&&d.addClass("topBorder");var u=!1;$.each(n,function(e,t){if(t&&t.type){if(9==Object.keys(i.data("upload-obj")).length)return u=!0,!1;var a=i.data("upload-ai");i.data("upload-obj")[a]=t,i.data("upload-ai",a+1)}}),u&&toastShow($.i18n.getString("COMMON_SEND_PHOTO_LIMIT",9)),$.each(i.data("upload-obj"),function(e,t){var a=$('<div class="cp-grid"><div><img/></div><img class="grid-cancel" src="images/common/icon/icon_compose_close.png"/></div>');$(".cp-file-img-area").append(a),a.data("file-num",e),$.inArray(6,i.data("message-list"))<0&&(i.data("message-list").push(6),i.data("attach",!0));var n=new FileReader;n.onload=function(e){var t=a.find("div img");t.load(function(){var e=t.width(),i=t.height();mathAvatarPos(t,e,i,100)}),t.attr("src",n.result)},n.readAsDataURL(t)})}if(a.length>0){var t=$("#page-compose"),i=t.find(".cp-content");i.find(".cp-attach-area").show(),i.find(".cp-file-area").show();var d=i.find(".cp-file-video-area");d.html("").show(),i.find(".cp-file-img-area").is(":visible")&&d.addClass("topBorder");var u=!1;$.each(a,function(e,t){if(t&&t.type){if(1==Object.keys(i.data("upload-video")).length)return u=!0,!1;var a=i.data("upload-ai");i.data("upload-video")[a]=t,i.data("upload-ai",a+1)}}),u&&toastShow($.i18n.getString("COMMON_SEND_VIDEO_LIMIT",1)),$.each(i.data("upload-video"),function(e,t){var a=$('<div class="cp-grid"><div><video data-file-num="'+e+'"/></div><img class="grid-cancel" src="images/common/icon/icon_compose_close.png"/></div>');a.data("file-num",e),d.append(a),t.size>5e7?a.find("div").html("<span>"+$.i18n.getString("COMMON_EXCEED_FILE_SIZE")+"</span>"):($.inArray(7,i.data("message-list"))<0&&(i.data("message-list").push(7),i.data("attach",!0)),renderVideoFile(t,d.find('video[data-file-num="'+e+'"]'),function(e){e.parent().addClass("loaded"),e.width()>100&&e.css("margin-left",.5*-(e.width()-100))},function(e){e.parent().addClass("error")}))})}o.replaceWith(o.val("").clone(!0))}),$(document).on("dragover",".timeline-dnd,.compose-dnd,.user-info-load-area .me",function(e){e.preventDefault(),e.stopPropagation()}),$(document).on("drop",".timeline-dnd,.compose-dnd,.user-info-load-area .me",function(e){e.preventDefault(),e.stopPropagation(),$(this).hide();var t=$(this).parents(".st-sub-box").find(".st-reply-message-file");$(this).hasClass("compose-dnd")&&(t=$(".cp-file")),$(this).hasClass("me")&&(t=$(this).find(".user-avatar-bar.me input"),$(this).show()),e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length&&(t[0].files=e.originalEvent.dataTransfer.files)}),$(document).on("dragover",".st-sub-box,#page-compose",function(e){var t=$(this);t.hasClass("st-sub-box")&&!t.find(".timeline-dnd").is(":visible")?t.find(".timeline-dnd").show().css("height",t.height()):$(".compose-dnd").show()}),$(document).on("dragleave",".timeline-dnd,.compose-dnd",function(){$(this).hide()}),$(document).on("click",".cp-sticker-area .sticker",function(e){var t=$(document).find(".cp-sticker-area");t.html(""),t.hide();var i=$(document).find(".cp-content");i.data("message-list").splice($.inArray(5,i.data("message-list")),1),i.data("stickerID",null);var a=i.data("message-list");a&&0!=a.length.length||i.find(".cp-attach-area").hide("fast"),composeCheckMessageList()}),$(document).on("click",".cp-grid .grid-cancel",function(e){var t=$(document).find(".cp-content"),i=$(this).parent(),a=i.data("file-num"),n=$(this);n.attr("src","images/common/icon/icon_compose_close_click.png"),setTimeout(function(){var e=i.parent();e.hasClass("cp-file-img-area")?(delete t.data("upload-obj")[a],n.attr("src","images/common/icon/icon_compose_close.png"),n.remove(),i.hide("fast",function(){i.remove(),""==e.html()&&(e.hide(),e.siblings(".cp-file-video-area").removeClass("topBorder"),t.data("message-list").splice($.inArray(6,t.data("message-list")),1),composeCheckMessageList())})):(delete t.data("upload-video")[a],n.attr("src","images/common/icon/icon_compose_close.png"),n.remove(),i.hide("fast",function(){i.remove(),""==e.html()&&(e.hide().removeClass("topBorder"),t.data("message-list").splice($.inArray(7,t.data("message-list")),1),composeCheckMessageList())}))},100)}),$("#page-compose").on("click",".page-back-comfirm",function(e){var t=$(this);popupShowAdjust("",$.i18n.getString("COMPOSE_DISCARD"),$.i18n.getString("COMMON_OK"),$.i18n.getString("COMMON_CANCEL"),[function(){t.siblings(".page-back").trigger("click")},$(this)])}),$(".main-more-btn").click(function(){var e=$(".main-footer-add");"125px"==e.css("bottom")?$(".main-footer-add").animate({bottom:"194px"},function(){$(".main-footer").css("z-index","0")}):"0"==$(".main-footer").css("z-index")&&($(".main-footer").css("z-index","100"),$(".main-footer-add").animate({bottom:"125px"}))}),$(".main-footer-item").click(function(){var e=$(this).data("main-act"),t="images/contact/toolbar_icon_";switch($(".main-footer-item").each(function(e,i){$(this).children().attr("src",t+$(this).data("main-act")+".png"),$(this).find("div").removeClass("color-white")}),$(this).children().attr("src",t+$(this).data("main-act")+"_active.png"),$(this).find("div").addClass("color-white"),e){case"chat":$.mobile.changePage("#page-chatroom")}}),$(".main-contact-l-row").click(function(){var e=$(this),t="images/contact/contact_sidemenu_";if($(".main-contact-l-row").css("background","url("+t+"rowbg.png)"),$(".main-contact-l-row img").attr("src",t+"icon_arrow.png"),$(".main-contact-l-row").removeClass("color-white"),e.css("background","url("+t+"rowbg_unfold.png)"),e.addClass("color-white"),$(".main-contact-l-row-subarea").each(function(t,i){$(this).is(e.next())||"0px"==$(this).css("height")||$(this).animate({height:"0px"},function(){$(this).hide()})}),e.data("main-sub-chk")){var i=e.next();i.show();var a=i.find(".main-contact-l-subarea-row");"0px"==i.css("height")?i.animate({height:43*a.length}):i.animate({height:"0px"},function(){e.children().attr("src",t+"icon_arrow_white.png"),i.hide()}),e.children().attr("src",t+"icon_arrow_white_below.png")}else e.children().attr("src",t+"icon_arrow_white.png"),$(".main-contact-l-subarea-row").height("0px")}),$(document).on("mousedown",".user-info-close",function(){$(this).attr("src","images/common/icon/bt_close_activity.png")}),$(document).on("mouseup",".user-info-close",function(){$("#page-group-main .gm-content").removeAttr("style"),$(window).scrollTop($(document).data("namecard-pos")),$(".user-info-load-area .me").hasClass("adjust")&&($(".user-info-load-area").addClass("transition1s"),$(".user-info-load-area").addClass("user-info-flip"),$(".user-info-load-area .me").removeClass("adjust")),$("body").removeClass("user-info-adjust"),$(".user-info-load-area > div").html(""),$(".screen-lock").fadeOut(),$(this).attr("src","images/common/icon/bt_close_normal.png"),$(".user-info-load-area").fadeOut("fast",function(){$(".user-info-load-area").removeClass("user-info-flip"),$(".user-info-load-area .user").show()})}),$(document).on("click",".user-info-load-area",function(e){var t=event.target||event.srcElement;if(cns.debug(t),t=$(t),t.hasClass("user-info-load-area"))$(this).hide(),$(".screen-lock").hide();else if(t.hasClass("user")||t.hasClass("rotate.adjust")){var i=t.parent();i.length>0&&i[0]==this&&$(".user-info-close").trigger("mouseup")}}),$(document).on("mouseup",".user-info-back",function(e){$(".user-info-load-area").addClass("user-info-flip"),$(".user-info-load-area .me").removeClass("adjust"),setTimeout(function(){$(".user-info-load-area").addClass("transition1s"),$(".user-info-load-area").removeClass("user-info-flip"),$(".user-info-load , .me-info-load").stop().animate({opacity:0},400),setTimeout(function(){$(".user-info-load-area .me").addClass("backface-visibility"),$(document).find(".user-info-load-area .user").show(),$(".user-info-load , .me-info-load").stop().animate({opacity:1},400)},400)},100),e.stopPropagation(),e.preventDefault()}),$(".chatroom-addstate-top-btn").click(function(){$(".chatroom-addstate-top-area").slideToggle()}),$(".chat-bar-add").click(function(){"0px"==$(".chatroom-footer").css("bottom")?($(".chatroom-footer").animate({bottom:"165px"},function(){$(".chat-bar-send").css("bottom","4px")}),$(".chatroom-addstate-area").animate({bottom:"0px"})):($(".chatroom-footer").animate({bottom:"0px"},function(){$(".chat-bar-send").css("bottom","5px")}),$(".chatroom-addstate-area").animate({bottom:"-166px"}))}),$(".chatroom-addstate-top-box").click(function(){var e=$(this);e.addClass("chatroom-addstate-top-box-click"),setTimeout(function(){e.removeClass("chatroom-addstate-top-box-click")},500)}),$(".chatroom-addstate-box").click(function(){var e=$(this);e.addClass("chatroom-addstate-box-click"),setTimeout(function(){e.removeClass("chatroom-addstate-box-click")},500)}),$(".chat-bar-send").click(function(){var e=new Date,t=(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes());$(".chat-bar-input").val()&&($(".chat-area").append('<div class="chat-me"><div class="chat-me-text">'+$(".chat-bar-input").val()+'<div class="chat-me-time">'+t+"</div></div></div>"),$(".chat-bar-input").val(""),$("html, body").animate({scrollTop:$(document).height()},0))}),$(document).on("change",'.audio-progress input[type="range"]',function(){var e=($(this).val()-$(this).attr("min"))/($(this).attr("max")-$(this).attr("min"));$(this).css("background-image","-webkit-gradient(linear, left top, right top, color-stop("+(e+.02)+", rgb(95,212,226)), color-stop("+(e+.02)+", rgb(197,203,207)))")}),$(document).on("click",".audio-play",function(e){var t=$(this);0==t.nextAll("audio").get(0).paused?(t.nextAll("audio").get(0).pause(),t.find("img:nth-child(3)").hide(),t.find("img:nth-child(1)").show()):(t.nextAll("audio").get(0).play(),t.find("img:nth-child(1)").hide(),t.find("img:nth-child(3)").show()),t.nextAll("audio").bind("ended",function(){t.find("img:nth-child(3)").hide(),t.find("img:nth-child(1)").show()})}),$(document).on("click",".polling-cnt",function(e){var t=$(this);if(!t.hasClass("sm-group-area")||t.hasClass("enable")){t.find(".sm-count").hide(),t.data("gi")==gi&&$(".sm-small-area[data-polling-cnt=A1]").find(".sm-count");var i=$.lStorage("_pollingData");i&&i.cnts[gi]&&(i.cnts[gi].A5=0,$.lStorage("_pollingData",i)),updatePollingCnts(t.find(".sm-count"),t.data("polling-cnt"))}}),$(document).on("click",".sm-group-area:not(.enable)",function(e){e.preventDefault(),e.stopPropagation();try{var t=$(".sm-group-list-area").attr("data-unlock")||0;t>0?($(".sm-group-list-area").removeAttr("data-unlock"),groupSwitchEnable()):$(".sm-group-list-area").attr("data-unlock",++t)}catch(e){errorReport(e)}}),$(document).on("click",".polling-cnt-cl",function(e){$(this).find(".sm-cl-count").hide(),updatePollingCnts($(this).find(".sm-cl-count"),$(this).data("polling-cnt"))}),$(document).on("mouseup",".namecard",function(e){return e.stopPropagation(),1==$(document).data("official")?!1:($(document).data("namecard-pos",$(window).scrollTop()),$(window).scrollTop(0),$("#page-group-main .gm-content").css("overflow","initial"),$(this).parents(".al-subbox").length&&$(this).parents(".al-subbox").data("stop",!0),void userInfoShow($(this).data("gi"),$(this).data("gu")))}),$(document).on("mouseup",".ab_namecard",function(e){e.stopPropagation(),$(document).data("namecard-pos",$(window).scrollTop()),$(window).scrollTop(0),$("#page-group-main .gm-content").css("overflow","initial"),$(this).parents(".al-subbox").length&&$(this).parents(".al-subbox").data("stop",!0),AddressBook.userInfoShow($(this).data("gi"),$(this).data("gu"))}),$(".st-feedbox-area,#page-timeline-detail").on("mouseenter",".attach-download",function(){var e=$(this),t=$('<a href="'+e.find(".download").attr("src")+'" download><img style="position:absolute;top:5px;right:5px;width:50px;opacity:0.9;" src="images/dl.png"/></a>');e.append(t),e.unbind("mouseleave").mouseleave(function(){t.remove()})}),$(document).on("click",".admin .st-official-tab",function(e){var t=$(this).data("type");switch(t){case"about":showGroupInfoPage();break;case"chat":break;case"setting":$(".sm-small-area[data-sm-act=groupSetting]").trigger("click");break;case"invite":$(".contact-add").trigger("click");break;case"share":break;case"cnt":}}),$(document).on("click",".general .st-official-tab",function(e){var t=$(this).data("type");switch(t){case"about":showGroupInfoPage();break;case"chat":$(".sm-small-area[data-sm-act=chat]").trigger("click");break;case"cnt":cns.debug("cnt");break;case"setting":$(".sm-small-area[data-sm-act=groupSetting]").trigger("click")}}),$(document).on("click",".st-attach-video.play div",function(e){var t=$(this).prev("video");t.length>0&&(t[0].play(),t.attr("controls",!0)),$(this).parent().removeClass("play")}),document.addEventListener("ended",function(e){if($(e.target).is("video")){var t=$(e.target);t.attr("controls",!1),t.parent().addClass("play")}},!0);var o={cursorcolor:"rgba(210, 210, 210, 0.8)",cursorwidth:"10",cursorborderradius:"10px",background:"rgba(255,255,255,0)",cursorborder:"",boxzoom:!1,zindex:999,scrollspeed:90,mousescrollstep:40};$(".gm-content > div:eq(1)").niceScroll(o),$(".contact-rows, .contact-searchResult").niceScroll(o);var s={cursorcolor:"rgba(107, 107, 107,0.8)",cursorwidth:"10",cursorborderradius:"10px",background:"rgba(255,255,255,0)",cursorborder:"",boxzoom:!1,zindex:999,scrollspeed:90,mousescrollstep:40};$(".sm-group-list-area").niceScroll(s),fetchHistoryTimeline=function(){console.debug("fetchHistoryTimeline");var e=$(".subpage-timeline");if(0!=e.is(":visible")){console.debug("fetchHistoryTimeline in timeline");var t=$("#page-group-main").data("navi")||"00";if(!$(".feed-subarea[data-feed="+t+"]").hasClass("no-data")){var i=$(".feed-subarea[data-feed="+t+"]"),a=i.find(".filter-show").last();i.find(".st-sub-box").last();a.length&&(i.data("scroll-chk")||(i.data("scroll-chk",!0),cns.debug("last event ct:",i.data("last-ct")),timelineListWrite(i.data("last-ct"))))}}};var r=$(".gm-content > div:eq(1)").getNiceScroll()[0];r.onDragToBottom=fetchHistoryTimeline,initStickerArea.load(),$("#send-sync-sticker-signal").off("click").click(function(){var e=$(this).attr("data-sid");cns.debug("sending sync sticker signal"),windowList&&$.each(windowList,function(t,i){$(i.document).find("#recv-sync-sticker-signal").attr("data-sid",e).click()})}),$("#recv-sync-sticker-signal").off("click").click(function(){cns.debug("update sticker"),initStickerArea.syncSticker($(this).attr("data-sid")),$(this).removeAttr("data-sid");var e=$(this).attr("data-ci");e&&windowList&&$.each(windowList,function(t,i){e!=t&&$(i.document).find("#recv-sync-sticker-signal").click()})}),$("#recv-chatroom-focus").off("click").click(function(){cns.debug("on chatroom focus"),updatePollingCnts($(this),"B7")}),$("#recv-sync-chat-list").off("click").click(function(){var e=$(this).attr("data-gi");cns.debug("update chat list ",e),e&&e==gi&&$(".subpage-chatList").is(":visible")&&$('.header-menu .sm-small-area[data-sm-act="chat"]').trigger("click")}),$("#page-compose .page-title").click(function(){cns.debug("ddd",$("#page-compose").find(".cp-content").data())})});var windowList=new Object,sortRoomListTimeout=700;$(document).ready(function(){$(".chatList-add-done").on("click",function(){var e=$(this),t=e.attr("data-gi"),i=e.attr("data-ci");gi==t?updateChatList(gi,function(){openChatWindow(t,i)}):openChatWindow(t,i)}),$(document).on("click",".newChatDetail-header",function(){var e=$(this).next();$(this).toggleClass("hide"),e.slideToggle()})}),initChatList=function(){$.lStorage(ui)[gi];$(".chatList-add").off("click"),$(".chatList-add").on("click",function(){$(".chatList-add").data("object_str",""),showNewRoomPage()}),updateChatList(gi)};var g_newChatMemList,g_newChatFavList,g_memCount,lastAlertCt=0,lastCnt=0;$(function(){initAlertDB(),$(".navi-alert").click(function(){$(".navi-alert").removeClass("new"),clearBadgeLabel(),$(".alert-area").is(":visible")?hideAlertBox():showAlertBox()}),$(".alert-area-cover").click(function(){$(".navi-alert").trigger("click")})}),initAlertDB=function(){idb_alert_events=new IDBStore({dbVersion:2,storeName:"alert_events",keyPath:"ei_ntp",autoIncrement:!1,indexes:[{name:"ei_ntp",keyPath:["ei","ntp"]}],onStoreReady:function(){$.lStorage("alert_db_updated")||(idb_alert_events.clear(),$.lStorage("alert_db_updated",!0))}})},showNewAlertIcon=function(e){e!=lastCnt&&(lastCnt=e,$(".alert-area").is(":visible")?($(".alert-area").scrollTop(0),"undefined"!=typeof updatePollingCnts&&(lastCnt=0,updatePollingCnts($("<div></div>"),"G3")),updateAlert()):($(".navi-alert").addClass("new"),setBadgeLabel(e.toString())))},hideAlertBox=function(e){return $(".alert").removeClass("alert-visit"),$(".alert-area-cover").hide(),e?!1:void setTimeout(function(){$(".alert").removeClass("alert-click"),$(".alert-area").slideUp()},100)},showAlertBox=function(){"undefined"!=typeof updatePollingCnts&&(lastCnt=0,updatePollingCnts($("<div></div>"),"G3")),updateAlert(),$(".alert").addClass("alert-click"),$(".alert-area").slideDown(),$(".alert-area-cover").show(),setTimeout(function(){$(".alert").addClass("alert-visit")},100)},showAlertFromDB=function(){idb_alert_events.getAll(function(e){showAlertContent(e)},{index:"ct",keyRange:idb_alert_events.makeKeyRange({upper:[(new Date).getTime()],lower:[]}),limit:20,order:"DESC",onEnd:function(e){},onError:function(e){}})},updateAlert=function(){"undefined"!=typeof ui&&ajaxDo("notices",{ui:ui,at:at,li:lang},"get",!1,null).complete(function(e){if(200==e.status){var t=$.parseJSON(e.responseText);idb_alert_events.getAll(function(e){for(var i={},a=0;a<e.length;a++)e[a].isRead&&(i[e[a].ei+"_"+e[a].ntp]=e[a].data);for(var a=0;a<t.nl.length;a++)try{var n={ei:t.nl[a].nd.ei,ntp:t.nl[a].ntp,ei_ntp:t.nl[a].nd.ei+"_"+t.nl[a].ntp,data:t.nl[a]},o=t.nl[a].nd.ei+"_"+t.nl[a].ntp;i.hasOwnProperty(o)&&i[o].nd.ct==t.nl[a].nd.ct&&(n.isRead=!0,t.nl[a].isRead=!0),idb_alert_events.put(n)}catch(s){errorReport(s)}showAlertContent(t.nl)})}})},showAlertContent=function(e){return e&&0!=e.length?void $("<div>").load("layout/alert_subbox.html .al-subbox",function(){var t=$(".alert-area .content");t.html("");var i=$.lStorage(ui);if(null!=i)for(var a=0;a<e.length;a++){var n=e[a],o=$(this).clone();n.isRead&&o.find(".al-subbox").addClass("isRead");var s;if(30==n.ntp){var r=$(o).find(".al-post-img.namecard");n.gat?r.css("background-image","url("+n.gat+")"):r.css("background-image","url(images/common/others/empty_img_all_l.png)"),r=$(o).find(".al-post-group"),r&&r.html(n.gn.replaceOriEmojiCode()),r=$(o).find(".al-post-name"),r&&r.html(n["in"].replaceOriEmojiCode()),s=$(o).find(".al-content.invite"),s.show(),r=$(o).find(".al-time .text"),r&&r.html(new Date(n.it).toFormatString());var l=$(o).find(".al-extra");l.html(n.im).show()}else{if(!e[a].hasOwnProperty("nd"))continue;if(group=i[n.gi],null==group)continue;if(r=$(o).find(".al-post-group"),r&&r.html(group.gn.replaceOriEmojiCode()),1==n.ntp){if(r=$(o).find(".al-post-name"),r&&r.html(n.gun.replaceOriEmojiCode()),s=$(o).find(".al-content.post"),group){var r=$(o).find(".al-post-img.namecard");if(r&&group.hasOwnProperty("guAll")&&group.guAll.hasOwnProperty(n.gu)){var c=group.guAll[n.gu].auo;c&&r.css("background-image","url("+c+")")}}}else{r=$(o).find(".al-post-name"),r&&n.gun&&(r.html(n.gun.replaceOriEmojiCode()),n.rcnt>1&&($(o).find(".posterDetail").css("display","inline-block"),$(o).find(".otherPosterCnt").html($.i18n.getString("NOTICES_RESPONSER_NUM",n.rcnt-1)))),s=$(o).find(".al-content.response"),s.find(".oriPoster").html(textSomeonesHtmlFormat(getPosterText(group,n)));var r=$(o).find(".al-post-img");if(r)if(n.aurl)r.css("background-image","url("+n.aurl+")");else if(group&&group.hasOwnProperty("guAll")&&group.guAll.hasOwnProperty(n.gu)){var c=group.guAll[n.gu].auo;c&&r.css("background-image","url("+c+")")}}if(1==n.ntp){if(r=$(o).find(".al-post-name"),r&&r.html(n.gun.replaceOriEmojiCode()),s=$(o).find(".al-content.post"),group){var r=$(o).find(".al-post-img.namecard");if(r&&group.hasOwnProperty("guAll")&&group.guAll.hasOwnProperty(n.gu)){var c=group.guAll[n.gu].auo;c&&r.css("background-image","url("+c+")")}}}else{r=$(o).find(".al-post-name"),r&&n.gun&&(r.html(n.gun.replaceOriEmojiCode()),n.rcnt>1&&($(o).find(".posterDetail").css("display","inline-block"),$(o).find(".otherPosterCnt").html($.i18n.getString("NOTICES_RESPONSER_NUM",n.rcnt-1)))),s=$(o).find(".al-content.response"),s.find(".oriPoster").html(textSomeonesHtmlFormat(getPosterText(group,n)));var r=$(o).find(".al-post-img");if(r)if(n.aurl)r.css("background-image","url("+n.aurl+")");else if(group&&group.hasOwnProperty("guAll")&&group.guAll.hasOwnProperty(n.gu)){var c=group.guAll[n.gu].auo;c&&r.css("background-image","url("+c+")")}}n.nd.hasOwnProperty("et")&&n.nd.et.length>0&&$(s).find(".boxTitle").html(getEventTitleText(n.nd.et)).css("display","inline-block"),$(s).find(".type").html(getEventTypeText(n.nd.etp)),$(s).find(".icon").attr("src",getEventTypeIcon(n.nd.etp)),s&&s.css("display","block");var l=$(o).find(".al-extra");if(l.css("display","none"),n.nd.hasOwnProperty("ml"))for(var d=0;d<n.nd.ml.length;d++)if(0==n.nd.ml[d].tp&&n.nd.ml[d].c.length>0){l.html(n.nd.ml[d].c.replaceOriEmojiCode()),l.css("display","");break}o.data("gi",n.gi),o.data("ei",n.nd.ei),o.data("ntp",n.ntp),o.click(function(){if($(this).find(".al-subbox").data("stop"))return $(this).find(".al-subbox").data("stop",!1),!1;var e=$(this).data("gi"),t=$(this).data("ei"),i=$(this).data("ntp"),a=t+"_"+i;if(idb_alert_events.get(a,function(e){return e?(e.isRead=!0,void idb_alert_events.put(e)):void cns.debug("error")},function(e){cns.debug(e)}),null!=e&&null!=t){var n=$.lStorage(ui)[e];if(null!=n){if(null==n.guAll||0==Object.keys(n.guAll).length){cns.debug("no guall",e);var o=$(this);return setGroupAllUser(!1,e,function(){o.trigger("click")}),!1}hideAlertBox(!0),$(".alert").removeClass("alert-click"),$(".alert-area").slideUp("fast",function(){setTimeout(function(){$.mobile.changePage("#page-timeline-detail",{transition:"slide"}),eventDetailShow(t)},100)})}}}),r=$(o).find(".al-time .text"),r&&r.html(new Date(n.nd.ct).toFormatString())}t.append(o),o._i18n(),$(o).find(".al-post-img.namecard").data("gu",n.gu),$(o).find(".al-post-img.namecard").data("gi",n.gi)}}):($(".alert-area .content").html(""),void cns.debug("no alert data"))},getPosterText=function(e,t){return t.gu==t.ogu?$.i18n.getString("COMMON_SELF"):e&&e.gu==t.ogu?$.i18n.getString("COMMON_YOU"):t.ogun?t.ogun.replaceOriEmojiCode():"unknown"},getEventTypeText=function(e){switch(e.substring(1,2)){case"0":return $.i18n.getString("FEED_POST");case"1":return $.i18n.getString("FEED_BULLETIN");case"2":return $.i18n.getString("FEED_REPORT");case"3":return $.i18n.getString("FEED_TASK");case"4":return $.i18n.getString("FEED_VOTE");case"5":return $.i18n.getString("FEED_LOCATION")}return"[type "+e+"]"},getEventTypeIcon=function(e){switch(e.substring(1,2)){case"0":return"images/compose/compose_box_bticon_post.png";case"1":return"images/compose/compose_box_bticon_announcement.png";case"2":return"images/compose/compose_box_bticon_feedback.png";case"3":return"images/compose/compose_box_bticon_work.png";case"4":return"images/compose/compose_box_bticon_vote.png";case"5":return"images/compose/compose_box_bticon_check.png";case"6":return"images/compose/compose_box_bticon_post.png"}return""},getEventTitleText=function(e){return e?"『"+e.replaceOriEmojiCode()+"』":""},setDetailAct=function(e){e.find(".detail").css("display","inline-block");var t=e.find(".sendFile");t&&t.html("<label class='and'>並</label>上傳了檔案")};var initStickerArea={isUpdated:!1,path:"sticker/",jsonPath:"sticker/stickerArea.json",splDict:null,domList:[],loadStash:[],isInit:!1,init:function(e,t){var i=this;i.domList.push(e),e.data("callback",t);var a=$("<div class='imgArea'></div>");e.append(a);var n=$("<div class='left'></div>");n.off("click").click(function(){var t=$(e).find(".mid").data("type"),a=$(e).find(".mid .group."+t),n=a.data("index"),o=a.data("cnt");n>0?n--:n=Math.max(0,o-1),n!=a.data("index")&&(a.data("index",n),a.animate({marginLeft:"-"+100*n+"%"},"fast")),i.showPageCount(e)}),a.append(n);var o=$("<span class='mid'></span>");a.append(o);var s=$("<div class='right'></div>");s.off("click").click(function(){var t=$(e).find(".mid").data("type"),a=$(e).find(".mid .group."+t),n=a.data("index"),o=a.data("cnt");o-1>n?n++:n=0,n!=a.data("index")&&(a.data("index",n),a.animate({marginLeft:"-"+100*n+"%"},"fast")),i.showPageCount(e)}),a.append(s);var r=$("<div class='pageArea'></div>");e.append(r);var l=$("<div class='catagory'></div>");l.append("<div class='cataBtn left'></div>");var c=$("<div class='content'></div>"),d=$("<div class='cata history'></div>");d.data("type","history"),d.data("cnt",0),c.append(d),l.append(c),l.append("<div class='cataBtn right'></div>"),e.append(l),i.showHistory(e),l.find(".cataBtn").click(function(){var e=$(this),t=e.parent().find(".content"),i=t.scrollLeft();e.hasClass("right")?t.animate({scrollLeft:i+t.width()},800):t.animate({scrollLeft:i-t.width()},800)});var u=function(){i.isUpdated=!0;for(var t in i.splDict){var a=i.splDict[t],n=$("<div class='cata'></div>"),o=$("<img/>");o.attr("src",a.l),n.append(o),n.data("type",t),c.append(n),i.showImg(e,t,a)}$(e).find(".cata").off("click").click(function(){var t=$(this).data("type");cns.debug(t),$(e).find(".mid").data("type",t);var a=$(e).find(".mid .group:not(."+t+")");a.css("display","none"),a=$(e).find(".mid .group."+t),a.css("display",""),a=$(e).find(".cata.active").removeClass("active"),$(this).addClass("active"),i.showPageCount(e)}),$(e).find(".cata:eq(1)").trigger("click")};i.isUpdated?u():i.load(u)},showImg:function(e,t,i,a){var n=this,o=$(e).find(".mid .group."+t);if(null==o||o.length<=0){o=$("<div class='group'></div>"),$(e).find(".cata.active").hasClass(t)||o.css("display","none"),o.css("left","0"),o.data("index",0),o.data("cata-type",t),o.addClass(t);var s=$(e).find(".mid");s.append(o)}if(1==i.isDownload&&i.list&&Object.keys(i.list).length>0){singleStickerObject=i.list;var r=Object.keys(singleStickerObject).length;o.html("");var l=Math.ceil(r/8),c=Math.floor(1/l*100),d=null,u=null,h=null;o.css("width",100*l+"%"),o.data("cnt",l);var p=0;$.each(singleStickerObject,function(e,t){if(p%8==0){d=$("<div class='page'></div>"),d.css("width",c+"%");var i=d.find(".up:last");u=$("<div class='row up'></div>"),i.length>0?i.after(u):d.append(u),
i=d.find(".down:last"),h=$("<div class='row down'></div>"),i.length>0?i.after(h):d.append(h),o.append(d)}var a=$("<div></div>"),n=null;n=$("<img class='stImg' src="+t.sou+">"),n.data("id",t.sid),n.error(function(){$(this).addClass("error"),$(this).attr("src","images/chatroom/chat_chatroom_icon_nosent.png")}),a.append(n),4>p%8?u.append(a):h.append(a),p++}),$(e).find(".page .row img").off("click").click(function(){var t=$(this),i=t.parents(".group").data("cata-type");if(t.hasClass("error"))return void n.downloadSticker(i,function(e){$("#send-sync-sticker-signal").attr("data-sid",e),$("#send-sync-sticker-signal").click()});var a=t.data("id");cns.debug(a);var o=$.lStorage("_stickerHistory");if(o){for(var s=0;s<o.length;s++)if(o[s].id==a){delete o[s],o.splice(s,1);break}}else o=[];o.push({id:a,src:t.attr("src")}),o.length>40&&o.splice(0,o.length-40),$.lStorage("_stickerHistory",o),n.showHistory(e),$("#send-sync-sticker-signal").removeAttr("data-sid"),$("#send-sync-sticker-signal").click();var r=e.data("callback");null!=r&&r(a)})}else{var f=$("<div class='downloadArea'></div>"),g=$("<div class='info'></div>"),m=$("<div class='left'></div>");m.append("<img src='"+i.l+"'/>"),g.append(m);var v=$("<div class='right'></div>");v.append("<div class='name'>"+i.na+"</div>"),v.append("<div class='price'>"+$.i18n.getString("COMMON_FREE")+"</div>"),g.append(v),f.append(g),f.append("<div class='download'>"+$.i18n.getString("COMMON_DOWNLOAD")+"</div>"),o.append(f),f.find(".download").click(function(){n.downloadSticker(t,function(){})})}},showHistory:function(e){var t=$.lStorage("_stickerHistory");try{if(null!=t){var i={isDownload:!0,list:{},spi:"history"};if(t.length>0){for(var a=t.length-1;a>=0;a--){var n=t[a];i.list[n.id]={sid:n.id,sou:n.src}}this.showImg(e,"history",i)}}}catch(o){errorReport(o)}},showPageCount:function(e){var t=$(e),i=t.find(".mid").data("type");if(null!=i){var a=t.find(".mid .group."+i),n=a.data("cnt");if(a.find(".downloadArea").length>0||1>=n)return t.children(".pageArea").css("opacity",0),void t.children(".imgArea").children(".left, .right").css("opacity",0);if(t.children(".pageArea").css("opacity",1),t.children(".imgArea").children(".left, .right").css("opacity",1),i!=t.find(".pageArea").data("type")){if(t.find(".pageArea").html(""),t.find(".pageArea").data("type",i),1>=n)return;for(var o=0;n>o;o++)t.find(".pageArea").append("<label class='dot'></label>")}else{if(1>=n)return;t.find(".pageArea").find(".dot.active").removeClass("active")}var a=t.find(".mid .group."+i),s=a.data("index");t.find(".pageArea").find(".dot:eq("+s+")").addClass("active")}},load:function(e){var t=this;try{t.getStickerListApi().complete(function(i){if(200==i.status){var a=$.parseJSON(i.responseText);t.splDict=$.lStorage("_sticker")||{};for(var n=0,o=a.spl.length,s={},r=0;o>r;r++){var l=a.spl[r];if(s[l.spi]=l,t.splDict.hasOwnProperty(l.spi)){var c=t.splDict[l.spi],d=c.ut,u=$.extend(c,s[l.spi]);if(1==u.isDownload&&u.ut!=d)t.downloadSticker(u.spi,function(i,a){s[i]=a,n++,o==n&&t.onInitSucc(s,e)},!1);else{if(n++,null!=u.sl&&null==u.list){u.list={};for(var h=t.splDict[l.spi].sl,p=0;p<h.length;p++)u.list[h[p].sid]=h[p];delete u.sl}s[l.spi]=u}}else n++;o==n&&t.onInitSucc(s,e)}}})}catch(i){errorReport(i),e()&&e()}},onInitSucc:function(e,t){var i=this;if(i.isInit=!0,i.splDict=e,$.lStorage("_sticker",i.splDict),null!=t&&t(),i.loadStash.length>0)for(var a=0;a<i.loadStash.length;a++){var n=i.loadStash[a];getStickerPath(n.sid,n.callback)}},getStickerListApi:function(){var e="sticker_packages",t={ui:ui,at:at,li:lang},i="get";return ajaxDo(e,t,i,!1,null)},getStickerDetailApi:function(e){var t="sticker_packages/"+e,i={ui:ui,at:at,li:lang},a="get";return ajaxDo(t,i,a,!1,null)},getSingleStickerPathApi:function(e){var t="stickers/"+e,i={ui:ui,at:at,li:lang},a="get";return ajaxDo(t,i,a,!1,null)},downloadSticker:function(e,t,i){null==i&&(i=!0);var a=this;a.getStickerDetailApi(e).complete(function(n){if(200==n.status){var o;try{var s=$.parseJSON(n.responseText);null==a.splDict[e].list&&(a.splDict[e].list={}),s.sl.sort(function(e,t){try{var i=e.sid.split("_"),a=t.sid.split("_");return parseInt(i[2])-parseInt(a[2])}catch(n){return cns.debug("error sid split",e,t),-1}});for(var r=$.lStorage("_stickerDetail")||{},l=0;l<s.sl.length;l++){var c=s.sl[l];r[c.sid]=c}$.lStorage("_stickerDetail",r),a.splDict[e].list=s.sl,a.splDict[e].isDownload=!0,o=a.splDict[e],$.lStorage("_sticker",a.splDict),i&&a.updateTypeInDomList(e),$("#send-sync-sticker-signal").removeAttr("data-sid"),$("#send-sync-sticker-signal").click()}catch(d){errorReport(d),t&&t(e,o)}}t&&t(e,o)})},updateTypeInDomList:function(e){for(var t=this,i=t.splDict[e],a=t.domList.length-1;a>=0;a--)null==t.domList[a]||0==t.domList[a].length?t.domList.splice(a,1):(t.showImg(t.domList[a],e,i),t.showPageCount(t.domList[a]))},getStickerPath:function(e,t){var i=$.lStorage("_stickerDetail")||{};void 0!==i[e]?t(i[e].sou):(new AjaxTransfer).execute({url:"stickers/"+e,method:"get"}).then(function(e){t(e.sou)})},getStickerPath_bak:function(e,t){var i=this;if(0==i.isInit)return void i.loadStash.push({sid:e,callback:t});try{if(i.isUpdated){var a;a=-1==e.indexOf("st_")?e.split("_")[0]:e.split("_")[1],null!=i.splDict[a].list&&i.splDict[a].list.hasOwnProperty(e)?t(i.splDict[a].list[e].sou):(null==i.splDict[a].list&&(i.splDict[a].list={}),i.getSingleStickerPathApi(e).complete(function(n){if(200==n.status){var o=$.parseJSON(n.responseText);i.splDict.hasOwnProperty(a)?i.splDict[a].list||(i.splDict[a].list={}):i.splDict[a]={list:{}},i.splDict[a].list[e]={sid:e,sou:o.sou,stu:o.stu},t(i.splDict[a].list[e].sou),$.lStorage("_sticker",i.splDict)}else t("")}))}else i.load(function(){i.isUpdated=!0,i.getStickerPath(e,t)})}catch(n){errorReport(n)}},setStickerSrc:function(e,t){this.getStickerPath(t,function(t){e.attr("src",t)})},syncSticker:function(e){var t=this;if(t.domList&&!(t.domList.length<=0)){var i=t.domList.length,a=$.lStorage("_stickerHistory");if(a)try{for(var n={isDownload:!0,list:{},spi:"history"},o=a.length-1;o>=0;o--){var s=a[o];n.list[s.id]={sid:s.id,sou:s.src}}for(var o=0;i>o;o++){var r=t.domList[o];t.showImg(r,"history",n)}}catch(l){errorReport(l)}var c=$.lStorage("_sticker");if(c)try{$.each(t.splDict,function(a,n){if(c.hasOwnProperty(a)&&c[a]&&"history"!=a&&(n.isDownload!=c[a].isDownload||e==a)){t.splDict[a]=c[a];for(var o=0;i>o;o++){var s=t.domList[o];t.showImg(s,a,t.splDict[a])}}})}catch(l){errorReport(l)}}}},CryptoJS=CryptoJS||function(e,t){var i={},a=i.lib={},n=function(){},o=a.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=a.WordArray=o.extend({init:function(e,i){e=this.words=e||[],this.sigBytes=i!=t?i:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,i=e.words,a=this.sigBytes;if(e=e.sigBytes,this.clamp(),a%4)for(var n=0;e>n;n++)t[a+n>>>2]|=(i[n>>>2]>>>24-8*(n%4)&255)<<24-8*((a+n)%4);else if(65535<i.length)for(n=0;e>n;n+=4)t[a+n>>>2]=i[n>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-8*(i%4),t.length=e.ceil(i/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],a=0;t>a;a+=4)i.push(4294967296*e.random()|0);return new s.init(i,t)}}),r=i.enc={},l=r.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],a=0;e>a;a++){var n=t[a>>>2]>>>24-8*(a%4)&255;i.push((n>>>4).toString(16)),i.push((15&n).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],a=0;t>a;a+=2)i[a>>>3]|=parseInt(e.substr(a,2),16)<<24-4*(a%8);return new s.init(i,t/2)}},c=r.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],a=0;e>a;a++)i.push(String.fromCharCode(t[a>>>2]>>>24-8*(a%4)&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],a=0;t>a;a++)i[a>>>2]|=(255&e.charCodeAt(a))<<24-8*(a%4);return new s.init(i,t)}},d=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=a.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,a=i.words,n=i.sigBytes,o=this.blockSize,r=n/(4*o),r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0);if(t=r*o,n=e.min(4*t,n),t){for(var l=0;t>l;l+=o)this._doProcessBlock(a,l);l=a.splice(0,t),i.sigBytes-=n}return new s.init(l,n)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});a.Hasher=u.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new h.HMAC.init(e,i).finalize(t)}}});var h=i.algo={};return i}(Math);!function(){var e=CryptoJS,t=e.lib,i=t.WordArray,a=t.Hasher,n=[],t=e.algo.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,a=i[0],o=i[1],s=i[2],r=i[3],l=i[4],c=0;80>c;c++){if(16>c)n[c]=0|e[t+c];else{var d=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=d<<1|d>>>31}d=(a<<5|a>>>27)+l+n[c],d=20>c?d+((o&s|~o&r)+1518500249):40>c?d+((o^s^r)+1859775393):60>c?d+((o&s|o&r|s&r)-1894007588):d+((o^s^r)-899497514),l=r,r=s,s=o<<30|o>>>2,o=a,a=d}i[0]=i[0]+a|0,i[1]=i[1]+o|0,i[2]=i[2]+s|0,i[3]=i[3]+r|0,i[4]=i[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[(a+64>>>9<<4)+14]=Math.floor(i/4294967296),t[(a+64>>>9<<4)+15]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=a._createHelper(t),e.HmacSHA1=a._createHmacHelper(t)}(),function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,a=this._map;e.clamp(),e=[];for(var n=0;i>n;n+=3)for(var o=(t[n>>>2]>>>24-8*(n%4)&255)<<16|(t[n+1>>>2]>>>24-8*((n+1)%4)&255)<<8|t[n+2>>>2]>>>24-8*((n+2)%4)&255,s=0;4>s&&i>n+.75*s;s++)e.push(a.charAt(o>>>6*(3-s)&63));if(t=a.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var i=e.length,a=this._map,n=a.charAt(64);n&&(n=e.indexOf(n),-1!=n&&(i=n));for(var n=[],o=0,s=0;i>s;s++)if(s%4){var r=a.indexOf(e.charAt(s-1))<<2*(s%4),l=a.indexOf(e.charAt(s))>>>6-2*(s%4);n[o>>>2]|=(r|l)<<24-8*(o%4),o++}return t.create(n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e,t,i,a,n,o,s){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,o=t.createElement(i),s=t.getElementsByTagName(i)[0],o.async=1,o.src=a,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-51655107-5","auto"),ga("send","pageview"),function(e){var t,i={className:"autosizejs",id:"autosizejs",append:"",callback:!1,resizeDelay:10,placeholder:!0},a='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',n=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],o=e(a).data("autosize",!0)[0];o.style.lineHeight="99px","99px"===e(o).css("lineHeight")&&n.push("lineHeight"),o.style.lineHeight="",e.fn.autosize=function(a){return this.length?(a=e.extend({},i,a||{}),o.parentNode!==document.body&&e(document.body).append(o),this.each(function(){function i(){var t,i=window.getComputedStyle?window.getComputedStyle(h,null):!1;i?(t=h.getBoundingClientRect().width,0===t&&(t=parseInt(i.width,10)),e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,a){t-=parseInt(i[a],10)})):t=Math.max(p.width(),0),o.style.width=t+"px"}function s(){var s={};if(t=h,o.className=a.className,o.id=a.id,c=parseInt(p.css("maxHeight"),10),e.each(n,function(e,t){s[t]=p.css(t)}),e(o).css(s).attr("wrap",p.attr("wrap")),i(),window.chrome){var r=h.style.width;h.style.width="0px",h.offsetWidth,h.style.width=r}}function r(){var e,n;t!==h?s():i(),o.value=!h.value&&a.placeholder?(p.attr("placeholder")||"")+a.append:h.value+a.append,o.style.overflowY=h.style.overflowY,n=parseInt(h.style.height,10),o.scrollTop=0,o.scrollTop=9e4,e=o.scrollTop,c&&e>c?(h.style.overflowY="scroll",e=c):(h.style.overflowY="scroll",d>e&&(e=d)),e+=f,n!==e&&(h.style.height=e+"px",g&&a.callback.call(h,h))}function l(){clearTimeout(u),u=setTimeout(function(){var e=p.width();e!==v&&(v=e,r())},parseInt(a.resizeDelay,10))}var c,d,u,h=this,p=e(h),f=0,g=e.isFunction(a.callback),m={height:h.style.height,overflow:h.style.overflow,overflowY:h.style.overflowY,wordWrap:h.style.wordWrap,resize:h.style.resize},v=p.width();p.data("autosize")||(p.data("autosize",!0),("border-box"===p.css("box-sizing")||"border-box"===p.css("-moz-box-sizing")||"border-box"===p.css("-webkit-box-sizing"))&&(f=p.outerHeight()-p.height()),d=Math.max(parseInt(p.css("minHeight"),10)-f||0,p.height()),p.css({overflow:"hidden",overflowY:"scroll",wordWrap:"break-word",resize:"none"===p.css("resize")||"vertical"===p.css("resize")?"none":"horizontal"}),"onpropertychange"in h?"oninput"in h?p.on("input.autosize keyup.autosize",r):p.on("propertychange.autosize",function(){"value"===event.propertyName&&r()}):p.on("input.autosize",r),a.resizeDelay!==!1&&e(window).on("resize.autosize",l),p.on("autosize.resize",r),p.on("autosize.resizeIncludeStyle",function(){t=null,r()}),p.on("autosize.destroy",function(){t=null,clearTimeout(u),e(window).off("resize",l),p.off("autosize").off(".autosize").css(m).removeData("autosize")}),r())})):this}}(window.jQuery||window.$),function(e){"use strict";var t={i18n:{bg:{months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],dayOfWeek:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"]},fa:{months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],dayOfWeek:["یکشنبه","دوشنبه","سه شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"]},ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeek:["Вск","Пн","Вт","Ср","Чт","Пт","Сб"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},el:{months:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],dayOfWeek:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeek:["zo","ma","di","wo","do","vr","za"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeek:["Paz","Pts","Sal","Çar","Per","Cum","Cts"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeek:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeek:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeek:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeek:["nd","pn","wt","śr","cz","pt","sb"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeek:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},da:{months:["January","Februar","Marts","April","Maj","Juni","July","August","September","Oktober","November","December"],dayOfWeek:["Søn","Man","Tir","ons","Tor","Fre","lør"]},ja:{months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["日","月","火","水","木","金","土"]},vi:{months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayOfWeek:["CN","T2","T3","T4","T5","T6","T7"]},sl:{months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],dayOfWeek:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"]}},value:"",lang:"en",format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",startDate:!1,step:60,monthChangeSpinner:!0,closeOnDateSelect:!1,closeOnWithoutClick:!0,timepicker:!0,datepicker:!0,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,lazyInit:!1,mask:!1,validateOnBlur:!0,allowBlank:!0,yearStart:1950,yearEnd:2050,style:"",id:"",fixed:!1,roundTime:"round",className:"",weekends:[],yearOffset:0};Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var i=t||0,a=this.length;a>i;i++)if(this[i]===e)return i;return-1}),Date.prototype.countDaysInMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},e.fn.xdsoftScroller=function(t){return this.each(function(){var i=e(this);if(!e(this).hasClass("xdsoft_scroller_box")){var a=function(e){var t={x:0,y:0};if("touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){var i=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];t.x=i.pageX,t.y=i.pageY}else("mousedown"==e.type||"mouseup"==e.type||"mousemove"==e.type||"mouseover"==e.type||"mouseout"==e.type||"mouseenter"==e.type||"mouseleave"==e.type)&&(t.x=e.pageX,t.y=e.pageY);return t},n=0,o=i.children().eq(0),s=i[0].clientHeight,r=o[0].offsetHeight,l=e('<div class="xdsoft_scrollbar"></div>'),c=e('<div class="xdsoft_scroller"></div>'),d=100,u=!1;l.append(c),i.addClass("xdsoft_scroller_box").append(l),c.on("mousedown.xdsoft_scroller",function(a){s||i.trigger("resize_scroll.xdsoft_scroller",[t]);var o=a.pageY,r=parseInt(c.css("margin-top")),u=l[0].offsetHeight;e(document.body).addClass("xdsoft_noselect"),e([document.body,window]).on("mouseup.xdsoft_scroller",function h(){e([document.body,window]).off("mouseup.xdsoft_scroller",h).off("mousemove.xdsoft_scroller",n).removeClass("xdsoft_noselect")}),e(document.body).on("mousemove.xdsoft_scroller",n=function(e){var t=e.pageY-o+r;0>t&&(t=0),t+c[0].offsetHeight>u&&(t=u-c[0].offsetHeight),i.trigger("scroll_element.xdsoft_scroller",[d?t/d:0])})}),i.on("scroll_element.xdsoft_scroller",function(e,t){s||i.trigger("resize_scroll.xdsoft_scroller",[t,!0]),t=t>1?1:0>t||isNaN(t)?0:t,c.css("margin-top",d*t),o.css("marginTop",-parseInt((r-s)*t))}).on("resize_scroll.xdsoft_scroller",function(e,t,a){s=i[0].clientHeight,r=o[0].offsetHeight;var n=s/r,u=n*l[0].offsetHeight;n>1?c.hide():(c.show(),c.css("height",parseInt(u>10?u:10)),d=l[0].offsetHeight-c[0].offsetHeight,a!==!0&&i.trigger("scroll_element.xdsoft_scroller",[t?t:Math.abs(parseInt(o.css("marginTop")))/(r-s)]))}),i.mousewheel&&i.mousewheel(function(e,t,a,n){var l=Math.abs(parseInt(o.css("marginTop")));return i.trigger("scroll_element.xdsoft_scroller",[(l-20*t)/(r-s)]),e.stopPropagation(),!1}),i.on("touchstart",function(e){u=a(e)}),i.on("touchmove",function(e){if(u){var t=a(e),n=Math.abs(parseInt(o.css("marginTop")));i.trigger("scroll_element.xdsoft_scroller",[(n-(t.y-u.y))/(r-s)]),e.stopPropagation(),e.preventDefault()}}),i.on("touchend touchcancel",function(e){u=!1})}i.trigger("resize_scroll.xdsoft_scroller",[t])})},e.fn.datetimepicker=function(i){var a=48,n=57,o=96,s=105,r=17,l=46,c=13,d=27,u=8,h=37,p=38,f=39,g=40,m=9,v=116,b=65,w=67,_=86,y=90,x=89,k=!1,$=e.isPlainObject(i)||!i?e.extend(!0,{},t,i):e.extend({},t),C=0,S=function(e){e.on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function t(i){e.is(":disabled")||e.is(":hidden")||!e.is(":visible")||e.data("xdsoft_datetimepicker")||(clearTimeout(C),C=setTimeout(function(){e.data("xdsoft_datetimepicker")||T(e),e.off("open.xdsoft focusin.xdsoft mousedown.xdsoft",t).trigger("open.xdsoft")},100))})},T=function(t){function i(){var e=$.value?$.value:t&&t.val&&t.val()?t.val():"";return e&&I.isValidDate(e=Date.parseDate(e,$.format))?C.data("changed",!0):e="",e||$.startDate===!1||(e=I.strToDateTime($.startDate)),e?e:0}var C=e("<div "+($.id?'id="'+$.id+'"':"")+" "+($.style?'style="'+$.style+'"':"")+' class="xdsoft_datetimepicker xdsoft_noselect '+$.className+'"></div>'),S=e('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),T=e('<div class="xdsoft_datepicker active"></div>'),E=e('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span></div><div class="xdsoft_label xdsoft_year"><span></span></div><button type="button" class="xdsoft_next"></button></div>'),O=e('<div class="xdsoft_calendar"></div>'),D=e('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),A=D.find(".xdsoft_time_box").eq(0),M=e('<div class="xdsoft_time_variant"></div>'),P=e('<div class="xdsoft_scrollbar"></div>'),N=(e('<div class="xdsoft_scroller"></div>'),e('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>')),L=e('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>');E.find(".xdsoft_month span").after(N),E.find(".xdsoft_year span").after(L),E.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft",function(t){E.find(".xdsoft_select").hide();var i=e(this).find(".xdsoft_select").eq(0),a=0,n=0;I.currentTime&&(a=I.currentTime[e(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),i.show();for(var o=i.find("div.xdsoft_option"),s=0;s<o.length&&o.eq(s).data("value")!=a;s++)n+=o[0].offsetHeight;return i.xdsoftScroller(n/(i.children()[0].offsetHeight-i[0].clientHeight)),t.stopPropagation(),!1}),E.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft",function(e){e.stopPropagation(),e.preventDefault()}).on("mousedown.xdsoft",".xdsoft_option",function(t){I&&I.currentTime&&I.currentTime[e(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](e(this).data("value")),e(this).parent().parent().hide(),C.trigger("xchange.xdsoft"),$.onChangeMonth&&$.onChangeMonth.call&&$.onChangeMonth.call(C,I.currentTime,C.data("input"))}),C.setOptions=function(i){if($=e.extend(!0,{},$,i),i.allowTimes&&e.isArray(i.allowTimes)&&i.allowTimes.length&&($.allowTimes=e.extend(!0,[],i.allowTimes)),i.weekends&&e.isArray(i.weekends)&&i.weekends.length&&($.weekends=e.extend(!0,[],i.weekends)),!$.open&&!$.opened||$.inline||t.trigger("open.xdsoft"),$.inline&&(F=!0,C.addClass("xdsoft_inline"),t.after(C).hide()),$.inverseButton&&($.next="xdsoft_prev",$.prev="xdsoft_next"),$.datepicker?T.addClass("active"):T.removeClass("active"),$.timepicker?D.addClass("active"):D.removeClass("active"),$.value&&(t&&t.val&&t.val($.value),I.setCurrentTime($.value)),isNaN($.dayOfWeekStart)||parseInt($.dayOfWeekStart)<0||parseInt($.dayOfWeekStart)>6?$.dayOfWeekStart=0:$.dayOfWeekStart=parseInt($.dayOfWeekStart),$.timepickerScrollbar||P.hide(),$.minDate&&/^-(.*)$/.test($.minDate)&&($.minDate=I.strToDateTime($.minDate).dateFormat($.formatDate)),$.maxDate&&/^\+(.*)$/.test($.maxDate)&&($.maxDate=I.strToDateTime($.maxDate).dateFormat($.formatDate)),E.find(".xdsoft_today_button").css("visibility",$.todayButton?"visible":"hidden"),$.mask){var S=function(e){try{if(document.selection&&document.selection.createRange){var t=document.selection.createRange();return t.getBookmark().charCodeAt(2)-2}if(e.setSelectionRange)return e.selectionStart}catch(i){return 0}},O=function(e,t){var e="string"==typeof e||e instanceof String?document.getElementById(e):e;if(!e)return!1;if(e.createTextRange){var i=e.createTextRange();return i.collapse(!0),i.moveEnd(t),i.moveStart(t),i.select(),!0}return e.setSelectionRange?(e.setSelectionRange(t,t),!0):!1},A=function(e,t){var i=e.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return RegExp(i).test(t)};switch(t.off("keydown.xdsoft"),!0){case $.mask===!0:$.mask=$.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59");case"string"==e.type($.mask):A($.mask,t.val())||t.val($.mask.replace(/[0-9]/g,"_")),t.on("keydown.xdsoft",function(i){var C=this.value,T=i.which;switch(!0){case T>=a&&n>=T||T>=o&&s>=T||T==u||T==l:var E=S(this),D=T!=u&&T!=l?String.fromCharCode(T>=o&&s>=T?T-a:T):"_";for(T!=u&&T!=l||!E||(E--,D="_");/[^0-9_]/.test($.mask.substr(E,1))&&E<$.mask.length&&E>0;)E+=T==u||T==l?-1:1;if(C=C.substr(0,E)+D+C.substr(E+1),""==e.trim(C))C=$.mask.replace(/[0-9]/g,"_");else if(E==$.mask.length)break;for(E+=T==u||T==l?0:1;/[^0-9_]/.test($.mask.substr(E,1))&&E<$.mask.length&&E>0;)E+=T==u||T==l?-1:1;A($.mask,C)?(this.value=C,O(this,E)):""==e.trim(C)?this.value=$.mask.replace(/[0-9]/g,"_"):t.trigger("error_input.xdsoft");break;case!!~[b,w,_,y,x].indexOf(T)&&k:case!!~[d,p,g,h,f,v,r,m,c].indexOf(T):return!0}return i.preventDefault(),!1})}}$.validateOnBlur&&t.off("blur.xdsoft").on("blur.xdsoft",function(){$.allowBlank&&!e.trim(e(this).val()).length?(e(this).val(null),C.data("xdsoft_datetime").empty()):Date.parseDate(e(this).val(),$.format)?C.data("xdsoft_datetime").setCurrentTime(e(this).val()):(e(this).val(I.now().dateFormat($.format)),C.data("xdsoft_datetime").setCurrentTime(e(this).val())),C.trigger("changedatetime.xdsoft")}),$.dayOfWeekStartPrev=0==$.dayOfWeekStart?6:$.dayOfWeekStart-1,C.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")},C.data("options",$).on("mousedown.xdsoft",function(e){return e.stopPropagation(),e.preventDefault(),L.hide(),N.hide(),!1});var j=D.find(".xdsoft_time_box");j.append(M),j.xdsoftScroller(),C.on("afterOpen.xdsoft",function(){j.xdsoftScroller()}),C.append(T).append(D),$.withoutCopyright!==!0&&C.append(S),T.append(E).append(O),e("body").append(C);var I=new function(){var e=this;e.now=function(){var e=new Date;return $.yearOffset&&e.setFullYear(e.getFullYear()+$.yearOffset),e},e.currentTime=this.now(),e.isValidDate=function(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())},e.setCurrentTime=function(t){e.currentTime="string"==typeof t?e.strToDateTime(t):e.isValidDate(t)?t:e.now(),C.trigger("xchange.xdsoft")},e.empty=function(){e.currentTime=null},e.getCurrentTime=function(t){return e.currentTime},e.nextMonth=function(){var t=e.currentTime.getMonth()+1;return 12==t&&(e.currentTime.setFullYear(e.currentTime.getFullYear()+1),t=0),e.currentTime.setDate(Math.min(Date.daysInMonth[t],e.currentTime.getDate())),e.currentTime.setMonth(t),$.onChangeMonth&&$.onChangeMonth.call&&$.onChangeMonth.call(C,I.currentTime,C.data("input")),C.trigger("xchange.xdsoft"),t},e.prevMonth=function(){var t=e.currentTime.getMonth()-1;return-1==t&&(e.currentTime.setFullYear(e.currentTime.getFullYear()-1),t=11),e.currentTime.setDate(Math.min(Date.daysInMonth[t],e.currentTime.getDate())),e.currentTime.setMonth(t),$.onChangeMonth&&$.onChangeMonth.call&&$.onChangeMonth.call(C,I.currentTime,C.data("input")),C.trigger("xchange.xdsoft"),t},e.strToDateTime=function(t){var i,a,n=[];return(n=/^(\+|\-)(.*)$/.exec(t))&&(n[2]=Date.parseDate(n[2],$.formatDate))?(i=n[2].getTime()-6e4*n[2].getTimezoneOffset(),a=new Date(I.now().getTime()+parseInt(n[1]+"1")*i)):a=t?Date.parseDate(t,$.format):e.now(),e.isValidDate(a)||(a=e.now()),a},e.strtodate=function(t){var i=t?Date.parseDate(t,$.formatDate):e.now();return e.isValidDate(i)||(i=e.now()),i},e.strtotime=function(t){var i=t?Date.parseDate(t,$.formatTime):e.now();return e.isValidDate(i)||(i=e.now()),i},e.str=function(){return e.currentTime.dateFormat($.format)}};E.find(".xdsoft_today_button").on("mousedown.xdsoft",function(){C.data("changed",!0),I.setCurrentTime(0),C.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){t.val(I.str()),C.trigger("close.xdsoft")}),E.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var t=e(this),i=0,a=!1;!function n(e){I.currentTime.getMonth();t.hasClass($.next)?I.nextMonth():t.hasClass($.prev)&&I.prevMonth(),$.monthChangeSpinner&&!a&&(i=setTimeout(n,e?e:100))}(500),e([document.body,window]).on("mouseup.xdsoft",function o(){clearTimeout(i),a=!0,e([document.body,window]).off("mouseup.xdsoft",o)})}),D.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var t=e(this),i=0,a=!1,n=110;!function o(e){var s=A[0].clientHeight,r=M[0].offsetHeight,l=Math.abs(parseInt(M.css("marginTop")));t.hasClass($.next)&&r-s-$.timeHeightInTimePicker>=l?M.css("marginTop","-"+(l+$.timeHeightInTimePicker)+"px"):t.hasClass($.prev)&&l-$.timeHeightInTimePicker>=0&&M.css("marginTop","-"+(l-$.timeHeightInTimePicker)+"px"),A.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(M.css("marginTop"))/(r-s))]),n=n>10?10:n-10,!a&&(i=setTimeout(o,e?e:n))}(500),e([document.body,window]).on("mouseup.xdsoft",function s(){clearTimeout(i),a=!0,e([document.body,window]).off("mouseup.xdsoft",s)})});var R=0;C.on("xchange.xdsoft",function(t){clearTimeout(R),R=setTimeout(function(){for(var t="",i=new Date(I.currentTime.getFullYear(),I.currentTime.getMonth(),1,12,0,0),a=0,n=I.now();i.getDay()!=$.dayOfWeekStart;)i.setDate(i.getDate()-1);t+="<table><thead><tr>";for(var o=0;7>o;o++)t+="<th>"+$.i18n[$.lang].dayOfWeek[o+$.dayOfWeekStart>6?0:o+$.dayOfWeekStart]+"</th>";t+="</tr></thead>",t+="<tbody><tr>";var s=!1,r=!1;$.maxDate!==!1&&(s=I.strtodate($.maxDate),s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999)),
$.minDate!==!1&&(r=I.strtodate($.minDate),r=new Date(r.getFullYear(),r.getMonth(),r.getDate()));for(var l,c,d,u=[];a<I.currentTime.countDaysInMonth()||i.getDay()!=$.dayOfWeekStart||I.currentTime.getMonth()==i.getMonth();)u=[],a++,l=i.getDate(),c=i.getFullYear(),d=i.getMonth(),u.push("xdsoft_date"),(s!==!1&&i>s||r!==!1&&r>i)&&u.push("xdsoft_disabled"),I.currentTime.getMonth()!=d&&u.push("xdsoft_other_month"),($.defaultSelect||C.data("changed"))&&I.currentTime.dateFormat($.formatDate)==i.dateFormat($.formatDate)&&u.push("xdsoft_current"),n.dateFormat($.formatDate)==i.dateFormat($.formatDate)&&u.push("xdsoft_today"),(0==i.getDay()||6==i.getDay()||~$.weekends.indexOf(i.dateFormat($.formatDate)))&&u.push("xdsoft_weekend"),$.beforeShowDay&&"function"==typeof $.beforeShowDay&&u.push($.beforeShowDay(i)),t+='<td data-date="'+l+'" data-month="'+d+'" data-year="'+c+'" class="xdsoft_date xdsoft_day_of_week'+i.getDay()+" "+u.join(" ")+'"><div>'+l+"</div></td>",i.getDay()==$.dayOfWeekStartPrev&&(t+="</tr>"),i.setDate(l+1);t+="</tbody></table>",O.html(t),E.find(".xdsoft_label span").eq(0).text($.i18n[$.lang].months[I.currentTime.getMonth()]),E.find(".xdsoft_label span").eq(1).text(I.currentTime.getFullYear());var h="",p="",d="",f=function(e,t){var i=I.now();i.setHours(e),e=parseInt(i.getHours()),i.setMinutes(t),t=parseInt(i.getMinutes()),u=[],($.maxTime!==!1&&I.strtotime($.maxTime).getTime()<i.getTime()||$.minTime!==!1&&I.strtotime($.minTime).getTime()>i.getTime())&&u.push("xdsoft_disabled"),($.initTime||$.defaultSelect||C.data("changed"))&&parseInt(I.currentTime.getHours())==parseInt(e)&&($.step>59||Math[$.roundTime](I.currentTime.getMinutes()/$.step)*$.step==parseInt(t))&&($.defaultSelect||C.data("changed")?u.push("xdsoft_current"):$.initTime&&u.push("xdsoft_init_time")),parseInt(n.getHours())==parseInt(e)&&parseInt(n.getMinutes())==parseInt(t)&&u.push("xdsoft_today"),h+='<div class="xdsoft_time '+u.join(" ")+'" data-hour="'+e+'" data-minute="'+t+'">'+i.dateFormat($.formatTime)+"</div>"};if($.allowTimes&&e.isArray($.allowTimes)&&$.allowTimes.length)for(var a=0;a<$.allowTimes.length;a++)p=I.strtotime($.allowTimes[a]).getHours(),d=I.strtotime($.allowTimes[a]).getMinutes(),f(p,d);else for(var a=0,o=0;a<($.hours12?12:24);a++)for(o=0;60>o;o+=$.step)p=(10>a?"0":"")+a,d=(10>o?"0":"")+o,f(p,d);M.html(h);var g="",a=0;for(a=parseInt($.yearStart,10)+$.yearOffset;a<=parseInt($.yearEnd,10)+$.yearOffset;a++)g+='<div class="xdsoft_option '+(I.currentTime.getFullYear()==a?"xdsoft_current":"")+'" data-value="'+a+'">'+a+"</div>";for(L.children().eq(0).html(g),a=0,g="";11>=a;a++)g+='<div class="xdsoft_option '+(I.currentTime.getMonth()==a?"xdsoft_current":"")+'" data-value="'+a+'">'+$.i18n[$.lang].months[a]+"</div>";N.children().eq(0).html(g),e(C).trigger("generate.xdsoft")},10),t.stopPropagation()}).on("afterOpen.xdsoft",function(){if($.timepicker){var e;if(M.find(".xdsoft_current").length?e=".xdsoft_current":M.find(".xdsoft_init_time").length&&(e=".xdsoft_init_time"),e){var t=A[0].clientHeight,i=M[0].offsetHeight,a=M.find(e).index()*$.timeHeightInTimePicker+1;a>i-t&&(a=i-t),A.trigger("scroll_element.xdsoft_scroller",[parseInt(a)/(i-t)])}else A.trigger("scroll_element.xdsoft_scroller",[0])}});var B=0;O.on("click.xdsoft","td",function(i){i.stopPropagation(),B++;var a=e(this),n=I.currentTime;return a.hasClass("xdsoft_disabled")?!1:(n.setDate(1),n.setFullYear(a.data("year")),n.setMonth(a.data("month")),n.setDate(a.data("date")),C.trigger("select.xdsoft",[n]),t.val(I.str()),(B>1||$.closeOnDateSelect===!0||0===$.closeOnDateSelect&&!$.timepicker)&&!$.inline&&C.trigger("close.xdsoft"),$.onSelectDate&&$.onSelectDate.call&&$.onSelectDate.call(C,I.currentTime,C.data("input")),C.data("changed",!0),C.trigger("xchange.xdsoft"),C.trigger("changedatetime.xdsoft"),void setTimeout(function(){B=0},200))}),M.on("click.xdsoft","div",function(t){t.stopPropagation();var i=e(this),a=I.currentTime;return i.hasClass("xdsoft_disabled")?!1:(a.setHours(i.data("hour")),a.setMinutes(i.data("minute")),C.trigger("select.xdsoft",[a]),C.data("input").val(I.str()),!$.inline&&C.trigger("close.xdsoft"),$.onSelectTime&&$.onSelectTime.call&&$.onSelectTime.call(C,I.currentTime,C.data("input")),C.data("changed",!0),C.trigger("xchange.xdsoft"),void C.trigger("changedatetime.xdsoft"))}),C.mousewheel&&T.mousewheel(function(e,t,i,a){return $.scrollMonth?(0>t?I.nextMonth():I.prevMonth(),!1):!0}),C.mousewheel&&A.unmousewheel().mousewheel(function(e,t,i,a){if(!$.scrollTime)return!0;var n=A[0].clientHeight,o=M[0].offsetHeight,s=Math.abs(parseInt(M.css("marginTop"))),r=!0;return 0>t&&o-n-$.timeHeightInTimePicker>=s?(M.css("marginTop","-"+(s+$.timeHeightInTimePicker)+"px"),r=!1):t>0&&s-$.timeHeightInTimePicker>=0&&(M.css("marginTop","-"+(s-$.timeHeightInTimePicker)+"px"),r=!1),A.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(M.css("marginTop"))/(o-n))]),e.stopPropagation(),r});var F=!1;C.on("changedatetime.xdsoft",function(){if($.onChangeDateTime&&$.onChangeDateTime.call){var e=C.data("input");$.onChangeDateTime.call(C,I.currentTime,e),e.trigger("change")}}).on("generate.xdsoft",function(){$.onGenerate&&$.onGenerate.call&&$.onGenerate.call(C,I.currentTime,C.data("input")),F&&(C.trigger("afterOpen.xdsoft"),F=!1)}).on("click.xdsoft",function(e){e.stopPropagation()});var H=0;t.mousewheel&&t.mousewheel(function(e,i,a,n){return $.scrollInput?!$.datepicker&&$.timepicker?(H=M.find(".xdsoft_current").length?M.find(".xdsoft_current").eq(0).index():0,H+i>=0&&H+i<M.children().length&&(H+=i),M.children().eq(H).length&&M.children().eq(H).trigger("mousedown"),!1):$.datepicker&&!$.timepicker?(T.trigger(e,[i,a,n]),t.val&&t.val(I.str()),C.trigger("changedatetime.xdsoft"),!1):void 0:!0});var q=function(){var t=C.data("input").offset(),i=t.top+C.data("input")[0].offsetHeight-1,a=t.left,n="absolute";$.fixed?(i-=e(window).scrollTop(),a-=e(window).scrollLeft(),n="fixed"):(i+C[0].offsetHeight>e(window).height()+e(window).scrollTop()&&(i=t.top-C[0].offsetHeight+1),0>i&&(i=0),a+C[0].offsetWidth>e(window).width()&&(a=t.left-C[0].offsetWidth+C.data("input")[0].offsetWidth)),C.css({left:a,top:i,position:n})};C.on("open.xdsoft",function(){var t=!0;$.onShow&&$.onShow.call&&(t=$.onShow.call(C,I.currentTime,C.data("input"))),t!==!1&&(C.show(),q(),e(window).off("resize.xdsoft",q).on("resize.xdsoft",q),$.closeOnWithoutClick&&e([document.body,window]).on("mousedown.xdsoft",function i(){C.trigger("close.xdsoft"),e([document.body,window]).off("mousedown.xdsoft",i)}))}).on("close.xdsoft",function(e){var t=!0;$.onClose&&$.onClose.call&&(t=$.onClose.call(C,I.currentTime,C.data("input"))),t===!1||$.opened||$.inline||C.hide(),e.stopPropagation()}).data("input",t);var z=0;C.data("xdsoft_datetime",I),C.setOptions($),I.setCurrentTime(i()),t.data("xdsoft_datetimepicker",C).on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function(e){t.is(":disabled")||t.is(":hidden")||!t.is(":visible")||(clearTimeout(z),z=setTimeout(function(){t.is(":disabled")||t.is(":hidden")||!t.is(":visible")||(F=!0,I.setCurrentTime(i()),C.trigger("open.xdsoft"))},100))}).on("keydown.xdsoft",function(t){var i=(this.value,t.which);switch(!0){case!!~[c].indexOf(i):var a=e("input:visible,textarea:visible");return C.trigger("close.xdsoft"),a.eq(a.index(this)+1).focus(),!1;case!!~[m].indexOf(i):return C.trigger("close.xdsoft"),!0}})},E=function(t){var i=t.data("xdsoft_datetimepicker");i&&(i.data("xdsoft_datetime",null),i.remove(),t.data("xdsoft_datetimepicker",null).off("open.xdsoft focusin.xdsoft focusout.xdsoft mousedown.xdsoft blur.xdsoft keydown.xdsoft"),e(window).off("resize.xdsoft"),e([window,document.body]).off("mousedown.xdsoft"),t.unmousewheel&&t.unmousewheel())};return e(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(e){e.keyCode==r&&(k=!0)}).on("keyup.xdsoftctrl",function(e){e.keyCode==r&&(k=!1)}),this.each(function(){var t;if(t=e(this).data("xdsoft_datetimepicker")){if("string"===e.type(i))switch(i){case"show":e(this).select().focus(),t.trigger("open.xdsoft");break;case"hide":t.trigger("close.xdsoft");break;case"destroy":E(e(this));break;case"reset":this.value=this.defaultValue,this.value&&t.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value,$.format))||t.data("changed",!1),t.data("xdsoft_datetime").setCurrentTime(this.value)}else t.setOptions(i);return 0}"string"!==e.type(i)&&(!$.lazyInit||$.open||$.inline?T(e(this)):S(e(this)))})}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var n,o=t||window.event,s=[].slice.call(arguments,1),r=0,l=0,c=0,d=0,u=0;return t=e.event.fix(o),t.type="mousewheel",o.wheelDelta&&(r=o.wheelDelta),o.detail&&(r=-1*o.detail),o.deltaY&&(c=-1*o.deltaY,r=c),o.deltaX&&(l=o.deltaX,r=-1*l),void 0!==o.wheelDeltaY&&(c=o.wheelDeltaY),void 0!==o.wheelDeltaX&&(l=-1*o.wheelDeltaX),d=Math.abs(r),(!i||i>d)&&(i=d),u=Math.max(Math.abs(c),Math.abs(l)),(!a||a>u)&&(a=u),n=r>0?"floor":"ceil",r=Math[n](r/i),l=Math[n](l/a),c=Math[n](c/a),s.unshift(t,r,l,c),(e.event.dispatch||e.event.handle).apply(this,s)}var i,a,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(e.event.fixHooks)for(var s=n.length;s;)e.event.fixHooks[n[--s]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=o.length;e;)this.addEventListener(o[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=o.length;e;)this.removeEventListener(o[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(e){if("unixtime"==e)return parseInt(this.getTime()/1e3);null==Date.formatFunctions[e]&&Date.createNewFormat(e);var t=Date.formatFunctions[e];return this[t]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;for(var code="Date.prototype."+funcName+" = function() {return ",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,code+="'"+String.escape(ch)+"' + "):code+=Date.getFormatCode(ch):special=!0;eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(e){switch(e){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(e)+"' + "}},Date.parseDate=function(e,t){if("unixtime"==t)return new Date(isNaN(parseInt(e))?0:1e3*parseInt(e));null==Date.parseFunctions[t]&&Date.createParser(t);var i=Date.parseFunctions[t];return Date[i](e)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;for(var code="Date."+funcName+" = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, z = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,regex+=String.escape(ch)):(obj=Date.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c)):special=!0;code+="if (y > 0 && z > 0){\nvar doyDate = new Date(y,0);\ndoyDate.setDate(z);\nm = doyDate.getMonth();\nd = doyDate.getDate();\n}",code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(e,t){switch(e){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+t+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:1,c:"z = parseInt(results["+t+"], 10);\n",s:"(\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+t+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+t+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+t+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+t+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+t+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+t+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+t+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+t+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+t+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+t+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(e)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,"0")},Date.prototype.getDayOfYear=function(){var e=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var t=0;t<this.getMonth();++t)e+=Date.daysInMonth[t];return e+this.getDate()},Date.prototype.getWeekOfYear=function(){var e=this.getDayOfYear()+(4-this.getDay()),t=new Date(this.getFullYear(),0,1),i=7-t.getDay()+4;return String.leftPad(Math.ceil((e-i)/7)+1,2,"0")},Date.prototype.isLeapYear=function(){var e=this.getFullYear();return 0==(3&e)&&(e%100||e%400==0&&e)},Date.prototype.getFirstDayOfMonth=function(){var e=(this.getDay()-(this.getDate()-1))%7;return 0>e?e+7:e},Date.prototype.getLastDayOfMonth=function(){var e=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return 0>e?e+7:e},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},String.escape=function(e){return e.replace(/('|\\)/g,"\\$1")},String.leftPad=function(e,t,i){var a=new String(e);for(null==i&&(i=" ");a.length<t;)a=i+a;return a},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"},window.Modernizr=function(e,t,i){function a(e,t){var i=e.charAt(0).toUpperCase()+e.substr(1),a=(e+" "+w.join(i+" ")+i).split(" ");return n(a,t)}function n(e,t){for(var a in e)if(v[e[a]]!==i)return"pfx"==t?e[a]:!0;return!1}function o(e,t){return!!~(""+e).indexOf(t)}function s(e,t){return typeof e===t}function r(e){v.cssText=e}var l,c,d,u="2.0.6",h={},p=!0,f=t.documentElement,g=(t.head||t.getElementsByTagName("head")[0],"modernizr"),m=t.createElement(g),v=m.style,b=(Object.prototype.toString," -webkit- -moz- -o- -ms- -khtml- ".split(" ")),w="Webkit Moz O ms Khtml".split(" "),_={},y=[],x=function(e,i,a,n){var o,s,r,l=t.createElement("div");if(parseInt(a,10))for(;a--;)r=t.createElement("div"),r.id=n?n[a]:g+(a+1),l.appendChild(r);return o=["&shy;","<style>",e,"</style>"].join(""),l.id=g,l.innerHTML+=o,f.appendChild(l),s=i(l,e),l.parentNode.removeChild(l),!!s},k=function(t){if(e.matchMedia)return matchMedia(t).matches;var i;return x("@media "+t+" { #"+g+" { position: absolute; } }",function(t){i="absolute"==(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position}),i},$={}.hasOwnProperty;d=s($,i)||s($.call,i)?function(e,t){return t in e&&s(e.constructor.prototype[t],i)}:function(e,t){return $.call(e,t)},_.rgba=function(){return r("background-color:rgba(150,255,150,.5)"),o(v.backgroundColor,"rgba")},_.boxshadow=function(){return a("boxShadow")},_.csstransitions=function(){return a("transitionProperty")};for(var C in _)d(_,C)&&(c=C.toLowerCase(),h[c]=_[C](),y.push((h[c]?"":"no-")+c));return h.addTest=function(e,t){if("object"==typeof e)for(var a in e)d(e,a)&&h.addTest(a,e[a]);else{if(e=e.toLowerCase(),h[e]!==i)return;t="boolean"==typeof t?t:!!t(),f.className+=" "+(t?"":"no-")+e,h[e]=t}return h},r(""),m=l=null,e.attachEvent&&function(){var e=t.createElement("div");return e.innerHTML="<elem></elem>",1!==e.childNodes.length}()&&function(e,t){function a(e){for(var t=-1;++t<l;)e.createElement(r[t])}e.iepp=e.iepp||{};var n,o=e.iepp,s=o.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",r=s.split("|"),l=r.length,c=new RegExp("(^|\\s)("+s+")","gi"),d=new RegExp("<(/*)("+s+")","gi"),u=/^\s*[\{\}]\s*$/,h=new RegExp("(^|[^\\n]*?\\s)("+s+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),p=t.createDocumentFragment(),f=t.documentElement,g=f.firstChild,m=t.createElement("body"),v=t.createElement("style"),b=/print|all/;o.getCSS=function(e,t){if(e+""===i)return"";for(var a,n=-1,s=e.length,r=[];++n<s;)a=e[n],a.disabled||(t=a.media||t,b.test(t)&&r.push(o.getCSS(a.imports,t),a.cssText),t="all");return r.join("")},o.parseCSS=function(e){for(var t,i=[];null!=(t=h.exec(e));)i.push(((u.exec(t[1])?"\n":t[1])+t[2]+t[3]).replace(c,"$1.iepp_$2")+t[4]);return i.join("\n")},o.writeHTML=function(){var e=-1;for(n=n||t.body;++e<l;)for(var i=t.getElementsByTagName(r[e]),a=i.length,o=-1;++o<a;)i[o].className.indexOf("iepp_")<0&&(i[o].className+=" iepp_"+r[e]);p.appendChild(n),f.appendChild(m),m.className=n.className,m.id=n.id,m.innerHTML=n.innerHTML.replace(d,"<$1font")},o._beforePrint=function(){v.styleSheet.cssText=o.parseCSS(o.getCSS(t.styleSheets,"all")),o.writeHTML()},o.restoreHTML=function(){m.innerHTML="",f.removeChild(m),f.appendChild(n)},o._afterPrint=function(){o.restoreHTML(),v.styleSheet.cssText=""},a(t),a(p),o.disablePP||(g.insertBefore(v,g.firstChild),v.media="print",v.className="iepp-printshim",e.attachEvent("onbeforeprint",o._beforePrint),e.attachEvent("onafterprint",o._afterPrint))}(e,t),h._version=u,h._prefixes=b,h._domPrefixes=w,h.mq=k,h.testProp=function(e){return n([e])},h.testAllProps=a,h.testStyles=x,f.className=f.className.replace(/\bno-js\b/,"")+(p?" js "+y.join(" "):""),h}(this,this.document),function(e,t){function i(){b(!0)}if(e.respond={},respond.update=function(){},respond.mediaQueriesSupported=t,!t){var a,n,o=e.document,s=o.documentElement,r=[],l=[],c=[],d={},u=30,h=o.getElementsByTagName("head")[0]||s,p=h.getElementsByTagName("link"),f=[],g=function(){for(var t,i,a,n,o=p,s=o.length,r=0;s>r;r++)t=o[r],i=t.href,a=t.media,n=t.rel&&"stylesheet"===t.rel.toLowerCase(),!!i&&n&&!d[i]&&(/^([a-zA-Z]+?:(\/\/)?(www\.)?)/.test(i)&&i.replace(RegExp.$1,"").split("/")[0]!==e.location.host?d[i]=!0:f.push({href:i,media:a}));m()},m=function(){if(f.length){var e=f.shift();w(e.href,function(t){v(t,e.href,e.media),d[e.href]=!0,m()})}},v=function(e,t,i){var a,n,o,s,c,d=e.match(/@media[^\{]+\{([^\{\}]+\{[^\}\{]+\})+/gi),u=d&&d.length||0,t=t.substring(0,t.lastIndexOf("/")),h=function(e){return e.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+t+"$2$3")},p=!u&&i,f=0;for(t.length&&(t+="/"),p&&(u=1);u>f;f++)for(a=0,p?(n=i,l.push(h(e))):(n=d[f].match(/@media ([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,l.push(RegExp.$2&&h(RegExp.$2))),s=n.split(","),c=s.length;c>a;a++)o=s[a],r.push({media:o.match(/(only\s+)?([a-zA-Z]+)(\sand)?/)&&RegExp.$2,rules:l.length-1,minw:o.match(/\(min\-width:[\s]*([\s]*[0-9]+)px[\s]*\)/)&&parseFloat(RegExp.$1),maxw:o.match(/\(max\-width:[\s]*([\s]*[0-9]+)px[\s]*\)/)&&parseFloat(RegExp.$1)});b()},b=function(e){var t="clientWidth",i=s[t],d="CSS1Compat"===o.compatMode&&i||o.body[t]||i,f={},g=o.createDocumentFragment(),m=p[p.length-1],v=(new Date).getTime();if(e&&a&&u>v-a)clearTimeout(n),n=setTimeout(b,u);else{a=v;for(var w in r){var _=r[w];(!_.minw&&!_.maxw||(!_.minw||_.minw&&d>=_.minw)&&(!_.maxw||_.maxw&&d<=_.maxw))&&(f[_.media]||(f[_.media]=[]),f[_.media].push(l[_.rules]))}for(var w in c)c[w]&&c[w].parentNode===h&&h.removeChild(c[w]);for(var w in f){var y=o.createElement("style"),x=f[w].join("\n");y.type="text/css",y.media=w,y.styleSheet?y.styleSheet.cssText=x:y.appendChild(o.createTextNode(x)),g.appendChild(y),c.push(y)}h.insertBefore(g,m.nextSibling)}},w=function(e,t){var i=_();if(i){if(i.open("GET",e,!0),i.onreadystatechange=function(){4==i.readyState&&(200==i.status||304==i.status)&&t(i.responseText)},4==i.readyState)return;i.send()}},_=function(){for(var e=!1,t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new XMLHttpRequest}],i=t.length;i--;){try{e=t[i]()}catch(a){continue}break}return function(){return e}}();g(),respond.update=g,e.addEventListener?e.addEventListener("resize",i,!1):e.attachEvent&&e.attachEvent("onresize",i)}}(this,Modernizr.mq("only all")),function(e,t,i){function a(e){return!e||"loaded"==e||"complete"==e}function n(){for(var e=1,t=-1;v.length-++t&&(!v[t].s||(e=v[t].r)););e&&r()}function o(e){var i,o=t.createElement("script");o.src=e.s,o.onreadystatechange=o.onload=function(){!i&&a(o.readyState)&&(i=1,n(),o.onload=o.onreadystatechange=null)},f(function(){i||(i=1,n())},h.errorTimeout),e.e?o.onload():g.parentNode.insertBefore(o,g)}function s(e){var i,a=t.createElement("link");if(a.href=e.s,a.rel="stylesheet",a.type="text/css",e.e||!k&&!w)a.onload=function(){i||(i=1,f(function(){n()},0))},e.e&&a.onload();else{var o=function(e){f(function(){if(!i)try{e.sheet.cssRules.length?(i=1,n()):o(e)}catch(t){1e3==t.code||"security"==t.message||"denied"==t.message?(i=1,f(function(){n()},0)):o(e)}},0)};o(a)}f(function(){i||(i=1,n())},h.errorTimeout),!e.e&&g.parentNode.insertBefore(a,g)}function r(){var e=v.shift();b=1,e?e.t?f(function(){"c"==e.t?s(e):o(e)},0):(e(),n()):b=0}function l(e,i,o,s,l,c){function d(){!p&&a(u.readyState)&&(m.r=p=1,!b&&n(),u.onload=u.onreadystatechange=null,f(function(){y.removeChild(u)},0))}var u=t.createElement(e),p=0,m={t:o,s:i,e:c};u.src=u.data=i,!_&&(u.style.display="none"),u.width=u.height="0","object"!=e&&(u.type=o),u.onload=u.onreadystatechange=d,"img"==e?u.onerror=d:"script"==e&&(u.onerror=function(){m.e=m.r=1,r()}),v.splice(s,0,m),y.insertBefore(u,_?null:g),f(function(){p||(y.removeChild(u),m.r=m.e=p=1,n())},h.errorTimeout)}function c(e,t,i){var a="c"==t?S:C;return b=0,t=t||"j",O(e)?l(a,e,t,this.i++,p,i):(v.splice(this.i++,0,e),1==v.length&&r()),this}function d(){var e=h;return e.loader={load:c,i:0},e}var u,h,p=t.documentElement,f=e.setTimeout,g=t.getElementsByTagName("script")[0],m={}.toString,v=[],b=0,w="MozAppearance"in p.style,_=w&&!!t.createRange().compareNode,y=_?p:g.parentNode,x=e.opera&&"[object Opera]"==m.call(e.opera),k="webkitAppearance"in p.style,$=k&&"async"in t.createElement("script"),C=w?"object":x||$?"img":"script",S=k?"img":C,T=Array.isArray||function(e){return"[object Array]"==m.call(e)},E=function(e){return Object(e)===e},O=function(e){return"string"==typeof e},D=function(e){return"[object Function]"==m.call(e)},A=[],M={};h=function(e){function t(e){var t,i,a=e.split("!"),n=A.length,o=a.pop(),s=a.length,r={url:o,origUrl:o,prefixes:a};for(i=0;s>i;i++)t=M[a[i]],t&&(r=t(r));for(i=0;n>i;i++)r=A[i](r);return r}function a(e,a,n,o,s){var r=t(e),l=r.autoCallback;if(!r.bypass){if(a&&(a=D(a)?a:a[e]||a[o]||a[e.split("/").pop().split("?")[0]]),r.instead)return r.instead(e,a,n,o,s);n.load(r.url,r.forceCSS||!r.forceJS&&/css$/.test(r.url)?"c":i,r.noexec),(D(a)||D(l))&&n.load(function(){d(),a&&a(r.origUrl,s,o),l&&l(r.origUrl,s,o)})}}function n(e,t){function i(e){if(O(e))a(e,l,t,0,o);else if(E(e))for(n in e)e.hasOwnProperty(n)&&a(e[n],l,t,n,o)}var n,o=!!e.test,s=o?e.yep:e.nope,r=e.load||e.both,l=e.callback;i(s),i(r),e.complete&&t.load(e.complete)}var o,s,r=this.yepnope.loader;if(O(e))a(e,0,r,0);else if(T(e))for(o=0;o<e.length;o++)s=e[o],O(s)?a(s,0,r,0):T(s)?h(s):E(s)&&n(s,r);else E(e)&&n(e,r)},h.addPrefix=function(e,t){M[e]=t},h.addFilter=function(e){A.push(e)},h.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=d()}(this,this.document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},function(e){e.flexslider=function(t,i){var a=e(t);a.vars=e.extend({},e.flexslider.defaults,i);var n,o=a.vars.namespace,s=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture,r=("ontouchstart"in window||s||window.DocumentTouch&&document instanceof DocumentTouch)&&a.vars.touch,l="click touchend MSPointerUp",c="",d="vertical"===a.vars.direction,u=a.vars.reverse,h=a.vars.itemWidth>0,p="fade"===a.vars.animation,f=""!==a.vars.asNavFor,g={},m=!0;e.data(t,"flexslider",a),g={init:function(){a.animating=!1,a.currentSlide=parseInt(a.vars.startAt?a.vars.startAt:0,10),isNaN(a.currentSlide)&&(a.currentSlide=0),a.animatingTo=a.currentSlide,a.atEnd=0===a.currentSlide||a.currentSlide===a.last,a.containerSelector=a.vars.selector.substr(0,a.vars.selector.search(" ")),a.slides=e(a.vars.selector,a),a.container=e(a.containerSelector,a),a.count=a.slides.length,a.syncExists=e(a.vars.sync).length>0,"slide"===a.vars.animation&&(a.vars.animation="swing"),a.prop=d?"top":"marginLeft",a.args={},a.manualPause=!1,a.stopped=!1,a.started=!1,a.startTimeout=null,a.transitions=!a.vars.video&&!p&&a.vars.useCSS&&function(){var e=document.createElement("div"),t=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t)if(void 0!==e.style[t[i]])return a.pfx=t[i].replace("Perspective","").toLowerCase(),a.prop="-"+a.pfx+"-transform",!0;return!1}(),a.ensureAnimationEnd="",""!==a.vars.controlsContainer&&(a.controlsContainer=e(a.vars.controlsContainer).length>0&&e(a.vars.controlsContainer)),""!==a.vars.manualControls&&(a.manualControls=e(a.vars.manualControls).length>0&&e(a.vars.manualControls)),a.vars.randomize&&(a.slides.sort(function(){return Math.round(Math.random())-.5}),a.container.empty().append(a.slides)),a.doMath(),a.setup("init"),a.vars.controlNav&&g.controlNav.setup(),a.vars.directionNav&&g.directionNav.setup(),a.vars.keyboard&&(1===e(a.containerSelector).length||a.vars.multipleKeyboard)&&e(document).bind("keyup",function(e){var t=e.keyCode;if(!a.animating&&(39===t||37===t)){var i=39===t?a.getTarget("next"):37===t?a.getTarget("prev"):!1;a.flexAnimate(i,a.vars.pauseOnAction)}}),a.vars.mousewheel&&a.bind("mousewheel",function(e,t,i,n){e.preventDefault();var o=0>t?a.getTarget("next"):a.getTarget("prev");a.flexAnimate(o,a.vars.pauseOnAction)}),a.vars.pausePlay&&g.pausePlay.setup(),a.vars.slideshow&&a.vars.pauseInvisible&&g.pauseInvisible.init(),a.vars.slideshow&&(a.vars.pauseOnHover&&a.hover(function(){a.manualPlay||a.manualPause||a.pause()},function(){a.manualPause||a.manualPlay||a.stopped||a.play()}),a.vars.pauseInvisible&&g.pauseInvisible.isHidden()||(a.vars.initDelay>0?a.startTimeout=setTimeout(a.play,a.vars.initDelay):a.play())),f&&g.asNav.setup(),r&&a.vars.touch&&g.touch(),(!p||p&&a.vars.smoothHeight)&&e(window).bind("resize orientationchange focus",g.resize),a.find("img").attr("draggable","false"),setTimeout(function(){a.vars.start(a)},200)},asNav:{setup:function(){a.asNav=!0,a.animatingTo=Math.floor(a.currentSlide/a.move),a.currentItem=a.currentSlide,a.slides.removeClass(o+"active-slide").eq(a.currentItem).addClass(o+"active-slide"),s?(t._slider=a,a.slides.each(function(){var t=this;t._gesture=new MSGesture,t._gesture.target=t,t.addEventListener("MSPointerDown",function(e){e.preventDefault(),e.currentTarget._gesture&&e.currentTarget._gesture.addPointer(e.pointerId)},!1),t.addEventListener("MSGestureTap",function(t){t.preventDefault();var i=e(this),n=i.index();e(a.vars.asNavFor).data("flexslider").animating||i.hasClass("active")||(a.direction=a.currentItem<n?"next":"prev",a.flexAnimate(n,a.vars.pauseOnAction,!1,!0,!0))})})):a.slides.on(l,function(t){t.preventDefault();var i=e(this),n=i.index(),s=i.offset().left-e(a).scrollLeft();0>=s&&i.hasClass(o+"active-slide")?a.flexAnimate(a.getTarget("prev"),!0):e(a.vars.asNavFor).data("flexslider").animating||i.hasClass(o+"active-slide")||(a.direction=a.currentItem<n?"next":"prev",a.flexAnimate(n,a.vars.pauseOnAction,!1,!0,!0))})}},controlNav:{setup:function(){a.manualControls?g.controlNav.setupManual():g.controlNav.setupPaging()},setupPaging:function(){var t,i,n="thumbnails"===a.vars.controlNav?"control-thumbs":"control-paging",s=1;if(a.controlNavScaffold=e('<ol class="'+o+"control-nav "+o+n+'"></ol>'),a.pagingCount>1)for(var r=0;r<a.pagingCount;r++){if(i=a.slides.eq(r),t="thumbnails"===a.vars.controlNav?'<img src="'+i.attr("data-thumb")+'"/>':"<a>"+s+"</a>","thumbnails"===a.vars.controlNav&&!0===a.vars.thumbCaptions){var d=i.attr("data-thumbcaption");""!=d&&void 0!=d&&(t+='<span class="'+o+'caption">'+d+"</span>")}a.controlNavScaffold.append("<li>"+t+"</li>"),s++}a.controlsContainer?e(a.controlsContainer).append(a.controlNavScaffold):a.append(a.controlNavScaffold),
g.controlNav.set(),g.controlNav.active(),a.controlNavScaffold.delegate("a, img",l,function(t){if(t.preventDefault(),""===c||c===t.type){var i=e(this),n=a.controlNav.index(i);i.hasClass(o+"active")||(a.direction=n>a.currentSlide?"next":"prev",a.flexAnimate(n,a.vars.pauseOnAction))}""===c&&(c=t.type),g.setToClearWatchedEvent()})},setupManual:function(){a.controlNav=a.manualControls,g.controlNav.active(),a.controlNav.bind(l,function(t){if(t.preventDefault(),""===c||c===t.type){var i=e(this),n=a.controlNav.index(i);i.hasClass(o+"active")||(n>a.currentSlide?a.direction="next":a.direction="prev",a.flexAnimate(n,a.vars.pauseOnAction))}""===c&&(c=t.type),g.setToClearWatchedEvent()})},set:function(){var t="thumbnails"===a.vars.controlNav?"img":"a";a.controlNav=e("."+o+"control-nav li "+t,a.controlsContainer?a.controlsContainer:a)},active:function(){a.controlNav.removeClass(o+"active").eq(a.animatingTo).addClass(o+"active")},update:function(t,i){a.pagingCount>1&&"add"===t?a.controlNavScaffold.append(e("<li><a>"+a.count+"</a></li>")):1===a.pagingCount?a.controlNavScaffold.find("li").remove():a.controlNav.eq(i).closest("li").remove(),g.controlNav.set(),a.pagingCount>1&&a.pagingCount!==a.controlNav.length?a.update(i,t):g.controlNav.active()}},directionNav:{setup:function(){var t=e('<ul class="'+o+'direction-nav"><li><a class="'+o+'prev" href="#">'+a.vars.prevText+'</a></li><li><a class="'+o+'next" href="#">'+a.vars.nextText+"</a></li></ul>");a.controlsContainer?(e(a.controlsContainer).append(t),a.directionNav=e("."+o+"direction-nav li a",a.controlsContainer)):(a.append(t),a.directionNav=e("."+o+"direction-nav li a",a)),g.directionNav.update(),a.directionNav.bind(l,function(t){t.preventDefault();var i;(""===c||c===t.type)&&(i=e(this).hasClass(o+"next")?a.getTarget("next"):a.getTarget("prev"),a.flexAnimate(i,a.vars.pauseOnAction)),""===c&&(c=t.type),g.setToClearWatchedEvent()})},update:function(){var e=o+"disabled";1===a.pagingCount?a.directionNav.addClass(e).attr("tabindex","-1"):a.vars.animationLoop?a.directionNav.removeClass(e).removeAttr("tabindex"):0===a.animatingTo?a.directionNav.removeClass(e).filter("."+o+"prev").addClass(e).attr("tabindex","-1"):a.animatingTo===a.last?a.directionNav.removeClass(e).filter("."+o+"next").addClass(e).attr("tabindex","-1"):a.directionNav.removeClass(e).removeAttr("tabindex")}},pausePlay:{setup:function(){var t=e('<div class="'+o+'pauseplay"><a></a></div>');a.controlsContainer?(a.controlsContainer.append(t),a.pausePlay=e("."+o+"pauseplay a",a.controlsContainer)):(a.append(t),a.pausePlay=e("."+o+"pauseplay a",a)),g.pausePlay.update(a.vars.slideshow?o+"pause":o+"play"),a.pausePlay.bind(l,function(t){t.preventDefault(),(""===c||c===t.type)&&(e(this).hasClass(o+"pause")?(a.manualPause=!0,a.manualPlay=!1,a.pause()):(a.manualPause=!1,a.manualPlay=!0,a.play())),""===c&&(c=t.type),g.setToClearWatchedEvent()})},update:function(e){"play"===e?a.pausePlay.removeClass(o+"pause").addClass(o+"play").html(a.vars.playText):a.pausePlay.removeClass(o+"play").addClass(o+"pause").html(a.vars.pauseText)}},touch:function(){function e(e){a.animating?e.preventDefault():(window.navigator.msPointerEnabled||1===e.touches.length)&&(a.pause(),m=d?a.h:a.w,b=Number(new Date),_=e.touches[0].pageX,y=e.touches[0].pageY,g=h&&u&&a.animatingTo===a.last?0:h&&u?a.limit-(a.itemW+a.vars.itemMargin)*a.move*a.animatingTo:h&&a.currentSlide===a.last?a.limit:h?(a.itemW+a.vars.itemMargin)*a.move*a.currentSlide:u?(a.last-a.currentSlide+a.cloneOffset)*m:(a.currentSlide+a.cloneOffset)*m,c=d?y:_,f=d?_:y,t.addEventListener("touchmove",i,!1),t.addEventListener("touchend",n,!1))}function i(e){_=e.touches[0].pageX,y=e.touches[0].pageY,v=d?c-y:c-_,w=d?Math.abs(v)<Math.abs(_-f):Math.abs(v)<Math.abs(y-f);var t=500;(!w||Number(new Date)-b>t)&&(e.preventDefault(),!p&&a.transitions&&(a.vars.animationLoop||(v/=0===a.currentSlide&&0>v||a.currentSlide===a.last&&v>0?Math.abs(v)/m+2:1),a.setProps(g+v,"setTouch")))}function n(e){if(t.removeEventListener("touchmove",i,!1),a.animatingTo===a.currentSlide&&!w&&null!==v){var o=u?-v:v,s=o>0?a.getTarget("next"):a.getTarget("prev");a.canAdvance(s)&&(Number(new Date)-b<550&&Math.abs(o)>50||Math.abs(o)>m/2)?a.flexAnimate(s,a.vars.pauseOnAction):p||a.flexAnimate(a.currentSlide,a.vars.pauseOnAction,!0)}t.removeEventListener("touchend",n,!1),c=null,f=null,v=null,g=null}function o(e){e.stopPropagation(),a.animating?e.preventDefault():(a.pause(),t._gesture.addPointer(e.pointerId),x=0,m=d?a.h:a.w,b=Number(new Date),g=h&&u&&a.animatingTo===a.last?0:h&&u?a.limit-(a.itemW+a.vars.itemMargin)*a.move*a.animatingTo:h&&a.currentSlide===a.last?a.limit:h?(a.itemW+a.vars.itemMargin)*a.move*a.currentSlide:u?(a.last-a.currentSlide+a.cloneOffset)*m:(a.currentSlide+a.cloneOffset)*m)}function r(e){e.stopPropagation();var i=e.target._slider;if(i){var a=-e.translationX,n=-e.translationY;return x+=d?n:a,v=x,w=d?Math.abs(x)<Math.abs(-a):Math.abs(x)<Math.abs(-n),e.detail===e.MSGESTURE_FLAG_INERTIA?void setImmediate(function(){t._gesture.stop()}):void((!w||Number(new Date)-b>500)&&(e.preventDefault(),!p&&i.transitions&&(i.vars.animationLoop||(v=x/(0===i.currentSlide&&0>x||i.currentSlide===i.last&&x>0?Math.abs(x)/m+2:1)),i.setProps(g+v,"setTouch"))))}}function l(e){e.stopPropagation();var t=e.target._slider;if(t){if(t.animatingTo===t.currentSlide&&!w&&null!==v){var i=u?-v:v,a=i>0?t.getTarget("next"):t.getTarget("prev");t.canAdvance(a)&&(Number(new Date)-b<550&&Math.abs(i)>50||Math.abs(i)>m/2)?t.flexAnimate(a,t.vars.pauseOnAction):p||t.flexAnimate(t.currentSlide,t.vars.pauseOnAction,!0)}c=null,f=null,v=null,g=null,x=0}}var c,f,g,m,v,b,w=!1,_=0,y=0,x=0;s?(t.style.msTouchAction="none",t._gesture=new MSGesture,t._gesture.target=t,t.addEventListener("MSPointerDown",o,!1),t._slider=a,t.addEventListener("MSGestureChange",r,!1),t.addEventListener("MSGestureEnd",l,!1)):t.addEventListener("touchstart",e,!1)},resize:function(){!a.animating&&a.is(":visible")&&(h||a.doMath(),p?g.smoothHeight():h?(a.slides.width(a.computedW),a.update(a.pagingCount),a.setProps()):d?(a.viewport.height(a.h),a.setProps(a.h,"setTotal")):(a.vars.smoothHeight&&g.smoothHeight(),a.newSlides.width(a.computedW),a.setProps(a.computedW,"setTotal")))},smoothHeight:function(e){if(!d||p){var t=p?a:a.viewport;e?t.animate({height:a.slides.eq(a.animatingTo).height()},e):t.height(a.slides.eq(a.animatingTo).height())}},sync:function(t){var i=e(a.vars.sync).data("flexslider"),n=a.animatingTo;switch(t){case"animate":i.flexAnimate(n,a.vars.pauseOnAction,!1,!0);break;case"play":i.playing||i.asNav||i.play();break;case"pause":i.pause()}},uniqueID:function(t){return t.find("[id]").each(function(){var t=e(this);t.attr("id",t.attr("id")+"_clone")}),t},pauseInvisible:{visProp:null,init:function(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)e[t]+"Hidden"in document&&(g.pauseInvisible.visProp=e[t]+"Hidden");if(g.pauseInvisible.visProp){var i=g.pauseInvisible.visProp.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(i,function(){g.pauseInvisible.isHidden()?a.startTimeout?clearTimeout(a.startTimeout):a.pause():a.started?a.play():a.vars.initDelay>0?setTimeout(a.play,a.vars.initDelay):a.play()})}},isHidden:function(){return document[g.pauseInvisible.visProp]||!1}},setToClearWatchedEvent:function(){clearTimeout(n),n=setTimeout(function(){c=""},3e3)}},a.flexAnimate=function(t,i,n,s,l){if(a.vars.animationLoop||t===a.currentSlide||(a.direction=t>a.currentSlide?"next":"prev"),f&&1===a.pagingCount&&(a.direction=a.currentItem<t?"next":"prev"),!a.animating&&(a.canAdvance(t,l)||n)&&a.is(":visible")){if(f&&s){var c=e(a.vars.asNavFor).data("flexslider");if(a.atEnd=0===t||t===a.count-1,c.flexAnimate(t,!0,!1,!0,l),a.direction=a.currentItem<t?"next":"prev",c.direction=a.direction,Math.ceil((t+1)/a.visible)-1===a.currentSlide||0===t)return a.currentItem=t,a.slides.removeClass(o+"active-slide").eq(t).addClass(o+"active-slide"),!1;a.currentItem=t,a.slides.removeClass(o+"active-slide").eq(t).addClass(o+"active-slide"),t=Math.floor(t/a.visible)}if(a.animating=!0,a.animatingTo=t,i&&a.pause(),a.vars.before(a),a.syncExists&&!l&&g.sync("animate"),a.vars.controlNav&&g.controlNav.active(),h||a.slides.removeClass(o+"active-slide").eq(t).addClass(o+"active-slide"),a.atEnd=0===t||t===a.last,a.vars.directionNav&&g.directionNav.update(),t===a.last&&(a.vars.end(a),a.vars.animationLoop||a.pause()),p)r?(a.slides.eq(a.currentSlide).css({opacity:0,zIndex:1}),a.slides.eq(t).css({opacity:1,zIndex:2}),a.wrapup(w)):(a.slides.eq(a.currentSlide).css({zIndex:1}).animate({opacity:0},a.vars.animationSpeed,a.vars.easing),a.slides.eq(t).css({zIndex:2}).animate({opacity:1},a.vars.animationSpeed,a.vars.easing,a.wrapup));else{var m,v,b,w=d?a.slides.filter(":first").height():a.computedW;h?(m=a.vars.itemMargin,b=(a.itemW+m)*a.move*a.animatingTo,v=b>a.limit&&1!==a.visible?a.limit:b):v=0===a.currentSlide&&t===a.count-1&&a.vars.animationLoop&&"next"!==a.direction?u?(a.count+a.cloneOffset)*w:0:a.currentSlide===a.last&&0===t&&a.vars.animationLoop&&"prev"!==a.direction?u?0:(a.count+1)*w:u?(a.count-1-t+a.cloneOffset)*w:(t+a.cloneOffset)*w,a.setProps(v,"",a.vars.animationSpeed),a.transitions?(a.vars.animationLoop&&a.atEnd||(a.animating=!1,a.currentSlide=a.animatingTo),a.container.unbind("webkitTransitionEnd transitionend"),a.container.bind("webkitTransitionEnd transitionend",function(){clearTimeout(a.ensureAnimationEnd),a.wrapup(w)}),clearTimeout(a.ensureAnimationEnd),a.ensureAnimationEnd=setTimeout(function(){a.wrapup(w)},a.vars.animationSpeed+100)):a.container.animate(a.args,a.vars.animationSpeed,a.vars.easing,function(){a.wrapup(w)})}a.vars.smoothHeight&&g.smoothHeight(a.vars.animationSpeed)}},a.wrapup=function(e){p||h||(0===a.currentSlide&&a.animatingTo===a.last&&a.vars.animationLoop?a.setProps(e,"jumpEnd"):a.currentSlide===a.last&&0===a.animatingTo&&a.vars.animationLoop&&a.setProps(e,"jumpStart")),a.animating=!1,a.currentSlide=a.animatingTo,a.vars.after(a)},a.animateSlides=function(){!a.animating&&m&&a.flexAnimate(a.getTarget("next"))},a.pause=function(){clearInterval(a.animatedSlides),a.animatedSlides=null,a.playing=!1,a.vars.pausePlay&&g.pausePlay.update("play"),a.syncExists&&g.sync("pause")},a.play=function(){a.playing&&clearInterval(a.animatedSlides),a.animatedSlides=a.animatedSlides||setInterval(a.animateSlides,a.vars.slideshowSpeed),a.started=a.playing=!0,a.vars.pausePlay&&g.pausePlay.update("pause"),a.syncExists&&g.sync("play")},a.stop=function(){a.pause(),a.stopped=!0},a.canAdvance=function(e,t){var i=f?a.pagingCount-1:a.last;return t?!0:f&&a.currentItem===a.count-1&&0===e&&"prev"===a.direction?!0:f&&0===a.currentItem&&e===a.pagingCount-1&&"next"!==a.direction?!1:e!==a.currentSlide||f?a.vars.animationLoop?!0:a.atEnd&&0===a.currentSlide&&e===i&&"next"!==a.direction?!1:a.atEnd&&a.currentSlide===i&&0===e&&"next"===a.direction?!1:!0:!1},a.getTarget=function(e){return a.direction=e,"next"===e?a.currentSlide===a.last?0:a.currentSlide+1:0===a.currentSlide?a.last:a.currentSlide-1},a.setProps=function(e,t,i){var n=function(){var i=e?e:(a.itemW+a.vars.itemMargin)*a.move*a.animatingTo,n=function(){if(h)return"setTouch"===t?e:u&&a.animatingTo===a.last?0:u?a.limit-(a.itemW+a.vars.itemMargin)*a.move*a.animatingTo:a.animatingTo===a.last?a.limit:i;switch(t){case"setTotal":return u?(a.count-1-a.currentSlide+a.cloneOffset)*e:(a.currentSlide+a.cloneOffset)*e;case"setTouch":return u?e:e;case"jumpEnd":return u?e:a.count*e;case"jumpStart":return u?a.count*e:e;default:return e}}();return-1*n+"px"}();a.transitions&&(n=d?"translate3d(0,"+n+",0)":"translate3d("+n+",0,0)",i=void 0!==i?i/1e3+"s":"0s",a.container.css("-"+a.pfx+"-transition-duration",i),a.container.css("transition-duration",i)),a.args[a.prop]=n,(a.transitions||void 0===i)&&a.container.css(a.args),a.container.css("transform",n)},a.setup=function(t){if(p)a.slides.css({width:"100%","float":"left",marginRight:"-100%",position:"relative"}),"init"===t&&(r?a.slides.css({opacity:0,display:"block",webkitTransition:"opacity "+a.vars.animationSpeed/1e3+"s ease",zIndex:1}).eq(a.currentSlide).css({opacity:1,zIndex:2}):0==a.vars.fadeFirstSlide?a.slides.css({opacity:0,display:"block",zIndex:1}).eq(a.currentSlide).css({zIndex:2}).css({opacity:1}):a.slides.css({opacity:0,display:"block",zIndex:1}).eq(a.currentSlide).css({zIndex:2}).animate({opacity:1},a.vars.animationSpeed,a.vars.easing)),a.vars.smoothHeight&&g.smoothHeight();else{var i,n;"init"===t&&(a.viewport=e('<div class="'+o+'viewport"></div>').css({overflow:"hidden",position:"relative"}).appendTo(a).append(a.container),a.cloneCount=0,a.cloneOffset=0,u&&(n=e.makeArray(a.slides).reverse(),a.slides=e(n),a.container.empty().append(a.slides))),a.vars.animationLoop&&!h&&(a.cloneCount=2,a.cloneOffset=1,"init"!==t&&a.container.find(".clone").remove(),g.uniqueID(a.slides.first().clone().addClass("clone").attr("aria-hidden","true")).appendTo(a.container),g.uniqueID(a.slides.last().clone().addClass("clone").attr("aria-hidden","true")).prependTo(a.container)),a.newSlides=e(a.vars.selector,a),i=u?a.count-1-a.currentSlide+a.cloneOffset:a.currentSlide+a.cloneOffset,d&&!h?(a.container.height(200*(a.count+a.cloneCount)+"%").css("position","absolute").width("100%"),setTimeout(function(){a.newSlides.css({display:"block"}),a.doMath(),a.viewport.height(a.h),a.setProps(i*a.h,"init")},"init"===t?100:0)):(a.container.width(200*(a.count+a.cloneCount)+"%"),a.setProps(i*a.computedW,"init"),setTimeout(function(){a.doMath(),a.newSlides.css({width:a.computedW,"float":"left",display:"block"}),a.vars.smoothHeight&&g.smoothHeight()},"init"===t?100:0))}h||a.slides.removeClass(o+"active-slide").eq(a.currentSlide).addClass(o+"active-slide"),a.vars.init(a)},a.doMath=function(){var e=a.slides.first(),t=a.vars.itemMargin,i=a.vars.minItems,n=a.vars.maxItems;a.w=void 0===a.viewport?a.width():a.viewport.width(),a.h=e.height(),a.boxPadding=e.outerWidth()-e.width(),h?(a.itemT=a.vars.itemWidth+t,a.minW=i?i*a.itemT:a.w,a.maxW=n?n*a.itemT-t:a.w,a.itemW=a.minW>a.w?(a.w-t*(i-1))/i:a.maxW<a.w?(a.w-t*(n-1))/n:a.vars.itemWidth>a.w?a.w:a.vars.itemWidth,a.visible=Math.floor(a.w/a.itemW),a.move=a.vars.move>0&&a.vars.move<a.visible?a.vars.move:a.visible,a.pagingCount=Math.ceil((a.count-a.visible)/a.move+1),a.last=a.pagingCount-1,a.limit=1===a.pagingCount?0:a.vars.itemWidth>a.w?a.itemW*(a.count-1)+t*(a.count-1):(a.itemW+t)*a.count-a.w-t):(a.itemW=a.w,a.pagingCount=a.count,a.last=a.count-1),a.computedW=a.itemW-a.boxPadding},a.update=function(e,t){a.doMath(),h||(e<a.currentSlide?a.currentSlide+=1:e<=a.currentSlide&&0!==e&&(a.currentSlide-=1),a.animatingTo=a.currentSlide),a.vars.controlNav&&!a.manualControls&&("add"===t&&!h||a.pagingCount>a.controlNav.length?g.controlNav.update("add"):("remove"===t&&!h||a.pagingCount<a.controlNav.length)&&(h&&a.currentSlide>a.last&&(a.currentSlide-=1,a.animatingTo-=1),g.controlNav.update("remove",a.last))),a.vars.directionNav&&g.directionNav.update()},a.addSlide=function(t,i){var n=e(t);a.count+=1,a.last=a.count-1,d&&u?void 0!==i?a.slides.eq(a.count-i).after(n):a.container.prepend(n):void 0!==i?a.slides.eq(i).before(n):a.container.append(n),a.update(i,"add"),a.slides=e(a.vars.selector+":not(.clone)",a),a.setup(),a.vars.added(a)},a.removeSlide=function(t){var i=isNaN(t)?a.slides.index(e(t)):t;a.count-=1,a.last=a.count-1,isNaN(t)?e(t,a.slides).remove():d&&u?a.slides.eq(a.last).remove():a.slides.eq(t).remove(),a.doMath(),a.update(i,"remove"),a.slides=e(a.vars.selector+":not(.clone)",a),a.setup(),a.vars.removed(a)},g.init()},e(window).blur(function(e){focused=!1}).focus(function(e){focused=!0}),e.flexslider.defaults={namespace:"flex-",selector:".slides > li",animation:"fade",easing:"swing",direction:"horizontal",reverse:!1,animationLoop:!0,smoothHeight:!1,startAt:0,slideshow:!0,slideshowSpeed:7e3,animationSpeed:600,initDelay:0,randomize:!1,fadeFirstSlide:!0,thumbCaptions:!1,pauseOnAction:!0,pauseOnHover:!1,pauseInvisible:!0,useCSS:!0,touch:!0,video:!1,controlNav:!0,directionNav:!0,prevText:"Previous",nextText:"Next",keyboard:!0,multipleKeyboard:!1,mousewheel:!1,pausePlay:!1,pauseText:"Pause",playText:"Play",controlsContainer:"",manualControls:"",sync:"",asNavFor:"",itemWidth:0,itemMargin:0,minItems:1,maxItems:0,move:0,allowOneSlide:!0,start:function(){},before:function(){},after:function(){},end:function(){},added:function(){},removed:function(){},init:function(){}},e.fn.flexslider=function(t){if(void 0===t&&(t={}),"object"==typeof t)return this.each(function(){var i=e(this),a=t.selector?t.selector:".slides > li",n=i.find(a);1===n.length&&t.allowOneSlide===!0||0===n.length?(n.fadeIn(400),t.start&&t.start(i)):void 0===i.data("flexslider")&&new e.flexslider(this,t)});var i=e(this).data("flexslider");switch(t){case"play":i.play();break;case"pause":i.pause();break;case"stop":i.stop();break;case"next":i.flexAnimate(i.getTarget("next"),!0);break;case"prev":case"previous":i.flexAnimate(i.getTarget("prev"),!0);break;default:"number"==typeof t&&i.flexAnimate(t,!0)}}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){"use strict";function t(){var e=document.getElementsByTagName("script"),t=e[e.length-1].src.split("?")[0];return t.split("/").length>0?t.split("/").slice(0,-1).join("/")+"/":""}function i(e,t,i){for(var a=0;a<t.length;a++)i(e,t[a])}var a=!1,n=!1,o=0,s=2e3,r=0,l=e,c=["webkit","ms","moz","o"],d=window.requestAnimationFrame||!1,u=window.cancelAnimationFrame||!1;if(!d)for(var h in c){var p=c[h];d||(d=window[p+"RequestAnimationFrame"]),u||(u=window[p+"CancelAnimationFrame"]||window[p+"CancelRequestAnimationFrame"])}var f=window.MutationObserver||window.WebKitMutationObserver||!1,g={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,railhoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:"auto",cursordragontouch:!1,oneaxismousemode:"auto",scriptpath:t(),preventmultitouchscrolling:!0},m=!1,v=function(){function e(){var e=["-webkit-grab","-moz-grab","grab"];(o.ischrome&&!o.ischrome22||o.isie)&&(e=[]);for(var t=0;t<e.length;t++){var a=e[t];if(i.cursor=a,i.cursor==a)return a}return"url(//mail.google.com/mail/images/2/openhand.cur),n-resize"}if(m)return m;var t=document.createElement("DIV"),i=t.style,a=navigator.userAgent,n=navigator.platform,o={};o.haspointerlock="pointerLockElement"in document||"webkitPointerLockElement"in document||"mozPointerLockElement"in document,o.isopera="opera"in window,o.isopera12=o.isopera&&"getUserMedia"in navigator,o.isoperamini="[object OperaMini]"===Object.prototype.toString.call(window.operamini),o.isie="all"in document&&"attachEvent"in t&&!o.isopera,o.isieold=o.isie&&!("msInterpolationMode"in i),o.isie7=o.isie&&!o.isieold&&(!("documentMode"in document)||7==document.documentMode),o.isie8=o.isie&&"documentMode"in document&&8==document.documentMode,o.isie9=o.isie&&"performance"in window&&document.documentMode>=9,o.isie10=o.isie&&"performance"in window&&10==document.documentMode,o.isie11="msRequestFullscreen"in t&&document.documentMode>=11,o.isie9mobile=/iemobile.9/i.test(a),o.isie9mobile&&(o.isie9=!1),o.isie7mobile=!o.isie9mobile&&o.isie7&&/iemobile/i.test(a),o.ismozilla="MozAppearance"in i,o.iswebkit="WebkitAppearance"in i,o.ischrome="chrome"in window,o.ischrome22=o.ischrome&&o.haspointerlock,o.ischrome26=o.ischrome&&"transition"in i,o.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window,o.hasmstouch=window.MSPointerEvent||!1,o.hasw3ctouch=window.PointerEvent||!1,o.ismac=/^mac$/i.test(n),o.isios=o.cantouch&&/iphone|ipad|ipod/i.test(n),o.isios4=o.isios&&!("seal"in Object),o.isios7=o.isios&&"webkitHidden"in document,o.isandroid=/android/i.test(a),o.haseventlistener="addEventListener"in t,o.trstyle=!1,o.hastransform=!1,o.hastranslate3d=!1,o.transitionstyle=!1,o.hastransition=!1,o.transitionend=!1;var s,r=["transform","msTransform","webkitTransform","MozTransform","OTransform"];for(s=0;s<r.length;s++)if("undefined"!=typeof i[r[s]]){o.trstyle=r[s];break}o.hastransform=!!o.trstyle,o.hastransform&&(i[o.trstyle]="translate3d(1px,2px,3px)",o.hastranslate3d=/translate3d/.test(i[o.trstyle])),o.transitionstyle=!1,o.prefixstyle="",o.transitionend=!1,r=["transition","webkitTransition","msTransition","MozTransition","OTransition","OTransition","KhtmlTransition"];var l=["","-webkit-","-ms-","-moz-","-o-","-o","-khtml-"],c=["transitionend","webkitTransitionEnd","msTransitionEnd","transitionend","otransitionend","oTransitionEnd","KhtmlTransitionEnd"];for(s=0;s<r.length;s++)if(r[s]in i){o.transitionstyle=r[s],o.prefixstyle=l[s],o.transitionend=c[s];break}return o.ischrome26&&(o.prefixstyle=l[1]),o.hastransition=o.transitionstyle,o.cursorgrabvalue=e(),o.hasmousecapture="setCapture"in t,o.hasMutationObserver=f!==!1,t=null,m=o,o},b=function(e,t){function i(){var e=b.doc.css(y.trstyle);return e&&"matrix"==e.substr(0,6)?e.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/):!1}function c(){var e=b.win;if("zIndex"in e)return e.zIndex();for(;e.length>0;){if(9==e[0].nodeType)return!1;var t=e.css("zIndex");if(!isNaN(t)&&0!=t)return parseInt(t);e=e.parent()}return!1}function h(e,t,i){var a=e.css(t),n=parseFloat(a);if(isNaN(n)){n=C[a]||0;var o=3==n?i?b.win.outerHeight()-b.win.innerHeight():b.win.outerWidth()-b.win.innerWidth():1;return b.isie8&&n&&(n+=1),o?n:0}return n}function p(e,t,i,a){b._bind(e,t,function(a){var a=a?a:window.event,n={original:a,target:a.target||a.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==a.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return a.preventDefault?a.preventDefault():a.returnValue=!1,!1},stopImmediatePropagation:function(){a.stopImmediatePropagation?a.stopImmediatePropagation():a.cancelBubble=!0}};return"mousewheel"==t?(n.deltaY=-1/40*a.wheelDelta,a.wheelDeltaX&&(n.deltaX=-1/40*a.wheelDeltaX)):n.deltaY=a.detail,i.call(e,n)},a)}function m(e,t,i){var a,n;if(0==e.deltaMode?(a=-Math.floor(e.deltaX*(b.opt.mousescrollstep/54)),n=-Math.floor(e.deltaY*(b.opt.mousescrollstep/54))):1==e.deltaMode&&(a=-Math.floor(e.deltaX*b.opt.mousescrollstep),n=-Math.floor(e.deltaY*b.opt.mousescrollstep)),t&&b.opt.oneaxismousemode&&0==a&&n&&(a=n,n=0,i)){var o=0>a?b.getScrollLeft()>=b.page.maxw:b.getScrollLeft()<=0;o&&(n=a,a=0)}if(a&&(b.scrollmom&&b.scrollmom.stop(),b.lastdeltax+=a,b.debounced("mousewheelx",function(){var e=b.lastdeltax;b.lastdeltax=0,b.rail.drag||b.doScrollLeftBy(e)},15)),n){if(b.opt.nativeparentscrolling&&i&&!b.ispage&&!b.zoomactive)if(0>n){if(b.getScrollTop()>=b.page.maxh)return!0}else if(b.getScrollTop()<=0)return!0;b.scrollmom&&b.scrollmom.stop(),b.lastdeltay+=n,b.debounced("mousewheely",function(){var e=b.lastdeltay;b.lastdeltay=0,b.rail.drag||b.doScrollBy(e)},15)}return e.stopImmediatePropagation(),e.preventDefault()}var b=this;if(this.dragToBottom=!1,this.onDragToBottom=function(){},this.dragToTop=!1,this.onDragToTop=function(){},this.version="3.6.0",this.name="nicescroll",this.me=t,this.opt={doc:l("body"),win:!1},l.extend(this.opt,g),this.opt.snapbackspeed=80,e)for(var _ in b.opt)"undefined"!=typeof e[_]&&(b.opt[_]=e[_]);this.doc=b.opt.doc,this.iddoc=this.doc&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/^BODY|HTML/.test(b.opt.win?b.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=b.opt.win!==!1,this.win=b.opt.win||(this.ispage?l(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?l(window):this.win,this.body=l("body"),this.viewport=!1,this.isfixed=!1,this.iframe=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.forcescreen=!1,this.canshowonmouseevent="scroll"!=b.opt.autohidemode,this.onmousedown=!1,this.onmouseup=!1,this.onmousemove=!1,this.onmousewheel=!1,this.onkeypress=!1,this.ongesturezoom=!1,this.onclick=!1,this.onscrollstart=!1,this.onscrollend=!1,this.onscrollcancel=!1,this.onzoomin=!1,this.onzoomout=!1,this.view=!1,this.page=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.isrtlmode="auto"==this.opt.rtlmode?"rtl"==(this.win[0]==window?this.body:this.win).css("direction"):this.opt.rtlmode===!0,this.scrollrunning=!1,this.scrollmom=!1,this.observer=!1,this.observerremover=!1,this.observerbody=!1;do this.id="ascrail"+s++;while(document.getElementById(this.id));this.rail=!1,this.cursor=!1,this.cursorfreezed=!1,this.selectiondrag=!1,this.zoom=!1,this.zoomactive=!1,this.hasfocus=!1,this.hasmousefocus=!1,this.visibility=!0,this.railslocked=!1,this.locked=!1,this.hidden=!1,this.cursoractive=!0,this.wheelprevented=!1,this.overflowx=b.opt.overflowx,this.overflowy=b.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltax=0,this.lastdeltay=0,this.detected=v();var y=l.extend({},this.detected);this.canhwscroll=y.hastransform&&b.opt.hwacceleration,this.ishwscroll=this.canhwscroll&&b.haswrapper,this.hasreversehr=this.isrtlmode&&!y.iswebkit,this.istouchcapable=!1,!y.cantouch||y.isios||y.isandroid||!y.iswebkit&&!y.ismozilla||(this.istouchcapable=!0,y.cantouch=!1),b.opt.enablemouselockapi||(y.hasmousecapture=!1,y.haspointerlock=!1),this.debounced=function(e,t,i){var a=b.delaylist[e];b.delaylist[e]=t,a||setTimeout(function(){var t=b.delaylist[e];b.delaylist[e]=!1,t.call(b)},i)};var x=!1;this.synched=function(e,t){function i(){x||(d(function(){x=!1;for(var e in b.synclist){var t=b.synclist[e];t&&t.call(b),b.synclist[e]=!1}}),x=!0)}return b.synclist[e]=t,i(),e},this.unsynched=function(e){b.synclist[e]&&(b.synclist[e]=!1)},this.css=function(e,t){for(var i in t)b.saved.css.push([e,i,e.css(i)]),e.css(i,t[i])},this.scrollTop=function(e){return"undefined"==typeof e?b.getScrollTop():b.setScrollTop(e)},this.scrollLeft=function(e){return"undefined"==typeof e?b.getScrollLeft():b.setScrollLeft(e)};var k=function(e,t,i,a,n,o,s){this.st=e,this.ed=t,this.spd=i,this.p1=a||0,this.p2=n||1,this.p3=o||0,this.p4=s||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st};if(k.prototype={B2:function(e){return 3*e*e*(1-e)},B3:function(e){return 3*e*(1-e)*(1-e)},B4:function(e){return(1-e)*(1-e)*(1-e)},getNow:function(){var e=(new Date).getTime(),t=1-(e-this.ts)/this.spd,i=this.B2(t)+this.B3(t)+this.B4(t);return 0>t?this.ed:this.st+Math.round(this.df*i)},update:function(e,t){return this.st=this.getNow(),this.ed=e,this.spd=t,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}},this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},y.hastranslate3d&&y.isios&&this.doc.css("-webkit-backface-visibility","hidden"),this.getScrollTop=function(e){if(!e){var t=i();if(t)return 16==t.length?-t[13]:-t[5];if(b.timerscroll&&b.timerscroll.bz)return b.timerscroll.bz.getNow()}return b.doc.translate.y},this.getScrollLeft=function(e){if(!e){var t=i();if(t)return 16==t.length?-t[12]:-t[4];if(b.timerscroll&&b.timerscroll.bh)return b.timerscroll.bh.getNow()}return b.doc.translate.x},this.notifyScrollEvent=function(e){var t=document.createEvent("UIEvents");t.initUIEvent("scroll",!1,!0,window,1),t.niceevent=!0,e.dispatchEvent(t)};var $=this.isrtlmode?1:-1;y.hastranslate3d&&b.opt.enabletranslate3d?(this.setScrollTop=function(e,t){b.doc.translate.y=e,b.doc.translate.ty=-1*e+"px",b.doc.css(y.trstyle,"translate3d("+b.doc.translate.tx+","+b.doc.translate.ty+",0px)"),t||b.notifyScrollEvent(b.win[0])},this.setScrollLeft=function(e,t){b.doc.translate.x=e,b.doc.translate.tx=e*$+"px",b.doc.css(y.trstyle,"translate3d("+b.doc.translate.tx+","+b.doc.translate.ty+",0px)"),t||b.notifyScrollEvent(b.win[0])}):(this.setScrollTop=function(e,t){b.doc.translate.y=e,b.doc.translate.ty=-1*e+"px",b.doc.css(y.trstyle,"translate("+b.doc.translate.tx+","+b.doc.translate.ty+")"),t||b.notifyScrollEvent(b.win[0])},this.setScrollLeft=function(e,t){b.doc.translate.x=e,b.doc.translate.tx=e*$+"px",b.doc.css(y.trstyle,"translate("+b.doc.translate.tx+","+b.doc.translate.ty+")"),t||b.notifyScrollEvent(b.win[0])})}else this.getScrollTop=function(){return b.docscroll.scrollTop()},this.setScrollTop=function(e){return b.docscroll.scrollTop(e)},this.getScrollLeft=function(){return b.detected.ismozilla&&b.isrtlmode?Math.abs(b.docscroll.scrollLeft()):b.docscroll.scrollLeft()},this.setScrollLeft=function(e){return b.docscroll.scrollLeft(b.detected.ismozilla&&b.isrtlmode?-e:e)};this.getTarget=function(e){return e?e.target?e.target:e.srcElement?e.srcElement:!1:!1},this.hasParent=function(e,t){if(!e)return!1;for(var i=e.target||e.srcElement||e||!1;i&&i.id!=t;)i=i.parentNode||!1;return i!==!1};var C={thin:1,medium:3,thick:5};this.getDocumentScrollOffset=function(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}},this.getOffset=function(){if(b.isfixed){var e=b.win.offset(),t=b.getDocumentScrollOffset();return e.top-=t.top,e.left-=t.left,e}var i=b.win.offset();if(!b.viewport)return i;var a=b.viewport.offset();return{top:i.top-a.top,left:i.left-a.left}},this.updateScrollBar=function(e){if(b.ishwscroll)b.rail.css({height:b.win.innerHeight()-(b.opt.railpadding.top+b.opt.railpadding.bottom)}),b.railh&&b.railh.css({width:b.win.innerWidth()-(b.opt.railpadding.left+b.opt.railpadding.right)});else{var t=b.getOffset(),i={top:t.top,left:t.left-(b.opt.railpadding.left+b.opt.railpadding.right)};i.top+=h(b.win,"border-top-width",!0),i.left+=b.rail.align?b.win.outerWidth()-h(b.win,"border-right-width")-b.rail.width:h(b.win,"border-left-width");var a=b.opt.railoffset;if(a&&(a.top&&(i.top+=a.top),b.rail.align&&a.left&&(i.left+=a.left)),b.railslocked||b.rail.css({top:i.top,left:i.left,height:(e?e.h:b.win.innerHeight())-(b.opt.railpadding.top+b.opt.railpadding.bottom)}),b.zoom&&b.zoom.css({top:i.top+1,left:1==b.rail.align?i.left-20:i.left+b.rail.width+4}),b.railh&&!b.railslocked){var i={top:t.top,left:t.left},a=b.opt.railhoffset;a&&(a.top&&(i.top+=a.top),a.left&&(i.left+=a.left));var n=b.railh.align?i.top+h(b.win,"border-top-width",!0)+b.win.innerHeight()-b.railh.height:i.top+h(b.win,"border-top-width",!0),o=i.left+h(b.win,"border-left-width");b.railh.css({top:n-(b.opt.railpadding.top+b.opt.railpadding.bottom),left:o,width:b.railh.width})}}},this.doRailClick=function(e,t,i){var a,n,o,s;b.railslocked||(b.cancelEvent(e),t?(a=i?b.doScrollLeft:b.doScrollTop,o=i?(e.pageX-b.railh.offset().left-b.cursorwidth/2)*b.scrollratio.x:(e.pageY-b.rail.offset().top-b.cursorheight/2)*b.scrollratio.y,a(o)):(a=i?b.doScrollLeftBy:b.doScrollBy,o=i?b.scroll.x:b.scroll.y,s=i?e.pageX-b.railh.offset().left:e.pageY-b.rail.offset().top,n=i?b.view.w:b.view.h,a(o>=s?n:-n)))},b.hasanimationframe=d,b.hascancelanimationframe=u,b.hasanimationframe?b.hascancelanimationframe||(u=function(){b.cancelAnimationFrame=!0}):(d=function(e){return setTimeout(e,15-Math.floor(+new Date/1e3)%16)},u=clearInterval),this.init=function(){if(b.saved.css=[],y.isie7mobile)return!0;if(y.isoperamini)return!0;if(y.hasmstouch&&b.css(b.ispage?l("html"):b.win,{"-ms-touch-action":"none"}),b.zindex="auto",b.ispage||"auto"!=b.opt.zindex?b.zindex=b.opt.zindex:b.zindex=c()||"auto",b.ispage||"auto"==b.zindex||b.zindex>r&&(r=b.zindex),b.isie&&0==b.zindex&&"auto"==b.opt.zindex&&(b.zindex="auto"),!b.ispage||!y.cantouch&&!y.isieold&&!y.isie9mobile){var e=b.docscroll;b.ispage&&(e=b.haswrapper?b.win:b.doc),y.isie9mobile||b.css(e,{"overflow-y":"hidden"}),b.ispage&&y.isie7&&("BODY"==b.doc[0].nodeName?b.css(l("html"),{
"overflow-y":"hidden"}):"HTML"==b.doc[0].nodeName&&b.css(l("body"),{"overflow-y":"hidden"})),!y.isios||b.ispage||b.haswrapper||b.css(l("body"),{"-webkit-overflow-scrolling":"touch"});var t=l(document.createElement("div"));t.css({position:"relative",top:0,"float":"right",width:b.opt.cursorwidth,height:"0px","background-color":b.opt.cursorcolor,border:b.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":b.opt.cursorborderradius,"-moz-border-radius":b.opt.cursorborderradius,"border-radius":b.opt.cursorborderradius}),t.hborder=parseFloat(t.outerHeight()-t.innerHeight()),t.addClass("nicescroll-cursors"),b.cursor=t;var i=l(document.createElement("div"));i.attr("id",b.id),i.addClass("nicescroll-rails nicescroll-rails-vr");var s,d,u=["left","right","top","bottom"];for(var h in u)d=u[h],s=b.opt.railpadding[d],s?i.css("padding-"+d,s+"px"):b.opt.railpadding[d]=0;i.append(t),i.width=Math.max(parseFloat(b.opt.cursorwidth),t.outerWidth()),i.css({width:i.width+"px",zIndex:b.zindex,background:b.opt.background,cursor:"default"}),i.visibility=!0,i.scrollable=!0,i.align="left"==b.opt.railalign?0:1,b.rail=i,b.rail.drag=!1;var p=!1;!b.opt.boxzoom||b.ispage||y.isieold||(p=document.createElement("div"),b.bind(p,"click",b.doZoom),b.bind(p,"mouseenter",function(){b.zoom.css("opacity",b.opt.cursoropacitymax)}),b.bind(p,"mouseleave",function(){b.zoom.css("opacity",b.opt.cursoropacitymin)}),b.zoom=l(p),b.zoom.css({cursor:"pointer","z-index":b.zindex,backgroundImage:"url("+b.opt.scriptpath+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),b.opt.dblclickzoom&&b.bind(b.win,"dblclick",b.doZoom),y.cantouch&&b.opt.gesturezoom&&(b.ongesturezoom=function(e){return e.scale>1.5&&b.doZoomIn(e),e.scale<.8&&b.doZoomOut(e),b.cancelEvent(e)},b.bind(b.win,"gestureend",b.ongesturezoom))),b.railh=!1;var g;if(b.opt.horizrailenabled){b.css(e,{"overflow-x":"hidden"});var t=l(document.createElement("div"));t.css({position:"absolute",top:0,height:b.opt.cursorwidth,width:"0px","background-color":b.opt.cursorcolor,border:b.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":b.opt.cursorborderradius,"-moz-border-radius":b.opt.cursorborderradius,"border-radius":b.opt.cursorborderradius}),y.isieold&&t.css({overflow:"hidden"}),t.wborder=parseFloat(t.outerWidth()-t.innerWidth()),t.addClass("nicescroll-cursors"),b.cursorh=t,g=l(document.createElement("div")),g.attr("id",b.id+"-hr"),g.addClass("nicescroll-rails nicescroll-rails-hr"),g.height=Math.max(parseFloat(b.opt.cursorwidth),t.outerHeight()),g.css({height:g.height+"px",zIndex:b.zindex,background:b.opt.background}),g.append(t),g.visibility=!0,g.scrollable=!0,g.align="top"==b.opt.railvalign?0:1,b.railh=g,b.railh.drag=!1}if(b.ispage)i.css({position:"fixed",top:"0px",height:"100%"}),i.align?i.css({right:"0px"}):i.css({left:"0px"}),b.body.append(i),b.railh&&(g.css({position:"fixed",left:"0px",width:"100%"}),g.align?g.css({bottom:"0px"}):g.css({top:"0px"}),b.body.append(g));else{if(b.ishwscroll){"static"==b.win.css("position")&&b.css(b.win,{position:"relative"});var m="HTML"==b.win[0].nodeName?b.body:b.win;l(m).scrollTop(0).scrollLeft(0),b.zoom&&(b.zoom.css({position:"absolute",top:1,right:0,"margin-right":i.width+4}),m.append(b.zoom)),i.css({position:"absolute",top:0}),i.align?i.css({right:0}):i.css({left:0}),m.append(i),g&&(g.css({position:"absolute",left:0,bottom:0}),g.align?g.css({bottom:0}):g.css({top:0}),m.append(g))}else{b.isfixed="fixed"==b.win.css("position");var v=b.isfixed?"fixed":"absolute";b.isfixed||(b.viewport=b.getViewport(b.win[0])),b.viewport&&(b.body=b.viewport,0==/fixed|absolute/.test(b.viewport.css("position"))&&b.css(b.viewport,{position:"relative"})),i.css({position:v}),b.zoom&&b.zoom.css({position:v}),b.updateScrollBar(),b.body.append(i),b.zoom&&b.body.append(b.zoom),b.railh&&(g.css({position:v}),b.body.append(g))}y.isios&&b.css(b.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),y.isie&&b.opt.disableoutline&&b.win.attr("hideFocus","true"),y.iswebkit&&b.opt.disableoutline&&b.win.css({outline:"none"})}if(b.opt.autohidemode===!1?(b.autohidedom=!1,b.rail.css({opacity:b.opt.cursoropacitymax}),b.railh&&b.railh.css({opacity:b.opt.cursoropacitymax})):b.opt.autohidemode===!0||"leave"===b.opt.autohidemode?(b.autohidedom=l().add(b.rail),y.isie8&&(b.autohidedom=b.autohidedom.add(b.cursor)),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh)),b.railh&&y.isie8&&(b.autohidedom=b.autohidedom.add(b.cursorh))):"scroll"==b.opt.autohidemode?(b.autohidedom=l().add(b.rail),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh))):"cursor"==b.opt.autohidemode?(b.autohidedom=l().add(b.cursor),b.railh&&(b.autohidedom=b.autohidedom.add(b.cursorh))):"hidden"==b.opt.autohidemode&&(b.autohidedom=!1,b.hide(),b.railslocked=!1),y.isie9mobile){b.scrollmom=new w(b),b.onmangotouch=function(){var e=b.getScrollTop(),t=b.getScrollLeft();if(e==b.scrollmom.lastscrolly&&t==b.scrollmom.lastscrollx)return!0;var i=e-b.mangotouch.sy,a=t-b.mangotouch.sx,n=Math.round(Math.sqrt(Math.pow(a,2)+Math.pow(i,2)));if(0!=n){var o=0>i?-1:1,s=0>a?-1:1,r=+new Date;if(b.mangotouch.lazy&&clearTimeout(b.mangotouch.lazy),r-b.mangotouch.tm>80||b.mangotouch.dry!=o||b.mangotouch.drx!=s)b.scrollmom.stop(),b.scrollmom.reset(t,e),b.mangotouch.sy=e,b.mangotouch.ly=e,b.mangotouch.sx=t,b.mangotouch.lx=t,b.mangotouch.dry=o,b.mangotouch.drx=s,b.mangotouch.tm=r;else{b.scrollmom.stop(),b.scrollmom.update(b.mangotouch.sx-a,b.mangotouch.sy-i),b.mangotouch.tm=r;var l=Math.max(Math.abs(b.mangotouch.ly-e),Math.abs(b.mangotouch.lx-t));b.mangotouch.ly=e,b.mangotouch.lx=t,l>2&&(b.mangotouch.lazy=setTimeout(function(){b.mangotouch.lazy=!1,b.mangotouch.dry=0,b.mangotouch.drx=0,b.mangotouch.tm=0,b.scrollmom.doMomentum(30)},100))}}};var _=b.getScrollTop(),x=b.getScrollLeft();b.mangotouch={sy:_,ly:_,dry:0,sx:x,lx:x,drx:0,lazy:!1,tm:0},b.bind(b.docscroll,"scroll",b.onmangotouch)}else{if(y.cantouch||b.istouchcapable||b.opt.touchbehavior||y.hasmstouch){b.scrollmom=new w(b),b.ontouchstart=function(e){if(e.pointerType&&2!=e.pointerType&&"touch"!=e.pointerType)return!1;if(b.hasmoving=!1,!b.railslocked){var t;if(y.hasmstouch)for(t=e.target?e.target:!1;t;){var i=l(t).getNiceScroll();if(i.length>0&&i[0].me==b.me)break;if(i.length>0)return!1;if("DIV"==t.nodeName&&t.id==b.id)break;t=t.parentNode?t.parentNode:!1}if(b.cancelScroll(),t=b.getTarget(e)){var a=/INPUT/i.test(t.nodeName)&&/range/i.test(t.type);if(a)return b.stopPropagation(e)}if(!("clientX"in e)&&"changedTouches"in e&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),b.forcescreen){var n=e;e={original:e.original?e.original:e},e.clientX=n.screenX,e.clientY=n.screenY}if(b.rail.drag={x:e.clientX,y:e.clientY,sx:b.scroll.x,sy:b.scroll.y,st:b.getScrollTop(),sl:b.getScrollLeft(),pt:2,dl:!1},b.ispage||!b.opt.directionlockdeadzone)b.rail.drag.dl="f";else{var o={w:l(window).width(),h:l(window).height()},s={w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},r=Math.max(0,s.h-o.h),c=Math.max(0,s.w-o.w);!b.rail.scrollable&&b.railh.scrollable?b.rail.drag.ck=r>0?"v":!1:b.rail.scrollable&&!b.railh.scrollable?b.rail.drag.ck=c>0?"h":!1:b.rail.drag.ck=!1,b.rail.drag.ck||(b.rail.drag.dl="f")}if(b.opt.touchbehavior&&b.isiframe&&y.isie){var d=b.win.position();b.rail.drag.x+=d.left,b.rail.drag.y+=d.top}if(b.hasmoving=!1,b.lastmouseup=!1,b.scrollmom.reset(e.clientX,e.clientY),!y.cantouch&&!this.istouchcapable&&!e.pointerType){var u=t?/INPUT|SELECT|TEXTAREA/i.test(t.nodeName):!1;if(!u)return!b.ispage&&y.hasmousecapture&&t.setCapture(),b.opt.touchbehavior?(t.onclick&&!t._onclick&&(t._onclick=t.onclick,t.onclick=function(e){return b.hasmoving?!1:void t._onclick.call(this,e)}),b.cancelEvent(e)):b.stopPropagation(e);/SUBMIT|CANCEL|BUTTON/i.test(l(t).attr("type"))&&(pc={tg:t,click:!1},b.preventclick=pc)}}},b.ontouchend=function(e){if(!b.rail.drag)return!0;if(2==b.rail.drag.pt){if(e.pointerType&&2!=e.pointerType&&"touch"!=e.pointerType)return!1;if(b.scrollmom.doMomentum(),b.rail.drag=!1,b.hasmoving&&(b.lastmouseup=!0,b.hideCursor(),y.hasmousecapture&&document.releaseCapture(),!y.cantouch))return b.cancelEvent(e)}else if(1==b.rail.drag.pt)return b.onmouseup(e)};var k=b.opt.touchbehavior&&b.isiframe&&!y.hasmousecapture;b.ontouchmove=function(e,t){if(!b.rail.drag)return!1;if(e.targetTouches&&b.opt.preventmultitouchscrolling&&e.targetTouches.length>1)return!1;if(e.pointerType&&2!=e.pointerType&&"touch"!=e.pointerType)return!1;if(2==b.rail.drag.pt){if(y.cantouch&&y.isios&&"undefined"==typeof e.original)return!0;b.hasmoving=!0,b.preventclick&&!b.preventclick.click&&(b.preventclick.click=b.preventclick.tg.onclick||!1,b.preventclick.tg.onclick=b.onpreventclick);var i=l.extend({original:e},e);if(e=i,"changedTouches"in e&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),b.forcescreen){var a=e;e={original:e.original?e.original:e},e.clientX=a.screenX,e.clientY=a.screenY}var n,o;if(o=n=0,k&&!t){var s=b.win.position();o=-s.left,n=-s.top}var r=e.clientY+n,c=r-b.rail.drag.y,d=e.clientX+o,u=d-b.rail.drag.x,h=b.rail.drag.st-c;b.ishwscroll&&b.opt.bouncescroll?0>h?h=Math.round(h/2):h>b.page.maxh&&(h=b.page.maxh+Math.round((h-b.page.maxh)/2)):(0>h&&(h=0,r=0),h>b.page.maxh&&(h=b.page.maxh,r=0));var p;b.railh&&b.railh.scrollable&&(p=b.isrtlmode?u-b.rail.drag.sl:b.rail.drag.sl-u,b.ishwscroll&&b.opt.bouncescroll?0>p?p=Math.round(p/2):p>b.page.maxw&&(p=b.page.maxw+Math.round((p-b.page.maxw)/2)):(0>p&&(p=0,d=0),p>b.page.maxw&&(p=b.page.maxw,d=0)));var f=!1;if(b.rail.drag.dl)f=!0,"v"==b.rail.drag.dl?p=b.rail.drag.sl:"h"==b.rail.drag.dl&&(h=b.rail.drag.st);else{var g=Math.abs(c),m=Math.abs(u),v=b.opt.directionlockdeadzone;if("v"==b.rail.drag.ck){if(g>v&&.3*g>=m)return b.rail.drag=!1,!0;m>v&&(b.rail.drag.dl="f",l("body").scrollTop(l("body").scrollTop()))}else if("h"==b.rail.drag.ck){if(m>v&&.3*m>=g)return b.rail.drag=!1,!0;g>v&&(b.rail.drag.dl="f",l("body").scrollLeft(l("body").scrollLeft()))}}if(b.synched("touchmove",function(){b.rail.drag&&2==b.rail.drag.pt&&(b.prepareTransition&&b.prepareTransition(0),b.rail.scrollable&&b.setScrollTop(h),b.scrollmom.update(d,r),b.railh&&b.railh.scrollable?(b.setScrollLeft(p),b.showCursor(h,p)):b.showCursor(h),y.isie10&&document.selection.clear())}),y.ischrome&&b.istouchcapable&&(f=!1),f)return b.cancelEvent(e)}else if(1==b.rail.drag.pt)return b.onmousemove(e)}}if(b.onmousedown=function(e,t){if(!b.rail.drag||1==b.rail.drag.pt){if(b.railslocked)return b.cancelEvent(e);b.cancelScroll(),b.rail.drag={x:e.clientX,y:e.clientY,sx:b.scroll.x,sy:b.scroll.y,pt:1,hr:!!t};var i=b.getTarget(e);return!b.ispage&&y.hasmousecapture&&i.setCapture(),b.isiframe&&!y.hasmousecapture&&(b.saved.csspointerevents=b.doc.css("pointer-events"),b.css(b.doc,{"pointer-events":"none"})),b.hasmoving=!1,b.cancelEvent(e)}},b.onmouseup=function(e){return b.rail.drag?1!=b.rail.drag.pt?!0:(y.hasmousecapture&&document.releaseCapture(),b.isiframe&&!y.hasmousecapture&&b.doc.css("pointer-events",b.saved.csspointerevents),b.rail.drag=!1,b.hasmoving&&b.triggerScrollEnd(),b.cancelEvent(e)):void 0},b.onmousemove=function(e){if(b.rail.drag){if(1!=b.rail.drag.pt)return;if(y.ischrome&&0==e.which)return b.onmouseup(e);if(b.cursorfreezed=!0,b.hasmoving=!0,b.rail.drag.hr){b.scroll.x=b.rail.drag.sx+(e.clientX-b.rail.drag.x),b.scroll.x<0&&(b.scroll.x=0);var t=b.scrollvaluemaxw;b.scroll.x>t&&(b.scroll.x=t)}else{b.scroll.y=b.rail.drag.sy+(e.clientY-b.rail.drag.y),b.scroll.y<0?(b.scroll.y=0,0==b.dragToTop&&(b.dragToTop=!0,b.onDragToTop())):b.dragToTop=!1;var i=b.scrollvaluemax;b.scroll.y>i?(b.scroll.y=i,0==b.dragToBottom&&(b.dragToBottom=!0,b.onDragToBottom())):b.dragToBottom=!1}return b.synched("mousemove",function(){b.rail.drag&&1==b.rail.drag.pt&&(b.showCursor(),b.rail.drag.hr?b.hasreversehr?b.doScrollLeft(b.scrollvaluemaxw-Math.round(b.scroll.x*b.scrollratio.x),b.opt.cursordragspeed):b.doScrollLeft(Math.round(b.scroll.x*b.scrollratio.x),b.opt.cursordragspeed):b.doScrollTop(Math.round(b.scroll.y*b.scrollratio.y),b.opt.cursordragspeed))}),b.cancelEvent(e)}},y.cantouch||b.opt.touchbehavior)b.onpreventclick=function(e){return b.preventclick?(b.preventclick.tg.onclick=b.preventclick.click,b.preventclick=!1,b.cancelEvent(e)):void 0},b.bind(b.win,"mousedown",b.ontouchstart),b.onclick=y.isios?!1:function(e){return b.lastmouseup?(b.lastmouseup=!1,b.cancelEvent(e)):!0},b.opt.grabcursorenabled&&y.cursorgrabvalue&&(b.css(b.ispage?b.doc:b.win,{cursor:y.cursorgrabvalue}),b.css(b.rail,{cursor:y.cursorgrabvalue}));else{var $=function(e){if(b.selectiondrag){if(e){var t=b.win.outerHeight(),i=e.pageY-b.selectiondrag.top;i>0&&t>i&&(i=0),i>=t&&(i-=t),b.selectiondrag.df=i}if(0!=b.selectiondrag.df){var a=2*-Math.floor(b.selectiondrag.df/6);b.doScrollBy(a),b.debounced("doselectionscroll",function(){$()},50)}}};"getSelection"in document?b.hasTextSelected=function(){return document.getSelection().rangeCount>0}:"selection"in document?b.hasTextSelected=function(){return"None"!=document.selection.type}:b.hasTextSelected=function(){return!1},b.onselectionstart=function(e){b.ispage||(b.selectiondrag=b.win.offset())},b.onselectionend=function(e){b.selectiondrag=!1},b.onselectiondrag=function(e){b.selectiondrag&&b.hasTextSelected()&&b.debounced("selectionscroll",function(){$(e)},250)}}y.hasw3ctouch?(b.css(b.rail,{"touch-action":"none"}),b.css(b.cursor,{"touch-action":"none"}),b.bind(b.win,"pointerdown",b.ontouchstart),b.bind(document,"pointerup",b.ontouchend),b.bind(document,"pointermove",b.ontouchmove)):y.hasmstouch?(b.css(b.rail,{"-ms-touch-action":"none"}),b.css(b.cursor,{"-ms-touch-action":"none"}),b.bind(b.win,"MSPointerDown",b.ontouchstart),b.bind(document,"MSPointerUp",b.ontouchend),b.bind(document,"MSPointerMove",b.ontouchmove),b.bind(b.cursor,"MSGestureHold",function(e){e.preventDefault()}),b.bind(b.cursor,"contextmenu",function(e){e.preventDefault()})):this.istouchcapable&&(b.bind(b.win,"touchstart",b.ontouchstart),b.bind(document,"touchend",b.ontouchend),b.bind(document,"touchcancel",b.ontouchend),b.bind(document,"touchmove",b.ontouchmove)),(b.opt.cursordragontouch||!y.cantouch&&!b.opt.touchbehavior)&&(b.rail.css({cursor:"default"}),b.railh&&b.railh.css({cursor:"default"}),b.jqbind(b.rail,"mouseenter",function(){return b.ispage||b.win.is(":visible")?(b.canshowonmouseevent&&b.showCursor(),void(b.rail.active=!0)):!1}),b.jqbind(b.rail,"mouseleave",function(){b.rail.active=!1,b.rail.drag||b.hideCursor()}),b.opt.sensitiverail&&(b.bind(b.rail,"click",function(e){b.doRailClick(e,!1,!1)}),b.bind(b.rail,"dblclick",function(e){b.doRailClick(e,!0,!1)}),b.bind(b.cursor,"click",function(e){b.cancelEvent(e)}),b.bind(b.cursor,"dblclick",function(e){b.cancelEvent(e)})),b.railh&&(b.jqbind(b.railh,"mouseenter",function(){return b.ispage||b.win.is(":visible")?(b.canshowonmouseevent&&b.showCursor(),void(b.rail.active=!0)):!1}),b.jqbind(b.railh,"mouseleave",function(){b.rail.active=!1,b.rail.drag||b.hideCursor()}),b.opt.sensitiverail&&(b.bind(b.railh,"click",function(e){b.doRailClick(e,!1,!0)}),b.bind(b.railh,"dblclick",function(e){b.doRailClick(e,!0,!0)}),b.bind(b.cursorh,"click",function(e){b.cancelEvent(e)}),b.bind(b.cursorh,"dblclick",function(e){b.cancelEvent(e)})))),y.cantouch||b.opt.touchbehavior?(b.bind(y.hasmousecapture?b.win:document,"mouseup",b.ontouchend),b.bind(document,"mousemove",b.ontouchmove),b.onclick&&b.bind(document,"click",b.onclick),b.opt.cursordragontouch&&(b.bind(b.cursor,"mousedown",b.onmousedown),b.bind(b.cursor,"mouseup",b.onmouseup),b.cursorh&&b.bind(b.cursorh,"mousedown",function(e){b.onmousedown(e,!0)}),b.cursorh&&b.bind(b.cursorh,"mouseup",b.onmouseup))):(b.bind(y.hasmousecapture?b.win:document,"mouseup",b.onmouseup),b.bind(document,"mousemove",b.onmousemove),b.onclick&&b.bind(document,"click",b.onclick),b.bind(b.cursor,"mousedown",b.onmousedown),b.bind(b.cursor,"mouseup",b.onmouseup),b.railh&&(b.bind(b.cursorh,"mousedown",function(e){b.onmousedown(e,!0)}),b.bind(b.cursorh,"mouseup",b.onmouseup)),!b.ispage&&b.opt.enablescrollonselection&&(b.bind(b.win[0],"mousedown",b.onselectionstart),b.bind(document,"mouseup",b.onselectionend),b.bind(b.cursor,"mouseup",b.onselectionend),b.cursorh&&b.bind(b.cursorh,"mouseup",b.onselectionend),b.bind(document,"mousemove",b.onselectiondrag)),b.zoom&&(b.jqbind(b.zoom,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor(),b.rail.active=!0}),b.jqbind(b.zoom,"mouseleave",function(){b.rail.active=!1,b.rail.drag||b.hideCursor()}))),b.opt.enablemousewheel&&(b.isiframe||b.bind(y.isie&&b.ispage?document:b.win,"mousewheel",b.onmousewheel),b.bind(b.rail,"mousewheel",b.onmousewheel),b.railh&&b.bind(b.railh,"mousewheel",b.onmousewheelhr)),b.ispage||y.cantouch||/HTML|^BODY/.test(b.win[0].nodeName)||(b.win.attr("tabindex")||b.win.attr({tabindex:o++}),b.jqbind(b.win,"focus",function(e){a=b.getTarget(e).id||!0,b.hasfocus=!0,b.canshowonmouseevent&&b.noticeCursor()}),b.jqbind(b.win,"blur",function(e){a=!1,b.hasfocus=!1}),b.jqbind(b.win,"mouseenter",function(e){n=b.getTarget(e).id||!0,b.hasmousefocus=!0,b.canshowonmouseevent&&b.noticeCursor()}),b.jqbind(b.win,"mouseleave",function(){n=!1,b.hasmousefocus=!1,b.rail.drag||b.hideCursor()}))}if(b.onkeypress=function(e){if(b.railslocked&&0==b.page.maxh)return!0;e=e?e:window.e;var t=b.getTarget(e);if(t&&/INPUT|TEXTAREA|SELECT|OPTION/.test(t.nodeName)){var i=t.getAttribute("type")||t.type||!1;if(!i||!/submit|button|cancel/i.tp)return!0}if(l(t).attr("contenteditable"))return!0;if(b.hasfocus||b.hasmousefocus&&!a||b.ispage&&!a&&!n){var o=e.keyCode;if(b.railslocked&&27!=o)return b.cancelEvent(e);var s=e.ctrlKey||!1,r=e.shiftKey||!1,c=!1;switch(o){case 38:case 63233:b.doScrollBy(72),c=!0;break;case 40:case 63235:b.doScrollBy(-72),c=!0;break;case 37:case 63232:b.railh&&(s?b.doScrollLeft(0):b.doScrollLeftBy(72),c=!0);break;case 39:case 63234:b.railh&&(s?b.doScrollLeft(b.page.maxw):b.doScrollLeftBy(-72),c=!0);break;case 33:case 63276:b.doScrollBy(b.view.h),c=!0;break;case 34:case 63277:b.doScrollBy(-b.view.h),c=!0;break;case 36:case 63273:b.railh&&s?b.doScrollPos(0,0):b.doScrollTo(0),c=!0;break;case 35:case 63275:b.railh&&s?b.doScrollPos(b.page.maxw,b.page.maxh):b.doScrollTo(b.page.maxh),c=!0;break;case 32:b.opt.spacebarenabled&&(r?b.doScrollBy(b.view.h):b.doScrollBy(-b.view.h),c=!0);break;case 27:b.zoomactive&&(b.doZoom(),c=!0)}if(c)return b.cancelEvent(e)}},b.opt.enablekeyboard&&b.bind(document,y.isopera&&!y.isopera12?"keypress":"keydown",b.onkeypress),b.bind(document,"keydown",function(e){var t=e.ctrlKey||!1;t&&(b.wheelprevented=!0)}),b.bind(document,"keyup",function(e){var t=e.ctrlKey||!1;t||(b.wheelprevented=!1)}),b.bind(window,"blur",function(e){b.wheelprevented=!1}),b.bind(window,"resize",b.lazyResize),b.bind(window,"orientationchange",b.lazyResize),b.bind(window,"load",b.lazyResize),y.ischrome&&!b.ispage&&!b.haswrapper){var C=b.win.attr("style"),S=parseFloat(b.win.css("width"))+1;b.win.css("width",S),b.synched("chromefix",function(){b.win.attr("style",C)})}b.onAttributeChange=function(e){b.lazyResize(b.isieold?250:30)},f!==!1&&(b.observerbody=new f(function(e){return e.forEach(function(e){return"attributes"==e.type?l("body").hasClass("modal-open")?b.hide():b.show():void 0}),document.body.scrollHeight!=b.page.maxh?b.lazyResize(30):void 0}),b.observerbody.observe(document.body,{childList:!0,subtree:!0,characterData:!1,attributes:!0,attributeFilter:["class"]})),b.ispage||b.haswrapper||(f!==!1?(b.observer=new f(function(e){e.forEach(b.onAttributeChange)}),b.observer.observe(b.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),b.observerremover=new f(function(e){e.forEach(function(e){if(e.removedNodes.length>0)for(var t in e.removedNodes)if(b&&e.removedNodes[t]==b.win[0])return b.remove()})}),b.observerremover.observe(b.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(b.bind(b.win,y.isie&&!y.isie9?"propertychange":"DOMAttrModified",b.onAttributeChange),y.isie9&&b.win[0].attachEvent("onpropertychange",b.onAttributeChange),b.bind(b.win,"DOMNodeRemoved",function(e){e.target==b.win[0]&&b.remove()}))),!b.ispage&&b.opt.boxzoom&&b.bind(window,"resize",b.resizeZoom),b.istextarea&&b.bind(b.win,"mouseup",b.lazyResize),b.lazyResize(30)}if("IFRAME"==this.doc[0].nodeName){var T=function(){b.iframexd=!1;var e;try{e="contentDocument"in this?this.contentDocument:this.contentWindow.document;e.domain}catch(t){b.iframexd=!0,e=!1}if(b.iframexd)return"console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0;if(b.forcescreen=!0,b.isiframe&&(b.iframe={doc:l(e),html:b.doc.contents().find("html")[0],body:b.doc.contents().find("body")[0]},b.getContentSize=function(){return{w:Math.max(b.iframe.html.scrollWidth,b.iframe.body.scrollWidth),h:Math.max(b.iframe.html.scrollHeight,b.iframe.body.scrollHeight)}},b.docscroll=l(b.iframe.body)),!y.isios&&b.opt.iframeautoresize&&!b.isiframe){b.win.scrollTop(0),b.doc.height("");var i=Math.max(e.getElementsByTagName("html")[0].scrollHeight,e.body.scrollHeight);b.doc.height(i)}b.lazyResize(30),y.isie7&&b.css(l(b.iframe.html),{"overflow-y":"hidden"}),b.css(l(b.iframe.body),{"overflow-y":"hidden"}),y.isios&&b.haswrapper&&b.css(l(e.body),{"-webkit-transform":"translate3d(0,0,0)"}),"contentWindow"in this?b.bind(this.contentWindow,"scroll",b.onscroll):b.bind(e,"scroll",b.onscroll),b.opt.enablemousewheel&&b.bind(e,"mousewheel",b.onmousewheel),b.opt.enablekeyboard&&b.bind(e,y.isopera?"keypress":"keydown",b.onkeypress),(y.cantouch||b.opt.touchbehavior)&&(b.bind(e,"mousedown",b.ontouchstart),b.bind(e,"mousemove",function(e){return b.ontouchmove(e,!0)}),b.opt.grabcursorenabled&&y.cursorgrabvalue&&b.css(l(e.body),{cursor:y.cursorgrabvalue})),b.bind(e,"mouseup",b.ontouchend),b.zoom&&(b.opt.dblclickzoom&&b.bind(e,"dblclick",b.doZoom),b.ongesturezoom&&b.bind(e,"gestureend",b.ongesturezoom))};this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){T.call(b.doc[0],!1)},500),b.bind(this.doc,"load",T)}},this.showCursor=function(e,t){if(b.cursortimeout&&(clearTimeout(b.cursortimeout),b.cursortimeout=0),b.rail){if(b.autohidedom&&(b.autohidedom.stop().css({opacity:b.opt.cursoropacitymax}),b.cursoractive=!0),b.rail.drag&&1==b.rail.drag.pt||("undefined"!=typeof e&&e!==!1&&(b.scroll.y=Math.round(1*e/b.scrollratio.y)),"undefined"!=typeof t&&(b.scroll.x=Math.round(1*t/b.scrollratio.x))),b.cursor.css({height:b.cursorheight,top:b.scroll.y}),b.cursorh){var i=b.hasreversehr?b.scrollvaluemaxw-b.scroll.x:b.scroll.x;!b.rail.align&&b.rail.visibility?b.cursorh.css({width:b.cursorwidth,left:i+b.rail.width}):b.cursorh.css({width:b.cursorwidth,left:i}),b.cursoractive=!0}b.zoom&&b.zoom.stop().css({opacity:b.opt.cursoropacitymax})}},this.hideCursor=function(e){b.cursortimeout||b.rail&&b.autohidedom&&(b.hasmousefocus&&"leave"==b.opt.autohidemode||(b.cursortimeout=setTimeout(function(){b.rail.active&&b.showonmouseevent||(b.autohidedom.stop().animate({opacity:b.opt.cursoropacitymin}),b.zoom&&b.zoom.stop().animate({opacity:b.opt.cursoropacitymin}),b.cursoractive=!1),b.cursortimeout=0},e||b.opt.hidecursordelay)))},this.noticeCursor=function(e,t,i){b.showCursor(t,i),b.rail.active||b.hideCursor(e)},this.getContentSize=b.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:b.haswrapper?function(){return{w:b.doc.outerWidth()+parseInt(b.win.css("paddingLeft"))+parseInt(b.win.css("paddingRight")),h:b.doc.outerHeight()+parseInt(b.win.css("paddingTop"))+parseInt(b.win.css("paddingBottom"))}}:function(){return{w:b.docscroll[0].scrollWidth,h:b.docscroll[0].scrollHeight}},this.onResize=function(e,t){if(!b||!b.win)return!1;if(!b.haswrapper&&!b.ispage){if("none"==b.win.css("display"))return b.visibility&&b.hideRail().hideRailHr(),!1;b.hidden||b.visibility||b.showRail().showRailHr()}var i=b.page.maxh,a=b.page.maxw,n={h:b.view.h,w:b.view.w};if(b.view={w:b.ispage?b.win.width():parseInt(b.win[0].clientWidth),h:b.ispage?b.win.height():parseInt(b.win[0].clientHeight)},b.page=t?t:b.getContentSize(),b.page.maxh=Math.max(0,b.page.h-b.view.h),b.page.maxw=Math.max(0,b.page.w-b.view.w),b.page.maxh==i&&b.page.maxw==a&&b.view.w==n.w&&b.view.h==n.h){if(b.ispage)return b;var o=b.win.offset();if(b.lastposition){var s=b.lastposition;if(s.top==o.top&&s.left==o.left)return b}b.lastposition=o}if(0==b.page.maxh?(b.hideRail(),b.scrollvaluemax=0,b.scroll.y=0,b.scrollratio.y=0,b.cursorheight=0,b.setScrollTop(0),b.rail.scrollable=!1):(b.page.maxh-=b.opt.railpadding.top+b.opt.railpadding.bottom,b.rail.scrollable=!0),0==b.page.maxw?(b.hideRailHr(),b.scrollvaluemaxw=0,b.scroll.x=0,b.scrollratio.x=0,b.cursorwidth=0,b.setScrollLeft(0),b.railh.scrollable=!1):(b.page.maxw-=b.opt.railpadding.left+b.opt.railpadding.right,b.railh.scrollable=!0),b.railslocked=b.locked||0==b.page.maxh&&0==b.page.maxw,b.railslocked)return b.ispage||b.updateScrollBar(b.view),!1;b.hidden||b.visibility?b.hidden||b.railh.visibility||b.showRailHr():b.showRail().showRailHr(),b.istextarea&&b.win.css("resize")&&"none"!=b.win.css("resize")&&(b.view.h-=20),b.cursorheight=Math.min(b.view.h,Math.round(b.view.h*(b.view.h/b.page.h))),b.cursorheight=b.opt.cursorfixedheight?b.opt.cursorfixedheight:Math.max(b.opt.cursorminheight,b.cursorheight),b.cursorwidth=Math.min(b.view.w,Math.round(b.view.w*(b.view.w/b.page.w))),b.cursorwidth=b.opt.cursorfixedheight?b.opt.cursorfixedheight:Math.max(b.opt.cursorminheight,b.cursorwidth),b.scrollvaluemax=b.view.h-b.cursorheight-b.cursor.hborder-(b.opt.railpadding.top+b.opt.railpadding.bottom),b.railh&&(b.railh.width=b.page.maxh>0?b.view.w-b.rail.width:b.view.w,b.scrollvaluemaxw=b.railh.width-b.cursorwidth-b.cursorh.wborder-(b.opt.railpadding.left+b.opt.railpadding.right)),b.ispage||b.updateScrollBar(b.view),b.scrollratio={x:b.page.maxw/b.scrollvaluemaxw,y:b.page.maxh/b.scrollvaluemax};var r=b.getScrollTop();return r>b.page.maxh?b.doScrollTop(b.page.maxh):(b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.scroll.x=Math.round(b.getScrollLeft()*(1/b.scrollratio.x)),b.cursoractive&&b.noticeCursor()),b.scroll.y&&0==b.getScrollTop()&&b.doScrollTo(Math.floor(b.scroll.y*b.scrollratio.y)),b},this.resize=b.onResize,this.lazyResize=function(e){return e=isNaN(e)?30:e,b.debounced("resize",b.resize,e),b},this.jqbind=function(e,t,i){b.events.push({e:e,n:t,f:i,q:!0}),l(e).bind(t,i)},this.bind=function(e,t,i,a){var n="jquery"in e?e[0]:e;if("mousewheel"==t)if(window.addEventListener||"onwheel"in document)b._bind(n,"wheel",i,a||!1);else{var o="undefined"!=typeof document.onmousewheel?"mousewheel":"DOMMouseScroll";p(n,o,i,a||!1),"DOMMouseScroll"==o&&p(n,"MozMousePixelScroll",i,a||!1)}else if(n.addEventListener){if(y.cantouch&&/mouseup|mousedown|mousemove/.test(t)){var s="mousedown"==t?"touchstart":"mouseup"==t?"touchend":"touchmove";b._bind(n,s,function(e){if(e.touches){if(e.touches.length<2){var t=e.touches.length?e.touches[0]:e;t.original=e,i.call(this,t)}}else if(e.changedTouches){var t=e.changedTouches[0];t.original=e,i.call(this,t)}},a||!1)}b._bind(n,t,i,a||!1),y.cantouch&&"mouseup"==t&&b._bind(n,"touchcancel",i,a||!1)}else b._bind(n,t,function(e){return e=e||window.event||!1,e&&e.srcElement&&(e.target=e.srcElement),"pageY"in e||(e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop),i.call(n,e)===!1||a===!1?b.cancelEvent(e):!0})},y.haseventlistener?(this._bind=function(e,t,i,a){b.events.push({e:e,n:t,f:i,b:a,q:!1}),e.addEventListener(t,i,a||!1)},this.cancelEvent=function(e){if(!e)return!1;var e=e.original?e.original:e;return e.preventDefault(),e.stopPropagation(),e.preventManipulation&&e.preventManipulation(),!1},this.stopPropagation=function(e){if(!e)return!1;var e=e.original?e.original:e;return e.stopPropagation(),!1},this._unbind=function(e,t,i,a){e.removeEventListener(t,i,a)}):(this._bind=function(e,t,i,a){b.events.push({e:e,n:t,f:i,b:a,q:!1}),e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},this.cancelEvent=function(e){var e=window.event||!1;return e?(e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1,!1):!1},this.stopPropagation=function(e){var e=window.event||!1;return e?(e.cancelBubble=!0,!1):!1},this._unbind=function(e,t,i,a){e.detachEvent?e.detachEvent("on"+t,i):e["on"+t]=!1}),this.unbindAll=function(){for(var e=0;e<b.events.length;e++){var t=b.events[e];t.q?t.e.unbind(t.n,t.f):b._unbind(t.e,t.n,t.f,t.b)}},this.showRail=function(){return 0==b.page.maxh||!b.ispage&&"none"==b.win.css("display")||(b.visibility=!0,b.rail.visibility=!0,b.rail.css("display","block")),b},this.showRailHr=function(){return b.railh?(0==b.page.maxw||!b.ispage&&"none"==b.win.css("display")||(b.railh.visibility=!0,b.railh.css("display","block")),b):b},this.hideRail=function(){return b.visibility=!1,b.rail.visibility=!1,b.rail.css("display","none"),b},this.hideRailHr=function(){return b.railh?(b.railh.visibility=!1,b.railh.css("display","none"),b):b},this.show=function(){return b.hidden=!1,b.railslocked=!1,b.showRail().showRailHr()},this.hide=function(){return b.hidden=!0,b.railslocked=!0,b.hideRail().hideRailHr()},this.toggle=function(){return b.hidden?b.show():b.hide()},this.remove=function(){b.stop(),b.cursortimeout&&clearTimeout(b.cursortimeout),b.doZoomOut(),b.unbindAll(),y.isie9&&b.win[0].detachEvent("onpropertychange",b.onAttributeChange),b.observer!==!1&&b.observer.disconnect(),b.observerremover!==!1&&b.observerremover.disconnect(),b.observerbody!==!1&&b.observerbody.disconnect(),b.events=null,b.cursor&&b.cursor.remove(),b.cursorh&&b.cursorh.remove(),b.rail&&b.rail.remove(),b.railh&&b.railh.remove(),b.zoom&&b.zoom.remove();for(var e=0;e<b.saved.css.length;e++){var t=b.saved.css[e];t[0].css(t[1],"undefined"==typeof t[2]?"":t[2])}b.saved=!1,b.me.data("__nicescroll","");var i=l.nicescroll;i.each(function(e){if(this&&this.id===b.id){delete i[e];for(var t=++e;t<i.length;t++,e++)i[e]=i[t];i.length--,i.length&&delete i[i.length]}});for(var a in b)b[a]=null,delete b[a];b=null},this.scrollstart=function(e){return this.onscrollstart=e,b},this.scrollend=function(e){return this.onscrollend=e,b},this.scrollcancel=function(e){return this.onscrollcancel=e,b},this.zoomin=function(e){return this.onzoomin=e,b},this.zoomout=function(e){return this.onzoomout=e,b},this.isScrollable=function(e){var t=e.target?e.target:e;if("OPTION"==t.nodeName)return!0;for(;t&&1==t.nodeType&&!/^BODY|HTML/.test(t.nodeName);){var i=l(t),a=i.css("overflowY")||i.css("overflowX")||i.css("overflow")||"";if(/scroll|auto/.test(a))return t.clientHeight!=t.scrollHeight;t=t.parentNode?t.parentNode:!1}return!1},this.getViewport=function(e){for(var t=e&&e.parentNode?e.parentNode:!1;t&&1==t.nodeType&&!/^BODY|HTML/.test(t.nodeName);){var i=l(t);if(/fixed|absolute/.test(i.css("position")))return i;var a=i.css("overflowY")||i.css("overflowX")||i.css("overflow")||"";if(/scroll|auto/.test(a)&&t.clientHeight!=t.scrollHeight)return i;if(i.getNiceScroll().length>0)return i;t=t.parentNode?t.parentNode:!1}return!1},this.triggerScrollEnd=function(){if(b.onscrollend){var e=b.getScrollLeft(),t=b.getScrollTop(),i={type:"scrollend",current:{x:e,y:t},end:{x:e,y:t}};b.onscrollend.call(b,i)}},this.onmousewheel=function(e){if(!b.wheelprevented){if(b.railslocked)return b.debounced("checkunlock",b.resize,250),!0;if(b.rail.drag)return b.cancelEvent(e);if("auto"==b.opt.oneaxismousemode&&0!=e.deltaX&&(b.opt.oneaxismousemode=!1),b.opt.oneaxismousemode&&0==e.deltaX&&!b.rail.scrollable)return b.railh&&b.railh.scrollable?b.onmousewheelhr(e):!0;var t=+new Date,i=!1;if(b.opt.preservenativescrolling&&b.checkarea+600<t&&(b.nativescrollingarea=b.isScrollable(e),i=!0),b.checkarea=t,b.nativescrollingarea)return!0;var a=m(e,!1,i);return a&&(b.checkarea=0),a}},this.onmousewheelhr=function(e){if(!b.wheelprevented){if(b.railslocked||!b.railh.scrollable)return!0;if(b.rail.drag)return b.cancelEvent(e);var t=+new Date,i=!1;return b.opt.preservenativescrolling&&b.checkarea+600<t&&(b.nativescrollingarea=b.isScrollable(e),i=!0),b.checkarea=t,
b.nativescrollingarea?!0:b.railslocked?b.cancelEvent(e):m(e,!0,i)}},this.stop=function(){return b.cancelScroll(),b.scrollmon&&b.scrollmon.stop(),b.cursorfreezed=!1,b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.noticeCursor(),b},this.getTransitionSpeed=function(e){var t=Math.round(10*b.opt.scrollspeed),i=Math.min(t,Math.round(e/20*b.opt.scrollspeed));return i>20?i:0},b.opt.smoothscroll?b.ishwscroll&&y.hastransition&&b.opt.usetransition&&b.opt.smoothscroll?(this.prepareTransition=function(e,t){var i=t?e>20?e:0:b.getTransitionSpeed(e),a=i?y.prefixstyle+"transform "+i+"ms ease-out":"";return b.lasttransitionstyle&&b.lasttransitionstyle==a||(b.lasttransitionstyle=a,b.doc.css(y.transitionstyle,a)),i},this.doScrollLeft=function(e,t){var i=b.scrollrunning?b.newscrolly:b.getScrollTop();b.doScrollPos(e,i,t)},this.doScrollTop=function(e,t){var i=b.scrollrunning?b.newscrollx:b.getScrollLeft();b.doScrollPos(i,e,t)},this.doScrollPos=function(e,t,i){var a=b.getScrollTop(),n=b.getScrollLeft();return((b.newscrolly-a)*(t-a)<0||(b.newscrollx-n)*(e-n)<0)&&b.cancelScroll(),0==b.opt.bouncescroll&&(0>t?t=0:t>b.page.maxh&&(t=b.page.maxh),0>e?e=0:e>b.page.maxw&&(e=b.page.maxw)),b.scrollrunning&&e==b.newscrollx&&t==b.newscrolly?!1:(b.newscrolly=t,b.newscrollx=e,b.newscrollspeed=i||!1,b.timer?!1:void(b.timer=setTimeout(function(){var i=b.getScrollTop(),a=b.getScrollLeft(),n={};n.x=e-a,n.y=t-i,n.px=a,n.py=i;var o=Math.round(Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))),s=b.newscrollspeed&&b.newscrollspeed>1?b.newscrollspeed:b.getTransitionSpeed(o);if(b.newscrollspeed&&b.newscrollspeed<=1&&(s*=b.newscrollspeed),b.prepareTransition(s,!0),b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm),s>0){if(!b.scrollrunning&&b.onscrollstart){var r={type:"scrollstart",current:{x:a,y:i},request:{x:e,y:t},end:{x:b.newscrollx,y:b.newscrolly},speed:s};b.onscrollstart.call(b,r)}y.transitionend?b.scrollendtrapped||(b.scrollendtrapped=!0,b.bind(b.doc,y.transitionend,b.onScrollTransitionEnd,!1)):(b.scrollendtrapped&&clearTimeout(b.scrollendtrapped),b.scrollendtrapped=setTimeout(b.onScrollTransitionEnd,s));var l=i,c=a;b.timerscroll={bz:new k(l,b.newscrolly,s,0,0,.58,1),bh:new k(c,b.newscrollx,s,0,0,.58,1)},b.cursorfreezed||(b.timerscroll.tm=setInterval(function(){b.showCursor(b.getScrollTop(),b.getScrollLeft())},60))}b.synched("doScroll-set",function(){b.timer=0,b.scrollendtrapped&&(b.scrollrunning=!0),b.setScrollTop(b.newscrolly),b.setScrollLeft(b.newscrollx),b.scrollendtrapped||b.onScrollTransitionEnd()})},50)))},this.cancelScroll=function(){if(!b.scrollendtrapped)return!0;var e=b.getScrollTop(),t=b.getScrollLeft();return b.scrollrunning=!1,y.transitionend||clearTimeout(y.transitionend),b.scrollendtrapped=!1,b._unbind(b.doc[0],y.transitionend,b.onScrollTransitionEnd),b.prepareTransition(0),b.setScrollTop(e),b.railh&&b.setScrollLeft(t),b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm),b.timerscroll=!1,b.cursorfreezed=!1,b.showCursor(e,t),b},this.onScrollTransitionEnd=function(){b.scrollendtrapped&&b._unbind(b.doc[0],y.transitionend,b.onScrollTransitionEnd),b.scrollendtrapped=!1,b.prepareTransition(0),b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm),b.timerscroll=!1;var e=b.getScrollTop(),t=b.getScrollLeft();return b.setScrollTop(e),b.railh&&b.setScrollLeft(t),b.noticeCursor(!1,e,t),b.cursorfreezed=!1,0>e?e=0:e>b.page.maxh&&(e=b.page.maxh),0>t?t=0:t>b.page.maxw&&(t=b.page.maxw),e!=b.newscrolly||t!=b.newscrollx?b.doScrollPos(t,e,b.opt.snapbackspeed):(b.onscrollend&&b.scrollrunning&&b.triggerScrollEnd(),void(b.scrollrunning=!1))}):(this.doScrollLeft=function(e,t){var i=b.scrollrunning?b.newscrolly:b.getScrollTop();b.doScrollPos(e,i,t)},this.doScrollTop=function(e,t){var i=b.scrollrunning?b.newscrollx:b.getScrollLeft();b.doScrollPos(i,e,t)},this.doScrollPos=function(e,t,i){function a(){if(b.cancelAnimationFrame)return!0;if(b.scrollrunning=!0,h=1-h)return b.timer=d(a)||1;var e,t,i=0,n=t=b.getScrollTop();if(b.dst.ay){n=b.bzscroll?b.dst.py+b.bzscroll.getNow()*b.dst.ay:b.newscrolly;var o=n-t;(0>o&&n<b.newscrolly||o>0&&n>b.newscrolly)&&(n=b.newscrolly),b.setScrollTop(n),n==b.newscrolly&&(i=1)}else i=1;var s=e=b.getScrollLeft();if(b.dst.ax){s=b.bzscroll?b.dst.px+b.bzscroll.getNow()*b.dst.ax:b.newscrollx;var o=s-e;(0>o&&s<b.newscrollx||o>0&&s>b.newscrollx)&&(s=b.newscrollx),b.setScrollLeft(s),s==b.newscrollx&&(i+=1)}else i+=1;2==i?(b.timer=0,b.cursorfreezed=!1,b.bzscroll=!1,b.scrollrunning=!1,0>n?n=0:n>b.page.maxh&&(n=b.page.maxh),0>s?s=0:s>b.page.maxw&&(s=b.page.maxw),s!=b.newscrollx||n!=b.newscrolly?b.doScrollPos(s,n):b.onscrollend&&b.triggerScrollEnd()):b.timer=d(a)||1}var t="undefined"==typeof t||t===!1?b.getScrollTop(!0):t;if(b.timer&&b.newscrolly==t&&b.newscrollx==e)return!0;b.timer&&u(b.timer),b.timer=0;var n=b.getScrollTop(),o=b.getScrollLeft();((b.newscrolly-n)*(t-n)<0||(b.newscrollx-o)*(e-o)<0)&&b.cancelScroll(),b.newscrolly=t,b.newscrollx=e,b.bouncescroll&&b.rail.visibility||(b.newscrolly<0?b.newscrolly=0:b.newscrolly>b.page.maxh&&(b.newscrolly=b.page.maxh)),b.bouncescroll&&b.railh.visibility||(b.newscrollx<0?b.newscrollx=0:b.newscrollx>b.page.maxw&&(b.newscrollx=b.page.maxw)),b.dst={},b.dst.x=e-o,b.dst.y=t-n,b.dst.px=o,b.dst.py=n;var s=Math.round(Math.sqrt(Math.pow(b.dst.x,2)+Math.pow(b.dst.y,2)));b.dst.ax=b.dst.x/s,b.dst.ay=b.dst.y/s;var r=0,l=s;0==b.dst.x?(r=n,l=t,b.dst.ay=1,b.dst.py=0):0==b.dst.y&&(r=o,l=e,b.dst.ax=1,b.dst.px=0);var c=b.getTransitionSpeed(s);if(i&&1>=i&&(c*=i),c>0?b.bzscroll=b.bzscroll?b.bzscroll.update(l,c):new k(r,l,c,0,1,0,1):b.bzscroll=!1,!b.timer){(n==b.page.maxh&&t>=b.page.maxh||o==b.page.maxw&&e>=b.page.maxw)&&b.checkContentSize();var h=1;if(b.cancelAnimationFrame=!1,b.timer=1,b.onscrollstart&&!b.scrollrunning){var p={type:"scrollstart",current:{x:o,y:n},request:{x:e,y:t},end:{x:b.newscrollx,y:b.newscrolly},speed:c};b.onscrollstart.call(b,p)}a(),(n==b.page.maxh&&t>=n||o==b.page.maxw&&e>=o)&&b.checkContentSize(),b.noticeCursor()}},this.cancelScroll=function(){return b.timer&&u(b.timer),b.timer=0,b.bzscroll=!1,b.scrollrunning=!1,b}):(this.doScrollLeft=function(e,t){var i=b.getScrollTop();b.doScrollPos(e,i,t)},this.doScrollTop=function(e,t){var i=b.getScrollLeft();b.doScrollPos(i,e,t)},this.doScrollPos=function(e,t,i){var a=e>b.page.maxw?b.page.maxw:e;0>a&&(a=0);var n=t>b.page.maxh?b.page.maxh:t;0>n&&(n=0),b.synched("scroll",function(){b.setScrollTop(n),b.setScrollLeft(a)})},this.cancelScroll=function(){}),this.doScrollBy=function(e,t){var i=0;if(t)i=Math.floor((b.scroll.y-e)*b.scrollratio.y);else{var a=b.timer?b.newscrolly:b.getScrollTop(!0);i=a-e}if(b.bouncescroll){var n=Math.round(b.view.h/2);-n>i?i=-n:i>b.page.maxh+n&&(i=b.page.maxh+n)}b.cursorfreezed=!1;var o=b.getScrollTop(!0);return 0>i&&0>=o?b.noticeCursor():i>b.page.maxh&&o>=b.page.maxh?(b.checkContentSize(),b.noticeCursor()):void b.doScrollTop(i)},this.doScrollLeftBy=function(e,t){var i=0;if(t)i=Math.floor((b.scroll.x-e)*b.scrollratio.x);else{var a=b.timer?b.newscrollx:b.getScrollLeft(!0);i=a-e}if(b.bouncescroll){var n=Math.round(b.view.w/2);-n>i?i=-n:i>b.page.maxw+n&&(i=b.page.maxw+n)}b.cursorfreezed=!1;var o=b.getScrollLeft(!0);return 0>i&&0>=o?b.noticeCursor():i>b.page.maxw&&o>=b.page.maxw?b.noticeCursor():void b.doScrollLeft(i)},this.doScrollTo=function(e,t){var i=t?Math.round(e*b.scrollratio.y):e;0>i?i=0:i>b.page.maxh&&(i=b.page.maxh),b.cursorfreezed=!1,b.doScrollTop(e)},this.checkContentSize=function(){var e=b.getContentSize();(e.h!=b.page.h||e.w!=b.page.w)&&b.resize(!1,e)},b.onscroll=function(e){b.rail.drag||b.cursorfreezed||b.synched("scroll",function(){b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.railh&&(b.scroll.x=Math.round(b.getScrollLeft()*(1/b.scrollratio.x))),b.noticeCursor()})},b.bind(b.docscroll,"scroll",b.onscroll),this.doZoomIn=function(e){if(!b.zoomactive){b.zoomactive=!0,b.zoomrestore={style:{}};var t=["position","top","left","zIndex","backgroundColor","marginTop","marginBottom","marginLeft","marginRight"],i=b.win[0].style;for(var a in t){var n=t[a];b.zoomrestore.style[n]="undefined"!=typeof i[n]?i[n]:""}b.zoomrestore.style.width=b.win.css("width"),b.zoomrestore.style.height=b.win.css("height"),b.zoomrestore.padding={w:b.win.outerWidth()-b.win.width(),h:b.win.outerHeight()-b.win.height()},y.isios4&&(b.zoomrestore.scrollTop=l(window).scrollTop(),l(window).scrollTop(0)),b.win.css({position:y.isios4?"absolute":"fixed",top:0,left:0,"z-index":r+100,margin:"0px"});var o=b.win.css("backgroundColor");return(""==o||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(o))&&b.win.css("backgroundColor","#fff"),b.rail.css({"z-index":r+101}),b.zoom.css({"z-index":r+102}),b.zoom.css("backgroundPosition","0px -18px"),b.resizeZoom(),b.onzoomin&&b.onzoomin.call(b),b.cancelEvent(e)}},this.doZoomOut=function(e){return b.zoomactive?(b.zoomactive=!1,b.win.css("margin",""),b.win.css(b.zoomrestore.style),y.isios4&&l(window).scrollTop(b.zoomrestore.scrollTop),b.rail.css({"z-index":b.zindex}),b.zoom.css({"z-index":b.zindex}),b.zoomrestore=!1,b.zoom.css("backgroundPosition","0px 0px"),b.onResize(),b.onzoomout&&b.onzoomout.call(b),b.cancelEvent(e)):void 0},this.doZoom=function(e){return b.zoomactive?b.doZoomOut(e):b.doZoomIn(e)},this.resizeZoom=function(){if(b.zoomactive){var e=b.getScrollTop();b.win.css({width:l(window).width()-b.zoomrestore.padding.w+"px",height:l(window).height()-b.zoomrestore.padding.h+"px"}),b.onResize(),b.setScrollTop(Math.min(b.page.maxh,e))}},this.init(),l.nicescroll.push(this)},w=function(e){var t=this;this.nc=e,this.lastx=0,this.lasty=0,this.speedx=0,this.speedy=0,this.lasttime=0,this.steptime=0,this.snapx=!1,this.snapy=!1,this.demulx=0,this.demuly=0,this.lastscrollx=-1,this.lastscrolly=-1,this.chkx=0,this.chky=0,this.timer=0,this.time=function(){return+new Date},this.reset=function(e,i){t.stop();var a=t.time();t.steptime=0,t.lasttime=a,t.speedx=0,t.speedy=0,t.lastx=e,t.lasty=i,t.lastscrollx=-1,t.lastscrolly=-1},this.update=function(e,i){var a=t.time();t.steptime=a-t.lasttime,t.lasttime=a;var n=i-t.lasty,o=e-t.lastx,s=t.nc.getScrollTop(),r=t.nc.getScrollLeft(),l=s+n,c=r+o;t.snapx=0>c||c>t.nc.page.maxw,t.snapy=0>l||l>t.nc.page.maxh,t.speedx=o,t.speedy=n,t.lastx=e,t.lasty=i},this.stop=function(){t.nc.unsynched("domomentum2d"),t.timer&&clearTimeout(t.timer),t.timer=0,t.lastscrollx=-1,t.lastscrolly=-1},this.doSnapy=function(e,i){var a=!1;0>i?(i=0,a=!0):i>t.nc.page.maxh&&(i=t.nc.page.maxh,a=!0),0>e?(e=0,a=!0):e>t.nc.page.maxw&&(e=t.nc.page.maxw,a=!0),a?t.nc.doScrollPos(e,i,t.nc.opt.snapbackspeed):t.nc.triggerScrollEnd()},this.doMomentum=function(e){var i=t.time(),a=e?i+e:t.lasttime,n=t.nc.getScrollLeft(),o=t.nc.getScrollTop(),s=t.nc.page.maxh,r=t.nc.page.maxw;t.speedx=r>0?Math.min(60,t.speedx):0,t.speedy=s>0?Math.min(60,t.speedy):0;var l=a&&60>=i-a;(0>o||o>s||0>n||n>r)&&(l=!1);var c=t.speedy&&l?t.speedy:!1,d=t.speedx&&l?t.speedx:!1;if(c||d){var u=Math.max(16,t.steptime);if(u>50){var h=u/50;t.speedx*=h,t.speedy*=h,u=50}t.demulxy=0,t.lastscrollx=t.nc.getScrollLeft(),t.chkx=t.lastscrollx,t.lastscrolly=t.nc.getScrollTop(),t.chky=t.lastscrolly;var p=t.lastscrollx,f=t.lastscrolly,g=function(){var e=t.time()-i>600?.04:.02;t.speedx&&(p=Math.floor(t.lastscrollx-t.speedx*(1-t.demulxy)),t.lastscrollx=p,(0>p||p>r)&&(e=.1)),t.speedy&&(f=Math.floor(t.lastscrolly-t.speedy*(1-t.demulxy)),t.lastscrolly=f,(0>f||f>s)&&(e=.1)),t.demulxy=Math.min(1,t.demulxy+e),t.nc.synched("domomentum2d",function(){if(t.speedx){var e=t.nc.getScrollLeft();e!=t.chkx&&t.stop(),t.chkx=p,t.nc.setScrollLeft(p)}if(t.speedy){var i=t.nc.getScrollTop();i!=t.chky&&t.stop(),t.chky=f,t.nc.setScrollTop(f)}t.timer||(t.nc.hideCursor(),t.doSnapy(p,f))}),t.demulxy<1?t.timer=setTimeout(g,u):(t.stop(),t.nc.hideCursor(),t.doSnapy(p,f))};g()}else t.doSnapy(t.nc.getScrollLeft(),t.nc.getScrollTop())}},_=e.fn.scrollTop;e.cssHooks.pageYOffset={get:function(e,t,i){var a=l.data(e,"__nicescroll")||!1;return a&&a.ishwscroll?a.getScrollTop():_.call(e)},set:function(e,t){var i=l.data(e,"__nicescroll")||!1;return i&&i.ishwscroll?i.setScrollTop(parseInt(t)):_.call(e,t),this}},e.fn.scrollTop=function(e){if("undefined"==typeof e){var t=this[0]?l.data(this[0],"__nicescroll")||!1:!1;return t&&t.ishwscroll?t.getScrollTop():_.call(this)}return this.each(function(){var t=l.data(this,"__nicescroll")||!1;t&&t.ishwscroll?t.setScrollTop(parseInt(e)):_.call(l(this),e)})};var y=e.fn.scrollLeft;l.cssHooks.pageXOffset={get:function(e,t,i){var a=l.data(e,"__nicescroll")||!1;return a&&a.ishwscroll?a.getScrollLeft():y.call(e)},set:function(e,t){var i=l.data(e,"__nicescroll")||!1;return i&&i.ishwscroll?i.setScrollLeft(parseInt(t)):y.call(e,t),this}},e.fn.scrollLeft=function(e){if("undefined"==typeof e){var t=this[0]?l.data(this[0],"__nicescroll")||!1:!1;return t&&t.ishwscroll?t.getScrollLeft():y.call(this)}return this.each(function(){var t=l.data(this,"__nicescroll")||!1;t&&t.ishwscroll?t.setScrollLeft(parseInt(e)):y.call(l(this),e)})};var x=function(e){var t=this;if(this.length=0,this.name="nicescrollarray",this.each=function(e){for(var i=0,a=0;i<t.length;i++)e.call(t[i],a++);return t},this.push=function(e){t[t.length]=e,t.length++},this.eq=function(e){return t[e]},e)for(var i=0;i<e.length;i++){var a=l.data(e[i],"__nicescroll")||!1;a&&(this[this.length]=a,this.length++)}return this};i(x.prototype,["show","hide","toggle","onResize","resize","remove","stop","doScrollPos"],function(e,t){e[t]=function(){var e=arguments;return this.each(function(){this[t].apply(this,e)})}}),e.fn.getNiceScroll=function(e){if("undefined"==typeof e)return new x(this);var t=this[e]&&l.data(this[e],"__nicescroll")||!1;return t},e.extend(e.expr[":"],{nicescroll:function(e){return l.data(e,"__nicescroll")?!0:!1}}),l.fn.niceScroll=function(e,t){"undefined"==typeof t&&("object"!=typeof e||"jquery"in e||(t=e,e=!1)),t=l.extend({},t);var i=new x;"undefined"==typeof t&&(t={}),e&&(t.doc=l(e),t.win=l(this));var a=!("doc"in t);return a||"win"in t||(t.win=l(this)),this.each(function(){var e=l(this).data("__nicescroll")||!1;e||(t.doc=a?l(this):t.doc,e=new b(t,l(this)),l(this).data("__nicescroll",e)),i.push(e)}),1==i.length?i[0]:i},window.NiceScroll={getjQuery:function(){return e}},l.nicescroll||(l.nicescroll=new x,l.nicescroll.options=g)}),function(e){var t=Array.prototype.slice,i={dict:null,load:function(t){var i=this;e.get(t,function(t){null!==i.dict?e.extend(i.dict,t):i.dict=t})},load:function(t,i){var a=this;e.ajaxSetup({async:!1,timeout:2e3}),e.get("lan/"+t+".json",function(t){null!==a.dict?e.extend(a.dict,t):a.dict=t,e.ajaxSetup({async:!0,timeout:3e4}),i()})},_:function(e){return dict=this.dict,dict&&dict.hasOwnProperty(e)?e=dict[e]:(e="[!"+e+"]",cns.debug("[!]error str: ",e)),args=t.call(arguments),args[0]=e,this.printf.apply(this,args)},getString:function(e){return this._.apply(i,arguments)},printf:function(i,a){return arguments.length<2?i:(a=e.isArray(a)?a:t.call(arguments,1),i.replace(/([^%]|^)%(?:(\d+)\$)?(@|d|ld)/g,function(e,t,i){return i?t+a[parseInt(i)-1]:t+a.shift()}).replace(/%%s/g,"%s"))}};e.fn._t=function(t,a){return e(this).html(i._.apply(i,arguments))},e.fn._i18n=function(t){e(this).find("[data-textid]").each(function(){var t=e(this).data("textid");e(this).html(i._.apply(i,[t]))}),e(this).find("[data-textph-id]").each(function(){var t=e(this).data("textph-id");e(this).attr("placeholder",i._.apply(i,[t]))})},e.i18n=i,e.i18n._t=function(e,t){return i._.apply(i,arguments)}}(jQuery);