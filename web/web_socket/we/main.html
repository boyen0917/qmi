<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8' />

</head>

<body>  
<div id="shot"></div>

<div id="spot"></div>
<img id="crosshair" src="image/Crosshair.png">

<img id="t1" src="image/player.png">
<img id="t2" src="image/player.png">

<img id="t3" src="image/player.png">

<img id="t4" src="image/player.png">
<img id="t5" src="image/player.png">


<script src="../../js/jquery.js"></script>
<script type="text/javascript">
$(function(){
	var wsUri = "ws://172.20.10.4:9000/demo/server.php"; 
	
	websocket = new WebSocket(wsUri);
    websocket.onopen = function()
    {
    };
    websocket.onmessage = function(e) {
    	
    	var obj = $.parseJSON(e.data);
    	if(obj.click){
    		$("#shot").html('<audio src="http://zjdx2.sc.chinaz.com/Files/DownLoad/sound1/201312/3874.mp3" autoplay></audio>');
    		if(isOverlap("crosshair","t1")){
                $("#t1").hide();
            }else if(isOverlap("crosshair","t2")){
                $("#t2").hide();
            }else if(isOverlap("crosshair","t3")){
                $("#t3").hide();
            }else if(isOverlap("crosshair","t4")){
                $("#t4").hide();
            }else  if(isOverlap("crosshair","t5")){
                $("#t5").hide();
            }
    	}else if(obj.reset){
            console.log("ya");
            $("img").show();
        }else{
    		$("#crosshair").css("left",obj.pos_x + "%");
            $("#crosshair").css("top",obj.pos_y + "%");
    	}
    }
    websocket.onclose = function(){
    };
});



function isOverlap(idOne,idTwo){ 
	var objOne=$("#"+idOne), 
	objTwo=$("#"+idTwo), 
	offsetOne = objOne.offset(), 
	offsetTwo = objTwo.offset(), 
	topOne=offsetOne.top, 
	topTwo=offsetTwo.top, 
	leftOne=offsetOne.left, 
	leftTwo=offsetTwo.left, 
	widthOne = objOne.width(), 
	widthTwo = objTwo.width(), 
	heightOne = objOne.height(), 
	heightTwo = objTwo.height(); 
	
	var target_x = leftOne+(widthOne)/2;
    var target_y = topOne+(heightOne)/2;
    
    var h = target_x >= leftTwo && target_x <= leftTwo+widthTwo;
    var v = target_y >= topTwo && target_y <= topTwo+heightTwo;
    
	return h && v; 
	} 


</script>
<style>

body{
    background:url(image/cs_bg.png) ;
    background-size:cover;
}

#crosshair{
    width:100px;
    position:absolute;
    z-index:100;
}

#t1{
    position:absolute;
    top: 66%;
	left: 10%;
	width: 18%;
}

#t2{
    position:absolute;
    top: 65%;
	left: 30%;
	width: 7%;
}

#t3{
    position:absolute;
    top: 70%;
    left: 73%;
    width: 15%;
}

#t4{
    position:absolute;
    top: 50%;
	left: 60%;
	width: 13%;
}

#t5{
    position:absolute;
    top: 38%;
	left: 35%;
	width: 8%;
}

</style>
</body>
</html>